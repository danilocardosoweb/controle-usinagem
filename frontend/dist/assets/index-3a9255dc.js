import{r as I,a as ox,g as cx,c as ka,b as Fs}from"./vendor-ce4ffebd.js";import{u as lx,N as dx,a as ux,O as fx,b as Mn,R as hx,c as Gr,B as mx}from"./router-4a89a537.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Iu={exports:{}},Zo={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xx=I,px=Symbol.for("react.element"),gx=Symbol.for("react.fragment"),vx=Object.prototype.hasOwnProperty,yx=xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bx={key:!0,ref:!0,__self:!0,__source:!0};function Ru(e,t,r){var a,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)vx.call(t,a)&&!bx.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:px,type:e,key:i,ref:o,props:s,_owner:yx.current}}Zo.Fragment=gx;Zo.jsx=Ru;Zo.jsxs=Ru;Iu.exports=Zo;var n=Iu.exports,Yc={},D0=ox;Yc.createRoot=D0.createRoot,Yc.hydrateRoot=D0.hydrateRoot;const wx="modulepreload",_x=function(e){return"/"+e},I0={},hn=function(t,r,a){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(i=>{if(i=_x(i),i in I0)return;I0[i]=!0;const o=i.endsWith(".css"),c=o?'[rel="stylesheet"]':"";if(!!a)for(let u=s.length-1;u>=0;u--){const f=s[u];if(f.href===i&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${c}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":wx,o||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),o)return new Promise((u,f)=>{d.addEventListener("load",u),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},Sx=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hn(()=>Promise.resolve().then(()=>ei),void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)};class Al extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class Nx extends Al{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class R0 extends Al{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class L0 extends Al{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Qc;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Qc||(Qc={}));var kx=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};class jx{constructor(t,{headers:r={},customFetch:a,region:s=Qc.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Sx(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var a;return kx(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=r;let c={},{region:l}=r;l||(l=this.region);const d=new URL(`${this.url}/${t}`);l&&l!=="any"&&(c["x-region"]=l,d.searchParams.set("forceFunctionRegion",l));let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(c["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(c["Content-Type"]="application/json",u=JSON.stringify(o)));const f=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),s),body:u}).catch(p=>{throw new Nx(p)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new R0(f);if(!f.ok)throw new L0(f);let h=((a=f.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),g;return h==="application/json"?g=yield f.json():h==="application/octet-stream"?g=yield f.blob():h==="text/event-stream"?g=f:h==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(s){return{data:null,error:s,response:s instanceof L0||s instanceof R0?s.context:void 0}}})}}var aa={},Cl={},ec={},Ji={},tc={},rc={},Ex=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xn=Ex();const Tx=Xn.fetch,Lu=Xn.fetch.bind(Xn),Mu=Xn.Headers,Ax=Xn.Request,Cx=Xn.Response,ei=Object.freeze(Object.defineProperty({__proto__:null,Headers:Mu,Request:Ax,Response:Cx,default:Lu,fetch:Tx},Symbol.toStringTag,{value:"Module"})),Fx=cx(ei);var ac={};Object.defineProperty(ac,"__esModule",{value:!0});let Px=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};ac.default=Px;var Bu=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rc,"__esModule",{value:!0});const Ox=Bu(Fx),Dx=Bu(ac);let Ix=class{constructor(t){var r,a;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(a=t.isMaybeSingle)!==null&&a!==void 0?a:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Ox.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let s=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,c,l,d;let u=null,f=null,m=null,h=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?f=_:f=JSON.parse(_))}const x=(c=this.headers.get("Prefer"))===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),w=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");x&&w&&w.length>1&&(m=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,h=406,g="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const x=await i.text();try{u=JSON.parse(x),Array.isArray(u)&&i.status===404&&(f=[],u=null,h=200,g="OK")}catch{i.status===404&&x===""?(h=204,g="No Content"):u={message:x}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,h=200,g="OK"),u&&this.shouldThrowOnError)throw new Dx.default(u)}return{error:u,data:f,count:m,status:h,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,c,l;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};rc.default=Ix;var Rx=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tc,"__esModule",{value:!0});const Lx=Rx(rc);let Mx=class extends Lx.default{select(t){let r=!1;const a=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:a,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${t}.${r?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:a=r}={}){const s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:a,referencedTable:s=a}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:a=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var c;const l=[t?"analyze":null,r?"verbose":null,a?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(c=this.headers.get("Accept"))!==null&&c!==void 0?c:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${l};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};tc.default=Mx;var Bx=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ji,"__esModule",{value:!0});const Ux=Bx(tc);let qx=class extends Ux.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const a=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${a})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:a,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=a===void 0?"":`(${a})`;return this.url.searchParams.append(t,`${i}fts${o}.${r}`),this}match(t){return Object.entries(t).forEach(([r,a])=>{this.url.searchParams.append(r,`eq.${a}`)}),this}not(t,r,a){return this.url.searchParams.append(t,`not.${r}.${a}`),this}or(t,{foreignTable:r,referencedTable:a=r}={}){const s=a?`${a}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,a){return this.url.searchParams.append(t,`${r}.${a}`),this}};Ji.default=qx;var $x=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ec,"__esModule",{value:!0});const di=$x(Ji);let Hx=class{constructor(t,{headers:r={},schema:a,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=a,this.fetch=s}select(t,{head:r=!1,count:a}={}){const s=r?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),a&&this.headers.append("Prefer",`count=${a}`),new di.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:a=!0}={}){var s;const i="POST";if(r&&this.headers.append("Prefer",`count=${r}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const o=t.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(o.length>0){const c=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",c.join(","))}}return new di.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:a=!1,count:s,defaultToNull:i=!0}={}){var o;const c="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(l.length>0){const d=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new di.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(t,{count:r}={}){var a;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new di.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:t}={}){var r;const a="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new di.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};ec.default=Hx;var Uu=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cl,"__esModule",{value:!0});const zx=Uu(ec),Wx=Uu(Ji);let Vx=class qu{constructor(t,{headers:r={},schema:a,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new zx.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new qu(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:s=!1,count:i}={}){var o;let c;const l=new URL(`${this.url}/rpc/${t}`);let d;a||s?(c=a?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{l.searchParams.append(f,m)})):(c="POST",d=r);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new Wx.default({method:c,url:l,headers:u,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};Cl.default=Vx;var ti=ka&&ka.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(aa,"__esModule",{value:!0});aa.PostgrestError=aa.PostgrestBuilder=aa.PostgrestTransformBuilder=aa.PostgrestFilterBuilder=aa.PostgrestQueryBuilder=aa.PostgrestClient=void 0;const $u=ti(Cl);aa.PostgrestClient=$u.default;const Hu=ti(ec);aa.PostgrestQueryBuilder=Hu.default;const zu=ti(Ji);aa.PostgrestFilterBuilder=zu.default;const Wu=ti(tc);aa.PostgrestTransformBuilder=Wu.default;const Vu=ti(rc);aa.PostgrestBuilder=Vu.default;const Gu=ti(ac);aa.PostgrestError=Gu.default;var Gx=aa.default={PostgrestClient:$u.default,PostgrestQueryBuilder:Hu.default,PostgrestFilterBuilder:zu.default,PostgrestTransformBuilder:Wu.default,PostgrestBuilder:Vu.default,PostgrestError:Gu.default};const{PostgrestClient:Xx,PostgrestQueryBuilder:EE,PostgrestFilterBuilder:TE,PostgrestTransformBuilder:AE,PostgrestBuilder:CE,PostgrestError:FE}=Gx;class Kx{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,s=parseInt(a.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Jx="2.15.5",Yx=`realtime-js/${Jx}`,Qx="1.0.0",Zc=1e4,Zx=1e3,ep=100;var yi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(yi||(yi={}));var fr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(fr||(fr={}));var Ia;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ia||(Ia={}));var el;(function(e){e.websocket="websocket"})(el||(el={}));var Js;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Js||(Js={}));class tp{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,r,a)}_decodeBroadcast(t,r,a){const s=r.getUint8(1),i=r.getUint8(2);let o=this.HEADER_LENGTH+2;const c=a.decode(t.slice(o,o+s));o=o+s;const l=a.decode(t.slice(o,o+i));o=o+i;const d=JSON.parse(a.decode(t.slice(o,t.byteLength)));return{ref:null,topic:c,event:l,payload:d}}}class Xu{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Mt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Mt||(Mt={}));const M0=(e,t,r={})=>{var a;const s=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(t).reduce((i,o)=>(i[o]=rp(o,e,t,s),i),{})},rp=(e,t,r,a)=>{const s=t.find(c=>c.name===e),i=s==null?void 0:s.type,o=r[e];return i&&!a.includes(i)?Ku(i,o):tl(o)},Ku=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return ip(t,r)}switch(e){case Mt.bool:return ap(t);case Mt.float4:case Mt.float8:case Mt.int2:case Mt.int4:case Mt.int8:case Mt.numeric:case Mt.oid:return sp(t);case Mt.json:case Mt.jsonb:return np(t);case Mt.timestamp:return op(t);case Mt.abstime:case Mt.date:case Mt.daterange:case Mt.int4range:case Mt.int8range:case Mt.money:case Mt.reltime:case Mt.text:case Mt.time:case Mt.timestamptz:case Mt.timetz:case Mt.tsrange:case Mt.tstzrange:return tl(t);default:return tl(t)}},tl=e=>e,ap=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},sp=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},np=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},ip=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>Ku(t,c))}return e},op=e=>typeof e=="string"?e.replace(" ","T"):e,Ju=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class kc{constructor(t,r,a={},s=Zc){this.channel=t,this.event=r,this.payload=a,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var B0;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(B0||(B0={}));class bi{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},s=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=bi.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=bi.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(a.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=bi.syncDiff(this.state,s,i,o),c())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,s){const i=this.cloneDeep(t),o=this.transformState(r),c={},l={};return this.map(i,(d,u)=>{o[d]||(l[d]=u)}),this.map(o,(d,u)=>{const f=i[d];if(f){const m=u.map(x=>x.presence_ref),h=f.map(x=>x.presence_ref),g=u.filter(x=>h.indexOf(x.presence_ref)<0),p=f.filter(x=>m.indexOf(x.presence_ref)<0);g.length>0&&(c[d]=g),p.length>0&&(l[d]=p)}else c[d]=u}),this.syncDiff(i,{joins:c,leaves:l},a,s)}static syncDiff(t,r,a,s){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),s||(s=()=>{}),this.map(i,(c,l)=>{var d;const u=(d=t[c])!==null&&d!==void 0?d:[];if(t[c]=this.cloneDeep(l),u.length>0){const f=t[c].map(h=>h.presence_ref),m=u.filter(h=>f.indexOf(h.presence_ref)<0);t[c].unshift(...m)}a(c,u,l)}),this.map(o,(c,l)=>{let d=t[c];if(!d)return;const u=l.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),t[c]=d,s(c,d,l),d.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const s=t[a];return"metas"in s?r[a]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[a]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var U0;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(U0||(U0={}));var wi;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(wi||(wi={}));var is;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(is||(is={}));class Fl{constructor(t,r={config:{}},a){this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=fr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new kc(this,Ia.join,this.params,this.timeout),this.rejoinTimer=new Xu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=fr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=fr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ia.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new bi(this),this.broadcastEndpointURL=Ju(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var a,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==fr.closed){const{config:{broadcast:o,presence:c,private:l}}=this.params,d=(s=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(h=>h.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[wi.PRESENCE]&&this.bindings[wi.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},m={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:u}),postgres_changes:d,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(is.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(is.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var g;if(this.socket.setAuth(),h===void 0){t==null||t(is.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,x=(g=p==null?void 0:p.length)!==null&&g!==void 0?g:0,w=[];for(let _=0;_<x;_++){const v=p[_],{filter:{event:R,schema:q,table:U,filter:P}}=v,X=h&&h[_];if(X&&X.event===R&&X.schema===q&&X.table===U&&X.filter===P)w.push(Object.assign(Object.assign({},v),{id:X.id}));else{this.unsubscribe(),this.state=fr.errored,t==null||t(is.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(is.SUBSCRIBED);return}}).receive("error",h=>{this.state=fr.errored,t==null||t(is.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(is.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===fr.joined&&t===wi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,a)}async send(t,r={}){var a,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,l;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=fr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ia.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(s=>{a=new kc(this,Ia.leave,{},t),a.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a==null||a.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=fr.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const s=new AbortController,i=setTimeout(()=>s.abort(),a),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(i),o}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new kc(this,t,r,a);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ep){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var s,i;const o=t.toLocaleLowerCase(),{close:c,error:l,leave:d,join:u}=Ia;if(a&&[c,l,d,u].indexOf(o)>=0&&a!==this._joinRef())return;let m=this._onMessage(o,r,a);if(r&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var g,p,x;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(p=h.filter)===null||p===void 0?void 0:p.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(h=>h.callback(m,a)):(i=this.bindings[o])===null||i===void 0||i.filter(h=>{var g,p,x,w,_,v;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in h){const R=h.id,q=(g=h.filter)===null||g===void 0?void 0:g.event;return R&&((p=r.ids)===null||p===void 0?void 0:p.includes(R))&&(q==="*"||(q==null?void 0:q.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const R=(_=(w=h==null?void 0:h.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return R==="*"||R===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===o}).map(h=>{if(typeof m=="object"&&"ids"in m){const g=m.data,{schema:p,table:x,commit_timestamp:w,type:_,errors:v}=g;m=Object.assign(Object.assign({},{schema:p,table:x,commit_timestamp:w,eventType:_,new:{},old:{},errors:v}),this._getPayloadRecords(g))}h.callback(m,a)})}_isClosed(){return this.state===fr.closed}_isJoined(){return this.state===fr.joined}_isJoining(){return this.state===fr.joining}_isLeaving(){return this.state===fr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const s=t.toLocaleLowerCase(),i={type:s,filter:r,callback:a};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===a&&Fl.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Ia.close,{},t)}_onError(t){this._on(Ia.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=M0(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=M0(t.columns,t.old_record)),r}}const jc=()=>{},xo={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},cp=[1e3,2e3,5e3,1e4],lp=1e4,dp=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class up{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Zc,this.transport=null,this.heartbeatIntervalMs=xo.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=jc,this.ref=0,this.reconnectTimer=null,this.logger=jc,this.conn=null,this.sendBuffer=[],this.serializer=new tp,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>hn(()=>Promise.resolve().then(()=>ei),void 0).then(({default:c})=>c(...o)).catch(c=>{throw new Error(`Failed to load @supabase/node-fetch: ${c.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((a=r==null?void 0:r.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${el.websocket}`,this.httpEndpoint=Ju(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Kx.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Qx}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case yi.connecting:return Js.Connecting;case yi.open:return Js.Open;case yi.closing:return Js.Closing;default:return Js.Closed}}isConnected(){return this.connectionState()===Js.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===a);if(s)return s;{const i=new Fl(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:a,payload:s,ref:i}=t,o=()=>{this.encode(t,c=>{var l;(l=this.conn)===null||l===void 0||l.send(c)})};this.log("push",`${r} ${a} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Zx,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},xo.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:s,payload:i,ref:o}=r,c=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${a} ${s} ${c}`.trim(),i),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(s,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Ia.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${a}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([dp],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const s={access_token:r,version:Yx};r&&a.updateJoinPayload(s),a.joinedOnce&&a._isJoined()&&a._push(Ia.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Xu(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xo.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,s,i,o,c,l,d,u;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t==null?void 0:t.timeout)!==null&&a!==void 0?a:Zc,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:xo.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:jc,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:f=>cp[f-1]||lp,this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(f,m)=>m(JSON.stringify(f)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Pl extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function hr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class fp extends Pl{constructor(t,r,a){super(t),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class rl extends Pl{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var hp=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};const Yu=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hn(()=>Promise.resolve().then(()=>ei),void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},mp=()=>hp(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield hn(()=>Promise.resolve().then(()=>ei),void 0)).Response:Response}),al=e=>{if(Array.isArray(e))return e.map(r=>al(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const s=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=al(a)}),t},xp=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var mn=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};const Ec=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pp=(e,t,r)=>mn(void 0,void 0,void 0,function*(){const a=yield mp();e instanceof a&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new fp(Ec(s),i,o))}).catch(s=>{t(new rl(Ec(s),s))}):t(new rl(Ec(e),e))}),gp=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!a?s:(xp(a)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(a)):s.body=a,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function Yi(e,t,r,a,s,i){return mn(this,void 0,void 0,function*(){return new Promise((o,c)=>{e(r,gp(t,a,s,i)).then(l=>{if(!l.ok)throw l;return a!=null&&a.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>pp(l,c,a))})})}function Oo(e,t,r,a){return mn(this,void 0,void 0,function*(){return Yi(e,"GET",t,r,a)})}function Xa(e,t,r,a,s){return mn(this,void 0,void 0,function*(){return Yi(e,"POST",t,a,s,r)})}function sl(e,t,r,a,s){return mn(this,void 0,void 0,function*(){return Yi(e,"PUT",t,a,s,r)})}function vp(e,t,r,a){return mn(this,void 0,void 0,function*(){return Yi(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function Qu(e,t,r,a,s){return mn(this,void 0,void 0,function*(){return Yi(e,"DELETE",t,a,s,r)})}var Xr=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};const yp={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},q0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bp{constructor(t,r={},a,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=a,this.fetch=Yu(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,a,s){return Xr(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},q0),s);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&a instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",a)):typeof FormData<"u"&&a instanceof FormData?(i=a,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=a,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,l&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s!=null&&s.headers&&(c=Object.assign(Object.assign({},c),s.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),f=yield(t=="PUT"?sl:Xa)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(hr(i))return{data:null,error:i};throw i}})}upload(t,r,a){return Xr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,s){return Xr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",r);try{let l;const d=Object.assign({upsert:q0.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",a)):typeof FormData<"u"&&a instanceof FormData?(l=a,l.append("cacheControl",d.cacheControl)):(l=a,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield sl(this.fetch,c.toString(),l,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(hr(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Xr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const i=yield Xa(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:s}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new Pl("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:c},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}})}update(t,r,a){return Xr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return Xr(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}})}copy(t,r,a){return Xr(this,void 0,void 0,function*(){try{return{data:{path:(yield Xa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a==null?void 0:a.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,a){return Xr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield Xa(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},a!=null&&a.transform?{transform:a.transform}:{}),{headers:this.headers});const o=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,a){return Xr(this,void 0,void 0,function*(){try{const s=yield Xa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=a!=null&&a.download?`&download=${a.download===!0?"":a.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}})}download(t,r){return Xr(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=i?`?${i}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield Oo(this.fetch,`${this.url}/${s}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(hr(c))return{data:null,error:c};throw c}})}info(t){return Xr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield Oo(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:al(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}})}exists(t){return Xr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield vp(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a)&&a instanceof rl){const s=a.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),s=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&s.push(i);const c=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&s.push(l);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${a}${d}`)}}}remove(t){return Xr(this,void 0,void 0,function*(){try{return{data:yield Qu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}list(t,r,a){return Xr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},yp),r),{prefix:t||""});return{data:yield Xa(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},a),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(hr(s))return{data:null,error:s};throw s}})}listV2(t,r){return Xr(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield Xa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const wp="2.12.1",_p={"X-Client-Info":`storage-js/${wp}`};var Cn=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};class Sp{constructor(t,r={},a,s){this.shouldThrowOnError=!1;const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},_p),r),this.fetch=Yu(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Cn(this,void 0,void 0,function*(){try{return{data:yield Oo(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(hr(t))return{data:null,error:t};throw t}})}getBucket(t){return Cn(this,void 0,void 0,function*(){try{return{data:yield Oo(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Cn(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Cn(this,void 0,void 0,function*(){try{return{data:yield sl(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(hr(a))return{data:null,error:a};throw a}})}emptyBucket(t){return Cn(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Cn(this,void 0,void 0,function*(){try{return{data:yield Qu(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}}class Np extends Sp{constructor(t,r={},a,s){super(t,r,a,s)}from(t){return new bp(this.url,this.headers,t,this.fetch)}}const kp="2.57.4";let xi="";typeof Deno<"u"?xi="deno":typeof document<"u"?xi="web":typeof navigator<"u"&&navigator.product==="ReactNative"?xi="react-native":xi="node";const jp={"X-Client-Info":`supabase-js-${xi}/${kp}`},Ep={headers:jp},Tp={schema:"public"},Ap={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Cp={};var Fp=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};const Pp=e=>{let t;return e?t=e:typeof fetch>"u"?t=Lu:t=fetch,(...r)=>t(...r)},Op=()=>typeof Headers>"u"?Mu:Headers,Dp=(e,t,r)=>{const a=Pp(r),s=Op();return(i,o)=>Fp(void 0,void 0,void 0,function*(){var c;const l=(c=yield t())!==null&&c!==void 0?c:e;let d=new s(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),a(i,Object.assign(Object.assign({},o),{headers:d}))})};var Ip=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};function Rp(e){return e.endsWith("/")?e:e+"/"}function Lp(e,t){var r,a;const{db:s,auth:i,realtime:o,global:c}=e,{db:l,auth:d,realtime:u,global:f}=t,m={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(a=c==null?void 0:c.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>Ip(this,void 0,void 0,function*(){return""})};return e.accessToken?m.accessToken=e.accessToken:delete m.accessToken,m}function Mp(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Rp(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Zu="2.71.1",Bn=30*1e3,nl=3,Tc=nl*Bn,Bp="http://localhost:9999",Up="supabase.auth.token",qp={"X-Client-Info":`gotrue-js/${Zu}`},il="X-Supabase-Api-Version",ef={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},$p=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Hp=10*60*1e3;class Ol extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function ct(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class zp extends Ol{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function Wp(e){return ct(e)&&e.name==="AuthApiError"}class tf extends Ol{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ls extends Ol{constructor(t,r,a,s){super(t,a,s),this.name=r,this.status=a}}class ks extends Ls{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Vp(e){return ct(e)&&e.name==="AuthSessionMissingError"}class po extends Ls{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class go extends Ls{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class vo extends Ls{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Gp(e){return ct(e)&&e.name==="AuthImplicitGrantRedirectError"}class $0 extends Ls{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ol extends Ls{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Ac(e){return ct(e)&&e.name==="AuthRetryableFetchError"}class H0 extends Ls{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class cl extends Ls{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Do="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),z0=` 	
\r=`.split(""),Xp=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<z0.length;t+=1)e[z0[t].charCodeAt(0)]=-2;for(let t=0;t<Do.length;t+=1)e[Do[t].charCodeAt(0)]=t;return e})();function W0(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Do[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(Do[a]),t.queuedBits-=6}}function rf(e,t,r){const a=Xp[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function V0(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},a={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{Yp(o,a,r)};for(let o=0;o<e.length;o+=1)rf(e.charCodeAt(o),s,i);return t.join("")}function Kp(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Jp(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const s=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Kp(a,t)}}function Yp(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if(!(e>>7-a&1)){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Qp(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)rf(e.charCodeAt(s),r,a);return new Uint8Array(t)}function Zp(e){const t=[];return Jp(e,r=>t.push(r)),new Uint8Array(t)}function eg(e){const t=[],r={queue:0,queuedBits:0},a=s=>{t.push(s)};return e.forEach(s=>W0(s,r,a)),W0(null,r,a),t.join("")}function tg(e){return Math.round(Date.now()/1e3)+e}function rg(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Da=()=>typeof window<"u"&&typeof document<"u",Vs={tested:!1,writable:!1},af=()=>{if(!Da())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vs.tested)return Vs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Vs.tested=!0,Vs.writable=!0}catch{Vs.tested=!0,Vs.writable=!1}return Vs.writable};function ag(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return r.searchParams.forEach((a,s)=>{t[s]=a}),t}const sf=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>hn(()=>Promise.resolve().then(()=>ei),void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},sg=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Un=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Gs=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ss=async(e,t)=>{await e.removeItem(t)};class sc{constructor(){this.promise=new sc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}sc.promiseConstructor=Promise;function Cc(e){const t=e.split(".");if(t.length!==3)throw new cl("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!$p.test(t[a]))throw new cl("JWT not in base64url format");return{header:JSON.parse(V0(t[0])),payload:JSON.parse(V0(t[1])),signature:Qp(t[2]),raw:{header:t[0],payload:t[1]}}}async function ng(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ig(e,t){return new Promise((a,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){a(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function og(e){return("0"+e.toString(16)).substr(-2)}function cg(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let s="";for(let i=0;i<56;i++)s+=r.charAt(Math.floor(Math.random()*a));return s}return crypto.getRandomValues(t),Array.from(t,og).join("")}async function lg(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(a);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function dg(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await lg(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Fn(e,t,r=!1){const a=cg();let s=a;r&&(s+="/PASSWORD_RECOVERY"),await Un(e,`${t}-code-verifier`,s);const i=await dg(a);return[i,a===i?"plain":"s256"]}const ug=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function fg(e){const t=e.headers.get(il);if(!t||!t.match(ug))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function hg(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function mg(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xg=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Pn(e){if(!xg.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Fc(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function G0(e){return JSON.parse(JSON.stringify(e))}var pg=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};const Ks=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gg=[502,503,504];async function X0(e){var t;if(!sg(e))throw new ol(Ks(e),0);if(gg.includes(e.status))throw new ol(Ks(e),e.status);let r;try{r=await e.json()}catch(i){throw new tf(Ks(i),i)}let a;const s=fg(e);if(s&&s.getTime()>=ef["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new H0(Ks(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new ks}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new H0(Ks(r),e.status,r.weak_password.reasons);throw new zp(Ks(r),e.status||500,a)}const vg=(e,t,r,a)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(a),Object.assign(Object.assign({},s),r))};async function bt(e,t,r,a){var s;const i=Object.assign({},a==null?void 0:a.headers);i[il]||(i[il]=ef["2024-01-01"].name),a!=null&&a.jwt&&(i.Authorization=`Bearer ${a.jwt}`);const o=(s=a==null?void 0:a.query)!==null&&s!==void 0?s:{};a!=null&&a.redirectTo&&(o.redirect_to=a.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await yg(e,t,r+c,{headers:i,noResolveJson:a==null?void 0:a.noResolveJson},{},a==null?void 0:a.body);return a!=null&&a.xform?a==null?void 0:a.xform(l):{data:Object.assign({},l),error:null}}async function yg(e,t,r,a,s,i){const o=vg(t,a,s,i);let c;try{c=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new ol(Ks(l),0)}if(c.ok||await X0(c),a!=null&&a.noResolveJson)return c;try{return await c.json()}catch(l){await X0(l)}}function ns(e){var t;let r=null;Sg(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=tg(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function K0(e){const t=ns(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function js(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function bg(e){return{data:e,error:null}}function wg(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:i}=e,o=pg(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:a,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:c,user:l},error:null}}function _g(e){return e}function Sg(e){return e.access_token&&e.refresh_token&&e.expires_in}const Pc=["global","local","others"];var Ng=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};class kg{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=sf(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Pc[0]){if(Pc.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Pc.join(", ")}`);try{return await bt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(ct(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await bt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:js})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Ng(t,["options"]),s=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(s.new_email=a==null?void 0:a.newEmail,delete s.newEmail),await bt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:wg,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ct(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await bt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:js})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,s,i,o,c,l;try{const d={nextPage:null,lastPage:0,total:0},u=await bt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:_g});if(u.error)throw u.error;const f=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,h=(l=(c=u.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=p}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(ct(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Pn(t);try{return await bt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:js})}catch(r){if(ct(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Pn(t);try{return await bt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:js})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Pn(t);try{return await bt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:js})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Pn(t.userId);try{const{data:r,error:a}=await bt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:a}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Pn(t.userId),Pn(t.id);try{return{data:await bt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}}function J0(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function jg(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const On={debug:!!(globalThis&&af()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class nf extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Eg extends nf{}async function Tg(e,t,r){On.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),On.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async s=>{if(s){On.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{On.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw On.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Eg(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(On.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}jg();const Ag={url:Bp,storageKey:Up,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qp,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Y0(e,t,r){return await r()}const Dn={};class Pi{constructor(t){var r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Pi.nextInstanceID,Pi.nextInstanceID+=1,this.instanceID>0&&Da()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Ag),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new kg({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=sf(s.fetch),this.lock=s.lock||Y0,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Da()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Tg:this.lock=Y0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:af()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=J0(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=J0(this.memoryStorage)),Da()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=Dn[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Dn[this.storageKey]=Object.assign(Object.assign({},Dn[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Dn[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Dn[this.storageKey]=Object.assign(Object.assign({},Dn[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zu}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ag(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),Da()&&this.detectSessionInUrl&&a!=="none"){const{data:s,error:i}=await this._getSessionFromURL(r,a);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Gp(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ct(r)?{error:r}:{error:new tf("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,s;try{const i=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:ns}),{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const l=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,a,s;try{let i;if("email"in t){const{email:u,password:f,options:m}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await Fn(this.storage,this.storageKey)),i=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:f,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:h,code_challenge_method:g},xform:ns})}else if("phone"in t){const{phone:u,password:f,options:m}=t;i=await bt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(a=m==null?void 0:m.data)!==null&&a!==void 0?a:{},channel:(s=m==null?void 0:m.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:ns})}else throw new go("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const l=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(i){if(ct(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:c}=t;r=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:K0})}else if("phone"in t){const{phone:i,password:o,options:c}=t;r=await bt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:K0})}else throw new go("You must provide either an email or phone number and a password");const{data:a,error:s}=r;return s?{data:{user:null,session:null},error:s}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new po}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:s})}catch(r){if(ct(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,a,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,a,s,i,o,c,l,d,u,f,m,h;let g,p;if("message"in t)g=t.message,p=t.signature;else{const{chain:x,wallet:w,statement:_,options:v}=t;let R;if(Da())if(typeof w=="object")R=w;else{const U=window;if("solana"in U&&typeof U.solana=="object"&&("signIn"in U.solana&&typeof U.solana.signIn=="function"||"signMessage"in U.solana&&typeof U.solana.signMessage=="function"))R=U.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=w}const q=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const U=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:q.host,uri:q.href}),_?{statement:_}:null));let P;if(Array.isArray(U)&&U[0]&&typeof U[0]=="object")P=U[0];else if(U&&typeof U=="object"&&"signedMessage"in U&&"signature"in U)P=U;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)g=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),p=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${q.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${q.href}`,`Issued At: ${(s=(a=v==null?void 0:v.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const U=await R.signMessage(new TextEncoder().encode(g),"utf8");if(!U||!(U instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=U}}try{const{data:x,error:w}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:eg(p)},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:ns});if(w)throw w;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new po}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:w})}catch(x){if(ct(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Gs(this.storage,`${this.storageKey}-code-verifier`),[a,s]=(r??"").split("/");try{const{data:i,error:o}=await bt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:ns});if(await Ss(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new po}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(ct(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:a,token:s,access_token:i,nonce:o}=t,c=await bt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ns}),{data:l,error:d}=c;return d?{data:{user:null,session:null},error:d}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new po}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:d})}catch(r){if(ct(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,a,s,i,o;try{if("email"in t){const{email:c,options:l}=t;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Fn(this.storage,this.storageKey));const{error:f}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:c,options:l}=t,{data:d,error:u}=await bt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new go("You must provide either an email or phone number.")}catch(c){if(ct(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var r,a;try{let s,i;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:o,error:c}=await bt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:ns});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,d=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:d,session:l},error:null}}catch(s){if(ct(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,a,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Fn(this.storage,this.storageKey)),await bt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:bg})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new ks;const{error:s}=await bt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(ct(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:s,options:i}=t,{error:o}=await bt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:a,type:s,options:i}=t,{data:o,error:c}=await bt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new go("You must provide either an email or phone number and a type")}catch(r){if(ct(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Gs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<Tc:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const o=await Gs(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Fc()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,d,u))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:js}):await this._useSession(async r=>{var a,s,i;const{data:o,error:c}=r;if(c)throw c;return!(!((a=o.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ks}:await bt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:js})})}catch(r){if(ct(r))return Vp(r)&&(await this._removeSession(),await Ss(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:s,error:i}=a;if(i)throw i;if(!s.session)throw new ks;const o=s.session;let c=null,l=null;this.flowType==="pkce"&&t.email!=null&&([c,l]=await Fn(this.storage,this.storageKey));const{data:d,error:u}=await bt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:l}),jwt:o.access_token,xform:js});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(a){if(ct(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ks;const r=Date.now()/1e3;let a=r,s=!0,i=null;const{payload:o}=Cc(t.access_token);if(o.exp&&(a=o.exp,s=a<=r),s){const{session:c,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(ct(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(a=o.session)!==null&&a!==void 0?a:void 0}if(!(t!=null&&t.refresh_token))throw new ks;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ct(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Da())throw new vo("No browser detected.");if(t.error||t.error_description||t.error_code)throw new vo(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new $0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vo("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new $0("No code detected.");const{data:_,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:c,expires_at:l,token_type:d}=t;if(!i||!c||!o||!d)throw new vo("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(c);let m=u+f;l&&(m=parseInt(l));const h=m-u;h*1e3<=Bn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const g=m-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,m,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,m,u);const{data:p,error:x}=await this._getUser(i);if(x)throw x;const w={provider_token:a,provider_refresh_token:s,access_token:i,expires_in:f,expires_at:m,refresh_token:o,token_type:d,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(a){if(ct(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Gs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:s,error:i}=r;if(i)return{error:i};const o=(a=s.session)===null||a===void 0?void 0:a.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(Wp(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await Ss(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=rg(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,s;try{const{data:{session:i},error:o}=r;if(o)throw o;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let a=null,s=null;this.flowType==="pkce"&&([a,s]=await Fn(this.storage,this.storageKey,!0));try{return await bt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(ct(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ct(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:a,error:s}=await this._useSession(async i=>{var o,c,l,d,u;const{data:f,error:m}=i;if(m)throw m;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await bt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return Da()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a==null?void 0:a.url),{data:{provider:t.provider,url:a==null?void 0:a.url},error:null}}catch(a){if(ct(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,s;const{data:i,error:o}=r;if(o)throw o;return await bt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(ct(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await ig(async s=>(s>0&&await ng(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await bt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ns})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Ac(i)&&Date.now()+o-a<Bn})}catch(a){if(this._debug(r,"error",a),ct(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Da()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const s=await Gs(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Gs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Un(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Fc()}else if(s&&!s.user&&!s.user){const o=await Gs(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Ss(this.storage,this.storageKey+"-user"),await Un(this.storage,this.storageKey,s)):s.user=Fc()}if(this._debug(a,"session from storage",s),!this._isValidSession(s)){this._debug(a,"session is not valid"),s!==null&&await this._removeSession();return}const i=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Tc;if(this._debug(a,`session has${i?"":" not"} expired with margin of ${Tc}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ac(o)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(s.access_token);!c&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(a,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(a,"error",s),console.error(s);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new ks;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new sc;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new ks;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(s,"error",i),ct(i)){const o={session:null,error:i};return Ac(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,a=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Un(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const i=G0(s);await Un(this.storage,this.storageKey,i)}else{const s=G0(r);await Un(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Ss(this.storage,this.storageKey),await Ss(this.storage,this.storageKey+"-code-verifier"),await Ss(this.storage,this.storageKey+"-user"),this.userStorage&&await Ss(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Da()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Bn);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((a.expires_at*1e3-t)/Bn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Bn}ms, refresh threshold is ${nl} ticks`),s<=nl&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof nf)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Da()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const s=[`provider=${encodeURIComponent(r)}`];if(a!=null&&a.redirectTo&&s.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a!=null&&a.scopes&&s.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[i,o]=await Fn(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(c.toString())}if(a!=null&&a.queryParams){const i=new URLSearchParams(a.queryParams);s.push(i.toString())}return a!=null&&a.skipBrowserRedirect&&s.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;return i?{data:null,error:i}:await bt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ct(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,s;const{data:i,error:o}=r;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:d}=await bt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(a=i==null?void 0:i.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(t.factorType==="totp"&&(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(ct(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const{data:o,error:c}=await bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(r){if(ct(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:s,error:i}=r;return i?{data:null,error:i}:await bt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(a=s==null?void 0:s.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(ct(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=(t==null?void 0:t.factors)||[],s=a.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=a.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:a,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,a;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Cc(s.access_token);let c=null;o.aal&&(c=o.aal);let l=c;((a=(r=s.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:c,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(c=>c.kid===t);if(a)return a;const s=Date.now();if(a=this.jwks.keys.find(c=>c.kid===t),a&&this.jwks_cached_at+Hp>s)return a;const{data:i,error:o}=await bt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,a=i.keys.find(c=>c.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:h,error:g}=await this.getSession();if(g||!h.session)return{data:null,error:g};a=h.session.access_token}const{header:s,payload:i,signature:o,raw:{header:c,payload:l}}=Cc(a);r!=null&&r.allowExpired||hg(i.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:h}=await this.getUser(a);if(h)throw h;return{data:{claims:i,header:s,signature:o},error:null}}const u=mg(s.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,Zp(`${c}.${l}`)))throw new cl("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(a){if(ct(a))return{data:null,error:a};throw a}}}Pi.nextInstanceID=0;const Cg=Pi;class Fg extends Cg{constructor(t){super(t)}}var Pg=globalThis&&globalThis.__awaiter||function(e,t,r,a){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{d(a.next(u))}catch(f){o(f)}}function l(u){try{d(a.throw(u))}catch(f){o(f)}}function d(u){u.done?i(u.value):s(u.value).then(c,l)}d((a=a.apply(e,t||[])).next())})};class Og{constructor(t,r,a){var s,i,o;this.supabaseUrl=t,this.supabaseKey=r;const c=Mp(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:Tp,realtime:Cp,auth:Object.assign(Object.assign({},Ap),{storageKey:l}),global:Ep},u=Lp(a??{},d);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Dp(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Xx(new URL("rest/v1",c).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new Np(this.storageUrl.href,this.headers,this.fetch,a==null?void 0:a.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new jx(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Pg(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:s,userStorage:i,storageKey:o,flowType:c,lock:l,debug:d},u,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fg({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:s,userStorage:i,flowType:c,lock:l,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new up(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a==null?void 0:a.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Dg=(e,t,r)=>new Og(e,t,r);function Ig(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Ig()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const ll={url:"https://oykzakzcqjoaeixbxhvb.supabase.co",anonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im95a3pha3pjcWpvYWVpeGJ4aHZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNjY2MjgsImV4cCI6MjA3NDc0MjYyOH0.00BmsnzyIHlzcO41aAmIPwy5NXN8Gq6Qaopn6UbdIEc"},Rg=()=>{if(!ll.url.startsWith("https://"))throw new Error("URL do Supabase deve comear com https://");return!0};class Lg{constructor(){var t,r,a,s,i;this.supabaseUrl=ll.url,this.supabaseKey=ll.anonKey,this.supabase=null,this.isInitialized=!1;try{console.log("[Supabase ENV] url:",!!this.supabaseUrl,"key:",!!this.supabaseKey),console.log("[ENV keys]",Object.keys(((t=import.meta)==null?void 0:t.env)||{})),console.log("[VITE vars]",{VITE_SUPABASE_URL_present:typeof((a=(r=import.meta)==null?void 0:r.env)==null?void 0:a.VITE_SUPABASE_URL)=="string",VITE_SUPABASE_ANON_KEY_length:(((i=(s=import.meta)==null?void 0:s.env)==null?void 0:i.VITE_SUPABASE_ANON_KEY)||"").length})}catch{}}async getByIn(t,r,a){await this.init();try{if(!Array.isArray(a)||a.length===0)return[];const{data:s,error:i}=await this.supabase.from(t).select("*").in(r,a);return i?(console.error(`Erro ao buscar por IN em ${t}:`,i),Promise.reject(i)):s||[]}catch(s){return console.error(`Erro ao buscar por IN em ${t}:`,s),Promise.reject(s)}}async init(){if(this.isInitialized)return Promise.resolve();try{return Rg(),this.supabase||(this.supabase=Dg(this.supabaseUrl,this.supabaseKey)),this.isInitialized=!0,console.log(" Cliente Supabase inicializado com sucesso"),Promise.resolve()}catch(t){return console.error(" Erro ao inicializar Supabase:",t.message),Promise.reject(t)}}async add(t,r){await this.init();try{const{data:a,error:s}=await this.supabase.from(t).insert(r).select();return s?(console.error(`Erro ao adicionar item em ${t}:`,s),Promise.reject(s)):a[0].id}catch(a){return console.error(`Erro ao adicionar item em ${t}:`,a),Promise.reject(a)}}async addMany(t,r){await this.init();try{r.length>100&&console.warn(`Lote muito grande (${r.length}). Considere usar lotes menores.`);const{data:s,error:i}=await this.supabase.from(t).insert(r);return i?(console.error(`Erro ao adicionar mltiplos itens em ${t}:`,i),Promise.reject(i)):r.length}catch(a){return console.error(`Erro ao adicionar mltiplos itens em ${t}:`,a),Promise.reject(a)}}async update(t,r){await this.init();try{const{error:a}=await this.supabase.from(t).update(r).eq("id",r.id);return a?(console.error(`Erro ao atualizar item em ${t}:`,a),Promise.reject(a)):Promise.resolve()}catch(a){return console.error(`Erro ao atualizar item em ${t}:`,a),Promise.reject(a)}}async remove(t,r){await this.init();try{const{error:a}=await this.supabase.from(t).delete().eq("id",r);return a?(console.error(`Erro ao remover item de ${t}:`,a),Promise.reject(a)):Promise.resolve()}catch(a){return console.error(`Erro ao remover item de ${t}:`,a),Promise.reject(a)}}async removeMany(t,r){await this.init();try{if(!Array.isArray(r)||r.length===0)return Promise.resolve();const{error:a}=await this.supabase.from(t).delete().in("id",r);return a?(console.error(`Erro ao remover mltiplos itens de ${t}:`,a),Promise.reject(a)):Promise.resolve()}catch(a){return console.error(`Erro ao remover mltiplos itens de ${t}:`,a),Promise.reject(a)}}async clear(t){await this.init();try{const{error:r}=await this.supabase.from(t).delete().not("id","is",null);return r?(console.error(`Erro ao limpar tabela ${t}:`,r),Promise.reject(r)):Promise.resolve()}catch(r){return console.error(`Erro ao limpar tabela ${t}:`,r),Promise.reject(r)}}async getById(t,r){await this.init();try{const{data:a,error:s}=await this.supabase.from(t).select("*").eq("id",r).single();return s?(console.error(`Erro ao buscar item em ${t}:`,s),Promise.reject(s)):a}catch(a){return console.error(`Erro ao buscar item em ${t}:`,a),Promise.reject(a)}}async getAll(t){await this.init();try{if(t==="lotes"){let s=[],i=0;const o=1e3;for(;;){const{data:c,error:l}=await this.supabase.from(t).select("*").range(i,i+o-1);if(l)return console.error(`Erro ao buscar lotes (lote ${i}-${i+o-1}):`,l),Promise.reject(l);if(!c||c.length===0||(s=s.concat(c),console.log(` Carregados ${s.length} lotes...`),c.length<o))break;i+=o}return console.log(` Total de lotes carregados: ${s.length}`),s}const{data:r,error:a}=await this.supabase.from(t).select("*");return a?(console.error(`Erro ao buscar todos os itens de ${t}:`,a),Promise.reject(a)):r}catch(r){return console.error(`Erro ao buscar todos os itens de ${t}:`,r),Promise.reject(r)}}async getByIndex(t,r,a){await this.init();try{const{data:s,error:i}=await this.supabase.from(t).select("*").eq(r,a);return i?(console.error(`Erro ao buscar por ndice em ${t}:`,i),Promise.reject(i)):s}catch(s){return console.error(`Erro ao buscar por ndice em ${t}:`,s),Promise.reject(s)}}async salvarConfiguracao(t,r){try{const{data:a,error:s}=await this.supabase.from("configuracoes").upsert({chave:t,valor:r}).select();return s?(console.error("Erro ao salvar configurao:",s),Promise.reject(s)):Promise.resolve()}catch(a){return console.error("Erro ao salvar configurao:",a),Promise.reject(a)}}async obterConfiguracao(t){try{const{data:r,error:a}=await this.supabase.from("configuracoes").select("valor").eq("chave",t).single();return a?a.code==="PGRST116"?null:(console.error("Erro ao obter configurao:",a),Promise.reject(a)):r?r.valor:null}catch(r){return console.error("Erro ao obter configurao:",r),Promise.reject(r)}}async uploadImagemEstoque({bucket:t,file:r,path:a}){await this.init();try{if(!t)return Promise.reject(new Error("Bucket no informado."));if(!r)return Promise.reject(new Error("Arquivo no informado."));if(!a)return Promise.reject(new Error("Caminho do arquivo no informado."));const{error:s}=await this.supabase.storage.from(t).upload(a,r,{upsert:!0,contentType:r.type||"application/octet-stream"});if(s)return console.error("Erro ao enviar arquivo para o Storage:",s),Promise.reject(s);const{data:i}=this.supabase.storage.from(t).getPublicUrl(a);return(i==null?void 0:i.publicUrl)||null}catch(s){return console.error("Erro ao enviar arquivo para o Storage:",s),Promise.reject(s)}}}const Qe=new Lg,Mg=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"}));class Bg{async registrarAcao({usuario:t,acao:r,modulo:a,descricao:s,dadosAnteriores:i=null,dadosNovos:o=null}){try{const c=navigator.userAgent,l=await this.obterIP(),d={usuario_id:(t==null?void 0:t.id)||null,usuario_nome:(t==null?void 0:t.nome)||"Desconhecido",usuario_email:(t==null?void 0:t.email)||(t==null?void 0:t.username)||"desconhecido@sistema.com",acao:r,modulo:a,descricao:s,dados_anteriores:i,dados_novos:o,ip_address:l,user_agent:c,created_at:new Date().toISOString()};await Qe.add("historico_acoes",d),console.log(" Ao registrada:",{acao:r,modulo:a,usuario:t==null?void 0:t.nome})}catch(c){console.error(" Erro ao registrar auditoria:",c)}}async obterIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"N/A"}}async registrarLogin(t){await this.registrarAcao({usuario:t,acao:"login",modulo:"autenticacao",descricao:`Login realizado por ${t.nome}`})}async registrarLogout(t){await this.registrarAcao({usuario:t,acao:"logout",modulo:"autenticacao",descricao:`Logout realizado por ${t.nome}`})}async registrarCriacao(t,r,a,s){await this.registrarAcao({usuario:t,acao:"criar",modulo:r,descricao:a,dadosNovos:s})}async registrarEdicao(t,r,a,s,i){await this.registrarAcao({usuario:t,acao:"editar",modulo:r,descricao:a,dadosAnteriores:s,dadosNovos:i})}async registrarExclusao(t,r,a,s){await this.registrarAcao({usuario:t,acao:"excluir",modulo:r,descricao:a,dadosAnteriores:s})}async registrarAcessoNegado(t,r,a){await this.registrarAcao({usuario:t,acao:"acesso_negado",modulo:r,descricao:a})}async registrarExportacao(t,r,a){await this.registrarAcao({usuario:t,acao:"exportar",modulo:r,descricao:a})}async buscarHistoricoUsuario(t,r=50){try{return(await Qe.getAll("historico_acoes")).filter(s=>s.usuario_id===t).sort((s,i)=>new Date(i.created_at)-new Date(s.created_at)).slice(0,r)}catch(a){return console.error("Erro ao buscar histrico:",a),[]}}async buscarHistoricoGeral(t={}){try{let r=await Qe.getAll("historico_acoes");return t.acao&&(r=r.filter(a=>a.acao===t.acao)),t.modulo&&(r=r.filter(a=>a.modulo===t.modulo)),t.usuarioId&&(r=r.filter(a=>a.usuario_id===t.usuarioId)),t.dataInicio&&(r=r.filter(a=>new Date(a.created_at)>=new Date(t.dataInicio))),t.dataFim&&(r=r.filter(a=>new Date(a.created_at)<=new Date(t.dataFim))),r.sort((a,s)=>new Date(s.created_at)-new Date(a.created_at))}catch(r){return console.error("Erro ao buscar histrico geral:",r),[]}}async obterEstatisticas(t=null){try{let r=await Qe.getAll("historico_acoes");t&&(r=r.filter(s=>s.usuario_id===t));const a={total:r.length,porAcao:{},porModulo:{},ultimaAcao:r.length>0?r.sort((s,i)=>new Date(i.created_at)-new Date(s.created_at))[0]:null};return r.forEach(s=>{a.porAcao[s.acao]=(a.porAcao[s.acao]||0)+1,a.porModulo[s.modulo]=(a.porModulo[s.modulo]||0)+1}),a}catch(r){return console.error("Erro ao obter estatsticas:",r),{total:0,porAcao:{},porModulo:{},ultimaAcao:null}}}}const ls=new Bg,of=I.createContext();function Ug({children:e}){const[t,r]=I.useState(null),[a,s]=I.useState(!0);I.useEffect(()=>{const l=localStorage.getItem("user");l&&r(JSON.parse(l)),s(!1)},[]);const c={user:t,login:async(l,d)=>{console.log("AuthContext: Tentativa de login",{username:l,password:d});try{const{default:u}=await hn(()=>Promise.resolve().then(()=>Mg),void 0),f=await u.getByIndex("usuarios","email",l.toLowerCase());if(f.length===0)return console.log("AuthContext: Usurio no encontrado"),{success:!1,message:"Credenciais invlidas"};const m=f[0];if(!(m.senha===d||m.senha_hash===d))return console.log("AuthContext: Senha incorreta"),{success:!1,message:"Credenciais invlidas"};if(m.ativo===!1)return console.log("AuthContext: Usurio inativo"),{success:!1,message:"Usurio inativo. Contate o administrador."};console.log("AuthContext: Login bem-sucedido",{email:m.email,nivel:m.nivel_acesso}),await u.update("usuarios",{...m,ultimo_acesso:new Date().toISOString()});const g={id:m.id,nome:m.nome,username:m.email,email:m.email,role:m.nivel_acesso};return localStorage.setItem("user",JSON.stringify(g)),r(g),await ls.registrarLogin(g),{success:!0}}catch(u){return console.error("Erro ao fazer login:",u),{success:!1,message:"Erro ao fazer login: "+u.message}}},logout:async()=>{t&&await ls.registrarLogout(t),localStorage.removeItem("user"),r(null)},loading:a};return n.jsx(of.Provider,{value:c,children:e})}function Ms(){return I.useContext(of)}const cf=I.createContext(null),qg=5e3,$g=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`,Hg=({children:e})=>{const[t,r]=I.useState([]),a=I.useCallback(u=>{r(f=>f.filter(m=>m.id!==u))},[]),s=I.useCallback(u=>{r(f=>[...f,u]),u.autoDismiss!==!1&&setTimeout(()=>a(u.id),u.duration??qg)},[a]),i=I.useCallback((u,{type:f="info",duration:m,autoDismiss:h=!0}={})=>{if(!u)return;const g=$g();s({id:g,message:u,type:f,duration:m,autoDismiss:h})},[s]),o=I.useCallback(u=>i(u,{type:"success"}),[i]),c=I.useCallback(u=>i(u,{type:"error",autoDismiss:!1}),[i]),l=I.useCallback(u=>i(u,{type:"warning"}),[i]),d=I.useMemo(()=>({toasts:t,showToast:i,showSuccess:o,showError:c,showWarning:l,removeToast:a}),[t,i,o,c,l,a]);return n.jsx(cf.Provider,{value:d,children:e})},zg=()=>{const e=I.useContext(cf);if(!e)throw new Error("useToast deve ser usado dentro de ToastProvider");return e},Wg="/assets/LogoDaniloBranco-2e4f5a2a.png",Vg=({onLogin:e})=>{const[t,r]=I.useState(""),[a,s]=I.useState(""),[i,o]=I.useState(""),[c,l]=I.useState(!1);I.useEffect(()=>{i&&o("")},[t,a]);const d=async u=>{u.preventDefault(),o(""),l(!0),console.log("Tentando login com:",{username:t,password:a});try{const f=await e(t,a);console.log("Resultado do login:",f),f.success||o(f.message||"Credenciais invlidas")}catch(f){console.error("Erro ao fazer login:",f),o("Ocorreu um erro ao tentar fazer login: "+(f.message||""))}finally{l(!1)}};return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 via-blue-800 to-blue-900 py-12 px-4 sm:px-6 lg:px-8",children:n.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-10 rounded-lg shadow-2xl",children:[n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("div",{className:"mb-6",children:n.jsx("img",{src:Wg,alt:"Logo Danilo Cardoso",className:"h-24 w-auto"})}),n.jsx("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Controle de Usinagem"}),n.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Faa login para acessar o sistema"})]}),n.jsxs("form",{className:"mt-8 space-y-6",onSubmit:d,autoComplete:"off",children:[i&&n.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:i}),n.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"username",className:"sr-only",children:"Email"}),n.jsx("input",{id:"username",name:"username",type:"email",autoComplete:"off",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Seu email",value:t,onChange:u=>r(u.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"password",className:"sr-only",children:"Senha"}),n.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-primary-500 focus:border-primary-500 focus:z-10 sm:text-sm",placeholder:"Sua senha",value:a,onChange:u=>s(u.target.value)})]})]}),n.jsx("div",{children:n.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:bg-gray-400",children:c?"Entrando...":"Entrar"})})]})]})})};function ft(e){const[t,r]=I.useState([]),[a,s]=I.useState(!0),[i,o]=I.useState(null),[c,l]=I.useState(!1),d=I.useCallback(async()=>{try{await Qe.init(),l(!0),o(null)}catch(w){console.error("Erro ao conectar Supabase:",w),o(`Erro de conexo: ${w.message}`),l(!1)}},[]),u=I.useCallback(async()=>{if(c)try{s(!0);const w=await Qe.getAll(e);r(w||[]),o(null)}catch(w){console.error(`Erro ao carregar ${e}:`,w),o(`Erro ao carregar dados: ${w.message}`)}finally{s(!1)}},[e,c]),f=I.useCallback(async w=>{try{const _=await Qe.add(e,w);return await u(),_}catch(_){throw console.error(`Erro ao adicionar em ${e}:`,_),o(`Erro ao adicionar: ${_.message}`),_}},[e,u]),m=I.useCallback(async w=>{try{await Qe.addMany(e,w),await u()}catch(_){throw console.error(`Erro ao adicionar mltiplos em ${e}:`,_),o(`Erro ao adicionar mltiplos: ${_.message}`),_}},[e,u]),h=I.useCallback(async w=>{try{await Qe.update(e,w),await u()}catch(_){throw console.error(`Erro ao atualizar em ${e}:`,_),o(`Erro ao atualizar: ${_.message}`),_}},[e,u]),g=I.useCallback(async w=>{try{await Qe.remove(e,w),await u()}catch(_){throw console.error(`Erro ao remover de ${e}:`,_),o(`Erro ao remover: ${_.message}`),_}},[e,u]),p=I.useCallback(async()=>{try{await Qe.clear(e),await u()}catch(w){throw console.error(`Erro ao limpar ${e}:`,w),o(`Erro ao limpar: ${w.message}`),w}},[e,u]),x=I.useCallback(async(w,_)=>{try{return await Qe.getByIndex(e,w,_)||[]}catch(v){return console.error(`Erro ao buscar em ${e}:`,v),o(`Erro na busca: ${v.message}`),[]}},[e]);return I.useEffect(()=>{d()},[d]),I.useEffect(()=>{c&&u()},[c,u]),{items:t,loading:a,error:i,isConnected:c,addItem:f,addItems:m,updateItem:h,removeItem:g,clearItems:p,loadItems:u,getByField:x}}const Gg=()=>{const[e,t]=I.useState([]),[r,a]=I.useState(!0);return I.useEffect(()=>{(async()=>{try{a(!0);const i=new Date;i.setHours(0,0,0,0);const o=new Date(i);o.setDate(o.getDate()+1);const l=(await Qe.getAll("apontamentos")||[]).filter(d=>{const u=new Date(d.inicio),f=u>=i&&u<o,m=["usinagem","embalagem"].includes(d.exp_stage);return f&&m});t(l)}catch(i){console.error("Erro ao buscar apontamentos recentes:",i),t([])}finally{a(!1)}})()},[]),{apontamentosRecentes:e,loading:r}};var lf={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Q0=Fs.createContext&&Fs.createContext(lf),Ps=globalThis&&globalThis.__assign||function(){return Ps=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ps.apply(this,arguments)},Xg=globalThis&&globalThis.__rest||function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r};function df(e){return e&&e.map(function(t,r){return Fs.createElement(t.tag,Ps({key:r},t.attr),df(t.child))})}function tt(e){return function(t){return Fs.createElement(Kg,Ps({attr:Ps({},e.attr)},t),df(e.child))}}function Kg(e){var t=function(r){var a=e.attr,s=e.size,i=e.title,o=Xg(e,["attr","size","title"]),c=s||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Fs.createElement("svg",Ps({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,o,{className:l,style:Ps(Ps({color:e.color||r.color},r.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),i&&Fs.createElement("title",null,i),e.children)};return Q0!==void 0?Fs.createElement(Q0.Consumer,null,function(r){return t(r)}):t(lf)}function Z0(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M413.1 222.5l22.2 22.2c9.4 9.4 9.4 24.6 0 33.9L241 473c-9.4 9.4-24.6 9.4-33.9 0L12.7 278.6c-9.4-9.4-9.4-24.6 0-33.9l22.2-22.2c9.5-9.5 25-9.3 34.3.4L184 343.4V56c0-13.3 10.7-24 24-24h32c13.3 0 24 10.7 24 24v287.4l114.8-120.5c9.3-9.8 24.8-10 34.3-.4z"}}]})(e)}function dl(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"}}]})(e)}function ed(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"}}]})(e)}function uf(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M425.7 256c-16.9 0-32.8-9-41.4-23.4L320 126l-64.2 106.6c-8.7 14.5-24.6 23.5-41.5 23.5-4.5 0-9-.6-13.3-1.9L64 215v178c0 14.7 10 27.5 24.2 31l216.2 54.1c10.2 2.5 20.9 2.5 31 0L551.8 424c14.2-3.6 24.2-16.4 24.2-31V215l-137 39.1c-4.3 1.3-8.8 1.9-13.3 1.9zm212.6-112.2L586.8 41c-3.1-6.2-9.8-9.8-16.7-8.9L320 64l91.7 152.1c3.8 6.3 11.4 9.3 18.5 7.3l197.9-56.5c9.9-2.9 14.7-13.9 10.2-23.1zM53.2 41L1.7 143.8c-4.6 9.2.3 20.2 10.1 23l197.9 56.5c7.1 2 14.7-1 18.5-7.3L320 64 69.8 32.1c-6.9-.8-13.5 2.7-16.6 8.9z"}}]})(e)}function td(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M509.5 184.6L458.9 32.8C452.4 13.2 434.1 0 413.4 0H272v192h238.7c-.4-2.5-.4-5-1.2-7.4zM240 0H98.6c-20.7 0-39 13.2-45.5 32.8L2.5 184.6c-.8 2.4-.8 4.9-1.2 7.4H240V0zM0 224v240c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48V224H0z"}}]})(e)}function Jg(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M256.47 216.77l86.73 109.18s-16.6 102.36-76.57 150.12C206.66 523.85 0 510.19 0 510.19s3.8-23.14 11-55.43l94.62-112.17c3.97-4.7-.87-11.62-6.65-9.5l-60.4 22.09c14.44-41.66 32.72-80.04 54.6-97.47 59.97-47.76 163.3-40.94 163.3-40.94zM636.53 31.03l-19.86-25c-5.49-6.9-15.52-8.05-22.41-2.56l-232.48 177.8-34.14-42.97c-5.09-6.41-15.14-5.21-18.59 2.21l-25.33 54.55 86.73 109.18 58.8-12.45c8-1.69 11.42-11.2 6.34-17.6l-34.09-42.92 232.48-177.8c6.89-5.48 8.04-15.53 2.55-22.44z"}}]})(e)}function rd(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M496 224c-79.59 0-144 64.41-144 144s64.41 144 144 144 144-64.41 144-144-64.41-144-144-144zm64 150.29c0 5.34-4.37 9.71-9.71 9.71h-60.57c-5.34 0-9.71-4.37-9.71-9.71v-76.57c0-5.34 4.37-9.71 9.71-9.71h12.57c5.34 0 9.71 4.37 9.71 9.71V352h38.29c5.34 0 9.71 4.37 9.71 9.71v12.58zM496 192c5.4 0 10.72.33 16 .81V144c0-25.6-22.4-48-48-48h-80V48c0-25.6-22.4-48-48-48H176c-25.6 0-48 22.4-48 48v48H48c-25.6 0-48 22.4-48 48v80h395.12c28.6-20.09 63.35-32 100.88-32zM320 96H192V64h128v32zm6.82 224H208c-8.84 0-16-7.16-16-16v-48H0v144c0 25.6 22.4 48 48 48h291.43C327.1 423.96 320 396.82 320 368c0-16.66 2.48-32.72 6.82-48z"}}]})(e)}function ad(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 0H48C22.4 0 0 22.4 0 48v416c0 25.6 22.4 48 48 48h352c25.6 0 48-22.4 48-48V48c0-25.6-22.4-48-48-48zM128 435.2c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm0-128c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm128 128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm0-128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8v-38.4c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v38.4zm128 128c0 6.4-6.4 12.8-12.8 12.8h-38.4c-6.4 0-12.8-6.4-12.8-12.8V268.8c0-6.4 6.4-12.8 12.8-12.8h38.4c6.4 0 12.8 6.4 12.8 12.8v166.4zm0-256c0 6.4-6.4 12.8-12.8 12.8H76.8c-6.4 0-12.8-6.4-12.8-12.8V76.8C64 70.4 70.4 64 76.8 64h294.4c6.4 0 12.8 6.4 12.8 12.8v102.4z"}}]})(e)}function Yg(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"}}]})(e)}function Qg(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.8 320h38.4c6.4 0 12.8-6.4 12.8-12.8V172.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v134.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V76.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v230.4c0 6.4 6.4 12.8 12.8 12.8zm-288 0h38.4c6.4 0 12.8-6.4 12.8-12.8v-70.4c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v70.4c0 6.4 6.4 12.8 12.8 12.8zm96 0h38.4c6.4 0 12.8-6.4 12.8-12.8V108.8c0-6.4-6.4-12.8-12.8-12.8h-38.4c-6.4 0-12.8 6.4-12.8 12.8v198.4c0 6.4 6.4 12.8 12.8 12.8zM496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z"}}]})(e)}function _i(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M496 384H64V80c0-8.84-7.16-16-16-16H16C7.16 64 0 71.16 0 80v336c0 17.67 14.33 32 32 32h464c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM464 96H345.94c-21.38 0-32.09 25.85-16.97 40.97l32.4 32.4L288 242.75l-73.37-73.37c-12.5-12.5-32.76-12.5-45.25 0l-68.69 68.69c-6.25 6.25-6.25 16.38 0 22.63l22.62 22.62c6.25 6.25 16.38 6.25 22.63 0L192 237.25l73.37 73.37c12.5 12.5 32.76 12.5 45.25 0l96-96 32.4 32.4c15.12 15.12 40.97 4.41 40.97-16.97V112c.01-8.84-7.15-16-15.99-16z"}}]})(e)}function Zg(e){return tt({tag:"svg",attr:{viewBox:"0 0 544 512"},child:[{tag:"path",attr:{d:"M527.79 288H290.5l158.03 158.03c6.04 6.04 15.98 6.53 22.19.68 38.7-36.46 65.32-85.61 73.13-140.86 1.34-9.46-6.51-17.85-16.06-17.85zm-15.83-64.8C503.72 103.74 408.26 8.28 288.8.04 279.68-.59 272 7.1 272 16.24V240h223.77c9.14 0 16.82-7.68 16.19-16.8zM224 288V50.71c0-9.55-8.39-17.4-17.84-16.06C86.99 51.49-4.1 155.6.14 280.37 4.5 408.51 114.83 513.59 243.03 511.98c50.4-.63 96.97-16.87 135.26-44.03 7.9-5.6 8.42-17.23 1.57-24.08L224 288z"}}]})(e)}function e1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"}}]})(e)}function t1(e){return tt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M336 64h-80c0-35.3-28.7-64-64-64s-64 28.7-64 64H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zM96 424c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-96c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm96-192c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zm128 368c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16zm0-96c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16z"}}]})(e)}function Oi(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"}}]})(e)}function r1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"}}]})(e)}function sd(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M320 448v40c0 13.255-10.745 24-24 24H24c-13.255 0-24-10.745-24-24V120c0-13.255 10.745-24 24-24h72v296c0 30.879 25.121 56 56 56h168zm0-344V0H152c-13.255 0-24 10.745-24 24v368c0 13.255 10.745 24 24 24h272c13.255 0 24-10.745 24-24V128H344c-13.2 0-24-10.8-24-24zm120.971-31.029L375.029 7.029A24 24 0 0 0 358.059 0H352v96h96v-6.059a24 24 0 0 0-7.029-16.97z"}}]})(e)}function a1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M488.6 250.2L392 214V105.5c0-15-9.3-28.4-23.4-33.7l-100-37.5c-8.1-3.1-17.1-3.1-25.3 0l-100 37.5c-14.1 5.3-23.4 18.7-23.4 33.7V214l-96.6 36.2C9.3 255.5 0 268.9 0 283.9V394c0 13.6 7.7 26.1 19.9 32.2l100 50c10.1 5.1 22.1 5.1 32.2 0l103.9-52 103.9 52c10.1 5.1 22.1 5.1 32.2 0l100-50c12.2-6.1 19.9-18.6 19.9-32.2V283.9c0-15-9.3-28.4-23.4-33.7zM358 214.8l-85 31.9v-68.2l85-37v73.3zM154 104.1l102-38.2 102 38.2v.6l-102 41.4-102-41.4v-.6zm84 291.1l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6zm240 112l-85 42.5v-79.1l85-38.8v75.4zm0-112l-102 41.4-102-41.4v-.6l102-38.2 102 38.2v.6z"}}]})(e)}function s1(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"}}]})(e)}function ui(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(e)}function Io(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"}}]})(e)}function nd(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"}}]})(e)}function n1(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"}}]})(e)}function i1(e){return tt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"}}]})(e)}function o1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M16 288c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h112v-64zm489-183L407.1 7c-4.5-4.5-10.6-7-17-7H384v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-153 31V0H152c-13.3 0-24 10.7-24 24v264h128v-65.2c0-14.3 17.3-21.4 27.4-11.3L379 308c6.6 6.7 6.6 17.4 0 24l-95.7 96.4c-10.1 10.1-27.4 3-27.4-11.3V352H128v136c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H376c-13.2 0-24-10.8-24-24z"}}]})(e)}function fi(e){return tt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"}}]})(e)}function id(e){return tt({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm65.18 216.01H224v80c0 8.84-7.16 16-16 16h-32c-8.84 0-16-7.16-16-16v-80H94.82c-14.28 0-21.41-17.29-11.27-27.36l96.42-95.7c6.65-6.61 17.39-6.61 24.04 0l96.42 95.7c10.15 10.07 3.03 27.36-11.25 27.36zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"}}]})(e)}function od(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M571.31 193.94l-22.63-22.63c-6.25-6.25-16.38-6.25-22.63 0l-11.31 11.31-28.9-28.9c5.63-21.31.36-44.9-16.35-61.61l-45.25-45.25c-62.48-62.48-163.79-62.48-226.28 0l90.51 45.25v18.75c0 16.97 6.74 33.25 18.75 45.25l49.14 49.14c16.71 16.71 40.3 21.98 61.61 16.35l28.9 28.9-11.31 11.31c-6.25 6.25-6.25 16.38 0 22.63l22.63 22.63c6.25 6.25 16.38 6.25 22.63 0l90.51-90.51c6.23-6.24 6.23-16.37-.02-22.62zm-286.72-15.2c-3.7-3.7-6.84-7.79-9.85-11.95L19.64 404.96c-25.57 23.88-26.26 64.19-1.53 88.93s65.05 24.05 88.93-1.53l238.13-255.07c-3.96-2.91-7.9-5.87-11.44-9.41l-49.14-49.14z"}}]})(e)}function c1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 255.531c.253 136.64-111.18 248.372-247.82 248.468-59.015.042-113.223-20.53-155.822-54.911-11.077-8.94-11.905-25.541-1.839-35.607l11.267-11.267c8.609-8.609 22.353-9.551 31.891-1.984C173.062 425.135 212.781 440 256 440c101.705 0 184-82.311 184-184 0-101.705-82.311-184-184-184-48.814 0-93.149 18.969-126.068 49.932l50.754 50.754c10.08 10.08 2.941 27.314-11.313 27.314H24c-8.837 0-16-7.163-16-16V38.627c0-14.254 17.234-21.393 27.314-11.314l49.372 49.372C129.209 34.136 189.552 8 256 8c136.81 0 247.747 110.78 248 247.531zm-180.912 78.784l9.823-12.63c8.138-10.463 6.253-25.542-4.21-33.679L288 256.349V152c0-13.255-10.745-24-24-24h-16c-13.255 0-24 10.745-24 24v135.651l65.409 50.874c10.463 8.137 25.541 6.253 33.679-4.21z"}}]})(e)}function ff(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M475.115 163.781L336 252.309v-68.28c0-18.916-20.931-30.399-36.885-20.248L160 252.309V56c0-13.255-10.745-24-24-24H24C10.745 32 0 42.745 0 56v400c0 13.255 10.745 24 24 24h464c13.255 0 24-10.745 24-24V184.029c0-18.917-20.931-30.399-36.885-20.248z"}}]})(e)}function l1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(e)}function d1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(e)}function u1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"}}]})(e)}function Di(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(e)}function f1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M448 192V77.25c0-8.49-3.37-16.62-9.37-22.63L393.37 9.37c-6-6-14.14-9.37-22.63-9.37H96C78.33 0 64 14.33 64 32v160c-35.35 0-64 28.65-64 64v112c0 8.84 7.16 16 16 16h48v96c0 17.67 14.33 32 32 32h320c17.67 0 32-14.33 32-32v-96h48c8.84 0 16-7.16 16-16V256c0-35.35-28.65-64-64-64zm-64 256H128v-96h256v96zm0-224H128V64h192v48c0 8.84 7.16 16 16 16h48v96zm48 72c-13.25 0-24-10.75-24-24 0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24z"}}]})(e)}function h1(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M384 320H256c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h128c17.67 0 32-14.33 32-32V352c0-17.67-14.33-32-32-32zM192 32c0-17.67-14.33-32-32-32H32C14.33 0 0 14.33 0 32v128c0 17.67 14.33 32 32 32h95.72l73.16 128.04C211.98 300.98 232.4 288 256 288h.28L192 175.51V128h224V64H192V32zM608 0H480c-17.67 0-32 14.33-32 32v128c0 17.67 14.33 32 32 32h128c17.67 0 32-14.33 32-32V32c0-17.67-14.33-32-32-32z"}}]})(e)}function ba(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"}}]})(e)}function hf(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"}}]})(e)}function m1(e){return tt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41z"}}]})(e)}function x1(e){return tt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M279 224H41c-21.4 0-32.1-25.9-17-41L143 64c9.4-9.4 24.6-9.4 33.9 0l119 119c15.2 15.1 4.5 41-16.9 41z"}}]})(e)}function p1(e){return tt({tag:"svg",attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.9 17-41z"}}]})(e)}function mf(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"}}]})(e)}function Oc(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"}}]})(e)}function xf(e){return tt({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 32C128.94 32 0 160.94 0 320c0 52.8 14.25 102.26 39.06 144.8 5.61 9.62 16.3 15.2 27.44 15.2h443c11.14 0 21.83-5.58 27.44-15.2C561.75 422.26 576 372.8 576 320c0-159.06-128.94-288-288-288zm0 64c14.71 0 26.58 10.13 30.32 23.65-1.11 2.26-2.64 4.23-3.45 6.67l-9.22 27.67c-5.13 3.49-10.97 6.01-17.64 6.01-17.67 0-32-14.33-32-32S270.33 96 288 96zM96 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm48-160c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm246.77-72.41l-61.33 184C343.13 347.33 352 364.54 352 384c0 11.72-3.38 22.55-8.88 32H232.88c-5.5-9.45-8.88-20.28-8.88-32 0-33.94 26.5-61.43 59.9-63.59l61.34-184.01c4.17-12.56 17.73-19.45 30.36-15.17 12.57 4.19 19.35 17.79 15.17 30.36zm14.66 57.2l15.52-46.55c3.47-1.29 7.13-2.23 11.05-2.23 17.67 0 32 14.33 32 32s-14.33 32-32 32c-11.38-.01-20.89-6.28-26.57-15.22zM480 384c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"}}]})(e)}function g1(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M139.61 35.5a12 12 0 0 0-17 0L58.93 98.81l-22.7-22.12a12 12 0 0 0-17 0L3.53 92.41a12 12 0 0 0 0 17l47.59 47.4a12.78 12.78 0 0 0 17.61 0l15.59-15.62L156.52 69a12.09 12.09 0 0 0 .09-17zm0 159.19a12 12 0 0 0-17 0l-63.68 63.72-22.7-22.1a12 12 0 0 0-17 0L3.53 252a12 12 0 0 0 0 17L51 316.5a12.77 12.77 0 0 0 17.6 0l15.7-15.69 72.2-72.22a12 12 0 0 0 .09-16.9zM64 368c-26.49 0-48.59 21.5-48.59 48S37.53 464 64 464a48 48 0 0 0 0-96zm432 16H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H208a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h288a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"}}]})(e)}function Ys(e){return tt({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}}]})(e)}function Dl(e){return tt({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M501.1 395.7L384 278.6c-23.1-23.1-57.6-27.6-85.4-13.9L192 158.1V96L64 0 0 64l96 128h62.1l106.6 106.6c-13.6 27.8-9.2 62.3 13.9 85.4l117.1 117.1c14.6 14.6 38.2 14.6 52.7 0l52.7-52.7c14.5-14.6 14.5-38.2 0-52.7zM331.7 225c28.3 0 54.9 11 74.9 31l19.4 19.4c15.8-6.9 30.8-16.5 43.8-29.5 37.1-37.1 49.7-89.3 37.9-136.7-2.2-9-13.5-12.1-20.1-5.5l-74.4 74.4-67.9-11.3L334 98.9l74.4-74.4c6.6-6.6 3.4-17.9-5.7-20.2-47.4-11.7-99.6.9-136.6 37.9-28.5 28.5-41.9 66.1-41.2 103.6l82.1 82.1c8.1-1.9 16.5-2.9 24.7-2.9zm-103.9 82l-56.7-56.7L18.7 402.8c-25 25-25 65.5 0 90.5s65.5 25 90.5 0l123.6-123.6c-7.6-19.9-9.9-41.6-5-62.7zM64 472c-13.2 0-24-10.8-24-24 0-13.3 10.7-24 24-24s24 10.7 24 24c0 13.2-10.7 24-24 24z"}}]})(e)}function os(e){return tt({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(e)}function v1(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"}}]})(e)}function y1(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"}}]})(e)}function b1(e){return tt({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M504 352H136.4c-4.4 0-8 3.6-8 8l-.1 48c0 4.4 3.6 8 8 8H504c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm0 96H136.1c-4.4 0-8 3.6-8 8l-.1 48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm0-192H136.6c-4.4 0-8 3.6-8 8l-.1 48c0 4.4 3.6 8 8 8H504c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zm106.5-139L338.4 3.7a48.15 48.15 0 0 0-36.9 0L29.5 117C11.7 124.5 0 141.9 0 161.3V504c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8V256c0-17.6 14.6-32 32.6-32h382.8c18 0 32.6 14.4 32.6 32v248c0 4.4 3.6 8 8 8h80c4.4 0 8-3.6 8-8V161.3c0-19.4-11.7-36.8-29.5-44.3z"}}]})(e)}const w1=({apontamentosRecentes:e,loading:t})=>{var l,d;const[r,a]=I.useState(!1);if(t)return n.jsx("div",{className:"fixed top-4 right-4 z-50",children:n.jsx("div",{className:"bg-gray-100 rounded-lg p-3 shadow-lg animate-pulse",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx("div",{className:"w-5 h-5 bg-gray-300 rounded-full"}),n.jsx("div",{className:"w-24 h-4 bg-gray-300 rounded"})]})})});if(!e||e.length===0)return null;const s=e.reduce((u,f)=>(u[f.exp_stage]||(u[f.exp_stage]=[]),u[f.exp_stage].push(f),u),{}),i=e.length,o=((l=s.usinagem)==null?void 0:l.length)||0,c=((d=s.embalagem)==null?void 0:d.length)||0;return n.jsx("div",{className:"fixed top-4 right-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg border-l-4 border-blue-500 max-w-sm",children:[n.jsx("div",{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(ed,{className:"text-blue-500 text-lg"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-800",children:"Novos Apontamentos"}),n.jsxs("p",{className:"text-xs text-gray-600",children:[i," hoje"]})]})]}),n.jsx("button",{onClick:()=>a(!r),className:"text-gray-400 hover:text-gray-600 transition-colors",children:r?n.jsx(Ys,{}):n.jsx(ed,{})})]})}),n.jsx("div",{className:"px-4 pb-2",children:n.jsxs("div",{className:"flex space-x-4 text-xs",children:[n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(od,{className:"text-orange-500"}),n.jsxs("span",{className:"text-gray-700",children:["Usinagem: ",n.jsx("strong",{children:o})]})]}),n.jsxs("div",{className:"flex items-center space-x-1",children:[n.jsx(td,{className:"text-green-500"}),n.jsxs("span",{className:"text-gray-700",children:["Embalagem: ",n.jsx("strong",{children:c})]})]})]})}),r&&n.jsx("div",{className:"border-t border-gray-200",children:n.jsx("div",{className:"max-h-64 overflow-y-auto",children:Object.entries(s).map(([u,f])=>n.jsxs("div",{className:"border-b border-gray-100 last:border-b-0",children:[n.jsx("div",{className:"px-4 py-2 bg-gray-50",children:n.jsxs("div",{className:"flex items-center space-x-2",children:[u==="usinagem"?n.jsx(od,{className:"text-orange-500"}):n.jsx(td,{className:"text-green-500"}),n.jsx("span",{className:"text-sm font-medium text-gray-700 capitalize",children:u==="usinagem"?"Usinagem":"Embalagem"}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",f.length,")"]})]})}),n.jsxs("div",{className:"px-4 py-2 space-y-1",children:[f.slice(0,3).map((m,h)=>n.jsxs("div",{className:"text-xs text-gray-600",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"font-medium",children:m.pedido_seq||"N/A"}),n.jsxs("span",{children:[m.quantidade," ",m.exp_unidade||"PC"]})]}),n.jsxs("div",{className:"text-gray-500",children:[m.operador,"  ",m.maquina]})]},h)),f.length>3&&n.jsxs("div",{className:"text-xs text-gray-500 italic",children:["+",f.length-3," mais..."]})]})]},u))})})]})})},_1=()=>{const{items:e}=ft("pedidos"),{items:t}=ft("apontamentos"),{items:r}=ft("paradas"),{items:a}=ft("maquinas"),{apontamentosRecentes:s,loading:i}=Gg(),[o,c]=I.useState("hoje"),l=new Date;(()=>{const h=l.getFullYear(),g=String(l.getMonth()+1).padStart(2,"0"),p=String(l.getDate()).padStart(2,"0");return`${h}-${g}-${p}`})();const d=h=>{if(!(h instanceof Date)||isNaN(h.getTime()))return"";const g=h.getFullYear(),p=String(h.getMonth()+1).padStart(2,"0"),x=String(h.getDate()).padStart(2,"0");return`${g}-${p}-${x}`},u=I.useMemo(()=>{const h=new Date,g=new Date(h),p=new Date(h);return o==="ontem"?(g.setDate(h.getDate()-1),p.setDate(h.getDate()-1)):o==="ult7"&&g.setDate(h.getDate()-6),g.setHours(0,0,0,0),p.setHours(23,59,59,999),{inicio:g,fim:p,ymdInicio:d(g),ymdFim:d(p)}},[o]),f=I.useMemo(()=>{const h=(t||[]).reduce((se,V)=>{const ye=V.inicio||V.inicio_timestamp||V.data||V.inicio_norm||"",Ee=ye?new Date(ye):null,ve=Number(V.quantidade||0);return!Ee||isNaN(Ee.getTime())?se:Ee>=u.inicio&&Ee<=u.fim?se+(isNaN(ve)?0:ve):se},0),g=u.inicio,p=u.fim,x=(r||[]).reduce((se,V)=>{const ye=V.inicio||V.inicio_timestamp||V.inicio_norm;if(!ye)return se;const Ee=V.fim||V.fim_timestamp||V.fim_norm||new Date,ve=new Date(ye),Fe=new Date(Ee);if(isNaN(ve.getTime()))return se;const Te=ve>g?ve:g,$e=Fe<p?Fe:p,ae=Math.max(0,$e-Te);return se+ae},0),w=Math.floor(x/6e4),_=String(Math.floor(w/60)).padStart(2,"0"),v=String(w%60).padStart(2,"0"),R=x>0?`${_}:${v}`:"-",q=(e||[]).filter(se=>{if(se!=null&&se.finalizado_manual)return!0;const V=Number(se.separado||0),ye=Number(se.qtd_pedido||0);return ye>0&&V>=ye}).length,U=(e||[]).filter(se=>{if(se!=null&&se.finalizado_manual)return!1;const V=Number(se.separado||0),ye=Number(se.qtd_pedido||0);return!(ye>0&&V>=ye)}).length;return{oee:{disponibilidade:0,performance:0,qualidade:0,total:0},tempoParada:R,producaoDiaria:h,ordensCompletadas:q,ordensPendentes:U}},[t,e,r,u]),m=I.useMemo(()=>{const h={};for(const w of t||[]){const _=String(w.ordem_trabalho||w.pedido_seq||"");if(!_)continue;const v=Number(w.quantidade||0);h[_]||(h[_]={quantidade:0,ultimo:null}),h[_].quantidade+=isNaN(v)?0:v,h[_].ultimo=w}const g=new Map;for(const w of a||[]){const _=(w.nome||w.codigo||w.modelo||"").toString()||"-";w.id&&g.set(String(w.id),_),w.codigo&&g.set(String(w.codigo),_)}const p=w=>String(w||"").toLowerCase();return(e||[]).filter(w=>{const _=String(w.pedido_seq||""),v=h[_];if(!v||v.quantidade<=0||["finalizado","concluido"].includes(p(w.status))||w.finalizado_manual)return!1;const q=Number(w.qtd_pedido||0);return!(q>0&&v.quantidade>=q)}).map(w=>{const _=String(w.pedido_seq||""),v=h[_]||{quantidade:0},R=Number(w.qtd_pedido||0),q=v.quantidade,U=R>0?Math.min(Math.round(q/R*100),100):0,P=v.ultimo||{},X=String(P.maquina||w.operacao_atual||"").trim(),G=g.get(X)||(/^[0-9a-f-]{8,}$/i.test(X)?"-":X||"-");return{codigo:w.pedido_seq||w.nro_op||w.id,perfil:w.produto,maquina:G,operador:P.operador||"-",qtdPedido:R,separado:Number(w.separado||0),apontado:q,progresso:U}}).slice(0,5)},[e,t,a]);return n.jsxs("div",{children:[n.jsx(w1,{apontamentosRecentes:s,loading:i}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("select",{value:o,onChange:h=>c(h.target.value),className:"border border-gray-300 rounded px-3 py-1 text-sm",children:[n.jsx("option",{value:"hoje",children:"Hoje"}),n.jsx("option",{value:"ontem",children:"Ontem"}),n.jsx("option",{value:"ult7",children:"ltimos 7 dias"})]}),n.jsxs("span",{className:"text-xs text-gray-500",children:[u.ymdInicio,"  ",u.ymdFim]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"OEE Total"}),n.jsx("p",{className:"text-3xl font-bold text-primary-600",children:f.oee.total?`${f.oee.total}%`:"-"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Tempo de Parada"}),n.jsx("p",{className:"text-3xl font-bold text-yellow-500",children:f.tempoParada})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Produo no Perodo"}),n.jsx("p",{className:"text-3xl font-bold text-green-600",children:f.producaoDiaria})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Ordens"}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Concludas"}),n.jsx("p",{className:"text-xl font-bold text-green-600",children:f.ordensCompletadas})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Pendentes"}),n.jsx("p",{className:"text-xl font-bold text-yellow-500",children:f.ordensPendentes})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Componentes do OEE"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Disponibilidade"}),n.jsxs("div",{className:"mt-1 relative pt-1",children:[n.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded bg-gray-200",children:n.jsx("div",{style:{width:`${f.oee.disponibilidade}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500"})}),n.jsxs("p",{className:"text-right text-sm font-semibold text-gray-700",children:[f.oee.disponibilidade,"%"]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Performance"}),n.jsxs("div",{className:"mt-1 relative pt-1",children:[n.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded bg-gray-200",children:n.jsx("div",{style:{width:`${f.oee.performance}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-yellow-500"})}),n.jsxs("p",{className:"text-right text-sm font-semibold text-gray-700",children:[f.oee.performance,"%"]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Qualidade"}),n.jsxs("div",{className:"mt-1 relative pt-1",children:[n.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded bg-gray-200",children:n.jsx("div",{style:{width:`${f.oee.qualidade}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"})}),n.jsxs("p",{className:"text-right text-sm font-semibold text-gray-700",children:[f.oee.qualidade,"%"]})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Ordens em Execuo"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cdigo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Perfil"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operador"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd. Pedido"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Separado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Apontado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Progresso"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[m.map((h,g)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:h.codigo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.perfil}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.maquina}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:h.operador}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(h.qtdPedido||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(h.separado||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(h.apontado||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsxs("div",{className:"relative pt-1",children:[n.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded bg-gray-200",children:n.jsx("div",{style:{width:`${h.progresso}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-primary-500"})}),n.jsxs("span",{className:"text-xs font-semibold inline-block text-primary-600",children:[h.progresso,"%"]})]})})]},g)),m.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-6 py-6 text-center text-gray-500",children:"Nenhuma ordem em produo"})})]})]})})]})]})]})},Si=()=>{try{const e=localStorage.getItem("configuracao_impressoras");return e?JSON.parse(e):{termica:{nome:"Impressora Trmica",caminho:"\\\\192.168.1.100\\Zebra_ZT230",ip:"192.168.1.100",porta:"9100",ativa:!0},comum:{nome:"Impressora Comum",caminho:"\\\\192.168.1.101\\HP_LaserJet",ip:"192.168.1.101",porta:"9100",ativa:!0}}}catch(e){return console.error("Erro ao carregar configuraes de impressoras:",e),{termica:{nome:"Impressora Trmica",caminho:"",ip:"",porta:"9100",ativa:!1},comum:{nome:"Impressora Comum",caminho:"",ip:"",porta:"9100",ativa:!1}}}},cd=e=>{var r;return((r=Si()[e])==null?void 0:r.ativa)||!1},ld=e=>{const r=Si()[e];return!r||!r.ativa?null:r.caminho?r.caminho:r.ip&&r.porta?`${r.ip}:${r.porta}`:null},dd=async e=>{try{await navigator.clipboard.writeText(e),alert(`Copiado para a rea de transferncia:
`+e)}catch{alert("No foi possvel copiar para a rea de transferncia.")}},pf=({tituloPagina:e="Apontamentos de Usinagem",subtituloForm:t="Novo Apontamento",modo:r="usinagem"})=>{var En,Dr,ys,Ws;const{user:a}=Ms(),{items:s,loading:i}=ft("pedidos"),{items:o,addItem:c,loadItems:l}=ft("apontamentos"),{items:d}=ft("lotes"),[u,f]=I.useState(!1),[m,h]=I.useState(new Set);I.useEffect(()=>{g()},[]);const g=async()=>{try{const O=await Qe.getAll("pcp_prioridades"),te=new Set((O||[]).map(b=>b.pedido_numero).filter(Boolean));h(te)}catch(O){console.warn("No foi possvel carregar prioridades do PCP:",O),h(new Set)}},p="apont_usinagem_draft",[x,w]=I.useState({operador:a?a.nome:"",maquina:"",codigoPerfil:"",ordemTrabalho:"",inicio:"",fim:"",quantidade:"",qtdPedido:0,perfilLongo:"",separado:"",cliente:"",pedidoCliente:"",dtFatura:"",unidade:"",comprimentoAcabado:"",nroOp:"",observacoes:"",romaneioNumero:"",loteExterno:"",lotesExternos:[]}),[_,v]=I.useState(!1),[R,q]=I.useState(null),[U,P]=I.useState(Date.now());I.useEffect(()=>{if(!_)return;const O=setInterval(()=>P(Date.now()),1e3);return()=>clearInterval(O)},[_]);const X=()=>{if(!x.ordemTrabalho){alert("Selecione um Pedido/Seq antes de iniciar o contador.");return}const O=x.inicio||Ta(),te=ps(O)||new Date;w(b=>({...b,inicio:O})),q(te),v(!0)},G=()=>{const O=new Date,te=rt=>String(rt).padStart(2,"0"),b=te(O.getDate()),K=te(O.getMonth()+1),ue=String(O.getFullYear()),y=`${b}${K}${ue}`,M=te(O.getHours()),H=te(O.getMinutes()),pe=`${M}${H}`,Oe=(x.romaneioNumero||"").toString().trim().replace(/\s+/g,""),_e=(x.lotesExternos&&x.lotesExternos.length>0?x.lotesExternos[0]:x.loteExterno||"").toString().trim().replace(/\s+/g,""),ze=(x.pedidoCliente||"").toString().trim().replace(/\s+/g,""),Xe=(x.nroOp||"").toString().trim().replace(/\s+/g,"");return`${y}-${pe}-${Oe}-${_e}-${ze}-${Xe}`.replace(/[^A-Za-z0-9_-]/g,"-")},le=(O,te,b,K)=>{const ue=Si().termica;if(!cd("termica")){alert(`Impressora trmica no est configurada ou ativa.
V em Configuraes > Impressoras para configurar.`);return}const y=ld("termica");console.log(` Imprimindo etiqueta trmica via: ${ue.nome} (${y})`);const M=x.cliente||"",H=x.ordemTrabalho||"",pe=x.codigoPerfil||"",Oe=x.comprimentoAcabado||"",_e=te||"",ze=K||"N/A",st=(Tn=>{if(!Tn)return"";const Er=String(Tn).toUpperCase(),An=/^([A-Z]{3})([A-Z0-9]+)/,bs=/^([A-Z]{2})([A-Z0-9]+)/;let Gt="",qt="",Ve=0,We=Er.match(An);if(We)Gt=We[1],qt=We[2],Ve=3;else if(We=Er.match(bs),We)Gt=We[1],qt=We[2],Ve=4;else return"";let Tr="";for(const sr of qt)if(/[0-9]/.test(sr)?Tr+=sr:sr==="O"&&(Tr+="0"),Tr.length===Ve)break;return Tr.length<Ve&&(Tr=Tr.padEnd(Ve,"0")),`${Gt}-${Tr}`})(pe),rt=`<!DOCTYPE html>
    <html><head><meta charset="utf-8" />
    <style>
      @page { size: 100mm 45mm; margin: 1mm; }
      body { 
        font-family: Arial, sans-serif; 
        color: #000; 
        margin: 0; 
        padding: 1mm;
        font-size: 13pt;
        line-height: 1.3;
        -webkit-print-color-adjust: exact; 
        print-color-adjust: exact;
      }
      .header { 
        background: #000; 
        color: #fff; 
        text-align: center; 
        font-weight: bold; 
        font-size: 14pt;
        padding: 1.5mm 0;
        margin-bottom: 1.5mm;
      }
      .content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1mm 3mm;
        margin-bottom: 1.5mm;
      }
      .info-item {
        margin-bottom: 1mm;
      }
      .label { 
        font-size: 10pt;
        color: #666;
        display: block;
        margin-bottom: 0.3mm;
      }
      .value { 
        font-weight: bold;
        font-size: 14pt;
        color: #000;
        display: block;
      }
      .barcode-section {
        text-align: center;
        margin-top: 1mm;
        padding-top: 1mm;
        border-top: 1px solid #ccc;
      }
      .barcode-text {
        font-family: 'Libre Barcode 128', 'Courier New', monospace;
        font-size: 32pt;
        letter-spacing: -1px;
        line-height: 1;
        font-weight: bold;
      }
    </style>
    </head><body>
      <div class="header">TECNOPERFIL ALUMNIO</div>
      <div class="content">
        <div class="col-left">
          <div class="info-item">
            <span class="label">Cliente:</span>
            <span class="value">${M}</span>
          </div>
          <div class="info-item">
            <span class="label">Pedido:</span>
            <span class="value">${H}</span>
          </div>
          <div class="info-item">
            <span class="label">Perfil:</span>
            <span class="value">${st}</span>
          </div>
          <div class="info-item">
            <span class="label">Dureza:</span>
            <span class="value">${ze}</span>
          </div>
        </div>
        <div class="col-right">
          <div class="info-item">
            <span class="label">Comprimento:</span>
            <span class="value">${Oe} mm</span>
          </div>
          <div class="info-item">
            <span class="label">Turno:</span>
            <span class="value">TB</span>
          </div>
          <div class="info-item">
            <span class="label">Quantidade:</span>
            <span class="value">${_e} PC</span>
          </div>
        </div>
      </div>
      <div class="barcode-section">
        <div class="barcode-text">${O.replace(/-/g,"")}</div>
      </div>
    </body></html>`,Be=new Blob([rt],{type:"text/html"}),jr=URL.createObjectURL(Be),dr=window.open(jr,"_blank","width=400,height=200");dr&&(dr.onload=()=>{setTimeout(()=>{dr.print()},250)}),setTimeout(()=>URL.revokeObjectURL(jr),1e3)},se=(O,te,b,K)=>{const ue=Si().comum;if(!cd("comum")){alert(`Impressora comum no est configurada ou ativa.
V em Configuraes > Impressoras para configurar.`);return}const y=ld("comum");console.log(` Imprimindo documento via: ${ue.nome} (${y})`);const M=x.cliente||"",H=x.codigoPerfil||"";x.perfilLongo;const pe=x.comprimentoAcabado||"",Oe=x.ordemTrabalho||"",_e=x.pedidoCliente||"",rt=`<!DOCTYPE html>
    <html><head><meta charset="utf-8" />
    <style>
      @page { 
        size: A4 landscape; 
        margin: 12.7mm; /* Margens estreitas padro */
      }
      @media print {
        @page {
          size: landscape;
          margin: 12.7mm;
        }
        body {
          margin: 0;
        }
      }
      body { 
        font-family: 'Segoe UI', Arial, sans-serif; 
        color: #000; 
        margin: 0;
        padding: 10mm;
        background: #fff;
        -webkit-print-color-adjust: exact; 
        print-color-adjust: exact; 
      }
      .container {
        max-width: 100%;
        margin: 0 auto;
        background: #fff;
        border: 2px solid #000;
        padding: 8mm;
      }
      .header { 
        text-align: center; 
        margin-bottom: 8mm;
        border-bottom: 3px solid #000;
        padding-bottom: 4mm;
      }
      .titulo { 
        font-size: 24pt; 
        font-weight: 800; 
        text-transform: uppercase;
        letter-spacing: 1pt;
        margin: 0;
      }
      .sub { 
        margin-top: 4mm; 
        font-size: 11pt; 
        font-weight: 600; 
        color: #333;
      }
      .form-grid { 
        display: grid;
        grid-template-columns: 25% 75%;
        gap: 5mm 0;
        margin-bottom: 5mm;
      }
      .form-row {
        display: contents;
      }
      .form-row.dupla {
        display: grid;
        grid-column: 1 / -1;
        grid-template-columns: 12.5% 37.5% 12.5% 37.5%;
        gap: 0 4mm;
        align-items: end;
      }
      .label { 
        font-weight: 700; 
        font-size: 14pt; 
        text-transform: uppercase;
        letter-spacing: 0.5pt;
        color: #000;
        padding-right: 4mm;
        align-self: end;
        padding-bottom: 2mm;
      }
      .valor { 
        border-bottom: 2px solid #000; 
        font-size: 16pt; 
        font-weight: 600;
        padding: 2mm 4mm; 
        min-height: 8mm; 
        text-align: center;
        background: #f9f9f9;
        position: relative;
      }
      .valor:empty::after {
        content: '';
        display: inline-block;
        width: 100%;
        height: 8mm;
      }
    </style>
    </head><body>
      <div class="container">
        <div class="header">
          <div class="titulo">Formulrio de Identificao do Material Cortado</div>
          <div class="sub">Lote: ${O}</div>
        </div>
        
        <div class="form-grid">
          <div class="form-row">
            <div class="label">Cliente:</div>
            <div class="valor">${M}</div>
          </div>
          
          <div class="form-row">
            <div class="label">Item:</div>
            <div class="valor">${H}</div>
          </div>
          
          <div class="form-row">
            <div class="label">Medida:</div>
            <div class="valor">${pe}</div>
          </div>
          
          <div class="form-row">
            <div class="label">Pedido Tecno:</div>
            <div class="valor">${Oe}</div>
          </div>
          
          <div class="form-row dupla">
            <div class="label">Qtde:</div>
            <div class="valor">${te||""}</div>
            <div class="label">Palet:</div>
            <div class="valor">${b||""}</div>
          </div>
          
          <div class="form-row">
            <div class="label">Pedido Cli:</div>
            <div class="valor">${_e}</div>
          </div>
          
          <div class="form-row">
            <div class="label">Dureza:</div>
            <div class="valor">${K||""}</div>
          </div>
        </div>
      </div>
    </body></html>`,Be=new Blob([rt],{type:"application/msword"}),jr=URL.createObjectURL(Be),dr=document.createElement("a");dr.href=jr,dr.download=`identificacao_${O}.doc`,document.body.appendChild(dr),dr.click(),document.body.removeChild(dr),URL.revokeObjectURL(jr)},V=()=>{const O=new Date,te=R||ps(x.inicio);if(!te){v(!1),q(null);return}const b=Math.round((O-te)/6e4),K=`Deseja utilizar este tempo no apontamento?

Incio: ${te.toLocaleString("pt-BR")}
Fim: ${O.toLocaleString("pt-BR")}
Tempo: ${b} minuto(s).`;if(window.confirm(K)){const y=Xe=>String(Xe).padStart(2,"0"),M=O.getFullYear(),H=y(O.getMonth()+1),pe=y(O.getDate()),Oe=y(O.getHours()),_e=y(O.getMinutes()),ze=`${M}-${H}-${pe}T${Oe}:${_e}`;w(Xe=>({...Xe,fim:ze}))}v(!1),q(null)},[ye,Ee]=I.useState(!1),[ve,Fe]=I.useState(!1),[Te,$e]=I.useState(""),[ae,He]=I.useState(!1),[Ue,k]=I.useState(""),[B,E]=I.useState(""),[D,z]=I.useState(""),[oe,J]=I.useState(""),[ce,he]=I.useState(""),[De,j]=I.useState(!1),[de,fe]=I.useState(!1),[re,xe]=I.useState(!1),[L,Y]=I.useState(!1),[ke,Pe]=I.useState(""),[Ge,et]=I.useState("documento"),[Pt,qe]=I.useState(!1),[ht,ot]=I.useState(""),[wt,jt]=I.useState([""]),[Ft,Ke]=I.useState(!1),[vt,yt]=I.useState(""),[mt,lr]=I.useState(""),[wr,Bt]=I.useState([]),[Wr,_r]=I.useState([]),[Sr,ar]=I.useState([]),[ha,pr]=I.useState([]),[ia,Qr]=I.useState(!1),[Zr,Ea]=I.useState(""),[Wt,Ut]=I.useState(!1),[pt,_t]=I.useState([]),[St,W]=I.useState([]),[me,we]=I.useState(!1),[Ae,S]=I.useState(""),[T,A]=I.useState(""),[N,C]=I.useState(!1),[F,Q]=I.useState(""),[ee,Z]=I.useState([]),[ne,ie]=I.useState([]),[Se,Ce]=I.useState([]),Ie=I.useMemo(()=>{const O=String(Ae||"").replace(/\D/g,""),te=String(T||"").replace(/\D/g,"");return pt.filter(b=>{const K=O?String(b.pedido_seq||"").replace(/\D/g,"").startsWith(O):!0,ue=te?String(b.romaneio||"").replace(/\D/g,"").startsWith(te):!0;return K&&ue})},[Ae,T,pt]),Ne=O=>String(O||"").replace(/\D/g,""),Le=(O,te)=>{try{const b=(O==null?void 0:O.dados_originais)||{},K=String(te).toLowerCase().replace(/[^a-z0-9]/g,"");for(const ue of Object.keys(b))if(String(ue).toLowerCase().replace(/[^a-z0-9]/g,"")===K)return b[ue];return""}catch{return""}},Je=()=>{const O=String(mt||"").trim();if(!O){Bt([]);return}try{let te=(d||[]).filter(ue=>String(ue.rack_embalagem||"").trim()===O);if(te.length===0){const ue=Ne(O);ue&&(te=(d||[]).filter(y=>{const M=Ne(y.rack_embalagem);return M?M===ue||M.endsWith(ue)&&ue.length>=3:!1}))}const b=new Map;for(const ue of te){const y=String(ue.lote||"").trim();if(!y)continue;const M=String(ue.pedido_seq||"").trim(),H=M.includes("/")?M.split("/"):["",""],pe=H[0]||"",Oe=H[1]||"",_e=String(ue.produto||Le(ue,"Produto")||ue.codigo||"").trim(),ze=xa(_e||""),Xe=String(ue.codigo||Le(ue,"Amarrado")||"").trim();b.has(y)||b.set(y,{lote:y,produto:_e,ferramenta:ze,romaneios:new Set,pedido:pe,seq:Oe,amarrados:[]});const st=b.get(y);!st.produto&&_e&&(st.produto=_e),!st.ferramenta&&ze&&(st.ferramenta=ze);const rt=String(ue.romaneio||"").trim();rt&&st.romaneios.add(rt),Xe&&!st.amarrados.some(Be=>Be.codigo===Xe)&&st.amarrados.push({codigo:Xe,rack:String(ue.rack_embalagem||"").trim(),lote:y,produto:_e,pedido_seq:M,romaneio:rt,qt_kg:Number(ue.qt_kg||0),qtd_pc:Number(ue.qtd_pc||0),situacao:String(ue.situacao||"").trim(),embalagem_data:ue.embalagem_data||null,nota_fiscal:String(ue.nota_fiscal||"").trim()})}const K=Array.from(b.values()).map(ue=>({lote:ue.lote,produto:ue.produto,ferramenta:ue.ferramenta,romaneio:Array.from(ue.romaneios).join(", "),pedido:ue.pedido,seq:ue.seq,amarrados:ue.amarrados}));Bt(K),_r(ue=>ue.filter(y=>K.some(M=>M.lote===y)))}catch{Bt([])}},Nt=()=>{const te=String(F||"").trim().replace(/\D/g,"");if(!te){Z([]),ie([]);return}try{const b=[];for(const K of d||[]){const ue=String(K.lote||"").replace(/\D/g,""),y=String(K.codigo||"").replace(/\D/g,""),M=String(Le(K,"Amarrado")||"").replace(/\D/g,"");(ue&&ue.includes(te)||y&&y.includes(te)||M&&M.includes(te))&&b.push({rack:String(K.rack_embalagem||"").trim(),lote:String(K.lote||"").trim(),produto:String(K.produto||Le(K,"Produto")||"").trim(),pedido_seq:String(K.pedido_seq||"").trim(),romaneio:String(K.romaneio||"").trim(),codigo:String(K.codigo||"").trim(),qt_kg:Number(K.qt_kg||0),qtd_pc:Number(K.qtd_pc||0)})}Z(b),ie([])}catch{Z([]),ie([])}},Tt=()=>{const O=ne.map(y=>ee[y]);if(!O.length){alert("Selecione pelo menos um amarrado.");return}const te=O.map(y=>y.lote).filter(Boolean);Array.from(new Set(O.map(y=>y.rack).filter(Boolean)));const b=Wr||[],K=Array.from(new Set([...b,...te]));_r(K);const ue=O.map(y=>({lote:y.lote,produto:y.produto,ferramenta:xa(y.produto||""),romaneio:y.romaneio,pedido:y.pedido_seq?y.pedido_seq.split("/")[0]:"",seq:y.pedido_seq?y.pedido_seq.split("/")[1]:"",rack:y.rack}));Bt(y=>[...y.filter(H=>!te.includes(H.lote)),...ue]),Ce(y=>[...y.filter(H=>!te.includes(H.lote)),...O]),ie([]),Z([]),Q(""),alert(`${O.length} amarrado(s) adicionado(s)  seleo. Total: ${K.length} lote(s) selecionado(s).`)},it=O=>{ar(te=>te.some(K=>K.codigo===O.codigo&&K.lote===O.lote)?te.filter(K=>!(K.codigo===O.codigo&&K.lote===O.lote)):[...te,O])},Qt=O=>{const te=wr.find(b=>b.lote===O);!te||!te.amarrados||ar(b=>[...b.filter(ue=>ue.lote!==O),...te.amarrados])},Pr=O=>{ar(te=>te.filter(b=>b.lote!==O))},Zt=O=>{const te=wr.find(b=>b.lote===O);return!te||!te.amarrados||te.amarrados.length===0?!1:te.amarrados.every(b=>Sr.some(K=>K.codigo===b.codigo&&K.lote===b.lote))},Vr=O=>{pr(te=>te.includes(O)?te.filter(b=>b!==O):[...te,O])},ma=()=>{const O=String(mt||"").trim();if(Sr.length>0){const te=Array.from(new Set(Sr.map(ue=>ue.lote))),b=Array.from(new Set(Sr.map(ue=>ue.rack).filter(Boolean))),K=b.length>1?"MLTIPLOS RACKS":b[0]||O;w(ue=>({...ue,rack_ou_pallet:K,rackOuPallet:K,lotesExternos:te,amarradosDetalhados:Sr})),Ke(!1),ar([]),pr([]);return}if(!(!Wr.length&&!window.confirm("Nenhum lote selecionado. Deseja continuar assim mesmo?"))){if(!O&&Wr.length>0){const te=wr.filter(b=>Wr.includes(b.lote)&&b.rack);if(te.length>0){const b=Array.from(new Set(te.map(ue=>ue.rack))),K=b.length>1?"MLTIPLOS RACKS":b[0];w(ue=>({...ue,rack_ou_pallet:K,rackOuPallet:K,lotesExternos:[...Wr]})),Ke(!1),ar([]);return}}if(!O){alert('Informe o Rack!Embalagem ou use "Procurar por Amarrado" para selecionar lotes.');return}w(te=>({...te,rack_ou_pallet:O,rackOuPallet:O,lotesExternos:[...Wr]})),Ke(!1),ar([])}},{items:er}=ft("maquinas"),$s=O=>{if(!O)return"";const te=String(O);if(te.length>=12){const b=te.slice(8,12);if(/^\d{4}$/.test(b))return`${b}mm`}return""},ps=O=>{try{const[te,b]=String(O||"").split("T");if(!te||!b)return null;const[K,ue,y]=te.split("-").map(Number),[M,H]=b.split(":").map(Number);return new Date(K,(ue||1)-1,y||1,M||0,H||0)}catch{return null}},es=O=>{const te=ps(O);return te&&!isNaN(te.getTime())?te.toISOString():null},qa=O=>{const te=Math.max(0,Math.floor((O||0)/1e3)),b=String(Math.floor(te/3600)).padStart(2,"0"),K=String(Math.floor(te%3600/60)).padStart(2,"0"),ue=String(te%60).padStart(2,"0");return`${b}:${K}:${ue}`},ts=()=>{try{typeof window<"u"&&localStorage.removeItem(p)}catch{}w({operador:a?a.nome:"",maquina:"",codigoPerfil:"",ordemTrabalho:"",inicio:"",fim:"",quantidade:"",qtdPedido:"",perfilLongo:"",separado:"",cliente:"",pedidoCliente:"",dtFatura:"",unidade:"",comprimentoAcabado:"",nroOp:"",observacoes:"",romaneioNumero:"",loteExterno:"",lotesExternos:[]})},xa=O=>{if(!O)return"";const te=String(O).toUpperCase(),b=/^([A-Z]{3})([A-Z0-9]+)/,K=/^([A-Z]{2})([A-Z0-9]+)/;let ue="",y="",M=0,H=te.match(b);if(H)ue=H[1],y=H[2],M=3;else if(H=te.match(K),H)ue=H[1],y=H[2],M=4;else return"";let pe="";for(const Oe of y)if(/[0-9]/.test(Oe)?pe+=Oe:Oe==="O"&&(pe+="0"),pe.length===M)break;return pe.length<M&&(pe=pe.padEnd(M,"0")),`${ue}-${pe}`},Nr=(O,te)=>{try{const b=(O==null?void 0:O.dados_originais)||{},K=String(te).toLowerCase().replace(/[^a-z0-9]/g,"");for(const ue of Object.keys(b))if(String(ue).toLowerCase().replace(/[^a-z0-9]/g,"")===K)return b[ue];return""}catch{return""}},Ta=()=>{const O=H=>String(H).padStart(2,"0"),te=new Date,b=te.getFullYear(),K=O(te.getMonth()+1),ue=O(te.getDate()),y=O(te.getHours()),M=O(te.getMinutes());return`${b}-${K}-${ue}T${y}:${M}`},_n=(O,te)=>{try{const b=jr=>String(jr).padStart(2,"0"),[K,ue]=String(O||Ta()).split("T"),[y,M,H]=K.split("-").map(Number),[pe,Oe]=(ue||"00:00").split(":").map(Number),_e=new Date(y,(M||1)-1,H||1,pe||0,Oe||0);_e.setMinutes(_e.getMinutes()+(Number.isFinite(te)?te:0));const ze=_e.getFullYear(),Xe=b(_e.getMonth()+1),st=b(_e.getDate()),rt=b(_e.getHours()),Be=b(_e.getMinutes());return`${ze}-${Xe}-${st}T${rt}:${Be}`}catch{return O}},ea=s.filter(O=>!(O!=null&&O.finalizado_manual)).map(O=>{const te=O.produto||Nr(O,"Produto")||Nr(O,"Ferramenta")||"",b=$s(te),K=xa(O.produto),ue=O.item_perfil||Nr(O,"ITEM.PERFIL")||Nr(O,"ITEM PERFIL")||Nr(O,"PERFIL LONGO")||"",y=O.separado??Nr(O,"SEPARADO")??0,M=Number(String(y).replace(/\D/g,""))||0,H=O.dt_fatura||Nr(O,"DT.FATURA")||Nr(O,"DATA ENTREGA")||"",pe=O.nro_op||Nr(O,"NRO DA OP")||Nr(O,"N OP")||Nr(O,"OP")||"";return{id:O.pedido_seq,codigoPerfil:O.produto||"",descricao:O.descricao||"",qtdPedido:Number(O.qtd_pedido||0),perfilLongo:ue,separado:M,cliente:Nr(O,"CLIENTE")||O.cliente||"",pedidoCliente:O.pedido_cliente||"",dtFatura:H,unidade:O.unidade||"",comprimentoAcabado:b,ferramenta:K,nroOp:pe}}),ta=I.useMemo(()=>{try{return new Set((o||[]).map(O=>String(O.ordemTrabalho||O.ordem_trabalho||O.pedido_seq||"").trim()).filter(Boolean))}catch{return new Set}},[o]),$a=I.useMemo(()=>r==="embalagem"?ea.filter(O=>ta.has(String(O.id))):ea,[r,ea,ta]),kr=u?$a.filter(O=>m.has(O.id)):$a,Aa=typeof window<"u"&&localStorage.getItem("pdfBasePath")||"",Or=typeof window<"u"&&localStorage.getItem("processBasePath")||"",Ca=xa(x.codigoPerfil),Sn=(((Dr=(En=import.meta)==null?void 0:En.env)==null?void 0:Dr.VITE_BACKEND_URL)||"http://localhost:8000").replace(/\/$/,""),Ha=(O,te)=>{const b=new URLSearchParams({base:O||""}),K=te.endsWith(".pdf")?te:`${te}.pdf`;return`${Sn}/api/files/pdf/${encodeURIComponent(K)}?${b.toString()}`},gs=kr.filter(O=>{if(!Te)return!0;const te=Te.toString().trim().toLowerCase(),b=te.replace(/\D/g,""),K=(O.comprimentoAcabado||"").replace(/\D/g,""),ue=String(O.id||"").toLowerCase(),y=ue.replace(/\D/g,""),M=String(O.pedidoCliente||"").toLowerCase(),H=M.replace(/\D/g,"");return!!(b&&(K.startsWith(b)||y.includes(b)||H&&H.includes(b))||ue.includes(te)||(O.ferramenta||"").toLowerCase().includes(te)||(O.codigoPerfil||"").toLowerCase().includes(te)||M.includes(te)||(O.cliente||"").toLowerCase().includes(te))});I.useEffect(()=>{a&&w(O=>({...O,operador:a.nome}))},[a]),I.useEffect(()=>{try{const O=typeof window<"u"?localStorage.getItem(p):null;if(O){const te=JSON.parse(O);te&&typeof te=="object"&&w(b=>({...b,...te,operador:a&&a.nome?a.nome:te.operador||b.operador}))}}catch{}Ee(!0)},[]),I.useEffect(()=>{if(ye)try{typeof window<"u"&&localStorage.setItem(p,JSON.stringify(x))}catch{}},[x,ye]);const Fa=O=>{const{name:te,value:b}=O.target;if(te==="ordemTrabalho"){const K=kr.find(ue=>ue.id===b);if(K){const ue=x.inicio||Ta();w({...x,ordemTrabalho:b,codigoPerfil:K.codigoPerfil,qtdPedido:K.qtdPedido,perfilLongo:K.perfilLongo,separado:K.separado,cliente:K.cliente,pedidoCliente:K.pedidoCliente,dtFatura:K.dtFatura,unidade:K.unidade,comprimentoAcabado:K.comprimentoAcabado,nroOp:K.nroOp,inicio:ue,fim:x.fim||_n(ue,60)}),yt(b),lr(""),Bt([]),_r([]),Ke(!0);return}}w({...x,[te]:b})},Pa=O=>{O.preventDefault(),E(String(x.quantidade||"")),k(""),z(""),J(""),he(""),He(!0)},Nn=async()=>{const O=Number(x.quantidade||0),te=Number(B||0);if(!Ue){alert("Informe o Nmero do Rack ou Pallet.");return}if(O<=0){alert("Quantidade Produzida deve ser maior que zero.");return}if(O!==te){alert("A quantidade confirmada deve ser igual  Quantidade Produzida.");return}const b=G(),K=[];if(x.lotesExternos&&x.lotesExternos.length>0)for(const M of x.lotesExternos){const H=(d||[]).find(pe=>String(pe.lote||"").trim()===M);H&&K.push({codigo:String(H.codigo||"").trim(),rack:String(H.rack_embalagem||"").trim(),lote:String(H.lote||"").trim(),produto:String(H.produto||Le(H,"Produto")||"").trim(),pedido_seq:String(H.pedido_seq||"").trim(),romaneio:String(H.romaneio||"").trim(),qt_kg:Number(H.qt_kg||0),qtd_pc:Number(H.qtd_pc||0),situacao:String(H.situacao||"").trim(),embalagem_data:H.embalagem_data||null,nota_fiscal:String(H.nota_fiscal||"").trim()})}const ue=r==="embalagem"?{exp_unidade:"embalagem",exp_stage:"para-embarque"}:{},y={operador:x.operador||(a?a.nome:""),maquina:x.maquina||"",produto:x.codigoPerfil||"",cliente:x.cliente||"",inicio:es(x.inicio),fim:x.fim?es(x.fim):null,quantidade:O,qtd_refugo:Number(D||0),comprimento_refugo:Number(oe||0),qtd_pedido:x.qtdPedido?Number(x.qtdPedido):null,nro_op:x.nroOp||"",perfil_longo:x.perfilLongo||"",comprimento_acabado_mm:Number(String(x.comprimentoAcabado||"").replace(/\D/g,""))||null,ordem_trabalho:x.ordemTrabalho||"",observacoes:x.observacoes||"",rack_ou_pallet:Ue||"",dureza_material:ce||"",lotes_externos:x.lotesExternos&&x.lotesExternos.length?[...x.lotesExternos]:[],lote:b,romaneio_numero:x.romaneioNumero||"",lote_externo:x.loteExterno||"",amarrados_detalhados:K.length>0?K:null,...ue};try{await c(y),console.log("Apontamento confirmado (Supabase):",y),setTimeout(()=>{l()},500)}catch(M){console.error("Falha ao registrar apontamento no Supabase:",M),alert(`No foi possvel registrar o apontamento no Supabase. Verifique a conexo e o schema.
Detalhes: `+((M==null?void 0:M.message)||"erro desconhecido"));return}He(!1),Pe(b),Y(!0)},rs=()=>{xe(!1),w(O=>({...O,quantidade:""}));try{if(typeof window<"u"){const O={...x,quantidade:""};localStorage.setItem(p,JSON.stringify(O))}}catch{}},as=()=>{xe(!1);try{typeof window<"u"&&localStorage.removeItem(p)}catch{}ts()},ci=()=>{Y(!1),Ge==="etiqueta"?le(ke,x.quantidade,Ue,ce):se(ke,x.quantidade,Ue,ce),xe(!0)},Hs=()=>{Y(!1),xe(!0)},vs=()=>{const O=String(ht||"").trim(),te=(wt||[]).map(b=>String(b||"").trim()).filter(b=>b);if(!O||te.length===0){alert("Informe o Nmero do Romaneio e pelo menos um Nmero de Lote (externo).");return}w(b=>({...b,romaneioNumero:O,lotesExternos:te,loteExterno:te[0]})),qe(!1)};I.useEffect(()=>{Ft&&Je()},[mt,Ft,vt,d]);const zs=I.useMemo(()=>{const O=String(x.ordemTrabalho||"");if(!O)return 0;try{console.log("Calculando totalApontado para:",O),console.log("ApontamentosDB:",(o==null?void 0:o.length)||0,"registros");const te=(o||[]).reduce((b,K)=>{const ue=String(K.ordem_trabalho||K.ordemTrabalho||K.pedido_seq||""),y=Number(K.quantidade||K.quantidadeProduzida||0),M=ue===O;return M&&console.log("Match encontrado:",{seq:ue,qtd:y,apontamento:K}),b+(M?isNaN(y)?0:y:0)},0);return console.log("Total calculado:",te),te}catch(te){return console.error("Erro ao calcular totalApontado:",te),0}},[o,x.ordemTrabalho]),kn=I.useMemo(()=>{const te=Number(x.qtdPedido||0)-Number(zs||0);return Number.isFinite(te)?te:0},[x.qtdPedido,zs]),jn=I.useMemo(()=>{const O=String(x.ordemTrabalho||"");if(!O)return[];try{return(o||[]).filter(te=>String(te.ordemTrabalho||te.pedido_seq||"")===O)}catch{return[]}},[o,x.ordemTrabalho]);return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:e}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 form-compact",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:t}),x.ordemTrabalho&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"px-3 py-1 rounded-md bg-primary-50 text-primary-700 text-sm font-semibold border border-primary-200",title:"Soma de apontamentos desta ordem",children:["Qtd. Apontada: ",zs]}),n.jsxs("div",{className:"px-3 py-1 rounded-md bg-amber-50 text-amber-700 text-sm font-semibold border border-amber-200",title:"Saldo para cortar = Qtd.Pedido - Qtd. Apontada",children:["Saldo p/ Cortar: ",kn]}),n.jsx("button",{type:"button",className:"p-2 rounded border border-gray-300 text-gray-600 hover:bg-gray-100 hover:text-gray-900",title:"Ver apontamentos deste pedido",onClick:()=>j(!0),"aria-label":"Ver apontamentos do pedido",children:n.jsx(l1,{})})]}),N&&n.jsxs("div",{className:"fixed inset-0 z-[67] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>C(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-7xl h-[90vh] p-5 form-compact flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Procurar Amarrados"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>C(!1),children:"Fechar"})]}),n.jsxs("div",{className:"flex-1 flex gap-4 min-h-0",children:[n.jsxs("div",{className:"flex-1 flex flex-col space-y-3",children:[n.jsxs("div",{className:"flex items-end gap-2",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Nmero do Amarrado"}),n.jsx("input",{type:"text",className:"input-field input-field-sm w-full",value:F,onChange:O=>Q(O.target.value),placeholder:"Digite o n do amarrado (pode colar parcial)",onKeyPress:O=>O.key==="Enter"&&Nt()})]}),n.jsx("button",{type:"button",className:"btn-primary",onClick:Nt,children:"Procurar"}),n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>{Q(""),Z([]),ie([])},children:"Limpar"})]}),ee.length>0&&n.jsxs("div",{className:"mb-2 flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[ee.length," amarrado(s) encontrado(s)  ",ne.length," selecionado(s)"]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[n.jsx("input",{type:"checkbox",checked:ne.length===ee.length&&ee.length>0,onChange:O=>{O.target.checked?ie(ee.map((te,b)=>b)):ie([])}}),"Selecionar todos"]})]}),n.jsxs("div",{className:"border rounded flex-1 overflow-auto",children:[(!ee||ee.length===0)&&n.jsx("div",{className:"text-sm text-gray-500 p-4 text-center",children:F?"Nenhum amarrado encontrado.":"Informe o nmero do amarrado e clique em Procurar."}),ee.length>0&&n.jsxs("table",{className:"min-w-full text-xs",children:[n.jsx("thead",{className:"bg-gray-50 text-gray-600 sticky top-0",children:n.jsxs("tr",{children:[n.jsx("th",{className:"p-2 w-8"}),n.jsx("th",{className:"p-2 text-left",children:"Rack/Embalagem"}),n.jsx("th",{className:"p-2 text-left",children:"Cdigo"}),n.jsx("th",{className:"p-2 text-left",children:"Lote"}),n.jsx("th",{className:"p-2 text-left",children:"Produto"}),n.jsx("th",{className:"p-2 text-left",children:"Pedido/Seq"}),n.jsx("th",{className:"p-2 text-left",children:"Romaneio"}),n.jsx("th",{className:"p-2 text-right",children:"Qt Kg"}),n.jsx("th",{className:"p-2 text-right",children:"Qtd PC"})]})}),n.jsx("tbody",{children:ee.map((O,te)=>n.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[n.jsx("td",{className:"p-2 text-center",children:n.jsx("input",{type:"checkbox",checked:ne.includes(te),onChange:()=>{ie(b=>b.includes(te)?b.filter(K=>K!==te):[...b,te])}})}),n.jsx("td",{className:"p-2 font-semibold",children:O.rack||"-"}),n.jsx("td",{className:"p-2",children:O.codigo||"-"}),n.jsx("td",{className:"p-2",children:O.lote||"-"}),n.jsx("td",{className:"p-2",children:O.produto||"-"}),n.jsx("td",{className:"p-2",children:O.pedido_seq||"-"}),n.jsx("td",{className:"p-2",children:O.romaneio||"-"}),n.jsx("td",{className:"p-2 text-right",children:Number.isFinite(O.qt_kg)?O.qt_kg:"-"}),n.jsx("td",{className:"p-2 text-right",children:Number.isFinite(O.qtd_pc)?O.qtd_pc:"-"})]},te))})]})]})]}),n.jsxs("div",{className:"w-80 flex flex-col",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("h4",{className:"text-sm font-semibold text-gray-800",children:["Amarrados Selecionados (",Se.length,")"]}),Se.length>0&&n.jsx("button",{type:"button",className:"text-xs text-red-600 hover:text-red-800",onClick:()=>{window.confirm("Deseja limpar todos os amarrados selecionados?")&&(Ce([]),Bt([]),_r([]))},children:"Limpar todos"})]}),n.jsxs("div",{className:"border rounded bg-gray-50 flex-1 overflow-auto p-3",children:[Se.length===0&&n.jsx("div",{className:"text-sm text-gray-500 text-center py-8",children:"Nenhum amarrado selecionado ainda."}),n.jsx("div",{className:"space-y-2",children:Se.map((O,te)=>n.jsxs("div",{className:"bg-white border rounded p-2 text-xs",children:[n.jsxs("div",{className:"font-semibold",children:["Lote: ",O.lote]}),n.jsxs("div",{className:"text-gray-600 mt-1",children:[n.jsxs("div",{children:["Rack: ",n.jsx("span",{className:"font-semibold text-blue-600",children:O.rack})]}),n.jsxs("div",{children:["Produto: ",O.produto]}),n.jsxs("div",{children:["Pedido/Seq: ",O.pedido_seq]}),n.jsxs("div",{children:["Romaneio: ",O.romaneio]})]}),n.jsx("button",{type:"button",className:"mt-1 text-red-500 hover:text-red-700 text-xs",onClick:()=>{const b=Se.filter((K,ue)=>ue!==te);Ce(b),_r(K=>K.filter(ue=>ue!==O.lote)),Bt(K=>K.filter(ue=>ue.lote!==O.lote))},children:"Remover"})]},te))})]})]})]}),n.jsxs("div",{className:"mt-4 flex justify-between",children:[n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>C(!1),children:"Cancelar"})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{type:"button",className:"btn-primary",onClick:Tt,disabled:ne.length===0,children:["Adicionar  Seleo (",ne.length,")"]}),n.jsxs("button",{type:"button",className:"btn-success",onClick:()=>C(!1),disabled:Se.length===0,children:["Finalizar (",Se.length," lotes)"]})]})]})]})]}),Wt&&n.jsxs("div",{className:"fixed inset-0 z-[67] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>Ut(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-3xl p-6 form-compact",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h3",{className:"text-base font-semibold text-gray-800",children:["Amarrados no Rack ",mt]}),n.jsxs("div",{className:"text-xs text-gray-500",children:["Total: ",Ie.length]})]}),n.jsxs("div",{className:"mb-2 flex items-center gap-3 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Filtro Pedido:"}),n.jsx("input",{type:"text",className:"input-field input-field-sm w-36",placeholder:"ex.: 82647",value:Ae,onChange:O=>{S(O.target.value),we(!1)}})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Filtro Romaneio:"}),n.jsx("input",{type:"text",className:"input-field input-field-sm w-36",placeholder:"ex.: 124784",value:T,onChange:O=>{A(O.target.value),we(!1)}})]}),(Ae||T)&&n.jsx("button",{type:"button",className:"px-2 py-1 text-xs border rounded bg-white hover:bg-gray-50",onClick:()=>{S(""),A(""),we(!1)},children:"Limpar filtros"}),n.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[n.jsx("input",{type:"checkbox",checked:me,onChange:O=>{const te=O.target.checked;we(te);const b=Ie.map(K=>K.idx);W(te?Array.from(new Set([...St||[],...b])):(St||[]).filter(K=>!b.includes(K)))}}),"Selecionar todos"]})]}),n.jsx("div",{className:"max-h-[60vh] overflow-auto border rounded",children:n.jsxs("table",{className:"min-w-full text-xs",children:[n.jsx("thead",{className:"bg-gray-50 text-gray-600",children:n.jsxs("tr",{children:[n.jsx("th",{className:"p-2 w-8"}),n.jsx("th",{className:"p-2 text-left",children:"Codigo"}),n.jsx("th",{className:"p-2 text-left",children:"Produto"}),n.jsx("th",{className:"p-2 text-left",children:"Lote"}),n.jsx("th",{className:"p-2 text-left",children:"Romaneio"}),n.jsx("th",{className:"p-2 text-left",children:"Pedido/Seq"}),n.jsx("th",{className:"p-2 text-right",children:"Qt Kg"}),n.jsx("th",{className:"p-2 text-right",children:"Qtd PC"})]})}),n.jsx("tbody",{children:Ie.map((O,te)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"p-2 text-center",children:n.jsx("input",{type:"checkbox",checked:St.includes(O.idx),onChange:()=>W(b=>b.includes(O.idx)?b.filter(K=>K!==O.idx):[...b,O.idx])})}),n.jsx("td",{className:"p-2",children:O.codigo||"-"}),n.jsx("td",{className:"p-2",children:O.produto||"-"}),n.jsx("td",{className:"p-2",children:O.lote||"-"}),n.jsx("td",{className:"p-2",children:O.romaneio||"-"}),n.jsx("td",{className:"p-2",children:O.pedido_seq||"-"}),n.jsx("td",{className:"p-2 text-right",children:Number.isFinite(O.qt_kg)?O.qt_kg:"-"}),n.jsx("td",{className:"p-2 text-right",children:Number.isFinite(O.qtd_pc)?O.qtd_pc:"-"})]},O.idx))})]})}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>Ut(!1),children:"Fechar"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const O=St.map(b=>pt[b]),te=Array.from(new Set(O.map(b=>String(b.lote||"").trim()).filter(Boolean)));_r(b=>Array.from(new Set([...b,...te]))),Ut(!1)},children:"Aplicar seleo"})]})]})]}),ia&&n.jsxs("div",{className:"fixed inset-0 z-[67] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>Qr(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-5 form-compact",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Digitar Lote de Extruso"})}),n.jsx("div",{className:"text-sm text-gray-600 mb-3",children:"Informe um ou mais lotes, separados por vrgula, espao ou quebra de linha."}),n.jsx("textarea",{className:"w-full border rounded p-2 text-sm h-32",placeholder:"Ex.: 125210022, 225390040",value:Zr,onChange:O=>Ea(O.target.value)}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>Qr(!1),children:"Cancelar"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const O=String(Zr||"").split(/[^0-9]+/).map(te=>te.trim()).filter(Boolean);if(!O.length){alert("Nenhum nmero de lote informado.");return}_r(te=>Array.from(new Set([...te||[],...O]))),Qr(!1)},children:"Adicionar  seleo"})]})]})]}),Pt&&n.jsxs("div",{className:"fixed inset-0 z-[65] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-5 form-compact",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Dados para Rastreabilidade"})}),n.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Informe o ",n.jsx("strong",{children:"Nmero do Romaneio"})," e o ",n.jsx("strong",{children:"Nmero do Lote (externo)"})," do material recebido."]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Nmero do Romaneio"}),n.jsx("input",{type:"text",className:"input-field input-field-sm",value:ht,onChange:O=>ot(O.target.value),autoFocus:!0})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700",children:"Nmero do Lote (externo)"}),n.jsx("button",{type:"button",title:"Adicionar outro lote",className:"p-1 rounded border border-gray-300 text-gray-600 hover:bg-gray-100",onClick:()=>jt(O=>[...O,""]),children:n.jsx(Di,{})})]}),n.jsx("div",{className:"space-y-2",children:(wt||[]).map((O,te)=>n.jsx("input",{type:"text",className:"input-field input-field-sm",value:O,onChange:b=>{const K=b.target.value;jt(ue=>{const y=[...ue];return y[te]=K,y})},placeholder:`Lote externo ${te+1}`},te))})]})]}),n.jsx("div",{className:"mt-4 flex justify-end gap-2",children:n.jsx("button",{type:"button",className:"btn-primary",onClick:vs,children:"Salvar"})})]})]}),Ft&&n.jsxs("div",{className:"fixed inset-0 z-[66] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30"}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 form-compact",children:[n.jsx("div",{className:"flex items-center justify-between mb-2",children:n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Selecionar Rack!Embalagem e Lotes"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Pedido/Seq"}),n.jsx("input",{type:"text",className:"input-field input-field-sm",value:vt,readOnly:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Rack!Embalagem"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",className:"input-field input-field-sm flex-1",value:mt,onChange:O=>lr(O.target.value),placeholder:"Informe o cdigo do Rack/Embalagem",autoFocus:!0}),n.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs rounded border border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Inspecionar amarrados do Rack",onClick:()=>{const O=String(mt||"").trim();if(!O){alert("Informe o Rack!Embalagem primeiro.");return}let te=(d||[]).filter(K=>String(K.rack_embalagem||"").trim()===O);if(te.length===0){const K=Ne(O);K&&(te=(d||[]).filter(ue=>{const y=Ne(ue.rack_embalagem);return y?y===K||y.endsWith(K)&&K.length>=3:!1}))}const b=te.map((K,ue)=>({idx:ue,codigo:String(K.codigo||"").trim(),produto:String(K.produto||Le(K,"Produto")||"").trim(),lote:String(K.lote||"").trim(),romaneio:String(K.romaneio||"").trim(),pedido_seq:String(K.pedido_seq||"").trim(),qt_kg:Number(K.qt_kg||0),qtd_pc:Number(K.qtd_pc||0)}));_t(b),W([]),we(!1),Ut(!0)},children:"Inspecionar"}),n.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs rounded border border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Procurar o Rack pelo nmero do Amarrado",onClick:()=>{C(!0),Q(""),Z([]),ie([]);const O=wr.filter(te=>te.rack).map(te=>({rack:te.rack,lote:te.lote,produto:te.produto,pedido_seq:`${te.pedido}/${te.seq}`,romaneio:te.romaneio}));Ce(O)},children:"Procurar por Amarrado"}),n.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs rounded border border-gray-300 bg-white hover:bg-gray-50 text-gray-700",title:"Digitar Lote de Extruso manualmente",onClick:()=>{Qr(!0),Ea("")},children:"Digitar Lote"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Lotes encontrados"}),n.jsxs("div",{className:"max-h-72 overflow-auto border rounded p-3 space-y-2",children:[wr.length===0&&n.jsx("div",{className:"text-sm text-gray-500",children:mt?"Nenhum lote encontrado para este Rack.":'Informe o Rack!Embalagem ou use "Procurar por Amarrado" para adicionar lotes.'}),wr.map(O=>{var te;return n.jsx("div",{className:"border rounded p-3 bg-gray-50",children:n.jsxs("div",{className:"flex items-start gap-3 text-sm",children:[n.jsx("input",{type:"checkbox",className:"mt-1",checked:Zt(O.lote),onChange:()=>{Zt(O.lote)?Pr(O.lote):Qt(O.lote)}}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"font-semibold whitespace-nowrap",children:["Lote: ",O.lote," (",((te=O.amarrados)==null?void 0:te.length)||0," amarrados)"]}),O.amarrados&&O.amarrados.length>0&&n.jsx("button",{type:"button",className:"text-xs text-blue-600 hover:text-blue-800 px-2 py-1 rounded border border-blue-200 hover:bg-blue-50",onClick:()=>Vr(O.lote),children:ha.includes(O.lote)?"Recolher":"Expandir"})]}),n.jsxs("div",{className:"text-gray-700 text-xs mt-1",children:[n.jsxs("div",{children:["Produto: ",O.produto||"-"]}),n.jsxs("div",{children:["Ferramenta: ",O.ferramenta?n.jsx("span",{className:"inline-block px-2 py-0.5 rounded bg-primary-50 text-primary-700 font-semibold",children:O.ferramenta}):"-"]}),O.rack&&n.jsxs("div",{children:["Rack: ",n.jsx("span",{className:"font-semibold text-blue-600",children:O.rack})]}),n.jsxs("div",{children:["Romaneio: ",O.romaneio||"-"]}),n.jsxs("div",{children:["Pedido: ",O.pedido||"-"]}),n.jsxs("div",{children:["Seq: ",O.seq||"-"]})]}),O.amarrados&&O.amarrados.length>0&&ha.includes(O.lote)&&n.jsxs("div",{className:"mt-2 border-t pt-2",children:[n.jsx("div",{className:"text-xs font-medium text-gray-600 mb-1",children:"Amarrados:"}),n.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:O.amarrados.map((b,K)=>n.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[n.jsx("input",{type:"checkbox",className:"text-xs",checked:Sr.some(ue=>ue.codigo===b.codigo&&ue.lote===b.lote),onChange:()=>it(b)}),n.jsx("span",{className:"font-mono text-blue-600",children:b.codigo}),n.jsxs("span",{className:"text-gray-500",children:[b.qt_kg>0&&`${b.qt_kg}kg`,b.qtd_pc>0&&` ${b.qtd_pc}pcs`]}),b.romaneio&&n.jsxs("span",{className:"text-gray-400",children:["Rom: ",b.romaneio]})]},`${b.lote}-${b.codigo}`))})]})]})]})},O.lote)})]})]})]}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>{Ke(!1),ar([]),pr([])},children:"Cancelar"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:ma,children:"Salvar"})]})]})]}),L&&n.jsxs("div",{className:"fixed inset-0 z-[68] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:Hs}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Imprimir identificao do material?"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:Hs,children:"Fechar"})]}),n.jsxs("div",{className:"text-sm text-gray-700 space-y-3",children:[n.jsx("p",{children:"Apontamento registrado com sucesso."}),n.jsxs("p",{children:[n.jsx("strong",{children:"Lote gerado:"})," ",ke]}),n.jsx("p",{children:"Escolha o tipo de impresso:"}),n.jsx("div",{className:"space-y-2",children:(()=>{const O=Si();return n.jsxs(n.Fragment,{children:[n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded cursor-pointer hover:bg-gray-50 ${O.comum.ativa?"":"opacity-50"}`,children:[n.jsx("input",{type:"radio",name:"tipoImpressao",value:"documento",checked:Ge==="documento",onChange:te=>et(te.target.value),className:"w-4 h-4",disabled:!O.comum.ativa}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold",children:" Formulrio Completo (A4)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Documento A4 para identificao do rack"}),n.jsx("div",{className:"text-xs text-blue-600 mt-1",children:O.comum.ativa?` ${O.comum.nome}`:" Impressora no configurada"})]})]}),n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded cursor-pointer hover:bg-gray-50 ${O.termica.ativa?"":"opacity-50"}`,children:[n.jsx("input",{type:"radio",name:"tipoImpressao",value:"etiqueta",checked:Ge==="etiqueta",onChange:te=>et(te.target.value),className:"w-4 h-4",disabled:!O.termica.ativa}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-semibold",children:" Etiqueta Trmica (100x45mm)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"Etiqueta compacta para impressora trmica"}),n.jsx("div",{className:"text-xs text-blue-600 mt-1",children:O.termica.ativa?` ${O.termica.nome}`:" Impressora no configurada"})]})]})]})})()})]}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:Hs,children:"Agora no"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:ci,children:"Imprimir"})]})]})]}),re&&n.jsxs("div",{className:"fixed inset-0 z-[70] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:rs}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-5",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Continuar cortando o mesmo item?"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:rs,children:"Fechar"})]}),n.jsxs("div",{className:"text-sm text-gray-700 space-y-3",children:[n.jsx("p",{children:"Apontamento registrado com sucesso."}),n.jsxs("p",{children:["Voc deseja continuar cortando o ",n.jsx("strong",{children:"mesmo item"}),"?"]}),n.jsxs("ul",{className:"list-disc ml-5 space-y-1",children:[n.jsxs("li",{children:["Se escolher ",n.jsx("strong",{children:"Continuar"}),', manterei todos os campos e vou limpar apenas "Quantidade Produzida".']}),n.jsxs("li",{children:["Se escolher ",n.jsx("strong",{children:"Novo item"}),", vou limpar todos os campos para voc selecionar o prximo pedido."]})]})]}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:as,children:"Novo item"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:rs,children:"Continuar"})]})]})]})]}),n.jsxs("form",{onSubmit:Pa,className:"space-y-3 form-compact",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 grid-compact",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Operador"}),n.jsx("input",{type:"text",name:"operador",value:x.operador,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Mquina"}),n.jsxs("select",{name:"maquina",value:x.maquina,onChange:Fa,required:!0,className:"input-field input-field-sm",children:[n.jsx("option",{value:"",children:"Selecione a mquina"}),(er||[]).map(O=>n.jsx("option",{value:O.id,children:O.nome||O.codigo||`Mquina ${O.id}`},O.id))]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700",children:"Pedido/Seq"}),n.jsxs("button",{type:"button",onClick:()=>f(!u),className:`flex items-center gap-1 px-2 py-0.5 text-xs rounded transition-colors ${u?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,title:u?"Mostrando apenas prioritrios":"Mostrar apenas prioritrios",children:[n.jsx(mf,{className:u?"text-yellow-500":"text-gray-400"}),n.jsx("span",{children:u?"Prioritrios":"Todos"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("select",{name:"ordemTrabalho",value:x.ordemTrabalho,onChange:Fa,required:!0,className:"input-field input-field-sm flex-1",children:[n.jsx("option",{value:"",children:i?"Carregando pedidos...":"Selecione o pedido"}),kr.map(O=>n.jsxs("option",{value:O.id,children:[O.id," - ",O.ferramenta," - ",O.comprimentoAcabado||""]},O.id))]}),n.jsx("button",{type:"button",className:"p-2 rounded border border-gray-300 text-gray-600 hover:bg-gray-100 hover:text-gray-900",title:"Buscar pedido",onClick:()=>Fe(!0),"aria-label":"Buscar pedido",children:n.jsx(hf,{})})]})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Produto"}),Ca?n.jsxs("div",{className:"flex items-center gap-2",children:[Aa?n.jsx("a",{href:Ha(Aa,`${Ca}.pdf`),target:"_blank",rel:"noreferrer noopener",title:`Abrir desenho: ${Ca}.pdf`,className:"text-red-600 hover:text-red-800",children:n.jsx(fi,{})}):n.jsx("span",{title:"Defina o caminho em Configuraes > Arquivos",className:"text-red-600 opacity-50",children:n.jsx(fi,{})}),Aa&&n.jsx("button",{type:"button",title:"Copiar caminho local",className:"p-1 rounded border text-gray-600 hover:bg-gray-100",onClick:()=>dd(`${String(Aa).replace(/[\\/]+$/,"")}\\${Ca}.pdf`),children:n.jsx(sd,{})}),Or?n.jsx("a",{href:Ha(Or,`${Ca}.pdf`),target:"_blank",rel:"noreferrer noopener",title:`Abrir ficha de processo: ${Ca}.pdf`,className:"text-blue-600 hover:text-blue-800",children:n.jsx(fi,{})}):n.jsx("span",{title:"Defina o caminho das fichas em Configuraes > Arquivos",className:"text-blue-600 opacity-50",children:n.jsx(fi,{})}),Or&&n.jsx("button",{type:"button",title:"Copiar caminho local (processo)",className:"p-1 rounded border text-gray-600 hover:bg-gray-100",onClick:()=>dd(`${String(Or).replace(/[\\/]+$/,"")}\\${Ca}.pdf`),children:n.jsx(sd,{})})]}):n.jsx("span",{title:"Selecione um pedido para habilitar",className:"text-red-600 opacity-50",children:n.jsx(fi,{})})]}),n.jsx("input",{type:"text",name:"codigoPerfil",value:x.codigoPerfil,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Cliente"}),n.jsx("input",{type:"text",name:"cliente",value:x.cliente,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Pedido.Cliente"}),n.jsx("input",{type:"text",name:"pedidoCliente",value:x.pedidoCliente,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Incio"}),n.jsx("input",{type:"datetime-local",name:"inicio",value:x.inicio,onChange:Fa,required:!0,className:"input-field input-field-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Fim"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"datetime-local",name:"fim",value:x.fim,onChange:Fa,className:"input-field input-field-sm flex-1"}),_&&n.jsx("button",{type:"button",className:"btn-primary",onClick:V,title:"Finalizar contador",children:"Finalizar contador"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Dt.Fatura (Entrega)"}),n.jsx("input",{type:"text",name:"dtFatura",value:x.dtFatura?new Date(x.dtFatura).toLocaleDateString("pt-BR"):"",readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Quantidade Produzida"}),n.jsx("input",{type:"number",name:"quantidade",value:x.quantidade,onChange:Fa,required:!0,min:"1",className:"input-field input-field-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Qtd.Pedido"}),n.jsx("input",{type:"number",name:"qtdPedido",value:x.qtdPedido,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Unidade"}),n.jsx("input",{type:"text",name:"unidade",value:x.unidade,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"N OP"}),n.jsx("input",{type:"text",name:"nroOp",value:x.nroOp,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Perfil Longo"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("input",{type:"text",name:"perfilLongo",value:x.perfilLongo,readOnly:!0,className:"input-field input-field-sm bg-gray-100"}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1 invisible",children:"Aes"}),n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{type:"button",className:"btn-primary flex-1 h-9 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>{if(!x.ordemTrabalho){alert("Selecione um Pedido/Seq antes de abrir o contador.");return}fe(!0)},disabled:!x.ordemTrabalho,title:x.ordemTrabalho?"Abrir contador em tela grande":"Selecione um Pedido/Seq para habilitar",children:"Abrir Contador"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Separado"}),n.jsx("input",{type:"number",name:"separado",value:x.separado,readOnly:!0,className:"input-field input-field-sm bg-gray-100"}),n.jsxs("div",{className:"mt-2",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1 invisible",children:"Aes"}),n.jsx("div",{className:"flex",children:n.jsxs("button",{type:"button",className:"btn-secondary flex items-center justify-center gap-2 h-9 px-3 disabled:opacity-60 disabled:cursor-not-allowed",onClick:()=>{if(!x.ordemTrabalho){alert("Selecione um Pedido/Seq antes de informar romaneio/lote.");return}ot(x.romaneioNumero||""),jt(x.lotesExternos&&x.lotesExternos.length?[...x.lotesExternos]:[x.loteExterno||""]),qe(!0)},disabled:!x.ordemTrabalho,title:"Adicionar/editar Romaneio e Lotes",children:[n.jsx(Di,{}),n.jsx("span",{children:"Romaneio/Lote"})]})})]})]}),n.jsxs("div",{className:"md:col-start-1",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Comprimento do Acabado"}),n.jsx("input",{type:"text",name:"comprimentoAcabado",value:x.comprimentoAcabado,readOnly:!0,className:"input-field input-field-sm bg-gray-100"})]})]}),n.jsxs("div",{className:"md:col-span-5",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700 mb-1",children:"Observaes"}),n.jsx("textarea",{name:"observacoes",value:x.observacoes,onChange:Fa,className:"input-field input-field-sm"})]}),(x.lotesExternos&&x.lotesExternos.length>0||x.amarradosDetalhados&&x.amarradosDetalhados.length>0)&&n.jsxs("div",{className:"col-span-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"block label-sm font-medium text-gray-700",children:x.amarradosDetalhados&&x.amarradosDetalhados.length>0?`Amarrados Selecionados (${x.amarradosDetalhados.length})`:`Lotes Selecionados (${((ys=x.lotesExternos)==null?void 0:ys.length)||0})`}),n.jsxs("div",{className:"flex items-center gap-2",children:[x.rack_ou_pallet&&n.jsxs("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:["Rack: ",x.rack_ou_pallet]}),n.jsx("button",{type:"button",className:"text-xs text-red-600 hover:text-red-800",onClick:()=>{window.confirm("Deseja remover todos os amarrados/lotes selecionados?")&&w(O=>({...O,lotesExternos:[],loteExterno:"",rack_ou_pallet:"",rackOuPallet:"",amarradosDetalhados:[]}))},title:"Remover todos os amarrados/lotes",children:"Limpar todos"})]})]}),n.jsx("div",{className:"border rounded p-3 bg-gray-50 max-h-32 overflow-auto",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:x.amarradosDetalhados&&x.amarradosDetalhados.length>0?x.amarradosDetalhados.map((O,te)=>n.jsxs("div",{className:"flex items-center gap-1 bg-white border rounded px-2 py-1 text-sm",children:[n.jsx("span",{className:"font-mono text-blue-600",children:O.codigo}),n.jsxs("span",{className:"text-xs text-gray-500",children:["(",O.lote,")"]}),O.qt_kg>0&&n.jsxs("span",{className:"text-xs text-gray-400",children:[O.qt_kg,"kg"]}),n.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 ml-1",onClick:()=>{w(b=>({...b,amarradosDetalhados:b.amarradosDetalhados.filter((K,ue)=>ue!==te)}))},title:"Remover este amarrado",children:""})]},te)):(Ws=x.lotesExternos)==null?void 0:Ws.map((O,te)=>n.jsxs("div",{className:"flex items-center gap-1 bg-white border rounded px-2 py-1 text-sm",children:[n.jsx("span",{className:"font-mono",children:O}),n.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 ml-1",onClick:()=>{w(b=>({...b,lotesExternos:b.lotesExternos.filter((K,ue)=>ue!==te),loteExterno:b.lotesExternos.length===1?"":b.loteExterno}))},title:"Remover este lote",children:""})]},te))})})]}),n.jsxs("div",{className:"flex justify-end pt-2 gap-2",children:[n.jsxs("button",{type:"button",className:"btn-outline flex items-center gap-2",onClick:()=>{confirm("Deseja realmente limpar o formulrio?")&&ts()},title:"Limpar todos os campos e comear do zero",children:[n.jsx(Jg,{}),n.jsx("span",{children:"Limpar"})]}),n.jsx("button",{type:"submit",className:"btn-primary",children:"Registrar Apontamento"})]})]})]}),ae&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-md p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Confirmar Apontamento"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>He(!1),children:"Fechar"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Quantidade Produzida"}),n.jsx("input",{type:"number",className:"input-field input-field-sm bg-gray-100",value:x.quantidade,readOnly:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Confirmar Quantidade"}),n.jsx("input",{type:"number",className:"input-field input-field-sm",value:B,onChange:O=>E(O.target.value)})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Refugos/Sucata (PCs)"}),n.jsx("input",{type:"number",className:"input-field input-field-sm",placeholder:"0",value:D,onChange:O=>z(O.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Compr (mm)"}),n.jsx("input",{type:"number",className:"input-field input-field-sm",placeholder:"0",value:oe,onChange:O=>J(O.target.value)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Nmero do Rack ou Pallet"}),n.jsx("input",{type:"text",className:"input-field input-field-sm",placeholder:"Ex.: RACK-12 ou P-07",value:Ue,onChange:O=>k(O.target.value)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Dureza do Material"}),n.jsx("input",{type:"text",className:"input-field input-field-sm",placeholder:"Ex.: HRC 45-50",value:ce,onChange:O=>he(O.target.value)})]})]}),n.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[n.jsx("button",{type:"button",className:"btn-outline",onClick:()=>He(!1),children:"Cancelar"}),n.jsx("button",{type:"button",className:"btn-primary",onClick:Nn,children:"Confirmar"})]})]})}),De&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>j(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-4xl p-4 form-compact",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("h3",{className:"text-base font-semibold text-gray-800",children:["Apontamentos do Pedido ",x.ordemTrabalho]}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>j(!1),children:"Fechar"})]}),n.jsx("div",{className:"max-h-96 overflow-auto border rounded",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-3 py-2",children:"Incio"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Fim"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Quantidade"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Operador"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Rack/Pallet"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Obs."})]})}),n.jsxs("tbody",{children:[jn.map((O,te)=>n.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2",children:O.inicio?new Date(O.inicio).toLocaleString("pt-BR"):""}),n.jsx("td",{className:"px-3 py-2",children:O.fim?new Date(O.fim).toLocaleString("pt-BR"):""}),n.jsx("td",{className:"px-3 py-2",children:O.quantidade}),n.jsx("td",{className:"px-3 py-2",children:O.operador||""}),n.jsx("td",{className:"px-3 py-2",children:O.rackOuPallet||""}),n.jsx("td",{className:"px-3 py-2",children:O.observacoes||""})]},te)),jn.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"6",className:"px-3 py-6 text-center text-gray-500",children:"Nenhum apontamento encontrado para este pedido"})})]})]})})]})]}),de&&n.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50",onClick:()=>fe(!1)}),n.jsxs("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-3xl p-6",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Contador de Produo"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>fe(!1),children:"Fechar"})]}),n.jsxs("div",{className:"flex flex-col items-center gap-4",children:[n.jsx("div",{className:"text-7xl font-mono font-extrabold tracking-widest text-gray-900",children:qa((_?U:Date.now())-(R?R.getTime():Date.now()))}),n.jsx("div",{className:"text-gray-600 text-sm",children:R?`Iniciado em ${R.toLocaleString("pt-BR")}`:"Aguardando incio"}),n.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[_?n.jsx("button",{type:"button",className:"btn-danger text-lg px-6 py-3",onClick:V,children:"Finalizar contador"}):n.jsx("button",{type:"button",className:"btn-primary text-lg px-6 py-3",onClick:X,children:"Iniciar"}),_&&n.jsx("button",{type:"button",className:"btn-outline text-lg px-6 py-3",onClick:()=>fe(!1),children:"Minimizar"})]})]})]})]}),ve&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>Fe(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-5xl p-4 form-compact",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-800",children:"Buscar Pedido"}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>Fe(!1),children:"Fechar"})]}),n.jsx("div",{className:"mb-3",children:n.jsx("input",{type:"text",placeholder:"Digite Pedido/Seq, Ferramenta (ex.: TP-0192, EXP-910) ou Comprimento (ex.: 1100)",className:"input-field input-field-sm",value:Te,onChange:O=>$e(O.target.value),autoFocus:!0})}),n.jsx("div",{className:"max-h-80 overflow-auto border rounded",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-3 py-2",children:"Pedido/Seq"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Ferramenta"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Produto"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Comprimento"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Cliente"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Pedido.Cliente"}),n.jsx("th",{className:"text-left px-3 py-2"})]})}),n.jsxs("tbody",{children:[gs.map(O=>n.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2",children:O.id}),n.jsx("td",{className:"px-3 py-2",children:O.ferramenta}),n.jsx("td",{className:"px-3 py-2",children:O.codigoPerfil}),n.jsx("td",{className:"px-3 py-2",children:O.comprimentoAcabado}),n.jsx("td",{className:"px-3 py-2",children:O.cliente}),n.jsx("td",{className:"px-3 py-2",children:O.pedidoCliente}),n.jsx("td",{className:"px-3 py-2 text-right",children:n.jsx("button",{type:"button",className:"btn-secondary py-1 px-2",onClick:()=>{w(te=>({...te,ordemTrabalho:O.id,codigoPerfil:O.codigoPerfil,qtdPedido:O.qtdPedido,perfilLongo:O.perfilLongo,separado:O.separado,cliente:O.cliente,pedidoCliente:O.pedidoCliente,dtFatura:O.dtFatura,unidade:O.unidade,comprimentoAcabado:O.comprimentoAcabado,nroOp:O.nroOp,inicio:te.inicio||Ta(),fim:te.fim||_n(te.inicio||Ta(),60)})),Fe(!1),yt(O.id),lr(""),Bt([]),_r([]),Ke(!0)},children:"Selecionar"})})]},O.id)),gs.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"7",className:"px-3 py-6 text-center text-gray-500",children:"Nenhum pedido encontrado"})})]})]})})]})]})]})};function S1(){return n.jsx(pf,{tituloPagina:"Apontamentos da Embalagem",subtituloForm:"Novo Apontamento de Embalagem",modo:"embalagem"})}function N1(){const e=["CNC - Ferramental","CNC - Consumveis","Usinagem - Lubrificantes","Usinagem - Fixao","Usinagem - Abrasivos","Usinagem - Medio","Manuteno","Limpeza","EPI"],t="estoque_categorias_insumos",r="estoque_categorias_ferramentas",a="estoque_minimo_acabados",s="ferramentas_vida_util_cfg",i=["un","pcs","kg","l","ml","m","cx"],o=["Broca","Fresa","Pastilha","Porta-ferramenta","Rosqueamento","Serra","Medio","Outros"],{items:c}=ft("apontamentos"),{items:l,loadItems:d}=ft("exp_estoque_baixas"),{items:u}=ft("maquinas"),{items:f,loadItems:m}=ft("ferramentas_cfg"),{items:h,loadItems:g}=ft("exp_insumos"),{items:p,loadItems:x}=ft("vw_insumos_saldo"),{items:w}=ft("vw_insumos_consumo_30d"),{items:_,loadItems:v}=ft("exp_insumos_mov"),{items:R,loadItems:q}=ft("vw_ferramentas_status");ft("vw_ferramentas_consumo_30d");const{items:U}=ft("exp_ferramentas_mov"),[P,X]=I.useState("acabados"),[G,le]=I.useState("30"),[se,V]=I.useState(!1),[ye,Ee]=I.useState(!1),[ve,Fe]=I.useState({produto:"",quantidade:"",motivo:"producao"}),[Te,$e]=I.useState(""),[ae,He]=I.useState(""),[Ue,k]=I.useState(!0),[B,E]=I.useState(!1),[D,z]=I.useState("alerta"),[oe,J]=I.useState(!1),[ce,he]=I.useState(""),[De,j]=I.useState(!1),[de,fe]=I.useState(!1),[re,xe]=I.useState(e),[L,Y]=I.useState(o),[ke,Pe]=I.useState(!1),[Ge,et]=I.useState(!1),[Pt,qe]=I.useState(""),[ht,ot]=I.useState(""),[wt,jt]=I.useState(""),[Ft,Ke]=I.useState({}),[vt,yt]=I.useState(!1),[mt,lr]=I.useState(""),[wr,Bt]=I.useState(""),[Wr,_r]=I.useState(""),[Sr,ar]=I.useState(""),[ha,pr]=I.useState(""),[ia,Qr]=I.useState(!1),[Zr,Ea]=I.useState(!1),[Wt,Ut]=I.useState(""),[pt,_t]=I.useState({id:"",ferramenta:"",vida_valor:"",vida_unidade:"dias",vida_util_dias:"",ultima_troca:"",responsavel:"",status:"ativa"}),[St,W]=I.useState({}),[me,we]=I.useState(!1),[Ae,S]=I.useState(!1),[T,A]=I.useState(!1),[N,C]=I.useState(!1),[F,Q]=I.useState({nome:"",categoria:"",quantidade:"",unidade:"un",responsavel:"",observacao:""}),[ee,Z]=I.useState({nome:"",quantidade:"",unidade:"un",motivo:"consumo",maquina:"",responsavel:"",observacao:""}),[ne,ie]=I.useState(null),[Se,Ce]=I.useState(""),[Ie,Ne]=I.useState(""),[Le,Je]=I.useState(!1),[Nt,Tt]=I.useState(!1),[it,Qt]=I.useState({ferramenta:"",categoria:"",tipo:"troca",quantidade:"1",unidade:"un",motivo:"troca",maquina:"",responsavel:"",observacao:""}),[Pr,Zt]=I.useState(""),[Vr,ma]=I.useState(!1),[er,$s]=I.useState(!1),[ps,es]=I.useState(""),[qa,ts]=I.useState({ferramenta:"",descricao:"",ativo:!0}),xa=I.useRef(null),Nr=y=>y?new Date(y):null,Ta=new Date,_n=y=>new Date(Ta.getFullYear(),Ta.getMonth(),Ta.getDate()-Number(y||0)),ea=y=>String(y||"").trim().toLowerCase();I.useEffect(()=>{if(!ne){Ce("");return}const y=URL.createObjectURL(ne);return Ce(y),()=>{try{URL.revokeObjectURL(y)}catch{}}},[ne]),I.useEffect(()=>{(async()=>{try{const M=await Qe.obterConfiguracao(t),H=await Qe.obterConfiguracao(r),pe=Array.isArray(M)?M:typeof M=="string"?JSON.parse(M):null,Oe=Array.isArray(H)?H:typeof H=="string"?JSON.parse(H):null;Array.isArray(pe)&&pe.length>0&&xe(pe),Array.isArray(Oe)&&Oe.length>0&&Y(Oe)}catch(M){console.error("Erro ao carregar categorias configurveis:",M)}})()},[]),I.useEffect(()=>{(async()=>{try{const M=await Qe.obterConfiguracao(a),H=M&&typeof M=="object"?M:typeof M=="string"?JSON.parse(M):null;H&&typeof H=="object"&&Ke(H)}catch(M){console.error("Erro ao carregar mnimos de acabados:",M)}})()},[]),I.useEffect(()=>{(async()=>{try{const M=await Qe.obterConfiguracao(s),H=M&&typeof M=="object"?M:typeof M=="string"?JSON.parse(M):null;H&&typeof H=="object"&&W(H)}catch(M){console.error("Erro ao carregar config de vida til de ferramentas:",M)}})()},[]);const ta=I.useMemo(()=>{const y={};return(Array.isArray(f)?f:[]).forEach(M=>{const H=String(M.ferramenta||M.codigo||"").trim();H&&(y[H]=M)}),y},[f]),$a=I.useMemo(()=>(Array.isArray(c)?c:[]).filter(y=>(y.exp_unidade||"").toLowerCase()==="embalagem"),[c]),kr=I.useMemo(()=>(Array.isArray(l)?l:[]).filter(y=>!y.estornado),[l]),Aa=I.useMemo(()=>{const y={},M=H=>`${String(H.produto||"").trim()}|${String(H.lote||H.lote_externo||"").trim()}`;return $a.forEach(H=>{const pe=M(H);y[pe]||(y[pe]={produto:String(H.produto||"").trim(),lote:H.lote||H.lote_externo||"",entradas:0,saidas:0}),y[pe].entradas+=Number(H.quantidade||0)}),kr.forEach(H=>{const pe=`${String(H.produto||"").trim()}|${String(H.lote_codigo||"").trim()}`;y[pe]||(y[pe]={produto:String(H.produto||"").trim(),lote:H.lote_codigo,entradas:0,saidas:0}),y[pe].saidas+=Number(H.quantidade_pc||0)}),Object.values(y).forEach(H=>{H.saldo=(H.entradas||0)-(H.saidas||0)}),y},[$a,kr]),Or=I.useMemo(()=>{const y={};return Object.values(Aa).forEach(M=>{const H=String(M.produto||"").trim();H&&(y[H]||(y[H]={produto:H,saldo:0,min:0}),y[H].saldo+=Number(M.saldo||0))}),Object.values(y).forEach(M=>{const H=ta[M.produto],pe=Number((H==null?void 0:H.pcs_por_pallet)||0),Oe=Number((Ft==null?void 0:Ft[M.produto])??NaN);M.min=Number.isFinite(Oe)?Oe:pe>0?pe:0}),Object.values(y)},[Aa,ta,Ft]),Ca=y=>{if(!y)return;const M=String(y.ferramenta||"").trim(),H=ta[M],pe=St==null?void 0:St[M],Oe=(pe==null?void 0:pe.vida_unidade)||"dias",_e=(pe==null?void 0:pe.vida_valor)??(H==null?void 0:H.vida_util_dias)??"";Ut(""),_t({id:(H==null?void 0:H.id)||"",ferramenta:M,vida_valor:_e===""?"":String(_e),vida_unidade:Oe,vida_util_dias:String((H==null?void 0:H.vida_util_dias)||""),ultima_troca:H!=null&&H.ultima_troca?new Date(H.ultima_troca).toISOString().slice(0,10):"",responsavel:(H==null?void 0:H.responsavel)||"",status:(H==null?void 0:H.ativo)===!1?"estoque":"ativa"}),Qr(!0)},Sn=async y=>{var _e;if((_e=y==null?void 0:y.preventDefault)==null||_e.call(y),Zr)return;Ut("");const M=pt.id;if(!M){Ut("No foi possvel localizar o registro da ferramenta para edio.");return}const H=pt.vida_valor?Number(pt.vida_valor):null;if(H!=null&&(!Number.isFinite(H)||H<0)){Ut("Vida til invlida.");return}const pe=pt.vida_unidade||"dias";let Oe=null;H!=null&&(pe==="dias"?Oe=H:pe==="horas"?Oe=H/24:pe==="semanas"?Oe=H*7:Oe=H,Number.isFinite(Oe)&&(Oe=Math.ceil(Oe)));try{Ea(!0),await Qe.update("ferramentas_cfg",{id:M,vida_util_dias:Oe,ultima_troca:pt.ultima_troca||null,responsavel:pt.responsavel||null,ativo:pt.status!=="estoque"});const ze={...St||{},[pt.ferramenta]:{vida_valor:H,vida_unidade:pe}};await Qe.salvarConfiguracao(s,ze),W(ze),await Promise.all([m(),q()]),Qr(!1)}catch(ze){console.error(ze),Ut((ze==null?void 0:ze.message)||"Falha ao salvar configurao da ferramenta.")}finally{Ea(!1)}};I.useMemo(()=>Or.reduce((y,M)=>y+(M.saldo||0),0),[Or]);const Ha=I.useMemo(()=>{const y=String(ae||"").trim().toLowerCase(),M=(Array.isArray(Or)?Or:[]).filter(Oe=>{if(!Oe)return!1;const _e=String(Oe.produto||"");return!(!(!y||_e.toLowerCase().includes(y))||Ue&&Number(Oe.saldo||0)<=0||B&&!(Number(Oe.min||0)>0&&Number(Oe.saldo||0)<Number(Oe.min||0)))}),H={alerta:(Oe,_e)=>{const ze=Number(Oe.min||0)>0&&Number(Oe.saldo||0)<Number(Oe.min||0)?1:0,Xe=Number(_e.min||0)>0&&Number(_e.saldo||0)<Number(_e.min||0)?1:0;return Xe!==ze?Xe-ze:String(Oe.produto||"").localeCompare(String(_e.produto||""))},produto:(Oe,_e)=>String(Oe.produto||"").localeCompare(String(_e.produto||"")),saldo_desc:(Oe,_e)=>Number(_e.saldo||0)-Number(Oe.saldo||0)},pe=H[D]||H.alerta;return[...M].sort(pe)},[Or,ae,Ue,B,D]),gs=I.useMemo(()=>{const y={};(Array.isArray(p)?p:[]).forEach(_e=>{y[ea(_e.nome)]=Number(_e.saldo||0)});const M={};(Array.isArray(h)?h:[]).forEach(_e=>{var Xe;const ze=ea(_e==null?void 0:_e.nome);ze&&(M[ze]?!((Xe=M[ze])!=null&&Xe.foto_url)&&(_e!=null&&_e.foto_url)&&(M[ze]=_e):M[ze]=_e)});const H=Object.values(M),pe=String(ce||"").trim().toLowerCase();return H.filter(_e=>{if(!_e)return!1;const ze=String(_e.nome||""),Xe=String(_e.categoria||"");if(!(!pe||ze.toLowerCase().includes(pe)||Xe.toLowerCase().includes(pe)))return!1;const rt=y[ea(_e.nome)]||0,Be=Number(rt)<Number(_e.qtd_minima||0);return!(De&&!Be)}).map(_e=>{const ze=y[ea(_e.nome)]||0,Xe=Number(ze)<Number(_e.qtd_minima||0);return{..._e,__saldo_calc:ze,__abaixo_min:Xe}}).sort((_e,ze)=>Number(ze.__abaixo_min)!==Number(_e.__abaixo_min)?Number(ze.__abaixo_min)-Number(_e.__abaixo_min):String(_e.nome||"").localeCompare(String(ze.nome||"")))},[h,p,ce,De]),Fa=I.useMemo(()=>_n(G),[G]),Pa=I.useMemo(()=>{const y=kr.filter(H=>{const pe=Nr(H.data_baixa||H.created_at);return pe&&pe>=Fa}),M={};return y.forEach(H=>{const pe=String(H.produto||"").trim();M[pe]||(M[pe]=0),M[pe]+=Number(H.quantidade_pc||0)}),M},[kr,Fa]),Nn=I.useMemo(()=>Object.entries(Pa).map(([M,H])=>({produto:M,qtd:H})).filter(M=>M.produto).sort((M,H)=>H.qtd-M.qtd).slice(0,5),[Pa]),rs=String(ae||"").trim().toLowerCase(),as=I.useMemo(()=>{if(!rs)return Pa;const y={};return Object.entries(Pa).forEach(([M,H])=>{String(M||"").toLowerCase().includes(rs)&&(y[M]=H)}),y},[Pa,rs]),ci=I.useMemo(()=>Object.entries(as).map(([M,H])=>({produto:M,qtd:H})).filter(M=>M.produto).sort((M,H)=>H.qtd-M.qtd).slice(0,5),[as]);I.useMemo(()=>Or.filter(M=>(M.saldo||0)>0&&!Pa[M.produto]).map(M=>M.produto),[Or,Pa]);const Hs=I.useMemo(()=>Ha.filter(M=>(M.saldo||0)>0&&!as[M.produto]).map(M=>M.produto),[Ha,as]),vs=Ha,zs=I.useMemo(()=>vs.reduce((y,M)=>y+Number(M.saldo||0),0),[vs]),kn=I.useMemo(()=>vs.filter(y=>y.min&&y.saldo<y.min).length,[vs]),jn=ci,En=Hs,Dr=I.useMemo(()=>{const M=(Array.isArray(R)?[...R]:[]).sort((H,pe)=>{const Oe=jr=>{const dr=String(jr||"").toLowerCase();return dr==="ativa"?0:dr==="ateno"?1:dr==="para trocar"?2:dr==="estoque"?3:dr==="inativa"?4:5},_e=ta[String(H.ferramenta||"")],ze=ta[String(pe.ferramenta||"")],Xe=(_e==null?void 0:_e.ativo)===!1?"estoque":H.status,st=(ze==null?void 0:ze.ativo)===!1?"estoque":pe.status,rt=Oe(Xe),Be=Oe(st);return rt!==Be?rt-Be:String(H.ferramenta||"").localeCompare(String(pe.ferramenta||""))});return me?M:M.filter(H=>{const pe=ta[String(H.ferramenta||"")],Oe=(pe==null?void 0:pe.ativo)===!1?"estoque":String(H.status||"").toLowerCase();return Oe!=="estoque"&&Oe!=="inativa"})},[R,me,ta]);I.useMemo(()=>{const y=new Date;return(Array.isArray(f)?f:[]).map(H=>{const pe=Number(H.vida_util_dias||H.vida_util||0),Oe=Nr(H.ultima_troca);let _e=Oe?Math.floor((y-Oe)/864e5):null;const ze=pe&&_e!=null?Math.max(pe-_e,0):null;let Xe="inativa";return pe>0&&_e!=null&&(ze<=0?Xe="para trocar":ze<=Math.ceil(pe*.2)?Xe="ateno":Xe="ativa"),{ferramenta:H.ferramenta,vidaUtilDias:pe,ultimaTroca:Oe,restante:ze,status:Xe,responsavel:H.responsavel||"-"}})},[f]);const ys=I.useMemo(()=>{const y=(Array.isArray(_)?_:[]).map(H=>({data:H.created_at,tipo:H.tipo==="entrada"?"Entrada":"Sada",item:H.nome,categoria:H.categoria,qtd:Number(H.quantidade||0),unidade:H.unidade||"",resp:H.responsavel||"-",maquina:H.maquina||"",origem:"insumo",motivo:H.motivo||""})),M=(Array.isArray(U)?U:[]).map(H=>({data:H.created_at,tipo:H.tipo,item:H.ferramenta,categoria:H.categoria,qtd:Number(H.quantidade||0),unidade:H.unidade||"",resp:H.responsavel||"-",maquina:H.maquina||"",origem:"ferramenta",motivo:H.motivo||""}));return[...y,...M].sort((H,pe)=>new Date(pe.data||0)-new Date(H.data||0)).slice(0,50)},[_,U]),Ws=I.useMemo(()=>{const y={};(Array.isArray(p)?p:[]).forEach(_e=>{y[String(_e.nome)]=Number(_e.saldo||0)});const M=Array.isArray(h)?h:[],H=M.filter(_e=>{const ze=y[String(_e.nome)]||0;return Number(ze)<Number(_e.qtd_minima||0)}).length;return{consumoMedio:(Array.isArray(w)?w:[]).reduce((_e,ze)=>_e+Number(ze.consumo_30d||0),0)/Math.max(1,Array.isArray(w)?w.length:1),abaixoMin:H,totalInsumos:M.length}},[h,p,w]),O=(y,M)=>y<0?"bg-red-200 text-red-800":M&&y<M?"bg-red-100 text-red-700":M&&y<M*1.3?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",te=I.useMemo(()=>{const y=(Array.isArray($a)?$a:[]).map(pe=>({tipo:"Entrada",produto:String(pe.produto||"").trim(),quantidade:Number(pe.quantidade||0),data:pe.inicio||pe.created_at||pe.fim,responsavel:pe.operador||"-",origem:"apontamento"})),M=(Array.isArray(kr)?kr:[]).map(pe=>({tipo:"Sada",produto:String(pe.produto||"").trim(),quantidade:Number(pe.quantidade_pc||0),data:pe.data_baixa||pe.created_at,responsavel:pe.baixado_por||"-",origem:pe.tipo_baixa||"baixa"}));return[...y,...M].filter(pe=>pe.produto).sort((pe,Oe)=>new Date(Oe.data||0)-new Date(pe.data||0)).slice(0,50)},[$a,kr]),b=(y="")=>{Fe({produto:y,quantidade:"",motivo:"producao"}),$e(""),V(!0)},K=()=>{ye||V(!1)},ue=async y=>{y.preventDefault(),$e("");const M=String(ve.produto||"").trim(),H=Number(ve.quantidade||0),pe=String(ve.motivo||"producao");if(!M){$e("Selecione o produto.");return}if(!Number.isFinite(H)||H<=0){$e("Quantidade invlida.");return}const Oe=Or.find(st=>st.produto===M);if(Number((Oe==null?void 0:Oe.saldo)||0)<H){$e("Estoque insuficiente.");return}const ze=Object.values(Aa).find(st=>String(st.produto||"").trim()===M&&(st.saldo||0)>0),Xe=(ze==null?void 0:ze.lote)||"";try{Ee(!0),await Qe.add("exp_estoque_baixas",{produto:M,lote_codigo:Xe,tipo_baixa:pe,quantidade_pc:H,baixado_por:"Sistema",baixado_em:new Date().toISOString(),estornado:!1}),await d()}catch(st){console.error("Erro ao dar baixa:",st),$e("Falha ao registrar baixa. Verifique conexo e permisses.");return}finally{Ee(!1)}V(!1)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Estoque"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx("label",{className:"text-gray-600",children:"Giro nos ltimos"}),n.jsxs("select",{className:"border rounded px-2 py-1",value:G,onChange:y=>le(y.target.value),children:[n.jsx("option",{value:"7",children:"7 dias"}),n.jsx("option",{value:"30",children:"30 dias"}),n.jsx("option",{value:"90",children:"90 dias"})]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>X("acabados"),className:`px-3 py-2 rounded ${P==="acabados"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Itens Acabados"}),n.jsx("button",{onClick:()=>X("ferramentas"),className:`px-3 py-2 rounded ${P==="ferramentas"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Ferramentas e Insumos"})]}),P==="acabados"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Total em Estoque (peas)"}),n.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(a1,{}),zs.toLocaleString("pt-BR")]})]}),n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Produtos com Alerta"}),n.jsxs("div",{className:"text-2l font-bold flex items-center gap-2",children:[n.jsx(Io,{className:"text-yellow-600"}),kn]})]}),n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Top Sadas"}),n.jsx("div",{className:"text-sm text-gray-800",children:jn.map(y=>`${y.produto}: ${y.qtd}`).join(" | ")||"-"})]}),n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Produtos Parados"}),n.jsx("div",{className:"text-sm text-gray-800",children:En.slice(0,5).join(" | ")||"-"})]})]}),n.jsxs("div",{className:"bg-white rounded shadow",children:[n.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between",children:[n.jsxs("div",{className:"font-semibold flex items-center gap-2",children:[n.jsx(uf,{})," Itens Acabados (Embalados)"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"text-xs bg-gray-100 px-3 py-1 rounded",onClick:()=>J(y=>!y),children:oe?"Ocultar secundrios":"Ver secundrios"}),n.jsxs("button",{className:"text-xs bg-gray-100 px-3 py-1 rounded inline-flex items-center gap-2",onClick:()=>b(),children:[" ",n.jsx(Z0,{})," Dar Baixa"]})]})]}),n.jsxs("div",{className:"p-4 border-b bg-white",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600",children:"Buscar produto"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:ae,onChange:y=>He(y.target.value),placeholder:"Ex: TP8329..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs text-gray-600",children:"Ordenar"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:D,onChange:y=>z(y.target.value),children:[n.jsx("option",{value:"alerta",children:"Alertas primeiro"}),n.jsx("option",{value:"saldo_desc",children:"Maior saldo"}),n.jsx("option",{value:"produto",children:"Produto (A-Z)"})]})]}),n.jsx("div",{className:"flex items-end gap-3",children:n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:Ue,onChange:y=>k(y.target.checked)}),"Somente com saldo"]})})]}),n.jsx("div",{className:"pt-3",children:n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:B,onChange:y=>E(y.target.checked)}),"Somente abaixo do mnimo"]})})]}),n.jsx("div",{className:"overflow-auto",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-2",children:"Produto"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Saldo"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Mnimo"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Status"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Aes"})]})}),n.jsxs("tbody",{children:[Ha.map(y=>{const M=O(y.saldo,y.min),H=mt&&mt===y.produto;return n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:y.produto||"-"}),n.jsx("td",{className:"px-4 py-2",children:Number(y.saldo||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-4 py-2",children:H?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",min:"0",className:"w-24 border rounded px-2 py-1",value:wr,onChange:pe=>Bt(pe.target.value)}),n.jsx("button",{type:"button",className:"text-xs bg-blue-600 text-white px-2 py-1 rounded",disabled:vt,onClick:async()=>{try{yt(!0);const pe=Number(wr||0);if(!Number.isFinite(pe)||pe<0)return;const Oe={...Ft||{},[y.produto]:pe};await Qe.salvarConfiguracao(a,Oe),Ke(Oe),lr(""),Bt("")}catch(pe){console.error(pe)}finally{yt(!1)}},children:"Salvar"}),n.jsx("button",{type:"button",className:"text-xs bg-gray-100 px-2 py-1 rounded",disabled:vt,onClick:()=>{lr(""),Bt("")},children:"Cancelar"})]}):n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("div",{children:Number(y.min||0).toLocaleString("pt-BR")}),n.jsx("button",{type:"button",className:"text-xs bg-gray-100 px-2 py-1 rounded",onClick:()=>{lr(y.produto),Bt(String(Number(y.min||0)))},children:"Definir"})]})}),n.jsx("td",{className:"px-4 py-2",children:n.jsx("span",{className:`px-2 py-1 rounded ${M}`,children:y.saldo<0?"Saldo negativo":y.min&&y.saldo<y.min?"Abaixo do mnimo":"OK"})}),n.jsx("td",{className:"px-4 py-2",children:n.jsx("button",{className:"text-xs bg-blue-50 hover:bg-blue-100 px-2 py-1 rounded",onClick:()=>b(y.produto),children:"Baixa"})})]},y.produto)}),Ha.length===0&&n.jsx("tr",{className:"border-t",children:n.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-gray-500",children:"Nenhum item encontrado com os filtros atuais."})})]})]})})]}),oe&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded shadow",children:[n.jsxs("div",{className:"px-4 py-2 border-b font-semibold flex items-center gap-2",children:[n.jsx(Zg,{})," Giro de Estoque no perodo"]}),n.jsx("div",{className:"p-4 text-sm text-gray-800",children:Nn.length===0?"Sem sadas no perodo.":Nn.map(y=>n.jsxs("div",{className:"flex items-center justify-between border-b last:border-0 py-1",children:[n.jsx("div",{children:y.produto}),n.jsx("div",{className:"font-semibold",children:Number(y.qtd).toLocaleString("pt-BR")})]},y.produto))})]}),n.jsxs("div",{className:"bg-white rounded shadow",children:[n.jsxs("div",{className:"px-4 py-2 border-b font-semibold flex items-center gap-2",children:[n.jsx(c1,{})," Histrico de Movimentaes"]}),n.jsx("div",{className:"overflow-auto",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-2",children:"Data"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Tipo"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Produto"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Quantidade"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Responsvel"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Origem"})]})}),n.jsx("tbody",{children:te.map((y,M)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-4 py-2",children:y.data?new Date(y.data).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-4 py-2",children:y.tipo}),n.jsx("td",{className:"px-4 py-2",children:y.produto}),n.jsx("td",{className:"px-4 py-2",children:Number(y.quantidade||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-4 py-2",children:y.responsavel}),n.jsx("td",{className:"px-4 py-2",children:y.origem})]},M))})]})})]})]})]}),ke&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-2xl",children:[n.jsxs("div",{className:"px-4 py-2 border-b font-semibold flex items-center justify-between",children:[n.jsx("div",{children:"Gerenciar categorias"}),n.jsx("button",{type:"button",className:"text-sm text-gray-600",onClick:()=>{Ge||Pe(!1)},children:"Fechar"})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Categorias (Insumos)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"1 por linha"}),n.jsx("textarea",{className:"w-full border rounded px-2 py-2 h-48",value:ht,onChange:y=>ot(y.target.value)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Categorias (Ferramentas)"}),n.jsx("div",{className:"text-xs text-gray-500",children:"1 por linha"}),n.jsx("textarea",{className:"w-full border rounded px-2 py-2 h-48",value:wt,onChange:y=>jt(y.target.value)})]})]}),Pt&&n.jsx("div",{className:"text-sm text-red-600",children:Pt}),n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>{Ge||Pe(!1)},disabled:Ge,children:"Cancelar"}),n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-blue-600 text-white",disabled:Ge,onClick:async()=>{try{et(!0),qe("");const y=pe=>String(pe||"").split(`
`).map(Oe=>Oe.trim()).filter(Boolean),M=y(ht),H=y(wt);await Qe.salvarConfiguracao(t,M),await Qe.salvarConfiguracao(r,H),xe(M.length?M:e),Y(H.length?H:o),Pe(!1)}catch(y){console.error(y),qe("Falha ao salvar categorias. Verifique conexo/permisses.")}finally{et(!1)}},children:Ge?"Salvando...":"Salvar"})]})]})]})}),Ae&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Entrada (Insumo)"}),n.jsxs("form",{className:"p-4 space-y-3",onSubmit:async y=>{if(y.preventDefault(),Ne(""),N)return;const M=String(F.nome||"").trim(),H=Number(F.quantidade||0);if(!M){Ne("Informe o nome do insumo.");return}if(!String(F.categoria||"").trim()){Ne("Selecione a categoria.");return}if(!Number.isFinite(H)||H<=0){Ne("Quantidade invlida.");return}try{C(!0);let pe=null;if(ne){const st=(String(ne.name||"").split(".").pop()||"jpg").toLowerCase(),Be=`insumos/${M.replace(/[^a-zA-Z0-9_-]/g,"_").slice(0,80)||"insumo"}-${Date.now()}.${st}`;pe=await Qe.uploadImagemEstoque({bucket:"estoque-itens",file:ne,path:Be})}const Oe=ea(M),_e=await Qe.getByIndex("exp_insumos","nome",M),ze=Array.isArray(_e)&&_e.length>0?_e[0]:(Array.isArray(h)?h:[]).find(Xe=>ea(Xe==null?void 0:Xe.nome)===Oe);ze!=null&&ze.id?pe&&await Qe.update("exp_insumos",{id:ze.id,foto_url:pe,atualizado_em:new Date().toISOString()}):await Qe.add("exp_insumos",{nome:M,categoria:F.categoria||null,qtd_minima:0,unidade:F.unidade||null,foto_url:pe,criado_em:new Date().toISOString(),atualizado_em:new Date().toISOString()}),await Qe.add("exp_insumos_mov",{tipo:"entrada",nome:M,categoria:F.categoria||null,quantidade:H,unidade:F.unidade||null,responsavel:F.responsavel||null,observacao:F.observacao||null}),await Promise.all([g(),x(),v()]),ie(null),S(!1)}catch(pe){console.error(pe),Ne("Falha ao registrar entrada.")}finally{C(!1)}},children:[n.jsx("datalist",{id:"cat-usinagem",children:re.map(y=>n.jsx("option",{value:y},y))}),n.jsx("datalist",{id:"unidades-padrao",children:i.map(y=>n.jsx("option",{value:y},y))}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Nome"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:F.nome,onChange:y=>Q(M=>({...M,nome:y.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Categoria"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:F.categoria,onChange:y=>Q(M=>({...M,categoria:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(re||[]).map(y=>n.jsx("option",{value:y,children:y},y))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Unidade"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",list:"unidades-padrao",value:F.unidade,onChange:y=>Q(M=>({...M,unidade:y.target.value}))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Quantidade"}),n.jsx("input",{type:"number",min:"0",className:"w-full border rounded px-2 py-1",value:F.quantidade,onChange:y=>Q(M=>({...M,quantidade:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Responsvel"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:F.responsavel,onChange:y=>Q(M=>({...M,responsavel:y.target.value}))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Observao"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:F.observacao,onChange:y=>Q(M=>({...M,observacao:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Foto do item (opcional)"}),n.jsx("input",{ref:xa,type:"file",accept:"image/*",className:"hidden",onChange:y=>{const M=y.target.files&&y.target.files[0];ie(M||null)}}),n.jsxs("div",{className:`mt-2 rounded border-2 border-dashed px-3 py-3 cursor-pointer select-none ${ne?"border-green-300 bg-green-50":"border-gray-300 bg-gray-50 hover:bg-gray-100"}`,onClick:()=>{var y;return(y=xa.current)==null?void 0:y.click()},onDragOver:y=>{y.preventDefault(),y.stopPropagation()},onDrop:y=>{var H;y.preventDefault(),y.stopPropagation();const M=((H=y.dataTransfer)==null?void 0:H.files)&&y.dataTransfer.files[0];M&&ie(M)},children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-10 w-10 rounded bg-white border flex items-center justify-center",children:n.jsx(u1,{className:"text-gray-500"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-gray-800",children:ne?"Foto selecionada":"Adicionar foto"}),n.jsx("div",{className:"text-xs text-gray-600",children:ne?ne.name||"arquivo":"Clique para escolher ou arraste a imagem aqui"})]}),ne&&n.jsx("button",{type:"button",className:"px-2 py-1 text-xs rounded bg-white border hover:bg-gray-50",onClick:y=>{y.preventDefault(),y.stopPropagation(),ie(null),xa.current&&(xa.current.value="")},children:"Remover"})]}),Se&&n.jsx("div",{className:"pt-3",children:n.jsx("img",{src:Se,alt:"Preview",className:"h-32 w-full object-cover rounded border bg-white"})})]})]}),Ie&&n.jsx("div",{className:"text-red-600 text-sm",children:Ie}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>{S(!1),ie(null)},disabled:N,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-green-600 text-white",disabled:N,children:N?"Salvando...":"Confirmar"})]})]})]})}),ia&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Editar status da ferramenta"}),n.jsxs("form",{className:"p-4 space-y-3",onSubmit:Sn,children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-xs text-gray-500 uppercase",children:"Ferramenta"}),n.jsx("div",{className:"font-semibold text-gray-800",children:pt.ferramenta||"-"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Vida til"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"number",min:"0",className:"w-24 border rounded px-2 py-1",value:pt.vida_valor,onChange:y=>_t(M=>({...M,vida_valor:y.target.value}))}),n.jsxs("select",{className:"border rounded px-2 py-1",value:pt.vida_unidade,onChange:y=>_t(M=>({...M,vida_unidade:y.target.value})),children:[n.jsx("option",{value:"dias",children:"Dias"}),n.jsx("option",{value:"horas",children:"Horas"}),n.jsx("option",{value:"semanas",children:"Semanas"})]})]}),n.jsx("div",{className:"text-xs text-gray-500 pt-1",children:"Convertemos para dias para calcular Restante."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"ltima troca"}),n.jsx("input",{type:"date",className:"w-full border rounded px-2 py-1",value:pt.ultima_troca,onChange:y=>_t(M=>({...M,ultima_troca:y.target.value}))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Responsvel"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:pt.responsavel,onChange:y=>_t(M=>({...M,responsavel:y.target.value})),placeholder:"Ex: Joo, Equipe Alnica..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Status"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:pt.status,onChange:y=>_t(M=>({...M,status:y.target.value})),children:[n.jsx("option",{value:"ativa",children:"Ativo (em uso)"}),n.jsx("option",{value:"estoque",children:"Em estoque (reserva)"})]})]}),Wt&&n.jsx("div",{className:"text-red-600 text-sm",children:Wt}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>{Zr||Qr(!1)},disabled:Zr,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white",disabled:Zr,children:Zr?"Salvando...":"Salvar"})]})]})]})}),T&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Sada (Insumo)"}),n.jsxs("form",{className:"p-4 space-y-3",onSubmit:async y=>{if(y.preventDefault(),Ne(""),N)return;const M=String(ee.nome||"").trim(),H=Number(ee.quantidade||0);if(!M){Ne("Selecione o insumo.");return}if(!Number.isFinite(H)||H<=0){Ne("Quantidade invlida.");return}const pe=(Array.isArray(p)?p:[]).find(_e=>ea(_e.nome)===ea(M));if(Number((pe==null?void 0:pe.saldo)||0)<H){Ne("Estoque insuficiente.");return}try{C(!0),await Qe.add("exp_insumos_mov",{tipo:"saida",nome:M,quantidade:H,unidade:ee.unidade||null,motivo:ee.motivo||null,maquina:ee.maquina||null,responsavel:ee.responsavel||null,observacao:ee.observacao||null}),await Promise.all([g(),x(),v()]),A(!1)}catch(_e){console.error(_e);const ze=(_e==null?void 0:_e.message)||(_e==null?void 0:_e.error_description)||"Falha ao registrar sada.";Ne(String(ze))}finally{C(!1)}},children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Insumo"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ee.nome,onChange:y=>Z(M=>({...M,nome:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(Array.isArray(p)?p:[]).map(y=>n.jsxs("option",{value:y.nome,children:[y.nome,"  saldo: ",Number(y.saldo||0).toLocaleString("pt-BR")]},y.nome))]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Quantidade"}),n.jsx("input",{type:"number",min:"1",className:"w-full border rounded px-2 py-1",value:ee.quantidade,onChange:y=>Z(M=>({...M,quantidade:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Motivo"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ee.motivo,onChange:y=>Z(M=>({...M,motivo:y.target.value})),children:[n.jsx("option",{value:"consumo",children:"Consumo"}),n.jsx("option",{value:"perda",children:"Perda/Avaria"}),n.jsx("option",{value:"manutencao",children:"Manuteno"}),n.jsx("option",{value:"transferencia",children:"Transferncia"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Unidade"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",list:"unidades-padrao",value:ee.unidade,onChange:y=>Z(M=>({...M,unidade:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Mquina/Setor"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ee.maquina,onChange:y=>Z(M=>({...M,maquina:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(Array.isArray(u)?u:[]).filter(y=>y&&String(y.status||"").toLowerCase()!=="inativa").map(y=>({key:String(y.id||""),label:String(y.nome||y.codigo||"").trim()})).filter(y=>y.label).sort((y,M)=>y.label.localeCompare(M.label)).map(y=>n.jsx("option",{value:y.label,children:y.label},y.key))]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Responsvel"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:ee.responsavel,onChange:y=>Z(M=>({...M,responsavel:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Observao"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:ee.observacao,onChange:y=>Z(M=>({...M,observacao:y.target.value}))})]})]}),Ie&&n.jsx("div",{className:"text-red-600 text-sm",children:Ie}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>A(!1),disabled:N,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white",disabled:N,children:N?"Salvando...":"Confirmar Sada"})]})]})]})}),Le&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Movimentao (Ferramenta)"}),n.jsxs("form",{className:"p-4 space-y-3",onSubmit:async y=>{y.preventDefault(),Zt("");const M=String(it.ferramenta||"").trim(),H=Number(it.quantidade||0);if(!M){Zt("Informe a ferramenta.");return}if(!String(it.categoria||"").trim()){Zt("Selecione a categoria.");return}if(!Number.isFinite(H)||H<=0){Zt("Quantidade invlida.");return}try{Tt(!0),await Qe.add("exp_ferramentas_mov",{ferramenta:M,categoria:it.categoria||null,tipo:it.tipo||"troca",quantidade:H,unidade:it.unidade||null,motivo:it.motivo||null,maquina:it.maquina||null,responsavel:it.responsavel||null,observacao:it.observacao||null}),Je(!1)}catch(pe){console.error(pe),Zt("Falha ao registrar movimentao.")}finally{Tt(!1)}},children:[n.jsx("datalist",{id:"cat-ferramentas",children:L.map(y=>n.jsx("option",{value:y},y))}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Ferramenta"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:it.ferramenta,onChange:y=>Qt(M=>({...M,ferramenta:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(Array.isArray(f)?f:[]).map(y=>String(y.ferramenta||y.codigo||"").trim()).filter(Boolean).sort((y,M)=>y.localeCompare(M)).map(y=>n.jsx("option",{value:y,children:y},y))]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Categoria"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:it.categoria,onChange:y=>Qt(M=>({...M,categoria:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(L||[]).map(y=>n.jsx("option",{value:y,children:y},y))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Unidade"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",list:"unidades-padrao",value:it.unidade,onChange:y=>Qt(M=>({...M,unidade:y.target.value}))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Tipo"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:it.tipo,onChange:y=>Qt(M=>({...M,tipo:y.target.value})),children:[n.jsx("option",{value:"troca",children:"Troca"}),n.jsx("option",{value:"consumo",children:"Consumo"}),n.jsx("option",{value:"entrada",children:"Entrada"}),n.jsx("option",{value:"ajuste",children:"Ajuste"}),n.jsx("option",{value:"perda",children:"Perda"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Quantidade"}),n.jsx("input",{type:"number",min:"0",className:"w-full border rounded px-2 py-1",value:it.quantidade,onChange:y=>Qt(M=>({...M,quantidade:y.target.value}))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Mquina"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:it.maquina,onChange:y=>Qt(M=>({...M,maquina:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),(Array.isArray(u)?u:[]).filter(y=>y&&String(y.status||"").toLowerCase()!=="inativa").map(y=>({key:String(y.id||""),label:String(y.nome||y.codigo||"").trim()})).filter(y=>y.label).sort((y,M)=>y.label.localeCompare(M.label)).map(y=>n.jsx("option",{value:y.label,children:y.label},y.key))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Responsvel"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:it.responsavel,onChange:y=>Qt(M=>({...M,responsavel:y.target.value}))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Observao"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:it.observacao,onChange:y=>Qt(M=>({...M,observacao:y.target.value}))})]}),Pr&&n.jsx("div",{className:"text-red-600 text-sm",children:Pr}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>Je(!1),disabled:Nt,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-indigo-600 text-white",disabled:Nt,children:Nt?"Salvando...":"Confirmar"})]})]})]})}),Vr&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Cadastrar Ferramenta"}),n.jsxs("form",{className:"p-4 space-y-3",onSubmit:async y=>{if(y.preventDefault(),er)return;es("");const M=String(qa.ferramenta||"").trim();if(!M){es("Informe o cdigo/nome da ferramenta.");return}try{$s(!0),(Array.isArray(f)?f:[]).some(pe=>String((pe==null?void 0:pe.ferramenta)||(pe==null?void 0:pe.codigo)||"").trim()===M)||await Qe.add("ferramentas_cfg",{ferramenta:M,codigo:M,descricao:qa.descricao||null,ativo:qa.ativo!==!1}),await m(),ma(!1)}catch(H){console.error(H),es((H==null?void 0:H.message)||"Falha ao cadastrar ferramenta.")}finally{$s(!1)}},children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Ferramenta (cdigo/nome)"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:qa.ferramenta,onChange:y=>ts(M=>({...M,ferramenta:y.target.value})),placeholder:"Ex: TR-0018"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Descrio (opcional)"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:qa.descricao,onChange:y=>ts(M=>({...M,descricao:y.target.value}))})]}),n.jsx("div",{children:n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:qa.ativo!==!1,onChange:y=>ts(M=>({...M,ativo:y.target.checked}))}),"Ativo"]})}),ps&&n.jsx("div",{className:"text-red-600 text-sm",children:ps}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:()=>{er||ma(!1)},disabled:er,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-gray-700 text-white",disabled:er,children:er?"Salvando...":"Salvar"})]})]})]})}),P==="ferramentas"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"px-3 py-2 rounded bg-green-600 text-white text-sm",onClick:()=>{S(!0),Ne("")},children:"Entrada (Insumo)"}),n.jsx("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm",onClick:()=>{A(!0),Ne("")},children:"Sada (Insumo)"}),n.jsx("button",{className:"px-3 py-2 rounded bg-indigo-600 text-white text-sm",onClick:()=>{Je(!0),Zt("")},children:"Movimentar Ferramenta"}),n.jsx("button",{className:"px-3 py-2 rounded bg-gray-700 text-white text-sm",onClick:()=>{ma(!0),es(""),ts({ferramenta:"",descricao:"",ativo:!0})},children:"Cadastrar Ferramenta"}),n.jsx("button",{className:"px-3 py-2 rounded bg-gray-100 text-gray-700 text-sm",onClick:()=>{qe(""),ot((re||[]).join(`
`)),jt((L||[]).join(`
`)),Pe(!0)},children:"Gerenciar categorias"}),n.jsx("button",{className:"px-3 py-2 rounded bg-gray-100 text-gray-700 text-sm",onClick:()=>fe(y=>!y),children:de?"Ocultar Histrico (Ferramentas e Insumos)":"Ver Histrico (Ferramentas e Insumos)"})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Insumos abaixo do mnimo"}),n.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(Io,{className:"text-red-600"})," ",Ws.abaixoMin]})]}),n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Consumo mdio (ref.)"}),n.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(Z0,{})," ",Number(Ws.consumoMedio||0).toLocaleString("pt-BR")]})]}),n.jsxs("div",{className:"bg-white rounded shadow p-4",children:[n.jsx("div",{className:"text-gray-500 text-sm",children:"Ferramentas monitoradas"}),n.jsxs("div",{className:"text-2xl font-bold flex items-center gap-2",children:[n.jsx(Dl,{})," ",(Array.isArray(f)?f:[]).length]})]})]}),n.jsxs("div",{className:"bg-white rounded shadow overflow-hidden",children:[n.jsxs("div",{className:"px-4 py-2 border-b font-semibold flex items-center justify-between",children:[n.jsx("div",{children:"Status de Ferramentas"}),n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:me,onChange:y=>we(y.target.checked)}),"Mostrar tambm estoque (inativas)"]})]}),n.jsx("div",{className:"overflow-auto",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-2",children:"Ferramenta"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Vida til"}),n.jsx("th",{className:"text-left px-4 py-2",children:"ltima troca"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Restante"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Status"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Responsvel"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Aes"})]})}),n.jsx("tbody",{children:(Array.isArray(Dr)?Dr:[]).map(y=>{const M=y.status==="para trocar"?"bg-red-100 text-red-700":y.status==="ateno"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",H=St==null?void 0:St[y.ferramenta],pe=(()=>H&&H.vida_valor!=null&&H.vida_unidade?`${H.vida_valor} ${H.vida_unidade}`:y.vida_util_dias!=null?`${y.vida_util_dias} dias`:"-")(),Oe=(()=>{if(y.restante_dias==null)return"-";const Xe=Number(y.restante_dias||0);return H&&H.vida_unidade==="horas"?`${Math.max(0,Math.round(Xe*24))} horas`:H&&H.vida_unidade==="semanas"?`${Math.max(0,Math.round(Xe/7))} semanas`:`${Math.max(0,Math.round(Xe))}d`})(),_e=ta[String(y.ferramenta||"")],ze=(_e==null?void 0:_e.ativo)===!1?"estoque":y.status;return n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-4 py-2 font-medium",children:y.ferramenta}),n.jsx("td",{className:"px-4 py-2",children:pe}),n.jsx("td",{className:"px-4 py-2",children:y.ultima_troca?new Date(y.ultima_troca).toLocaleDateString("pt-BR"):"-"}),n.jsx("td",{className:"px-4 py-2",children:Oe}),n.jsx("td",{className:"px-4 py-2",children:n.jsx("span",{className:`px-2 py-1 rounded ${M}`,children:ze})}),n.jsx("td",{className:"px-4 py-2",children:y.responsavel||"-"}),n.jsx("td",{className:"px-4 py-2",children:n.jsx("button",{type:"button",className:"text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded",onClick:()=>Ca(y),children:"Editar"})})]},y.ferramenta)})})]})})]}),n.jsxs("div",{className:"bg-white rounded shadow overflow-hidden",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold flex items-center gap-2",children:"Insumos"}),n.jsx("div",{className:"p-4 border-b bg-white",children:n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-xs text-gray-600",children:"Buscar (nome ou categoria)"}),n.jsx("input",{className:"w-full border rounded px-2 py-1",value:ce,onChange:y=>he(y.target.value),placeholder:"Ex: leo, broca, lubrificante..."})]}),n.jsx("div",{className:"flex items-end",children:n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:De,onChange:y=>j(y.target.checked)}),"Somente abaixo do mnimo"]})})]})}),n.jsx("div",{className:"overflow-auto",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-2",children:"Nome"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Categoria"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Qtd. Atual"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Mnimo"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Status"})]})}),n.jsxs("tbody",{children:[gs.map(y=>{const M=Number(y.__saldo_calc||0),H=!!y.__abaixo_min,pe=H?"bg-red-100 text-red-700":"bg-green-100 text-green-800",Oe=Sr&&Sr===String(y.id||"");return n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-4 py-2",children:n.jsxs("div",{className:"flex items-center gap-2",children:[y.foto_url?n.jsx("a",{href:y.foto_url,target:"_blank",rel:"noreferrer",title:"Abrir foto",children:n.jsx("img",{src:y.foto_url,alt:y.nome,className:"h-8 w-8 object-cover rounded border"})}):n.jsx("div",{className:"h-8 w-8 rounded border bg-gray-50"}),n.jsx("div",{children:y.nome})]})}),n.jsx("td",{className:"px-4 py-2",children:y.categoria}),n.jsxs("td",{className:"px-4 py-2",children:[Number(M).toLocaleString("pt-BR")," ",y.unidade||""]}),n.jsx("td",{className:"px-4 py-2",children:Oe?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"number",min:"0",className:"w-24 border rounded px-2 py-1",value:ha,onChange:_e=>pr(_e.target.value)}),n.jsx("button",{type:"button",className:"text-xs bg-blue-600 text-white px-2 py-1 rounded",disabled:Wr===String(y.id||""),onClick:async()=>{try{_r(String(y.id||""));const _e=Number(ha||0);if(!Number.isFinite(_e)||_e<0)return;await Qe.update("exp_insumos",{id:y.id,qtd_minima:_e,atualizado_em:new Date().toISOString()}),await g(),ar(""),pr("")}catch(_e){console.error(_e)}finally{_r("")}},children:"Salvar"}),n.jsx("button",{type:"button",className:"text-xs bg-gray-100 px-2 py-1 rounded",disabled:Wr===String(y.id||""),onClick:()=>{ar(""),pr("")},children:"Cancelar"})]}):n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{children:[Number(y.qtd_minima||0).toLocaleString("pt-BR")," ",y.unidade||""]}),n.jsx("button",{type:"button",className:"text-xs bg-gray-100 px-2 py-1 rounded",onClick:()=>{ar(String(y.id||"")),pr(String(Number(y.qtd_minima||0)))},children:"Definir"})]})}),n.jsx("td",{className:"px-4 py-2",children:n.jsx("span",{className:`px-2 py-1 rounded ${pe}`,children:H?"Abaixo do mnimo":"OK"})})]},y.id||y.nome)}),gs.length===0&&n.jsx("tr",{className:"border-t",children:n.jsx("td",{colSpan:5,className:"px-4 py-6 text-center text-sm text-gray-500",children:"Nenhum insumo encontrado com os filtros atuais."})})]})]})})]}),de&&n.jsxs("div",{className:"bg-white rounded shadow overflow-hidden",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Histrico (Ferramentas e Insumos)"}),n.jsx("div",{className:"overflow-auto",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-2",children:"Data"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Tipo"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Item"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Categoria"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Qtd"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Resp."}),n.jsx("th",{className:"text-left px-4 py-2",children:"Mquina"}),n.jsx("th",{className:"text-left px-4 py-2",children:"Origem"})]})}),n.jsxs("tbody",{children:[ys.map((y,M)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-4 py-2",children:y.data?new Date(y.data).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-4 py-2",children:y.tipo}),n.jsx("td",{className:"px-4 py-2",children:y.item}),n.jsx("td",{className:"px-4 py-2",children:y.categoria||"-"}),n.jsxs("td",{className:"px-4 py-2",children:[Number(y.qtd||0).toLocaleString("pt-BR")," ",y.unidade||""]}),n.jsx("td",{className:"px-4 py-2",children:y.resp}),n.jsx("td",{className:"px-4 py-2",children:y.maquina||"-"}),n.jsx("td",{className:"px-4 py-2",children:y.origem})]},M)),ys.length===0&&n.jsx("tr",{className:"border-t",children:n.jsx("td",{colSpan:8,className:"px-4 py-6 text-center text-sm text-gray-500",children:"Sem movimentaes recentes."})})]})]})})]})]}),se&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded shadow-lg w-full max-w-md",children:[n.jsx("div",{className:"px-4 py-2 border-b font-semibold",children:"Dar Baixa Automtica"}),n.jsxs("form",{onSubmit:ue,className:"p-4 space-y-3",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Produto"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ve.produto,onChange:y=>Fe(M=>({...M,produto:y.target.value})),children:[n.jsx("option",{value:"",children:"Selecione..."}),Or.map(y=>n.jsxs("option",{value:y.produto,children:[y.produto,"  saldo: ",Number(y.saldo||0).toLocaleString("pt-BR")]},y.produto))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Quantidade a consumir"}),n.jsx("input",{type:"number",min:"1",className:"w-full border rounded px-2 py-1",value:ve.quantidade,onChange:y=>Fe(M=>({...M,quantidade:y.target.value}))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm text-gray-600",children:"Motivo"}),n.jsxs("select",{className:"w-full border rounded px-2 py-1",value:ve.motivo,onChange:y=>Fe(M=>({...M,motivo:y.target.value})),children:[n.jsx("option",{value:"producao",children:"Produo"}),n.jsx("option",{value:"manutencao",children:"Manuteno"}),n.jsx("option",{value:"perda",children:"Perda"}),n.jsx("option",{value:"ajuste",children:"Ajuste"})]})]}),Te&&n.jsx("div",{className:"text-red-600 text-sm",children:Te}),n.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[n.jsx("button",{type:"button",className:"px-3 py-1 rounded bg-gray-100",onClick:K,disabled:ye,children:"Cancelar"}),n.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white",disabled:ye,children:ye?"Salvando...":"Confirmar Baixa"})]})]})]})})]})}const k1=()=>{const[e,t]=I.useState({maquina:"",motivoParada:"",tipoParada:"",inicio:"",fim:"",observacoes:""}),{items:r,addItem:a}=ft("apontamentos_parada"),{items:s}=ft("maquinas"),{items:i}=ft("motivos_parada"),{items:o}=ft("tipos_parada"),c=_=>{if(!_)return"";try{return String(_).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g,"_")}catch{return String(_).toLowerCase()}},l=I.useMemo(()=>{const _=c(e.tipoParada);return _?(i||[]).filter(v=>c((v==null?void 0:v.tipo_parada)||(v==null?void 0:v.tipo))===_):i||[]},[i,e.tipoParada]),d=_=>{try{if(!_)return null;const[v,R]=String(_).split("T");if(!v||!R)return null;const[q,U,P]=v.split("-").map(Number),[X,G]=R.split(":").map(Number);return new Date(q,(U||1)-1,P||1,X||0,G||0).toISOString()}catch{return null}},u=_=>{const v=R=>String(R).padStart(2,"0");return`${_.getFullYear()}-${v(_.getMonth()+1)}-${v(_.getDate())}T${v(_.getHours())}:${v(_.getMinutes())}`},[f,m]=I.useState(!0);I.useEffect(()=>{if(!e.inicio){const _=new Date,v=u(_),R=u(new Date(_.getTime()+10*6e4));t(q=>({...q,inicio:v,fim:R})),m(!0)}},[]);const h=_=>{const{name:v,value:R}=_.target;if(v==="motivoParada"){const q=(i||[]).find(U=>String(U.id)===String(R)||String(U.descricao??U.nome)===String(R));if(q){t({...e,motivoParada:q.descricao??q.nome,tipoParada:c(q.tipo_parada||q.tipo||e.tipoParada)});return}}if(v==="tipoParada"){const q=c(R),U=(i||[]).some(P=>c((P==null?void 0:P.tipo_parada)||(P==null?void 0:P.tipo))===q&&String((P==null?void 0:P.descricao)??(P==null?void 0:P.nome)??P)===String(e.motivoParada));t(P=>({...P,tipoParada:q,motivoParada:U?P.motivoParada:""}));return}if(t({...e,[v]:R}),v==="inicio"&&f)try{const q=new Date(R);if(!isNaN(q.getTime())){const U=u(new Date(q.getTime()+6e5));t(P=>({...P,fim:U,inicio:R}))}}catch{}v==="fim"&&m(!1)},g=async _=>{_.preventDefault();const v={maquina:e.maquina,motivo_parada:e.motivoParada,tipo_parada:e.tipoParada,inicio_timestamp:d(e.inicio),fim_timestamp:e.fim?d(e.fim):null,observacoes:e.observacoes||""};await a(v),alert("Parada registrada com sucesso!"),t({maquina:"",motivoParada:"",tipoParada:"",inicio:"",fim:"",observacoes:""}),m(!0)},p=I.useMemo(()=>{const _=(r||[]).map(v=>({id:v.id,maquina:v.maquina,motivo:v.motivo_parada||v.motivoParada||"-",tipo:v.tipo_parada||v.tipoParada||"-",inicio:v.inicio||v.inicio_timestamp,fim:v.fim||v.fim_timestamp}));return _.sort((v,R)=>String(R.inicio||"").localeCompare(String(v.inicio||""))),_.slice(0,10)},[r]),x=_=>{if(!_)return"-";try{const v=new Date(_),R=String(v.getDate()).padStart(2,"0"),q=String(v.getMonth()+1).padStart(2,"0"),U=v.getFullYear(),P=String(v.getHours()).padStart(2,"0"),X=String(v.getMinutes()).padStart(2,"0");return`${R}/${q}/${U} ${P}:${X}`}catch{return String(_)}},w=(_,v)=>{if(!_||!v)return null;try{const R=new Date(_),q=new Date(v);return Math.max(0,Math.round((q-R)/6e4))}catch{return null}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Apontamentos de Paradas"}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Nova Parada"}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mquina"}),n.jsxs("select",{className:"input-field",value:e.maquina,onChange:_=>h({target:{name:"maquina",value:_.target.value}}),required:!0,children:[n.jsx("option",{value:"",children:"Selecione a mquina"}),(s||[]).map(_=>n.jsx("option",{value:_.nome||_.codigo||`Mquina ${_.id}`,children:_.nome||_.codigo||`Mquina ${_.id}`},_.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Parada"}),n.jsxs("select",{className:"input-field",value:e.tipoParada,onChange:_=>h({target:{name:"tipoParada",value:_.target.value}}),required:!0,children:[n.jsx("option",{value:"",children:"Selecione o tipo"}),(o||[]).map(_=>{const v=_&&(_.descricao??_.nome??_)||"-",R=_&&(_.id??v),q=c(v);return n.jsx("option",{value:q,children:v},R)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo da Parada"}),n.jsxs("select",{className:"input-field",value:e.motivoParada,onChange:_=>h({target:{name:"motivoParada",value:_.target.value}}),required:!0,children:[n.jsx("option",{value:"",children:"Selecione o motivo"}),(l||[]).map(_=>{const v=_&&(_.descricao??_.nome??_)||"-",R=_&&(_.id??v);return n.jsx("option",{value:v,children:v},R)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Incio"}),n.jsx("input",{type:"datetime-local",className:"input-field",value:e.inicio,onChange:_=>h({target:{name:"inicio",value:_.target.value}}),required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fim"}),n.jsx("input",{type:"datetime-local",className:"input-field",value:e.fim,onChange:_=>h({target:{name:"fim",value:_.target.value}})})]}),n.jsx("div",{className:"hidden md:block"})]}),n.jsxs("div",{className:"md:col-span-3",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaes"}),n.jsx("textarea",{className:"input-field",rows:"3",value:e.observacoes,onChange:_=>h({target:{name:"observacoes",value:_.target.value}}),placeholder:"Descreva brevemente o motivo e observaes relevantes"})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",className:"btn-primary",children:"Registrar Parada"})})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Paradas Recentes"}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Incio"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fim"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durao"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[p.map(_=>{const v=w(_.inicio,_.fim),R=_.tipo==="setup"?"Setup":_.tipo==="nao_planejada"?"No Planejada":_.tipo==="manutencao"?"Manuteno":_.tipo==="planejada"?"Planejada":_.tipo||"-",q=_.tipo==="setup"?"bg-yellow-100 text-yellow-800":_.tipo==="nao_planejada"?"bg-red-100 text-red-800":_.tipo==="manutencao"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800";return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.maquina}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.motivo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${q}`,children:R})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(_.inicio)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(_.fim)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:v!=null?`${v} min`:"-"})]},_.id)}),p.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"6",className:"px-6 py-6 text-center text-gray-500",children:"Nenhuma parada registrada"})})]})]})})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ii={};Ii.version="0.18.5";var da=1200,sn=1252,j1=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Il={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},nc=function(e){j1.indexOf(e)!=-1&&(sn=Il[0]=e)};function E1(){nc(1252)}var Sa=function(e){da=e,nc(e)};function ic(){Sa(1200),E1()}function Ro(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function T1(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function gf(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $n=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?T1(e.slice(2)):t==254&&r==255?gf(e.slice(2)):t==65279?e.slice(1):e},pi=function(t){return String.fromCharCode(t)},ul=function(t){return String.fromCharCode(t)},Et;function A1(e){Et=e,Sa=function(t){da=t,nc(t)},$n=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Et.utils.decode(1200,Ro(t.slice(2))):t},pi=function(r){return da===1200?String.fromCharCode(r):Et.utils.decode(da,[r&255,r>>8])[0]},ul=function(r){return Et.utils.decode(sn,[r])[0]},Vf()}var Es="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ri(e){for(var t="",r=0,a=0,s=0,i=0,o=0,c=0,l=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),c=(a&15)<<2|s>>6,l=s&63,isNaN(a)?c=l=64:isNaN(s)&&(l=64),t+=Es.charAt(i)+Es.charAt(o)+Es.charAt(c)+Es.charAt(l);return t}function ua(e){var t="",r=0,a=0,s=0,i=0,o=0,c=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=Es.indexOf(e.charAt(d++)),o=Es.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),c=Es.indexOf(e.charAt(d++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),l=Es.indexOf(e.charAt(d++)),s=(c&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),hs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Os(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ud(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ca=function(t){return xt?hs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Qi(e){if(typeof ArrayBuffer>"u")return ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Bs(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function C1(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Rl(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Rl(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var yr=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:hs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function F1(e){for(var t=[],r=0,a=e.length+250,s=Os(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|c>>6&15|(o&3)<<4,s[r++]=128|c&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Os(65535),a=65530)}return t.push(s.slice(0,r)),yr(t)}var qr=/\u0000/g,gi=/[\u0001-\u0006]/g;function zn(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ra(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}function Ll(e,t){var r=""+e;return r.length>=t?r:Xt(" ",t-r.length)+r}function Lo(e,t){var r=""+e;return r.length>=t?r:r+Xt(" ",t-r.length)}function P1(e,t){var r=""+Math.round(e);return r.length>=t?r:Xt("0",t-r.length)+r}function O1(e,t){var r=""+e;return r.length>=t?r:Xt("0",t-r.length)+r}var fd=Math.pow(2,32);function In(e,t){if(e>fd||e<-fd)return P1(e,t);var r=Math.round(e);return O1(r,t)}function Mo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var hd=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Dc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function D1(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ze={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},md={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},I1={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bo(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,o=1,c=0,l=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),c=f*o+i,u=f*d+l,!(s-f<5e-8));)s=1/(s-f),i=o,o=c,l=d,d=u;if(u>t&&(d>t?(u=l,c=i):(u=d,c=o)),!r)return[0,a*c,u];var m=Math.floor(a*c/u);return[m,a*c-m*u,u]}function Ts(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,o=[],c={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++s==86400&&(c.T=s=0,++a,++c.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),a<60&&(i=(i+6)%7),r&&(i=q1(l,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=s%60,s=Math.floor(s/60),c.M=s%60,s=Math.floor(s/60),c.H=s,c.q=i,c}var vf=new Date(1899,11,31,0,0,0),R1=vf.getTime(),L1=new Date(1900,2,1,0,0,0);function yf(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=L1&&(r+=24*60*60*1e3),(r-(R1+(e.getTimezoneOffset()-vf.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ml(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function M1(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function B1(e){var t=e<0?12:11,r=Ml(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function U1(e){var t=Ml(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Li(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=B1(e):t===10?r=e.toFixed(10).substr(0,12):r=U1(e),Ml(M1(r.toUpperCase()))}function nn(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Li(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fa(14,yf(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function q1(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $1(e,t,r,a){var s="",i=0,o=0,c=r.y,l,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:l=c%100,d=2;break;default:l=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,d=t.length;break;case 3:return Dc[r.m-1][1];case 5:return Dc[r.m-1][0];default:return Dc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,d=t.length;break;case 3:return hd[r.q][0];default:return hd[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ra(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=Ra(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:l=c,d=1;break}var u=d>0?Ra(l,d):"";return u}function As(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var bf=/%/g;function H1(e,t,r){var a=t.replace(bf,""),s=t.length-a.length;return us(e,a,r*Math.pow(10,2*s))+Xt("%",s)}function z1(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function wf(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+wf(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,d,u){return l+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var _f=/# (\?+)( ?)\/( ?)(\d+)/;function W1(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),o=s-i*a,c=a;return r+(i===0?"":""+i)+" "+(o===0?Xt(" ",e[1].length+1+e[4].length):Ll(o,e[1].length)+e[2]+"/"+e[3]+Ra(c,e[4].length))}function V1(e,t,r){return r+(t===0?"":""+t)+Xt(" ",e[1].length+2+e[4].length)}var Sf=/^#*0*\.([0#]+)/,Nf=/\).*[0#]/,kf=/\(###\) ###\\?-####/;function Kr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function xd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function pd(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function G1(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function X1(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ga(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Nf)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ga("n",a,r):"("+ga("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return z1(e,t,r);if(t.indexOf("%")!==-1)return H1(e,t,r);if(t.indexOf("E")!==-1)return wf(t,r);if(t.charCodeAt(0)===36)return"$"+ga(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,c,l=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+In(l,t.length);if(t.match(/^[#?]+$/))return s=In(r,0),s==="0"&&(s=""),s.length>t.length?s:Kr(t.substr(0,t.length-s.length))+s;if(i=t.match(_f))return W1(i,l,d);if(t.match(/^#+0+$/))return d+In(l,t.length-t.indexOf("0"));if(i=t.match(Sf))return s=xd(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Kr(i[1])).replace(/\.$/,"."+Kr(i[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+Xt("0",Kr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+xd(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+As(In(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ga(e,t,-r):As(""+(Math.floor(r)+G1(r,i[1].length)))+"."+Ra(pd(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ga(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=zn(ga(e,t.replace(/[\\-]/g,""),r)),o=0,zn(zn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(kf))return s=ga(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=Bo(l,Math.pow(10,o)-1,!1),s=""+d,u=us("n",i[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Lo(c[2],o),u.length<i[4].length&&(u=Kr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=Bo(l,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ll(c[1],o)+i[2]+"/"+i[3]+Lo(c[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=In(r,0),t.length<=s.length?s:Kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,m=t.length-s.length-f;return Kr(t.substr(0,f)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=pd(r,i[1].length),r<0?"-"+ga(e,t,-r):As(X1(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ra(0,3-g.length):"")+g})+"."+Ra(o,i[1].length);switch(t){case"###,##0.00":return ga(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=As(In(l,0));return h!=="0"?d+h:"";case"###,###.00":return ga(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ga(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function K1(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return us(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function J1(e,t,r){var a=t.replace(bf,""),s=t.length-a.length;return us(e,a,r*Math.pow(10,2*s))+Xt("%",s)}function jf(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jf(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,l,d,u){return l+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Nf)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Va("n",a,r):"("+Va("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return K1(e,t,r);if(t.indexOf("%")!==-1)return J1(e,t,r);if(t.indexOf("E")!==-1)return jf(t,r);if(t.charCodeAt(0)===36)return"$"+Va(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,c,l=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ra(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Kr(t.substr(0,t.length-s.length))+s;if(i=t.match(_f))return V1(i,l,d);if(t.match(/^#+0+$/))return d+Ra(l,t.length-t.indexOf("0"));if(i=t.match(Sf))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Kr(i[1])).replace(/\.$/,"."+Kr(i[1])),s=s.replace(/\.(\d*)$/,function(g,p){return"."+p+Xt("0",Kr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+As(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Va(e,t,-r):As(""+r)+"."+Xt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Va(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=zn(Va(e,t.replace(/[\\-]/g,""),r)),o=0,zn(zn(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return o<s.length?s.charAt(o++):g==="0"?"0":""}));if(t.match(kf))return s=Va(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),c=Bo(l,Math.pow(10,o)-1,!1),s=""+d,u=us("n",i[1],c[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Lo(c[2],o),u.length<i[4].length&&(u=Kr(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),c=Bo(l,Math.pow(10,o)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ll(c[1],o)+i[2]+"/"+i[3]+Lo(c[2],o):Xt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Kr(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,m=t.length-s.length-f;return Kr(t.substr(0,f)+s+t.substr(t.length-m))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Va(e,t,-r):As(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ra(0,3-g.length):"")+g})+"."+Ra(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=As(""+l);return h!=="0"?d+h:"";default:if(t.match(/\.[0#?]*$/))return Va(e,t.slice(0,t.lastIndexOf(".")),r)+Kr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function us(e,t,r){return(r|0)===r?Va(e,t,r):ga(e,t,r)}function Y1(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Ef=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xn(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Mo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(Ef))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Q1(e,t,r,a){for(var s=[],i="",o=0,c="",l="t",d,u,f,m="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!Mo(e,o))throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var h=e.charAt(++o),g=h==="("||h===")"?h:"t";s[s.length]={t:g,v:h},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=Ts(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},l=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Ts(t,r),d==null))return"";for(i=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)i+=c;c==="m"&&l.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=m),s[s.length]={t:c,v:i},l=c;break;case"A":case"a":case"":var p={t:c,v:c};if(d==null&&(d=Ts(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",m="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,m="h"):e.substr(o,5).toUpperCase()==="/"?(d!=null&&(p.v=d.H>=12?"":""),p.t="T",o+=5,m="h"):(p.t="t",++o),d==null&&p.t==="T")return"";s[s.length]=p,l=c;break;case"[":for(i=c;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Ef)){if(d==null&&(d=Ts(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",xn(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++o<e.length&&(c=e.charAt(o))==="0";)i+=c;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)i+=c;s[s.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++o)===c;)i+=c;s[s.length]={t:c,v:i},l=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:c,v:c},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);s[s.length]={t:"t",v:c},++o;break}var x=0,w=0,_;for(o=s.length-1,l="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=m,l="h",x<1&&(x=1);break;case"s":(_=s[o].v.match(/\.0+$/))&&(w=Math.max(w,_[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=s[o].t;break;case"m":l==="s"&&(s[o].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[o].v.match(/[Hh]/)&&(x=1),x<2&&s[o].v.match(/[Mm]/)&&(x=2),x<3&&s[o].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",R;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=$1(s[o].t.charCodeAt(0),s[o].v,d,w),s[o].t="t";break;case"n":case"?":for(R=o+1;s[R]!=null&&((c=s[R].t)==="?"||c==="D"||(c===" "||c==="t")&&s[R+1]!=null&&(s[R+1].t==="?"||s[R+1].t==="t"&&s[R+1].v==="/")||s[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(s[R].v==="/"||s[R].v===" "&&s[R+1]!=null&&s[R+1].t=="?"));)s[o].v+=s[R].v,s[R]={v:"",t:";"},++R;v+=s[o].v,o=R-1;break;case"G":s[o].t="t",s[o].v=nn(t,r);break}var q="",U,P;if(v.length>0){v.charCodeAt(0)==40?(U=t<0&&v.charCodeAt(0)===45?-t:t,P=us("n",v,U)):(U=t<0&&a>1?-t:t,P=us("n",v,U),U<0&&s[0]&&s[0].t=="t"&&(P=P.substr(1),s[0].v="-"+s[0].v)),R=P.length-1;var X=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){X=o;break}var G=s.length;if(X===s.length&&P.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(R>=s[o].v.length-1?(R-=s[o].v.length,s[o].v=P.substr(R+1,s[o].v.length)):R<0?s[o].v="":(s[o].v=P.substr(0,R+1),R=-1),s[o].t="t",G=o);R>=0&&G<s.length&&(s[G].v=P.substr(0,R+1)+s[G].v)}else if(X!==s.length&&P.indexOf("E")===-1){for(R=P.indexOf(".")-1,o=X;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===X?s[o].v.indexOf(".")-1:s[o].v.length-1,q=s[o].v.substr(u+1);u>=0;--u)R>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(q=P.charAt(R--)+q);s[o].v=q,s[o].t="t",G=o}for(R>=0&&G<s.length&&(s[G].v=P.substr(0,R+1)+s[G].v),R=P.indexOf(".")+1,o=X;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==X)){for(u=s[o].v.indexOf(".")>-1&&o===X?s[o].v.indexOf(".")+1:0,q=s[o].v.substr(0,u);u<s[o].v.length;++u)R<P.length&&(q+=P.charAt(R++));s[o].v=q,s[o].t="t",G=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(U=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=us(s[o].t,s[o].v,U),s[o].t="t");var le="";for(o=0;o!==s.length;++o)s[o]!=null&&(le+=s[o].v);return le}var gd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vd(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Z1(e,t){var r=Y1(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(gd),c=r[1].match(gd);return vd(t,o)?[a,r[0]]:vd(t,c)?[a,r[1]]:[a,r[o!=null&&c!=null?2:1]]}return[a,i]}function fa(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ze)[e],a==null&&(a=r.table&&r.table[md[e]]||Ze[md[e]]),a==null&&(a=I1[e]||"General");break}if(Mo(a,0))return nn(t,r);t instanceof Date&&(t=yf(t,r.date1904));var s=Z1(a,t);if(Mo(s[1]))return nn(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Q1(s[1],t,r,s[0])}function Ja(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ze[r]==null){t<0&&(t=r);continue}if(Ze[r]==e){t=r;break}}t<0&&(t=391)}return Ze[t]=e,t}function Zi(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ja(e[t],t)}function ri(){Ze=D1()}var Uo={format:fa,load:Ja,_table:Ze,load_table:Zi,parse_date_code:Ts,is_date:xn,get_table:function(){return Uo._table=Ze}},ev={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Tf=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function tv(e){var t=typeof e=="number"?Ze[e]:e;return t=t.replace(Tf,"(\\d+)"),new RegExp("^"+t+"$")}function rv(e,t,r){var a=-1,s=-1,i=-1,o=-1,c=-1,l=-1;(t.match(Tf)||[]).forEach(function(f,m){var h=parseInt(r[m+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=h;break;case"d":i=h;break;case"h":o=h;break;case"s":l=h;break;case"m":o>=0?c=h:s=h;break}}),l>=0&&c==-1&&s>=0&&(c=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&c==-1&&l==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var av=function(){var e={};e.version="1.2.0";function t(){for(var P=0,X=new Array(256),G=0;G!=256;++G)P=G,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,P=P&1?-306674912^P>>>1:P>>>1,X[G]=P;return typeof Int32Array<"u"?new Int32Array(X):X}var r=t();function a(P){var X=0,G=0,le=0,se=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(le=0;le!=256;++le)se[le]=P[le];for(le=0;le!=256;++le)for(G=P[le],X=256+le;X<4096;X+=256)G=se[X]=G>>>8^P[G&255];var V=[];for(le=1;le!=16;++le)V[le-1]=typeof Int32Array<"u"?se.subarray(le*256,le*256+256):se.slice(le*256,le*256+256);return V}var s=a(r),i=s[0],o=s[1],c=s[2],l=s[3],d=s[4],u=s[5],f=s[6],m=s[7],h=s[8],g=s[9],p=s[10],x=s[11],w=s[12],_=s[13],v=s[14];function R(P,X){for(var G=X^-1,le=0,se=P.length;le<se;)G=G>>>8^r[(G^P.charCodeAt(le++))&255];return~G}function q(P,X){for(var G=X^-1,le=P.length-15,se=0;se<le;)G=v[P[se++]^G&255]^_[P[se++]^G>>8&255]^w[P[se++]^G>>16&255]^x[P[se++]^G>>>24]^p[P[se++]]^g[P[se++]]^h[P[se++]]^m[P[se++]]^f[P[se++]]^u[P[se++]]^d[P[se++]]^l[P[se++]]^c[P[se++]]^o[P[se++]]^i[P[se++]]^r[P[se++]];for(le+=15;se<le;)G=G>>>8^r[(G^P[se++])&255];return~G}function U(P,X){for(var G=X^-1,le=0,se=P.length,V=0,ye=0;le<se;)V=P.charCodeAt(le++),V<128?G=G>>>8^r[(G^V)&255]:V<2048?(G=G>>>8^r[(G^(192|V>>6&31))&255],G=G>>>8^r[(G^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ye=P.charCodeAt(le++)&1023,G=G>>>8^r[(G^(240|V>>8&7))&255],G=G>>>8^r[(G^(128|V>>2&63))&255],G=G>>>8^r[(G^(128|ye>>6&15|(V&3)<<4))&255],G=G>>>8^r[(G^(128|ye&63))&255]):(G=G>>>8^r[(G^(224|V>>12&15))&255],G=G>>>8^r[(G^(128|V>>6&63))&255],G=G>>>8^r[(G^(128|V&63))&255]);return~G}return e.table=r,e.bstr=R,e.buf=q,e.str=U,e}(),Ye=function(){var t={};t.version="1.2.1";function r(S,T){for(var A=S.split("/"),N=T.split("/"),C=0,F=0,Q=Math.min(A.length,N.length);C<Q;++C){if(F=A[C].length-N[C].length)return F;if(A[C]!=N[C])return A[C]<N[C]?-1:1}return A.length-N.length}function a(S){if(S.charAt(S.length-1)=="/")return S.slice(0,-1).indexOf("/")===-1?S:a(S.slice(0,-1));var T=S.lastIndexOf("/");return T===-1?S:S.slice(0,T+1)}function s(S){if(S.charAt(S.length-1)=="/")return s(S.slice(0,-1));var T=S.lastIndexOf("/");return T===-1?S:S.slice(T+1)}function i(S,T){typeof T=="string"&&(T=new Date(T));var A=T.getHours();A=A<<6|T.getMinutes(),A=A<<5|T.getSeconds()>>>1,S.write_shift(2,A);var N=T.getFullYear()-1980;N=N<<4|T.getMonth()+1,N=N<<5|T.getDate(),S.write_shift(2,N)}function o(S){var T=S.read_shift(2)&65535,A=S.read_shift(2)&65535,N=new Date,C=A&31;A>>>=5;var F=A&15;A>>>=4,N.setMilliseconds(0),N.setFullYear(A+1980),N.setMonth(F-1),N.setDate(C);var Q=T&31;T>>>=5;var ee=T&63;return T>>>=6,N.setHours(T),N.setMinutes(ee),N.setSeconds(Q<<1),N}function c(S){Cr(S,0);for(var T={},A=0;S.l<=S.length-4;){var N=S.read_shift(2),C=S.read_shift(2),F=S.l+C,Q={};switch(N){case 21589:A=S.read_shift(1),A&1&&(Q.mtime=S.read_shift(4)),C>5&&(A&2&&(Q.atime=S.read_shift(4)),A&4&&(Q.ctime=S.read_shift(4))),Q.mtime&&(Q.mt=new Date(Q.mtime*1e3));break}S.l=F,T[N]=Q}return T}var l;function d(){return l||(l={})}function u(S,T){if(S[0]==80&&S[1]==75)return ar(S,T);if((S[0]|32)==109&&(S[1]|32)==105)return pt(S,T);if(S.length<512)throw new Error("CFB file size "+S.length+" < 512");var A=3,N=512,C=0,F=0,Q=0,ee=0,Z=0,ne=[],ie=S.slice(0,512);Cr(ie,0);var Se=f(ie);switch(A=Se[0],A){case 3:N=512;break;case 4:N=4096;break;case 0:if(Se[1]==0)return ar(S,T);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}N!==512&&(ie=S.slice(0,N),Cr(ie,28));var Ce=S.slice(0,N);m(ie,A);var Ie=ie.read_shift(4,"i");if(A===3&&Ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ie);ie.l+=4,Q=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),ee=ie.read_shift(4,"i"),C=ie.read_shift(4,"i"),Z=ie.read_shift(4,"i"),F=ie.read_shift(4,"i");for(var Ne=-1,Le=0;Le<109&&(Ne=ie.read_shift(4,"i"),!(Ne<0));++Le)ne[Le]=Ne;var Je=h(S,N);x(Z,F,Je,N,ne);var Nt=_(Je,Q,ne,N);Nt[Q].name="!Directory",C>0&&ee!==ye&&(Nt[ee].name="!MiniFAT"),Nt[ne[0]].name="!FAT",Nt.fat_addrs=ne,Nt.ssz=N;var Tt={},it=[],Qt=[],Pr=[];v(Q,Nt,Je,it,C,Tt,Qt,ee),g(Qt,Pr,it),it.shift();var Zt={FileIndex:Qt,FullPaths:Pr};return T&&T.raw&&(Zt.raw={header:Ce,sectors:Je}),Zt}function f(S){if(S[S.l]==80&&S[S.l+1]==75)return[0,0];S.chk(Ee,"Header Signature: "),S.l+=16;var T=S.read_shift(2,"u");return[S.read_shift(2,"u"),T]}function m(S,T){var A=9;switch(S.l+=2,A=S.read_shift(2)){case 9:if(T!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(T!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}S.chk("0600","Mini Sector Shift: "),S.chk("000000000000","Reserved: ")}function h(S,T){for(var A=Math.ceil(S.length/T)-1,N=[],C=1;C<A;++C)N[C-1]=S.slice(C*T,(C+1)*T);return N[A-1]=S.slice(A*T),N}function g(S,T,A){for(var N=0,C=0,F=0,Q=0,ee=0,Z=A.length,ne=[],ie=[];N<Z;++N)ne[N]=ie[N]=N,T[N]=A[N];for(;ee<ie.length;++ee)N=ie[ee],C=S[N].L,F=S[N].R,Q=S[N].C,ne[N]===N&&(C!==-1&&ne[C]!==C&&(ne[N]=ne[C]),F!==-1&&ne[F]!==F&&(ne[N]=ne[F])),Q!==-1&&(ne[Q]=N),C!==-1&&N!=ne[N]&&(ne[C]=ne[N],ie.lastIndexOf(C)<ee&&ie.push(C)),F!==-1&&N!=ne[N]&&(ne[F]=ne[N],ie.lastIndexOf(F)<ee&&ie.push(F));for(N=1;N<Z;++N)ne[N]===N&&(F!==-1&&ne[F]!==F?ne[N]=ne[F]:C!==-1&&ne[C]!==C&&(ne[N]=ne[C]));for(N=1;N<Z;++N)if(S[N].type!==0){if(ee=N,ee!=ne[ee])do ee=ne[ee],T[N]=T[ee]+"/"+T[N];while(ee!==0&&ne[ee]!==-1&&ee!=ne[ee]);ne[N]=-1}for(T[0]+="/",N=1;N<Z;++N)S[N].type!==2&&(T[N]+="/")}function p(S,T,A){for(var N=S.start,C=S.size,F=[],Q=N;A&&C>0&&Q>=0;)F.push(T.slice(Q*V,Q*V+V)),C-=V,Q=Qs(A,Q*4);return F.length===0?be(0):yr(F).slice(0,S.size)}function x(S,T,A,N,C){var F=ye;if(S===ye){if(T!==0)throw new Error("DIFAT chain shorter than expected")}else if(S!==-1){var Q=A[S],ee=(N>>>2)-1;if(!Q)return;for(var Z=0;Z<ee&&(F=Qs(Q,Z*4))!==ye;++Z)C.push(F);x(Qs(Q,N-4),T-1,A,N,C)}}function w(S,T,A,N,C){var F=[],Q=[];C||(C=[]);var ee=N-1,Z=0,ne=0;for(Z=T;Z>=0;){C[Z]=!0,F[F.length]=Z,Q.push(S[Z]);var ie=A[Math.floor(Z*4/N)];if(ne=Z*4&ee,N<4+ne)throw new Error("FAT boundary crossed: "+Z+" 4 "+N);if(!S[ie])break;Z=Qs(S[ie],ne)}return{nodes:F,data:Cd([Q])}}function _(S,T,A,N){var C=S.length,F=[],Q=[],ee=[],Z=[],ne=N-1,ie=0,Se=0,Ce=0,Ie=0;for(ie=0;ie<C;++ie)if(ee=[],Ce=ie+T,Ce>=C&&(Ce-=C),!Q[Ce]){Z=[];var Ne=[];for(Se=Ce;Se>=0;){Ne[Se]=!0,Q[Se]=!0,ee[ee.length]=Se,Z.push(S[Se]);var Le=A[Math.floor(Se*4/N)];if(Ie=Se*4&ne,N<4+Ie)throw new Error("FAT boundary crossed: "+Se+" 4 "+N);if(!S[Le]||(Se=Qs(S[Le],Ie),Ne[Se]))break}F[Ce]={nodes:ee,data:Cd([Z])}}return F}function v(S,T,A,N,C,F,Q,ee){for(var Z=0,ne=N.length?2:0,ie=T[S].data,Se=0,Ce=0,Ie;Se<ie.length;Se+=128){var Ne=ie.slice(Se,Se+128);Cr(Ne,64),Ce=Ne.read_shift(2),Ie=dc(Ne,0,Ce-ne),N.push(Ie);var Le={name:Ie,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Je=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Je!==0&&(Le.ct=R(Ne,Ne.l-8));var Nt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Nt!==0&&(Le.mt=R(Ne,Ne.l-8)),Le.start=Ne.read_shift(4,"i"),Le.size=Ne.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=ye,Le.name=""),Le.type===5?(Z=Le.start,C>0&&Z!==ye&&(T[Z].name="!StreamData")):Le.size>=4096?(Le.storage="fat",T[Le.start]===void 0&&(T[Le.start]=w(A,Le.start,T.fat_addrs,T.ssz)),T[Le.start].name=Le.name,Le.content=T[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:Z!==ye&&Le.start!==ye&&T[Z]&&(Le.content=p(Le,T[Z].data,(T[ee]||{}).data))),Le.content&&Cr(Le.content,0),F[Ie]=Le,Q.push(Le)}}function R(S,T){return new Date((vr(S,T+4)/1e7*Math.pow(2,32)+vr(S,T)/1e7-11644473600)*1e3)}function q(S,T){return d(),u(l.readFileSync(S),T)}function U(S,T){var A=T&&T.type;switch(A||xt&&Buffer.isBuffer(S)&&(A="buffer"),A||"base64"){case"file":return q(S,T);case"base64":return u(ca(ua(S)),T);case"binary":return u(ca(S),T)}return u(S,T)}function P(S,T){var A=T||{},N=A.root||"Root Entry";if(S.FullPaths||(S.FullPaths=[]),S.FileIndex||(S.FileIndex=[]),S.FullPaths.length!==S.FileIndex.length)throw new Error("inconsistent CFB structure");S.FullPaths.length===0&&(S.FullPaths[0]=N+"/",S.FileIndex[0]={name:N,type:5}),A.CLSID&&(S.FileIndex[0].clsid=A.CLSID),X(S)}function X(S){var T="Sh33tJ5";if(!Ye.find(S,"/"+T)){var A=be(4);A[0]=55,A[1]=A[3]=50,A[2]=54,S.FileIndex.push({name:T,type:2,content:A,size:4,L:69,R:69,C:69}),S.FullPaths.push(S.FullPaths[0]+T),G(S)}}function G(S,T){P(S);for(var A=!1,N=!1,C=S.FullPaths.length-1;C>=0;--C){var F=S.FileIndex[C];switch(F.type){case 0:N?A=!0:(S.FileIndex.pop(),S.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(F.R*F.L*F.C)&&(A=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!T)){var Q=new Date(1987,1,19),ee=0,Z=Object.create?Object.create(null):{},ne=[];for(C=0;C<S.FullPaths.length;++C)Z[S.FullPaths[C]]=!0,S.FileIndex[C].type!==0&&ne.push([S.FullPaths[C],S.FileIndex[C]]);for(C=0;C<ne.length;++C){var ie=a(ne[C][0]);N=Z[ie],N||(ne.push([ie,{name:s(ie).replace("/",""),type:1,clsid:Fe,ct:Q,mt:Q,content:null}]),Z[ie]=!0)}for(ne.sort(function(Ie,Ne){return r(Ie[0],Ne[0])}),S.FullPaths=[],S.FileIndex=[],C=0;C<ne.length;++C)S.FullPaths[C]=ne[C][0],S.FileIndex[C]=ne[C][1];for(C=0;C<ne.length;++C){var Se=S.FileIndex[C],Ce=S.FullPaths[C];if(Se.name=s(Ce).replace("/",""),Se.L=Se.R=Se.C=-(Se.color=1),Se.size=Se.content?Se.content.length:0,Se.start=0,Se.clsid=Se.clsid||Fe,C===0)Se.C=ne.length>1?1:-1,Se.size=0,Se.type=5;else if(Ce.slice(-1)=="/"){for(ee=C+1;ee<ne.length&&a(S.FullPaths[ee])!=Ce;++ee);for(Se.C=ee>=ne.length?-1:ee,ee=C+1;ee<ne.length&&a(S.FullPaths[ee])!=a(Ce);++ee);Se.R=ee>=ne.length?-1:ee,Se.type=1}else a(S.FullPaths[C+1]||"")==a(Ce)&&(Se.R=C+1),Se.type=2}}}function le(S,T){var A=T||{};if(A.fileType=="mad")return _t(S,A);switch(G(S),A.fileType){case"zip":return pr(S,A)}var N=function(Ie){for(var Ne=0,Le=0,Je=0;Je<Ie.FileIndex.length;++Je){var Nt=Ie.FileIndex[Je];if(Nt.content){var Tt=Nt.content.length;Tt>0&&(Tt<4096?Ne+=Tt+63>>6:Le+=Tt+511>>9)}}for(var it=Ie.FullPaths.length+3>>2,Qt=Ne+7>>3,Pr=Ne+127>>7,Zt=Qt+Le+it+Pr,Vr=Zt+127>>7,ma=Vr<=109?0:Math.ceil((Vr-109)/127);Zt+Vr+ma+127>>7>Vr;)ma=++Vr<=109?0:Math.ceil((Vr-109)/127);var er=[1,ma,Vr,Pr,it,Le,Ne,0];return Ie.FileIndex[0].size=Ne<<6,er[7]=(Ie.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(S),C=be(N[7]<<9),F=0,Q=0;{for(F=0;F<8;++F)C.write_shift(1,ve[F]);for(F=0;F<8;++F)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),F=0;F<3;++F)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,N[2]),C.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:ye),C.write_shift(4,N[3]),C.write_shift(-4,N[1]?N[0]-1:ye),C.write_shift(4,N[1]),F=0;F<109;++F)C.write_shift(-4,F<N[2]?N[1]+F:-1)}if(N[1])for(Q=0;Q<N[1];++Q){for(;F<236+Q*127;++F)C.write_shift(-4,F<N[2]?N[1]+F:-1);C.write_shift(-4,Q===N[1]-1?ye:Q+1)}var ee=function(Ie){for(Q+=Ie;F<Q-1;++F)C.write_shift(-4,F+1);Ie&&(++F,C.write_shift(-4,ye))};for(Q=F=0,Q+=N[1];F<Q;++F)C.write_shift(-4,Te.DIFSECT);for(Q+=N[2];F<Q;++F)C.write_shift(-4,Te.FATSECT);ee(N[3]),ee(N[4]);for(var Z=0,ne=0,ie=S.FileIndex[0];Z<S.FileIndex.length;++Z)ie=S.FileIndex[Z],ie.content&&(ne=ie.content.length,!(ne<4096)&&(ie.start=Q,ee(ne+511>>9)));for(ee(N[6]+7>>3);C.l&511;)C.write_shift(-4,Te.ENDOFCHAIN);for(Q=F=0,Z=0;Z<S.FileIndex.length;++Z)ie=S.FileIndex[Z],ie.content&&(ne=ie.content.length,!(!ne||ne>=4096)&&(ie.start=Q,ee(ne+63>>6)));for(;C.l&511;)C.write_shift(-4,Te.ENDOFCHAIN);for(F=0;F<N[4]<<2;++F){var Se=S.FullPaths[F];if(!Se||Se.length===0){for(Z=0;Z<17;++Z)C.write_shift(4,0);for(Z=0;Z<3;++Z)C.write_shift(4,-1);for(Z=0;Z<12;++Z)C.write_shift(4,0);continue}ie=S.FileIndex[F],F===0&&(ie.start=ie.size?ie.start-1:ye);var Ce=F===0&&A.root||ie.name;if(ne=2*(Ce.length+1),C.write_shift(64,Ce,"utf16le"),C.write_shift(2,ne),C.write_shift(1,ie.type),C.write_shift(1,ie.color),C.write_shift(-4,ie.L),C.write_shift(-4,ie.R),C.write_shift(-4,ie.C),ie.clsid)C.write_shift(16,ie.clsid,"hex");else for(Z=0;Z<4;++Z)C.write_shift(4,0);C.write_shift(4,ie.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,ie.start),C.write_shift(4,ie.size),C.write_shift(4,0)}for(F=1;F<S.FileIndex.length;++F)if(ie=S.FileIndex[F],ie.size>=4096)if(C.l=ie.start+1<<9,xt&&Buffer.isBuffer(ie.content))ie.content.copy(C,C.l,0,ie.size),C.l+=ie.size+511&-512;else{for(Z=0;Z<ie.size;++Z)C.write_shift(1,ie.content[Z]);for(;Z&511;++Z)C.write_shift(1,0)}for(F=1;F<S.FileIndex.length;++F)if(ie=S.FileIndex[F],ie.size>0&&ie.size<4096)if(xt&&Buffer.isBuffer(ie.content))ie.content.copy(C,C.l,0,ie.size),C.l+=ie.size+63&-64;else{for(Z=0;Z<ie.size;++Z)C.write_shift(1,ie.content[Z]);for(;Z&63;++Z)C.write_shift(1,0)}if(xt)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function se(S,T){var A=S.FullPaths.map(function(Z){return Z.toUpperCase()}),N=A.map(function(Z){var ne=Z.split("/");return ne[ne.length-(Z.slice(-1)=="/"?2:1)]}),C=!1;T.charCodeAt(0)===47?(C=!0,T=A[0].slice(0,-1)+T):C=T.indexOf("/")!==-1;var F=T.toUpperCase(),Q=C===!0?A.indexOf(F):N.indexOf(F);if(Q!==-1)return S.FileIndex[Q];var ee=!F.match(gi);for(F=F.replace(qr,""),ee&&(F=F.replace(gi,"!")),Q=0;Q<A.length;++Q)if((ee?A[Q].replace(gi,"!"):A[Q]).replace(qr,"")==F||(ee?N[Q].replace(gi,"!"):N[Q]).replace(qr,"")==F)return S.FileIndex[Q];return null}var V=64,ye=-2,Ee="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],Fe="00000000000000000000000000000000",Te={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ye,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function $e(S,T,A){d();var N=le(S,A);l.writeFileSync(T,N)}function ae(S){for(var T=new Array(S.length),A=0;A<S.length;++A)T[A]=String.fromCharCode(S[A]);return T.join("")}function He(S,T){var A=le(S,T);switch(T&&T.type||"buffer"){case"file":return d(),l.writeFileSync(T.filename,A),A;case"binary":return typeof A=="string"?A:ae(A);case"base64":return Ri(typeof A=="string"?A:ae(A));case"buffer":if(xt)return Buffer.isBuffer(A)?A:hs(A);case"array":return typeof A=="string"?ca(A):A}return A}var Ue;function k(S){try{var T=S.InflateRaw,A=new T;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)Ue=S;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function B(S,T){if(!Ue)return _r(S,T);var A=Ue.InflateRaw,N=new A,C=N._processChunk(S.slice(S.l),N._finishFlushFlag);return S.l+=N.bytesRead,C}function E(S){return Ue?Ue.deflateRawSync(S):Ke(S)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(S){var T=(S<<1|S<<11)&139536|(S<<5|S<<15)&558144;return(T>>16|T>>8|T)&255}for(var ce=typeof Uint8Array<"u",he=ce?new Uint8Array(256):[],De=0;De<256;++De)he[De]=J(De);function j(S,T){var A=he[S&255];return T<=8?A>>>8-T:(A=A<<8|he[S>>8&255],T<=16?A>>>16-T:(A=A<<8|he[S>>16&255],A>>>24-T))}function de(S,T){var A=T&7,N=T>>>3;return(S[N]|(A<=6?0:S[N+1]<<8))>>>A&3}function fe(S,T){var A=T&7,N=T>>>3;return(S[N]|(A<=5?0:S[N+1]<<8))>>>A&7}function re(S,T){var A=T&7,N=T>>>3;return(S[N]|(A<=4?0:S[N+1]<<8))>>>A&15}function xe(S,T){var A=T&7,N=T>>>3;return(S[N]|(A<=3?0:S[N+1]<<8))>>>A&31}function L(S,T){var A=T&7,N=T>>>3;return(S[N]|(A<=1?0:S[N+1]<<8))>>>A&127}function Y(S,T,A){var N=T&7,C=T>>>3,F=(1<<A)-1,Q=S[C]>>>N;return A<8-N||(Q|=S[C+1]<<8-N,A<16-N)||(Q|=S[C+2]<<16-N,A<24-N)||(Q|=S[C+3]<<24-N),Q&F}function ke(S,T,A){var N=T&7,C=T>>>3;return N<=5?S[C]|=(A&7)<<N:(S[C]|=A<<N&255,S[C+1]=(A&7)>>8-N),T+3}function Pe(S,T,A){var N=T&7,C=T>>>3;return A=(A&1)<<N,S[C]|=A,T+1}function Ge(S,T,A){var N=T&7,C=T>>>3;return A<<=N,S[C]|=A&255,A>>>=8,S[C+1]=A,T+8}function et(S,T,A){var N=T&7,C=T>>>3;return A<<=N,S[C]|=A&255,A>>>=8,S[C+1]=A&255,S[C+2]=A>>>8,T+16}function Pt(S,T){var A=S.length,N=2*A>T?2*A:T+5,C=0;if(A>=T)return S;if(xt){var F=ud(N);if(S.copy)S.copy(F);else for(;C<S.length;++C)F[C]=S[C];return F}else if(ce){var Q=new Uint8Array(N);if(Q.set)Q.set(S);else for(;C<A;++C)Q[C]=S[C];return Q}return S.length=N,S}function qe(S){for(var T=new Array(S),A=0;A<S;++A)T[A]=0;return T}function ht(S,T,A){var N=1,C=0,F=0,Q=0,ee=0,Z=S.length,ne=ce?new Uint16Array(32):qe(32);for(F=0;F<32;++F)ne[F]=0;for(F=Z;F<A;++F)S[F]=0;Z=S.length;var ie=ce?new Uint16Array(Z):qe(Z);for(F=0;F<Z;++F)ne[C=S[F]]++,N<C&&(N=C),ie[F]=0;for(ne[0]=0,F=1;F<=N;++F)ne[F+16]=ee=ee+ne[F-1]<<1;for(F=0;F<Z;++F)ee=S[F],ee!=0&&(ie[F]=ne[ee+16]++);var Se=0;for(F=0;F<Z;++F)if(Se=S[F],Se!=0)for(ee=j(ie[F],N)>>N-Se,Q=(1<<N+4-Se)-1;Q>=0;--Q)T[ee|Q<<Se]=Se&15|F<<4;return N}var ot=ce?new Uint16Array(512):qe(512),wt=ce?new Uint16Array(32):qe(32);if(!ce){for(var jt=0;jt<512;++jt)ot[jt]=0;for(jt=0;jt<32;++jt)wt[jt]=0}(function(){for(var S=[],T=0;T<32;T++)S.push(5);ht(S,wt,32);var A=[];for(T=0;T<=143;T++)A.push(8);for(;T<=255;T++)A.push(9);for(;T<=279;T++)A.push(7);for(;T<=287;T++)A.push(8);ht(A,ot,288)})();var Ft=function(){for(var T=ce?new Uint8Array(32768):[],A=0,N=0;A<oe.length-1;++A)for(;N<oe[A+1];++N)T[N]=A;for(;N<32768;++N)T[N]=29;var C=ce?new Uint8Array(259):[];for(A=0,N=0;A<z.length-1;++A)for(;N<z[A+1];++N)C[N]=A;function F(ee,Z){for(var ne=0;ne<ee.length;){var ie=Math.min(65535,ee.length-ne),Se=ne+ie==ee.length;for(Z.write_shift(1,+Se),Z.write_shift(2,ie),Z.write_shift(2,~ie&65535);ie-- >0;)Z[Z.l++]=ee[ne++]}return Z.l}function Q(ee,Z){for(var ne=0,ie=0,Se=ce?new Uint16Array(32768):[];ie<ee.length;){var Ce=Math.min(65535,ee.length-ie);if(Ce<10){for(ne=ke(Z,ne,+(ie+Ce==ee.length)),ne&7&&(ne+=8-(ne&7)),Z.l=ne/8|0,Z.write_shift(2,Ce),Z.write_shift(2,~Ce&65535);Ce-- >0;)Z[Z.l++]=ee[ie++];ne=Z.l*8;continue}ne=ke(Z,ne,+(ie+Ce==ee.length)+2);for(var Ie=0;Ce-- >0;){var Ne=ee[ie];Ie=(Ie<<5^Ne)&32767;var Le=-1,Je=0;if((Le=Se[Ie])&&(Le|=ie&-32768,Le>ie&&(Le-=32768),Le<ie))for(;ee[Le+Je]==ee[ie+Je]&&Je<250;)++Je;if(Je>2){Ne=C[Je],Ne<=22?ne=Ge(Z,ne,he[Ne+1]>>1)-1:(Ge(Z,ne,3),ne+=5,Ge(Z,ne,he[Ne-23]>>5),ne+=3);var Nt=Ne<8?0:Ne-4>>2;Nt>0&&(et(Z,ne,Je-z[Ne]),ne+=Nt),Ne=T[ie-Le],ne=Ge(Z,ne,he[Ne]>>3),ne-=3;var Tt=Ne<4?0:Ne-2>>1;Tt>0&&(et(Z,ne,ie-Le-oe[Ne]),ne+=Tt);for(var it=0;it<Je;++it)Se[Ie]=ie&32767,Ie=(Ie<<5^ee[ie])&32767,++ie;Ce-=Je-1}else Ne<=143?Ne=Ne+48:ne=Pe(Z,ne,1),ne=Ge(Z,ne,he[Ne]),Se[Ie]=ie&32767,++ie}ne=Ge(Z,ne,0)-1}return Z.l=(ne+7)/8|0,Z.l}return function(Z,ne){return Z.length<8?F(Z,ne):Q(Z,ne)}}();function Ke(S){var T=be(50+Math.floor(S.length*1.1)),A=Ft(S,T);return T.slice(0,A)}var vt=ce?new Uint16Array(32768):qe(32768),yt=ce?new Uint16Array(32768):qe(32768),mt=ce?new Uint16Array(128):qe(128),lr=1,wr=1;function Bt(S,T){var A=xe(S,T)+257;T+=5;var N=xe(S,T)+1;T+=5;var C=re(S,T)+4;T+=4;for(var F=0,Q=ce?new Uint8Array(19):qe(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,ne=ce?new Uint8Array(8):qe(8),ie=ce?new Uint8Array(8):qe(8),Se=Q.length,Ce=0;Ce<C;++Ce)Q[D[Ce]]=F=fe(S,T),Z<F&&(Z=F),ne[F]++,T+=3;var Ie=0;for(ne[0]=0,Ce=1;Ce<=Z;++Ce)ie[Ce]=Ie=Ie+ne[Ce-1]<<1;for(Ce=0;Ce<Se;++Ce)(Ie=Q[Ce])!=0&&(ee[Ce]=ie[Ie]++);var Ne=0;for(Ce=0;Ce<Se;++Ce)if(Ne=Q[Ce],Ne!=0){Ie=he[ee[Ce]]>>8-Ne;for(var Le=(1<<7-Ne)-1;Le>=0;--Le)mt[Ie|Le<<Ne]=Ne&7|Ce<<3}var Je=[];for(Z=1;Je.length<A+N;)switch(Ie=mt[L(S,T)],T+=Ie&7,Ie>>>=3){case 16:for(F=3+de(S,T),T+=2,Ie=Je[Je.length-1];F-- >0;)Je.push(Ie);break;case 17:for(F=3+fe(S,T),T+=3;F-- >0;)Je.push(0);break;case 18:for(F=11+L(S,T),T+=7;F-- >0;)Je.push(0);break;default:Je.push(Ie),Z<Ie&&(Z=Ie);break}var Nt=Je.slice(0,A),Tt=Je.slice(A);for(Ce=A;Ce<286;++Ce)Nt[Ce]=0;for(Ce=N;Ce<30;++Ce)Tt[Ce]=0;return lr=ht(Nt,vt,286),wr=ht(Tt,yt,30),T}function Wr(S,T){if(S[0]==3&&!(S[1]&3))return[Os(T),2];for(var A=0,N=0,C=ud(T||1<<18),F=0,Q=C.length>>>0,ee=0,Z=0;!(N&1);){if(N=fe(S,A),A+=3,N>>>1)N>>1==1?(ee=9,Z=5):(A=Bt(S,A),ee=lr,Z=wr);else{A&7&&(A+=8-(A&7));var ne=S[A>>>3]|S[(A>>>3)+1]<<8;if(A+=32,ne>0)for(!T&&Q<F+ne&&(C=Pt(C,F+ne),Q=C.length);ne-- >0;)C[F++]=S[A>>>3],A+=8;continue}for(;;){!T&&Q<F+32767&&(C=Pt(C,F+32767),Q=C.length);var ie=Y(S,A,ee),Se=N>>>1==1?ot[ie]:vt[ie];if(A+=Se&15,Se>>>=4,!(Se>>>8&255))C[F++]=Se;else{if(Se==256)break;Se-=257;var Ce=Se<8?0:Se-4>>2;Ce>5&&(Ce=0);var Ie=F+z[Se];Ce>0&&(Ie+=Y(S,A,Ce),A+=Ce),ie=Y(S,A,Z),Se=N>>>1==1?wt[ie]:yt[ie],A+=Se&15,Se>>>=4;var Ne=Se<4?0:Se-2>>1,Le=oe[Se];for(Ne>0&&(Le+=Y(S,A,Ne),A+=Ne),!T&&Q<Ie&&(C=Pt(C,Ie+100),Q=C.length);F<Ie;)C[F]=C[F-Le],++F}}}return T?[C,A+7>>>3]:[C.slice(0,F),A+7>>>3]}function _r(S,T){var A=S.slice(S.l||0),N=Wr(A,T);return S.l+=N[1],N[0]}function Sr(S,T){if(S)typeof console<"u"&&console.error(T);else throw new Error(T)}function ar(S,T){var A=S;Cr(A,0);var N=[],C=[],F={FileIndex:N,FullPaths:C};P(F,{root:T.root});for(var Q=A.length-4;(A[Q]!=80||A[Q+1]!=75||A[Q+2]!=5||A[Q+3]!=6)&&Q>=0;)--Q;A.l=Q+4,A.l+=4;var ee=A.read_shift(2);A.l+=6;var Z=A.read_shift(4);for(A.l=Z,Q=0;Q<ee;++Q){A.l+=20;var ne=A.read_shift(4),ie=A.read_shift(4),Se=A.read_shift(2),Ce=A.read_shift(2),Ie=A.read_shift(2);A.l+=8;var Ne=A.read_shift(4),Le=c(A.slice(A.l+Se,A.l+Se+Ce));A.l+=Se+Ce+Ie;var Je=A.l;A.l=Ne+4,ha(A,ne,ie,F,Le),A.l=Je}return F}function ha(S,T,A,N,C){S.l+=2;var F=S.read_shift(2),Q=S.read_shift(2),ee=o(S);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var Z=S.read_shift(4),ne=S.read_shift(4),ie=S.read_shift(4),Se=S.read_shift(2),Ce=S.read_shift(2),Ie="",Ne=0;Ne<Se;++Ne)Ie+=String.fromCharCode(S[S.l++]);if(Ce){var Le=c(S.slice(S.l,S.l+Ce));(Le[21589]||{}).mt&&(ee=Le[21589].mt),((C||{})[21589]||{}).mt&&(ee=C[21589].mt)}S.l+=Ce;var Je=S.slice(S.l,S.l+ne);switch(Q){case 8:Je=B(S,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var Nt=!1;F&8&&(Z=S.read_shift(4),Z==134695760&&(Z=S.read_shift(4),Nt=!0),ne=S.read_shift(4),ie=S.read_shift(4)),ne!=T&&Sr(Nt,"Bad compressed size: "+T+" != "+ne),ie!=A&&Sr(Nt,"Bad uncompressed size: "+A+" != "+ie),W(N,Ie,Je,{unsafe:!0,mt:ee})}function pr(S,T){var A=T||{},N=[],C=[],F=be(1),Q=A.compression?8:0,ee=0,Z=0,ne=0,ie=0,Se=0,Ce=S.FullPaths[0],Ie=Ce,Ne=S.FileIndex[0],Le=[],Je=0;for(Z=1;Z<S.FullPaths.length;++Z)if(Ie=S.FullPaths[Z].slice(Ce.length),Ne=S.FileIndex[Z],!(!Ne.size||!Ne.content||Ie=="Sh33tJ5")){var Nt=ie,Tt=be(Ie.length);for(ne=0;ne<Ie.length;++ne)Tt.write_shift(1,Ie.charCodeAt(ne)&127);Tt=Tt.slice(0,Tt.l),Le[Se]=av.buf(Ne.content,0);var it=Ne.content;Q==8&&(it=E(it)),F=be(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,ee),F.write_shift(2,Q),Ne.mt?i(F,Ne.mt):F.write_shift(4,0),F.write_shift(-4,Le[Se]),F.write_shift(4,it.length),F.write_shift(4,Ne.content.length),F.write_shift(2,Tt.length),F.write_shift(2,0),ie+=F.length,N.push(F),ie+=Tt.length,N.push(Tt),ie+=it.length,N.push(it),F=be(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,ee),F.write_shift(2,Q),F.write_shift(4,0),F.write_shift(-4,Le[Se]),F.write_shift(4,it.length),F.write_shift(4,Ne.content.length),F.write_shift(2,Tt.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Nt),Je+=F.l,C.push(F),Je+=Tt.length,C.push(Tt),++Se}return F=be(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,Se),F.write_shift(2,Se),F.write_shift(4,Je),F.write_shift(4,ie),F.write_shift(2,0),yr([yr(N),yr(C),F])}var ia={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qr(S,T){if(S.ctype)return S.ctype;var A=S.name||"",N=A.match(/\.([^\.]+)$/);return N&&ia[N[1]]||T&&(N=(A=T).match(/[\.\\]([^\.\\])+$/),N&&ia[N[1]])?ia[N[1]]:"application/octet-stream"}function Zr(S){for(var T=Ri(S),A=[],N=0;N<T.length;N+=76)A.push(T.slice(N,N+76));return A.join(`\r
`)+`\r
`}function Ea(S){var T=S.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var ie=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});T=T.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),T.charAt(0)==`
`&&(T="=0D"+T.slice(1)),T=T.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],N=T.split(`\r
`),C=0;C<N.length;++C){var F=N[C];if(F.length==0){A.push("");continue}for(var Q=0;Q<F.length;){var ee=76,Z=F.slice(Q,Q+ee);Z.charAt(ee-1)=="="?ee--:Z.charAt(ee-2)=="="?ee-=2:Z.charAt(ee-3)=="="&&(ee-=3),Z=F.slice(Q,Q+ee),Q+=ee,Q<F.length&&(Z+="="),A.push(Z)}}return A.join(`\r
`)}function Wt(S){for(var T=[],A=0;A<S.length;++A){for(var N=S[A];A<=S.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+S[++A];T.push(N)}for(var C=0;C<T.length;++C)T[C]=T[C].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return ca(T.join(`\r
`))}function Ut(S,T,A){for(var N="",C="",F="",Q,ee=0;ee<10;++ee){var Z=T[ee];if(!Z||Z.match(/^\s*$/))break;var ne=Z.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":N=ne[2].trim();break;case"content-type":F=ne[2].trim();break;case"content-transfer-encoding":C=ne[2].trim();break}}switch(++ee,C.toLowerCase()){case"base64":Q=ca(ua(T.slice(ee).join("")));break;case"quoted-printable":Q=Wt(T.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var ie=W(S,N.slice(A.length),Q,{unsafe:!0});F&&(ie.ctype=F)}function pt(S,T){if(ae(S.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=T&&T.root||"",N=(xt&&Buffer.isBuffer(S)?S.toString("binary"):ae(S)).split(`\r
`),C=0,F="";for(C=0;C<N.length;++C)if(F=N[C],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),A||(A=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),F.slice(0,A.length)!=A););var Q=(N[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var ee="--"+(Q[1]||""),Z=[],ne=[],ie={FileIndex:Z,FullPaths:ne};P(ie);var Se,Ce=0;for(C=0;C<N.length;++C){var Ie=N[C];Ie!==ee&&Ie!==ee+"--"||(Ce++&&Ut(ie,N.slice(Se,C),A),Se=C)}return ie}function _t(S,T){var A=T||{},N=A.boundary||"SheetJS";N="------="+N;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],F=S.FullPaths[0],Q=F,ee=S.FileIndex[0],Z=1;Z<S.FullPaths.length;++Z)if(Q=S.FullPaths[Z].slice(F.length),ee=S.FileIndex[Z],!(!ee.size||!ee.content||Q=="Sh33tJ5")){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Je){return"_x"+Je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Je){return"_u"+Je.charCodeAt(0).toString(16)+"_"});for(var ne=ee.content,ie=xt&&Buffer.isBuffer(ne)?ne.toString("binary"):ae(ne),Se=0,Ce=Math.min(1024,ie.length),Ie=0,Ne=0;Ne<=Ce;++Ne)(Ie=ie.charCodeAt(Ne))>=32&&Ie<128&&++Se;var Le=Se>=Ce*4/5;C.push(N),C.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+Q),C.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),C.push("Content-Type: "+Qr(ee,Q)),C.push(""),C.push(Le?Ea(ie):Zr(ie))}return C.push(N+`--\r
`),C.join(`\r
`)}function St(S){var T={};return P(T,S),T}function W(S,T,A,N){var C=N&&N.unsafe;C||P(S);var F=!C&&Ye.find(S,T);if(!F){var Q=S.FullPaths[0];T.slice(0,Q.length)==Q?Q=T:(Q.slice(-1)!="/"&&(Q+="/"),Q=(Q+T).replace("//","/")),F={name:s(T),type:2},S.FileIndex.push(F),S.FullPaths.push(Q),C||Ye.utils.cfb_gc(S)}return F.content=A,F.size=A?A.length:0,N&&(N.CLSID&&(F.clsid=N.CLSID),N.mt&&(F.mt=N.mt),N.ct&&(F.ct=N.ct)),F}function me(S,T){P(S);var A=Ye.find(S,T);if(A){for(var N=0;N<S.FileIndex.length;++N)if(S.FileIndex[N]==A)return S.FileIndex.splice(N,1),S.FullPaths.splice(N,1),!0}return!1}function we(S,T,A){P(S);var N=Ye.find(S,T);if(N){for(var C=0;C<S.FileIndex.length;++C)if(S.FileIndex[C]==N)return S.FileIndex[C].name=s(A),S.FullPaths[C]=A,!0}return!1}function Ae(S){G(S,!0)}return t.find=se,t.read=U,t.parse=u,t.write=He,t.writeFile=$e,t.utils={cfb_new:St,cfb_add:W,cfb_del:me,cfb_mov:we,cfb_gc:Ae,ReadShift:Ni,CheckField:Gf,prep_blob:Cr,bconcat:yr,use_zlib:k,_deflateRaw:Ke,_inflateRaw:_r,consts:Te},t}();let Cs;function sv(e){Cs=e}function nv(e){return typeof e=="string"?Qi(e):Array.isArray(e)?C1(e):e}function eo(e,t,r){if(typeof Cs<"u"&&Cs.writeFileSync)return r?Cs.writeFileSync(e,t,r):Cs.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Qi(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Ka(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([nv(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Bs(t)),c.write(t),c.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function iv(e){if(typeof Cs<"u")return Cs.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function Yt(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function yd(e,t){for(var r=[],a=Yt(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function oc(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function cc(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function ov(e){for(var t=[],r=Yt(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var qo=new Date(1899,11,30,0,0,0);function xr(e,t){var r=e.getTime();t&&(r-=1462*24*60*60*1e3);var a=qo.getTime()+(e.getTimezoneOffset()-qo.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var Af=new Date,cv=qo.getTime()+(Af.getTimezoneOffset()-qo.getTimezoneOffset())*6e4,bd=Af.getTimezoneOffset();function lc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cv),t.getTimezoneOffset()!==bd&&t.setTime(t.getTime()+(t.getTimezoneOffset()-bd)*6e4),t}function lv(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var wd=new Date("2017-02-19T19:06:09.000Z"),Cf=isNaN(wd.getFullYear())?new Date("2/19/17"):wd,dv=Cf.getFullYear()==2017;function zt(e,t){var r=new Date(e);if(dv)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Cf.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function on(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ka(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ka(gf(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ka(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ka(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Lt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Lt(e[r]));return t}function Xt(e,t){for(var r="";r.length<t;)r+=e;return r}function La(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var uv=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kn(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&uv.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var fv=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],c=1;c<i.length;++c)o.push(s),o.push(i[c]);return o}}();function Ff(e){return e?e.content&&e.type?on(e.content,!0):e.data?$n(e.data):e.asNodeBuffer&&xt?$n(e.asNodeBuffer().toString("binary")):e.asBinary?$n(e.asBinary()):e._data&&e._data.getContent?$n(on(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Pf(e){if(!e)return null;if(e.data)return Ro(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Ro(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function hv(e){return e&&e.name.slice(-4)===".bin"?Pf(e):Ff(e)}function wa(e,t){for(var r=e.FullPaths||Yt(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Bl(e,t){var r=wa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ir(e,t,r){if(!r)return hv(Bl(e,t));if(!t)return null;try{return ir(e,t)}catch{return null}}function la(e,t,r){if(!r)return Ff(Bl(e,t));if(!t)return null;try{return la(e,t)}catch{return null}}function Of(e,t,r){if(!r)return Pf(Bl(e,t));if(!t)return null;try{return Of(e,t)}catch{return null}}function _d(e){for(var t=e.FullPaths||Yt(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function ut(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return xt?a=hs(r):a=F1(r),Ye.utils.cfb_add(e,t,a)}Ye.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ul(){return Ye.utils.cfb_new()}function Df(e,t){switch(t.type){case"base64":return Ye.read(e,{type:"base64"});case"binary":return Ye.read(e,{type:"binary"});case"buffer":case"array":return Ye.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function vi(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mv=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Sd=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,xv=/<[^>]*>/g,zr=rr.match(Sd)?Sd:xv,pv=/<\w*:/,gv=/<(\/?)\w+:/;function nt(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(mv),c=0,l="",d=0,u="",f="",m=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(m=(s=f.charCodeAt(i+1))==34||s==39?1:0,l=f.slice(i+1+m,f.length-m),c=0;c!=u.length&&u.charCodeAt(c)!==58;++c);if(c===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=l,r||(a[u.toLowerCase()]=l);else{var h=(c===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(c+1);if(a[h]&&u.slice(c-3,c)=="ext")continue;a[h]=l,r||(a[h.toLowerCase()]=l)}}return a}function Qa(e){return e.replace(gv,"<$1")}var If={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ql=oc(If),At=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(c,l){return If[c]||String.fromCharCode(parseInt(l,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,l){return String.fromCharCode(parseInt(l,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),$l=/[&<>'"]/g,vv=/[\u0000-\u0008\u000b-\u001f]/g;function It(e){var t=e+"";return t.replace($l,function(r){return ql[r]}).replace(vv,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Nd(e){return It(e).replace(/ /g,"_x0020_")}var Rf=/[\u0000-\u001f]/g;function Hl(e){var t=e+"";return t.replace($l,function(r){return ql[r]}).replace(/\n/g,"<br/>").replace(Rf,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function yv(e){var t=e+"";return t.replace($l,function(r){return ql[r]}).replace(Rf,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var kd=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function bv(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ic(e){for(var t="",r=0,a=0,s=0,i=0,o=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),c=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function jd(e){var t=Os(2*e.length),r,a,s=1,i=0,o=0,c;for(a=0;a<e.length;a+=s)s=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),s=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Ed(e){return hs(e,"binary").toString("utf8")}var yo="foo bar baz",Rt=xt&&(Ed(yo)==Ic(yo)&&Ed||jd(yo)==Ic(yo)&&jd)||Ic,Ka=xt?function(e){return hs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Mi=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),Lf=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),wv=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_v=/<\/?(?:vt:)?variant>/g,Sv=/<(?:vt:)([^>]*)>([\s\S]*)</;function Td(e,t){var r=nt(e),a=e.match(wv(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var o=i.replace(_v,"").match(Sv);o&&s.push({v:Rt(o[2]),t:o[1]})}),s}var Mf=/(^\s|\s$|\n)/;function Fr(e,t){return"<"+e+(t.match(Mf)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bi(e){return Yt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Re(e,t,r){return"<"+e+(r!=null?Bi(r):"")+(t!=null?(t.match(Mf)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fl(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Nv(e,t){switch(typeof e){case"string":var r=Re("vt:lpwstr",It(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return Re((e|0)==e?"vt:i4":"vt:r8",It(String(e)));case"boolean":return Re("vt:bool",e?"true":"false")}if(e instanceof Date)return Re("vt:filetime",fl(e));throw new Error("Unable to serialize "+e)}function zl(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Rt(Bs(Rl(e)));throw new Error("Bad input format: expected Buffer or string")}var Ui=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,mr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},pn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kv(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function jv(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=a?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var Ad=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},Cd=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:hs(t)})):Ad(e)}:Ad,Fd=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(ds(e,s)));return a.join("").replace(qr,"")},dc=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(qr,""):Fd(e,t,r)}:Fd,Pd=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},Bf=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Pd(e,t,r)}:Pd,Od=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(qn(e,s)));return a.join("")},ai=xt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):Od(t,r,a)}:Od,Uf=function(e,t){var r=vr(e,t);return r>0?ai(e,t+4,t+4+r-1):""},Wl=Uf,qf=function(e,t){var r=vr(e,t);return r>0?ai(e,t+4,t+4+r-1):""},Vl=qf,$f=function(e,t){var r=2*vr(e,t);return r>0?ai(e,t+4,t+4+r-1):""},Gl=$f,Hf=function(t,r){var a=vr(t,r);return a>0?dc(t,r+4,r+4+a):""},Xl=Hf,zf=function(e,t){var r=vr(e,t);return r>0?ai(e,t+4,t+4+r):""},Kl=zf,Wf=function(e,t){return kv(e,t)},$o=Wf,Jl=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(Wl=function(t,r){if(!Buffer.isBuffer(t))return Uf(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Vl=function(t,r){if(!Buffer.isBuffer(t))return qf(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Gl=function(t,r){if(!Buffer.isBuffer(t))return $f(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Xl=function(t,r){if(!Buffer.isBuffer(t))return Hf(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Kl=function(t,r){if(!Buffer.isBuffer(t))return zf(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},$o=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Wf(t,r)},Jl=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function Vf(){dc=function(e,t,r){return Et.utils.decode(1200,e.slice(t,r)).replace(qr,"")},ai=function(e,t,r){return Et.utils.decode(65001,e.slice(t,r))},Wl=function(e,t){var r=vr(e,t);return r>0?Et.utils.decode(sn,e.slice(t+4,t+4+r-1)):""},Vl=function(e,t){var r=vr(e,t);return r>0?Et.utils.decode(da,e.slice(t+4,t+4+r-1)):""},Gl=function(e,t){var r=2*vr(e,t);return r>0?Et.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Xl=function(e,t){var r=vr(e,t);return r>0?Et.utils.decode(1200,e.slice(t+4,t+4+r)):""},Kl=function(e,t){var r=vr(e,t);return r>0?Et.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Et<"u"&&Vf();var qn=function(e,t){return e[t]},ds=function(e,t){return e[t+1]*256+e[t]},Ev=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},vr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Qs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Tv=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ni(e,t){var r="",a,s,i=[],o,c,l,d;switch(t){case"dbcs":if(d=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ds(this,d)),d+=2;e*=2;break;case"utf8":r=ai(this,this.l,this.l+e);break;case"utf16le":e*=2,r=dc(this,this.l,this.l+e);break;case"wstr":if(typeof Et<"u")r=Et.utils.decode(da,this.slice(this.l,this.l+2*e));else return Ni.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Wl(this,this.l),e=4+vr(this,this.l);break;case"lpstr-cp":r=Vl(this,this.l),e=4+vr(this,this.l);break;case"lpwstr":r=Gl(this,this.l),e=4+2*vr(this,this.l);break;case"lpp4":e=4+vr(this,this.l),r=Xl(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+vr(this,this.l),r=Kl(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=qn(this,this.l+e++))!==0;)i.push(pi(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=ds(this,this.l+e))!==0;)i.push(pi(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(d)!==-1)return o=qn(this,d),this.l=d+1,c=Ni.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(pi(ds(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":if(typeof Et<"u"){r=Et.utils.decode(da,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",d=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(d)!==-1)return o=qn(this,d),this.l=d+1,c=Ni.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(pi(qn(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=qn(this,this.l),this.l++,a;case 2:return a=(t==="i"?Ev:ds)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Qs:Tv)(this,this.l),this.l+=4,a):(s=vr(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=$o(this,this.l):s=$o([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=Bf(this,this.l,e);break}}return this.l+=e,r}var Av=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Cv=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Fv=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Pv(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)Fv(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){if(typeof Et<"u"&&sn==874)for(s=0;s!=t.length;++s){var i=Et.utils.encode(sn,t.charAt(s));this[this.l+s]=i[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var c=t.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Av(this,t,this.l);break;case 8:if(a=8,r==="f"){jv(this,t,this.l);break}case 16:break;case-4:a=4,Cv(this,t,this.l);break}return this.l+=a,this}function Gf(e,t){var r=Bf(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Cr(e,t){e.l=t,e.read_shift=Ni,e.chk=Gf,e.write_shift=Pv}function Hr(e,t){e.l+=t}function be(e){var t=Os(e);return Cr(t,0),t}function ms(e,t,r){if(e){var a,s,i;Cr(e,e.l||0);for(var o=e.length,c=0,l=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var d=Vi[c]||Vi[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;l=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=l,t(u,d,c))return}}}function sa(){var e=[],t=xt?256:2048,r=function(d){var u=be(d);return Cr(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),yr(e)},c=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:c,end:o,_bufs:e}}function je(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=Vi[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var c=0;c!=4;++c)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Jl(r)&&e.push(r)}}function ki(e,t,r){var a=Lt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function Dd(e,t,r){var a=Lt(e);return a.s=ki(a.s,t.s,r),a.e=ki(a.e,t.s,r),a}function ji(e,t){if(e.cRel&&e.c<0)for(e=Lt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Lt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=at(e);return!e.cRel&&e.cRel!=null&&(r=Iv(r)),!e.rRel&&e.rRel!=null&&(r=Ov(r)),r}function Rc(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Kt(e.s.r)+":"+(e.e.rRel?"":"$")+Kt(e.e.r):ji(e.s,t.biff)+":"+ji(e.e,t.biff)}function Yl(e){return parseInt(Dv(e),10)-1}function Kt(e){return""+(e+1)}function Ov(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Dv(e){return e.replace(/\$(\d+)$/,"$1")}function Ql(e){for(var t=Rv(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Iv(e){return e.replace(/^([A-Z])/,"$$$1")}function Rv(e){return e.replace(/^\$([A-Z])/,"$1")}function Lv(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Vt(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function at(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Yr(e){var t=e.indexOf(":");return t==-1?{s:Vt(e),e:Vt(e)}:{s:Vt(e.slice(0,t)),e:Vt(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=at(e)),typeof t!="string"&&(t=at(t)),e==t?e:e+":"+t)}function kt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function Id(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fa(e.z,r?xr(t):t)}catch{}try{return e.w=fa((e.XF||{}).numFmtId||(r?14:0),r?xr(t):t)}catch{return""+t}}function Ya(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?xs[e.v]||e.v:t==null?Id(e,e.v):Id(e,t))}function Us(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Xf(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),o=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var l=typeof a.origin=="string"?Vt(a.origin):a.origin;o=l.r,c=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=kt(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[f].length;++m)if(!(typeof t[f][m]>"u")){var h={v:t[f][m]},g=o+f,p=c+m;if(d.s.r>g&&(d.s.r=g),d.s.c>p&&(d.s.c=p),d.e.r<g&&(d.e.r=g),d.e.c<p&&(d.e.c=p),t[f][m]&&typeof t[f][m]=="object"&&!Array.isArray(t[f][m])&&!(t[f][m]instanceof Date))h=t[f][m];else if(Array.isArray(h.v)&&(h.f=t[f][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(a.nullError)h.t="e",h.v=0;else if(a.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=a.dateNF||Ze[14],a.cellDates?(h.t="d",h.w=fa(h.z,xr(h.v))):(h.t="n",h.v=xr(h.v),h.w=fa(h.z,h.v))):h.t="s";if(s)i[g]||(i[g]=[]),i[g][p]&&i[g][p].z&&(h.z=i[g][p].z),i[g][p]=h;else{var x=at({c:p,r:g});i[x]&&i[x].z&&(h.z=i[x].z),i[x]=h}}}return d.s.c<1e7&&(i["!ref"]=dt(d)),i}function si(e,t){return Xf(null,e,t)}function Mv(e){return e.read_shift(4,"i")}function Ma(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function $r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function br(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Bv(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Uv(e,t){return t||(t=be(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0),t}function Zl(e,t){var r=e.l,a=e.read_shift(1),s=$r(e),i=[],o={t:s,h:s};if(a&1){for(var c=e.read_shift(4),l=0;l!=c;++l)i.push(Bv(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function qv(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),br(e.t,t),r?t.slice(0,t.l):t}var $v=Zl;function Hv(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),br(e.t,t),t.write_shift(4,1),Uv({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function ja(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gn(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vn(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function yn(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var zv=$r,Kf=br;function e0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Ho(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Wv=$r,hl=e0,t0=Ho;function r0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?$o([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Qs(t,0)>>2;return r?s/100:s}function Jf(e,t){t==null&&(t=be(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?a=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Yf(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Vv(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var bn=Yf,ni=Vv;function Br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function cn(e,t){return(t||be(8)).write_shift(8,e,"f")}function Gv(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),l=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=en[s];d&&(t.rgb=$i(d));break;case 2:t.rgb=$i([o,c,l]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function zo(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Xv(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Kv(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Qf(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Jv(e){return Qf(e,1)}function Yv(e){return Qf(e,2)}var a0=2,ra=3,bo=11,Rd=12,Wo=19,wo=64,Qv=65,Zv=71,e2=4108,t2=4126,gr=80,Zf=81,r2=[gr,Zf],ml={1:{n:"CodePage",t:a0},2:{n:"Category",t:gr},3:{n:"PresentationFormat",t:gr},4:{n:"ByteCount",t:ra},5:{n:"LineCount",t:ra},6:{n:"ParagraphCount",t:ra},7:{n:"SlideCount",t:ra},8:{n:"NoteCount",t:ra},9:{n:"HiddenCount",t:ra},10:{n:"MultimediaClipCount",t:ra},11:{n:"ScaleCrop",t:bo},12:{n:"HeadingPairs",t:e2},13:{n:"TitlesOfParts",t:t2},14:{n:"Manager",t:gr},15:{n:"Company",t:gr},16:{n:"LinksUpToDate",t:bo},17:{n:"CharacterCount",t:ra},19:{n:"SharedDoc",t:bo},22:{n:"HyperlinksChanged",t:bo},23:{n:"AppVersion",t:ra,p:"version"},24:{n:"DigSig",t:Qv},26:{n:"ContentType",t:gr},27:{n:"ContentStatus",t:gr},28:{n:"Language",t:gr},29:{n:"Version",t:gr},255:{},2147483648:{n:"Locale",t:Wo},2147483651:{n:"Behavior",t:Wo},1919054434:{}},xl={1:{n:"CodePage",t:a0},2:{n:"Title",t:gr},3:{n:"Subject",t:gr},4:{n:"Author",t:gr},5:{n:"Keywords",t:gr},6:{n:"Comments",t:gr},7:{n:"Template",t:gr},8:{n:"LastAuthor",t:gr},9:{n:"RevNumber",t:gr},10:{n:"EditTime",t:wo},11:{n:"LastPrinted",t:wo},12:{n:"CreatedDate",t:wo},13:{n:"ModifiedDate",t:wo},14:{n:"PageCount",t:ra},15:{n:"WordCount",t:ra},16:{n:"CharCount",t:ra},17:{n:"Thumbnail",t:Zv},18:{n:"Application",t:gr},19:{n:"DocSecurity",t:ra},255:{},2147483648:{n:"Locale",t:Wo},2147483651:{n:"Behavior",t:Wo},1919054434:{}},Ld={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},a2=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function s2(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var n2=s2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),en=Lt(n2),xs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},eh={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_o={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function s0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function i2(e){var t=s0();if(!e||!e.match)return t;var r={};if((e.match(zr)||[]).forEach(function(a){var s=nt(a);switch(s[0].replace(pv,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[pl[s.ContentType]]!==void 0&&t[pl[s.ContentType]].push(s.PartName);break}}),t.xmlns!==mr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function th(e,t){var r=ov(pl),a=[],s;a[a.length]=rr,a[a.length]=Re("Types",null,{xmlns:mr.CT,"xmlns:xsd":mr.xsd,"xmlns:xsi":mr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Re("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(s=e[l][0],a[a.length]=Re("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:_o[l][t.bookType]||_o[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(d){a[a.length]=Re("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:_o[l][t.bookType]||_o[l].xlsx})})},c=function(l){(e[l]||[]).forEach(function(d){a[a.length]=Re("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[l][0]})})};return i("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qi(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ei(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(zr)||[]).forEach(function(s){var i=nt(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:vi(i.Target,t);r[c]=o,a[i.Id]=o}}),r["!id"]=a,r}function Wn(e){var t=[rr,Re("Relationships",null,{xmlns:mr.RELS})];return Yt(e["!id"]).forEach(function(r){t[t.length]=Re("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Dt(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,i?s.TargetMode=i:[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var o2="application/vnd.oasis.opendocument.spreadsheet";function c2(e,t){for(var r=zl(e),a,s;a=Ui.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=nt(a[0],!1),s.path=="/"&&s.type!==o2)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function l2(e){var t=[rr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Md(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function d2(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function u2(e){var t=[rr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Md(e[r][0],e[r][1])),t.push(d2("",e[r][0]));return t.push(Md("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function rh(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ii.version+"</meta:generator></office:meta></office:document-meta>"}var Na=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],f2=function(){for(var e=new Array(Na.length),t=0;t<Na.length;++t){var r=Na[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function ah(e){var t={};e=Rt(e);for(var r=0;r<Na.length;++r){var a=Na[r],s=e.match(f2[r]);s!=null&&s.length>0&&(t[a[1]]=At(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=zt(t[a[1]]))}return t}function Lc(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=It(t),a[a.length]=r?Re(e,t,r):Fr(e,t))}function sh(e,t){var r=t||{},a=[rr,Re("cp:coreProperties",null,{"xmlns:cp":mr.CORE_PROPS,"xmlns:dc":mr.dc,"xmlns:dcterms":mr.dcterms,"xmlns:dcmitype":mr.dcmitype,"xmlns:xsi":mr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Lc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fl(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&Lc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fl(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Na.length;++i){var o=Na[i],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Lc(o[0],c,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var tn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],nh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ih(e,t,r,a){var s=[];if(typeof e=="string")s=Td(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?Td(t,a).map(function(u){return u.v}):t,c=0,l=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(l=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(c,c+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(c,c+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(c,c+l);break}c+=l}}function h2(e,t,r){var a={};return t||(t={}),e=Rt(e),tn.forEach(function(s){var i=(e.match(Mi(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=At(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&ih(a.HeadingPairs,a.TitlesOfParts,t,r),t}function oh(e){var t=[],r=Re;return e||(e={}),e.Application="SheetJS",t[t.length]=rr,t[t.length]=Re("Properties",null,{xmlns:mr.EXT_PROPS,"xmlns:vt":mr.vt}),tn.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=It(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+It(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var m2=/<[^>]+>[^<]*/g;function x2(e,t){var r={},a="",s=e.match(m2);if(s)for(var i=0;i!=s.length;++i){var o=s[i],c=nt(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=At(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),d=l[0].slice(4),u=l[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=At(u);break;case"bool":r[a]=$t(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=zt(u);break;case"cy":case"error":r[a]=At(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function ch(e){var t=[rr,Re("Properties",null,{xmlns:mr.CUST_PROPS,"xmlns:vt":mr.vt})];if(!e)return t.join("");var r=1;return Yt(e).forEach(function(s){++r,t[t.length]=Re("property",Nv(e[s],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:It(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Mc;function p2(e,t,r){Mc||(Mc=oc(gl)),t=Mc[t]||t,e[t]=r}function g2(e,t){var r=[];return Yt(gl).map(function(a){for(var s=0;s<Na.length;++s)if(Na[s][1]==a)return Na[s];for(s=0;s<tn.length;++s)if(tn[s][1]==a)return tn[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Fr(gl[a[1]]||a[1],s))}}),Re("DocumentProperties",r.join(""),{xmlns:oa.o})}function v2(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&Yt(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Na.length;++o)if(i==Na[o][1])return;for(o=0;o<tn.length;++o)if(i==tn[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var c=e[i],l="string";typeof c=="number"?(l="float",c=String(c)):c===!0||c===!1?(l="boolean",c=c?"1":"0"):c=String(c),s.push(Re(Nd(i),c,{"dt:dt":l}))}}),t&&Yt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),s.push(Re(Nd(i),o,{"dt:dt":c}))}}),"<"+a+' xmlns="'+oa.o+'">'+s.join("")+"</"+a+">"}function n0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function y2(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var o=be(8);return o.write_shift(4,a),o.write_shift(4,s),o}function lh(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function dh(e,t,r){var a=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(a.length+1&3)&3),a}function uh(e,t,r){return t===31?dh(e):lh(e,t,r)}function vl(e,t,r){return uh(e,t,r===!1?0:4)}function b2(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return uh(e,t,0)}function w2(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(qr,""),e.l-s&2&&(e.l+=2)}return r}function _2(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(qr,"");return r}function S2(e){var t=e.l,r=Vo(e,Zf);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=Vo(e,ra);return[r,a]}function N2(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(S2(e));return r}function Bd(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(qr,"").replace(gi,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),a}function fh(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function k2(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Vo(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==Rd&&a!==t&&r2.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===Rd?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return lh(e,a,4).replace(qr,"");case 31:return dh(e);case 64:return n0(e);case 65:return fh(e);case 71:return k2(e);case 80:return vl(e,a,!i.raw).replace(qr,"");case 81:return b2(e,a).replace(qr,"");case 4108:return N2(e);case 4126:case 4127:return a==4127?w2(e):_2(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Ud(e,t){var r=be(4),a=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=be(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=y2(t);break;case 31:case 80:for(a=be(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return yr([r,a])}function qd(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0,c=0,l=-1,d={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(_,v){return _[1]-v[1]});var m={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var h=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],h=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(h=!1,e.l=i[o][1]),h)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var g=t[i[o][0]];if(m[g.n]=Vo(e,g.t,{raw:!0}),g.p==="version"&&(m[g.n]=String(m[g.n]>>16)+"."+("0000"+String(m[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(m[g.n]){case 0:m[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Sa(c=m[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[g.n])}}else if(i[o][0]===1){if(c=m.CodePage=Vo(e,a0),Sa(c),l!==-1){var p=e.l;e.l=i[l][1],d=Bd(e,c),e.l=p}}else if(i[o][0]===0){if(c===0){l=o,e.l=i[o+1][1];continue}d=Bd(e,c)}else{var x=d[i[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=fh(e);break;case 30:e.l+=4,w=vl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=vl(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=tr(e,4);break;case 64:e.l+=4,w=zt(n0(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[x]=w}}return e.l=r+a,m}var hh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function j2(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function $d(e,t,r){var a=be(8),s=[],i=[],o=8,c=0,l=be(8),d=be(8);if(l.write_shift(4,2),l.write_shift(4,1200),d.write_shift(4,1),i.push(l),s.push(d),o+=8+l.length,!t){d=be(8),d.write_shift(4,0),s.unshift(d);var u=[be(4)];for(u[0].write_shift(4,e.length),c=0;c<e.length;++c){var f=e[c][0];for(l=be(4+4+2*(f.length+1)+(f.length%2?0:2)),l.write_shift(4,c+2),l.write_shift(4,f.length+1),l.write_shift(0,f,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=yr(u),i.unshift(l),o+=8+l.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(hh.indexOf(e[c][0])>-1||nh.indexOf(e[c][0])>-1)&&e[c][1]!=null){var m=e[c][1],h=0;if(t){h=+t[e[c][0]];var g=r[h];if(g.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}l=Ud(g.t,m)}else{var x=j2(m);x==-1&&(x=31,m=String(m)),l=Ud(x,m)}i.push(l),d=be(8),d.write_shift(4,t?h:2+c),s.push(d),o+=8+l.length}var w=8*(i.length+1);for(c=0;c<i.length;++c)s[c].write_shift(4,w),w+=i[c].length;return a.write_shift(4,o),a.write_shift(4,i.length),yr([a].concat(s).concat(i))}function Hd(e,t,r){var a=e.content;if(!a)return{};Cr(a,0);var s,i,o,c,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==Ye.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),c=a.read_shift(4),s===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);s===2&&(o=a.read_shift(16),l=a.read_shift(4));var f=qd(a,t),m={SystemIdentifier:d};for(var h in f)m[h]=f[h];if(m.FMTID=i,s===1)return m;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);var g;try{g=qd(a,null)}catch{}for(h in g)m[h]=g[h];return m.FMTID=[i,o],m}function zd(e,t,r,a,s,i){var o=be(s?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ye.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var l=$d(e,r,a);if(c.push(l),s){var d=$d(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+l.length),c.push(d)}return yr(c)}function Ns(e,t){return e.read_shift(t),null}function E2(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function T2(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function tr(e,t){return e.read_shift(t)===1}function Jr(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function or(e){return e.read_shift(2,"u")}function _a(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function mh(e,t){return T2(e,t,or)}function A2(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function xh(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function to(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont",i=da;if(r&&r.biff>=8&&(da=1200),!r||r.biff==8){var o=e.read_shift(1);o&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var c=a?e.read_shift(a,s):"";return da=i,c}function C2(e){var t=da;da=1200;var r=e.read_shift(2),a=e.read_shift(1),s=a&4,i=a&8,o=1+(a&1),c=0,l,d={};i&&(c=e.read_shift(2)),s&&(l=e.read_shift(4));var u=o==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,u);return i&&(e.l+=4*c),s&&(e.l+=l),d.t=f,i||(d.raw="<t>"+d.t+"</t>",d.r=d.t),da=t,d}function F2(e){var t=e.t||"",r=be(3+0);r.write_shift(2,t.length),r.write_shift(1,1);var a=be(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return yr(s)}function ln(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function ro(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):ln(e,a,r)}function wn(e,t,r){if(r.biff>5)return ro(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ph(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function P2(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function O2(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(qr,"");return a&&(e.l+=24),s}function D2(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(qr,"");return r+o}function I2(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return O2(e);case"0303000000000000c000000000000046":return D2(e);default:throw new Error("Unsupported Moniker "+r)}}function So(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(qr,""):"";return r}function Wd(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function R2(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,o,c,l,d="",u,f;s&16&&(i=So(e,r-e.l)),s&128&&(o=So(e,r-e.l)),(s&257)===257&&(c=So(e,r-e.l)),(s&257)===1&&(l=I2(e,r-e.l)),s&8&&(d=So(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=n0(e)),e.l=r;var m=o||c||l||"";m&&d&&(m+="#"+d),m||(m="#"+d),s&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function L2(e){var t=be(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),Wd(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var c=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&Wd(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;a.slice(l*3,l*3+3)=="../"||a.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,a.length-3*l+1),r=0;r<a.length-3*l;++r)t.write_shift(1,a.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function gh(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function vh(e,t){var r=gh(e);return r[3]=0,r}function Za(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function dn(e,t,r,a){return a||(a=be(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function M2(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function B2(e,t,r){return t===0?"":wn(e,t,r)}function U2(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,i,o]}function yh(e){var t=e.read_shift(2),r=r0(e);return[t,r]}function q2(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=to(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function uc(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function bh(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function wh(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var $2=wh;function _h(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function H2(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function z2(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ir(e){e.l+=2,e.l+=e.read_shift(2)}var W2={0:Ir,4:Ir,5:Ir,6:Ir,7:z2,8:Ir,9:Ir,10:Ir,11:Ir,12:Ir,13:H2,14:Ir,15:Ir,16:Ir,17:Ir,18:Ir,19:Ir,20:Ir,21:_h};function V2(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(W2[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function No(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function i0(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=be(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function G2(e,t){return t===0||e.read_shift(2),1200}function X2(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=wn(e,0,r);return e.read_shift(t+a-e.l),s}function K2(e,t){var r=!t||t.biff==8,a=be(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function J2(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Y2(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=to(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function Q2(e,t){var r=!t||t.biff>=8?2:1,a=be(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function Z2(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(C2(e));return i.Count=a,i.Unique=s,i}function ey(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=F2(e[s]);var i=yr([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function ty(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function ry(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function ay(e){var t=M2(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function sy(e){return e.read_shift(2),e.read_shift(4)}function Vd(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function ny(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),l=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:o,FirstTab:c,Selected:l,TabRatio:d}}function iy(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function oy(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function cy(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function ly(){}function dy(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=to(e,0,r),a}function uy(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=be(s);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function fy(e){var t=Za(e);return t.isst=e.read_shift(4),t}function hy(e,t,r,a){var s=be(10);return dn(e,t,a,s),s.write_shift(4,r),s}function my(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Za(e);r.biff==2&&e.l++;var i=ro(e,a-e.l,r);return s.val=i,s}function xy(e,t,r,a,s){var i=!s||s.biff==8,o=be(6+2+ +i+(1+i)*r.length);return dn(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function py(e,t,r){var a=e.read_shift(2),s=wn(e,0,r);return[a,s]}function gy(e,t,r,a){var s=r&&r.biff==5;a||(a=be(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var vy=wn;function Gd(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),c=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:i,c},e:{r:o,c:l}}}function yy(e,t){var r=t.biff==8||!t.biff?4:2,a=be(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function by(e){var t=e.read_shift(2),r=e.read_shift(2),a=yh(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function wy(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(yh(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function _y(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function Sy(e,t,r,a){var s={},i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),l=e.read_shift(2);return s.patternType=a2[c>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=c&127,s.icvBottom=c>>7&127,s.icvDiag=c>>14&127,s.dgDiag=c>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Ny(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=Sy(e,t,a.fStyle,r),a}function Xd(e,t,r,a){var s=r&&r.biff==5;a||(a=be(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function ky(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function jy(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}function Kd(e,t,r){var a=Za(e);(r.biff==2||t==9)&&++e.l;var s=A2(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function Ey(e,t,r,a,s,i){var o=be(8);return dn(e,t,a,o),xh(r,i,o),o}function Ty(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Za(e),s=Br(e);return a.val=s,a}function Ay(e,t,r,a){var s=be(14);return dn(e,t,a,s),cn(r,s),s}var Jd=B2;function Cy(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=ln(e,i),c=[];a>e.l;)c.push(ro(e));return[i,s,o,c]}function Yd(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=q2(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var Fy=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Qd(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=ln(e,o,r);s&32&&(d=Fy[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||c===0||!(u>0)?[]:V4(e,u,r,c);return{chKey:i,Name:d,itab:l,rgce:f}}function Sh(e,t,r){if(r.biff<8)return Py(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(U2(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Py(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=to(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Oy(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=ln(e,a,r),o=ln(e,s,r);return[i,o]}function Dy(e,t,r){var a=wh(e);e.l++;var s=e.read_shift(1);return t-=8,[G4(e,t,r),s,a]}function Zd(e,t,r){var a=$2(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,z4(e,t,r)]}function Iy(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Ry(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=wn(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},c,o,i]}}function Ly(e,t,r){return Ry(e,t,r)}function My(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(uc(e));return r}function By(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)bh(e[r],t);return t}function Uy(e,t,r){if(r&&r.biff<8)return $y(e,t,r);var a=_h(e),s=V2(e,t-22,a[1]);return{cmo:a,ft:s}}var qy={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function $y(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((qy[a]||Hr)(e,t,r)),{cmo:[s,a,i],ft:o}}function Hy(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=P2(e,6,r);var c=e.read_shift(2);e.read_shift(2),or(e,2);var l=e.read_shift(2);e.l+=l;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=ln(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?c:2*c))break}if(s.length!==c&&s.length!==c*2)throw new Error("cchText: "+c+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function zy(e,t){var r=uc(e);e.l+=16;var a=R2(e,t-24);return[r,a]}function Wy(e){var t=be(24),r=Vt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return yr([t,L2(e[1])])}function Vy(e,t){e.read_shift(2);var r=uc(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(qr,""),[r,a]}function Gy(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var a=Vt(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Xy(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Ld[r]||r,r=e.read_shift(2),t[1]=Ld[r]||r,t}function Ky(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Jy(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vh(e));return r}function Yy(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(vh(e));return r}function Qy(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Nh(e,t,r){if(!r.cellStyles)return Hr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),l=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:o,ixfe:c,flags:l};return(r.biff>=5||!r.biff)&&(d.level=l>>8&7),d}function Zy(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function eb(e,t){var r={};return t<32||(e.l+=16,r.header=Br(e),r.footer=Br(e),e.l+=2),r}function tb(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function rb(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var ab=Za,sb=mh,nb=ro;function ib(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function ob(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Za(e);++e.l;var s=wn(e,t-7,r);return a.t="str",a.val=s,a}function cb(e){var t=Za(e);++e.l;var r=Br(e);return t.t="n",t.val=r,t}function lb(e,t,r){var a=be(15);return io(a,e,t),a.write_shift(8,r,"f"),a}function db(e){var t=Za(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function ub(e,t,r){var a=be(9);return io(a,e,t),a.write_shift(2,r),a}function fb(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function hb(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function mb(e,t,r){var a=e.l+t,s=Za(e),i=e.read_shift(2),o=ln(e,i,r);return e.l=a,s.t="str",s.val=o,s}var xb=[2,3,48,49,131,139,140,245],yl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=oc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,l){var d=[],u=Os(1);switch(l.type){case"base64":u=ca(ua(c));break;case"binary":u=ca(c);break;case"buffer":case"array":u=c;break}Cr(u,0);var f=u.read_shift(1),m=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,x=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(x=u.read_shift(2));var w=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var v=[],R={},q=Math.min(u.length,f==2?521:x-10-(h?264:0)),U=g?32:11;u.l<q&&u[u.l]!=13;)switch(R={},R.name=Et.utils.decode(_,u.slice(u.l,u.l+U)).replace(/[\u0000\r\n].*$/g,""),u.l+=U,R.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(R.offset=u.read_shift(4)),R.len=u.read_shift(1),f==2&&(R.offset=u.read_shift(2)),R.dec=u.read_shift(1),R.name.length&&v.push(R),f!=2&&(u.l+=g?13:14),R.type){case"B":(!h||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var P=0,X=0;for(d[0]=[],X=0;X!=v.length;++X)d[0][X]=v[X].name;for(;p-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,d[++P]=[],X=0,X=0;X!=v.length;++X){var G=u.slice(u.l,u.l+v[X].len);u.l+=v[X].len,Cr(G,0);var le=Et.utils.decode(_,G);switch(v[X].type){case"C":le.trim().length&&(d[P][X]=le.replace(/\s+$/,""));break;case"D":le.length===8?d[P][X]=new Date(+le.slice(0,4),+le.slice(4,6)-1,+le.slice(6,8)):d[P][X]=le;break;case"F":d[P][X]=parseFloat(le.trim());break;case"+":case"I":d[P][X]=g?G.read_shift(-4,"i")^2147483648:G.read_shift(4,"i");break;case"L":switch(le.trim().toUpperCase()){case"Y":case"T":d[P][X]=!0;break;case"N":case"F":d[P][X]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+le+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[P][X]="##MEMO##"+(g?parseInt(le.trim(),10):G.read_shift(4));break;case"N":le=le.replace(/\u0000/g,"").trim(),le&&le!="."&&(d[P][X]=+le||0);break;case"@":d[P][X]=new Date(G.read_shift(-8,"f")-621356832e5);break;case"T":d[P][X]=new Date((G.read_shift(4)-2440588)*864e5+G.read_shift(4));break;case"Y":d[P][X]=G.read_shift(4,"i")/1e4+G.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[P][X]=-G.read_shift(-8,"f");break;case"B":if(h&&v[X].len==8){d[P][X]=G.read_shift(8,"f");break}case"G":case"P":G.l+=v[X].len;break;case"0":if(v[X].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[X].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(d=d.slice(0,l.sheetRows)),l.DBF=v,d}function a(c,l){var d=l||{};d.dateNF||(d.dateNF="yyyymmdd");var u=si(r(c,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(c,l){try{return Us(a(c,l),l)}catch(d){if(l&&l.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,l){var d=l||{};if(+d.codepage>=0&&Sa(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=sa(),f=Ko(c,{header:1,raw:!0,cellDates:!0}),m=f[0],h=f.slice(1),g=c["!cols"]||[],p=0,x=0,w=0,_=1;for(p=0;p<m.length;++p){if(((g[p]||{}).DBF||{}).name){m[p]=g[p].DBF.name,++w;continue}if(m[p]!=null){if(++w,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(x=0;x<1024;++x)if(m.indexOf(m[p]+"_"+x)==-1){m[p]+="_"+x;break}}}}var v=kt(c["!ref"]),R=[],q=[],U=[];for(p=0;p<=v.e.c-v.s.c;++p){var P="",X="",G=0,le=[];for(x=0;x<h.length;++x)h[x][p]!=null&&le.push(h[x][p]);if(le.length==0||m[p]==null){R[p]="?";continue}for(x=0;x<le.length;++x){switch(typeof le[x]){case"number":X="B";break;case"string":X="C";break;case"boolean":X="L";break;case"object":X=le[x]instanceof Date?"D":"C";break;default:X="C"}G=Math.max(G,String(le[x]).length),P=P&&P!=X?"C":X}G>250&&(G=250),X=((g[p]||{}).DBF||{}).type,X=="C"&&g[p].DBF.len>G&&(G=g[p].DBF.len),P=="B"&&X=="N"&&(P="N",U[p]=g[p].DBF.dec,G=g[p].DBF.len),q[p]=P=="C"||X=="N"?G:i[P]||0,_+=q[p],R[p]=P}var se=u.next(32);for(se.write_shift(4,318902576),se.write_shift(4,h.length),se.write_shift(2,296+32*w),se.write_shift(2,_),p=0;p<4;++p)se.write_shift(4,0);for(se.write_shift(4,0|(+t[sn]||3)<<8),p=0,x=0;p<m.length;++p)if(m[p]!=null){var V=u.next(32),ye=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ye,"sbcs"),V.write_shift(1,R[p]=="?"?"C":R[p],"sbcs"),V.write_shift(4,x),V.write_shift(1,q[p]||i[R[p]]||0),V.write_shift(1,U[p]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),x+=q[p]||i[R[p]]||0}var Ee=u.next(264);for(Ee.write_shift(4,13),p=0;p<65;++p)Ee.write_shift(4,0);for(p=0;p<h.length;++p){var ve=u.next(_);for(ve.write_shift(1,0),x=0;x<m.length;++x)if(m[x]!=null)switch(R[x]){case"L":ve.write_shift(1,h[p][x]==null?63:h[p][x]?84:70);break;case"B":ve.write_shift(8,h[p][x]||0,"f");break;case"N":var Fe="0";for(typeof h[p][x]=="number"&&(Fe=h[p][x].toFixed(U[x]||0)),w=0;w<q[x]-Fe.length;++w)ve.write_shift(1,32);ve.write_shift(1,Fe,"sbcs");break;case"D":h[p][x]?(ve.write_shift(4,("0000"+h[p][x].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(h[p][x].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+h[p][x].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var Te=String(h[p][x]!=null?h[p][x]:"").slice(0,q[x]);for(ve.write_shift(1,Te,"sbcs"),w=0;w<q[x]-Te.length;++w)ve.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}}(),kh=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Yt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var g=e[h];return typeof g=="number"?ul(g):g},a=function(m,h,g){var p=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?m:ul(p)};e["|"]=254;function s(m,h){switch(h.type){case"base64":return i(ua(m),h);case"binary":return i(m,h);case"buffer":return i(xt&&Buffer.isBuffer(m)?m.toString("binary"):Bs(m),h);case"array":return i(on(m),h)}throw new Error("Unrecognized type "+h.type)}function i(m,h){var g=m.split(/[\n\r]+/),p=-1,x=-1,w=0,_=0,v=[],R=[],q=null,U={},P=[],X=[],G=[],le=0,se;for(+h.codepage>=0&&Sa(+h.codepage);w!==g.length;++w){le=0;var V=g[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),ye=V.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),Ee=ye[0],ve;if(V.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ye[1].charAt(0)=="P"&&R.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Fe=!1,Te=!1,$e=!1,ae=!1,He=-1,Ue=-1;for(_=1;_<ye.length;++_)switch(ye[_].charAt(0)){case"A":break;case"X":x=parseInt(ye[_].slice(1))-1,Te=!0;break;case"Y":for(p=parseInt(ye[_].slice(1))-1,Te||(x=0),se=v.length;se<=p;++se)v[se]=[];break;case"K":ve=ye[_].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(La(ve))?isNaN(Kn(ve).getDate())||(ve=zt(ve)):(ve=La(ve),q!==null&&xn(q)&&(ve=lc(ve))),typeof Et<"u"&&typeof ve=="string"&&(h||{}).type!="string"&&(h||{}).codepage&&(ve=Et.utils.decode(h.codepage,ve)),Fe=!0;break;case"E":ae=!0;var k=Vn(ye[_].slice(1),{r:p,c:x});v[p][x]=[v[p][x],k];break;case"S":$e=!0,v[p][x]=[v[p][x],"S5S"];break;case"G":break;case"R":He=parseInt(ye[_].slice(1))-1;break;case"C":Ue=parseInt(ye[_].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+V)}if(Fe&&(v[p][x]&&v[p][x].length==2?v[p][x][0]=ve:v[p][x]=ve,q=null),$e){if(ae)throw new Error("SYLK shared formula cannot have own formula");var B=He>-1&&v[He][Ue];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");v[p][x][1]=Hh(B[1],{r:p-He,c:x-Ue})}break;case"F":var E=0;for(_=1;_<ye.length;++_)switch(ye[_].charAt(0)){case"X":x=parseInt(ye[_].slice(1))-1,++E;break;case"Y":for(p=parseInt(ye[_].slice(1))-1,se=v.length;se<=p;++se)v[se]=[];break;case"M":le=parseInt(ye[_].slice(1))/20;break;case"F":break;case"G":break;case"P":q=R[parseInt(ye[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(G=ye[_].slice(1).split(" "),se=parseInt(G[0],10);se<=parseInt(G[1],10);++se)le=parseInt(G[2],10),X[se-1]=le===0?{hidden:!0}:{wch:le},Ds(X[se-1]);break;case"C":x=parseInt(ye[_].slice(1))-1,X[x]||(X[x]={});break;case"R":p=parseInt(ye[_].slice(1))-1,P[p]||(P[p]={}),le>0?(P[p].hpt=le,P[p].hpx=Yn(le)):le===0&&(P[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+V)}E<1&&(q=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+V)}}return P.length>0&&(U["!rows"]=P),X.length>0&&(U["!cols"]=X),h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),[v,U]}function o(m,h){var g=s(m,h),p=g[0],x=g[1],w=si(p,h);return Yt(x).forEach(function(_){w[_]=x[_]}),w}function c(m,h){return Us(o(m,h),h)}function l(m,h,g,p){var x="C;Y"+(g+1)+";X"+(p+1)+";K";switch(m.t){case"n":x+=m.v||0,m.f&&!m.F&&(x+=";E"+f0(m.f,{r:g,c:p}));break;case"b":x+=m.v?"TRUE":"FALSE";break;case"e":x+=m.w||m.v;break;case"d":x+='"'+(m.w||m.v)+'"';break;case"s":x+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function d(m,h){h.forEach(function(g,p){var x="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Hi(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=zi(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&m.push(x)})}function u(m,h){h.forEach(function(g,p){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*Wi(g.hpx)+";"),x.length>2&&m.push(x+"R"+(p+1))})}function f(m,h){var g=["ID;PWXL;N;E"],p=[],x=kt(m["!ref"]),w,_=Array.isArray(m),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),m["!cols"]&&d(g,m["!cols"]),m["!rows"]&&u(g,m["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var R=x.s.r;R<=x.e.r;++R)for(var q=x.s.c;q<=x.e.c;++q){var U=at({r:R,c:q});w=_?(m[R]||[])[q]:m[U],!(!w||w.v==null&&(!w.f||w.F))&&p.push(l(w,m,R,q))}return g.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:o,from_sheet:f}}(),jh=function(){function e(i,o){switch(o.type){case"base64":return t(ua(i),o);case"binary":return t(i,o);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):Bs(i),o);case"array":return t(on(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var c=i.split(`
`),l=-1,d=-1,u=0,f=[];u!==c.length;++u){if(c[u].trim()==="BOT"){f[++l]=[],d=0;continue}if(!(l<0)){var m=c[u].trim().split(","),h=m[0],g=m[1];++u;for(var p=c[u]||"";(p.match(/["]/g)||[]).length&1&&u<c.length-1;)p+=`
`+c[++u];switch(p=p.trim(),+h){case-1:if(p==="BOT"){f[++l]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[l][d]=!0:p==="FALSE"?f[l][d]=!1:isNaN(La(g))?isNaN(Kn(g).getDate())?f[l][d]=g:f[l][d]=zt(g):f[l][d]=La(g),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[l][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return si(e(i,o),o)}function a(i,o){return Us(r(i,o),o)}var s=function(){var i=function(l,d,u,f,m){l.push(d),l.push(u+","+f),l.push('"'+m.replace(/"/g,'""')+'"')},o=function(l,d,u,f){l.push(d+","+u),l.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var d=[],u=kt(l["!ref"]),f,m=Array.isArray(l);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){o(d,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=at({r:h,c:g});if(f=m?(l[h]||[])[g]:l[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var x=f.w;!x&&f.v!=null&&(x=f.v),x==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,x,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=fa(f.z||Ze[14],xr(zt(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var w=`\r
`,_=d.join(w);return _}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),Eh=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,m){for(var h=f.split(`
`),g=-1,p=-1,x=0,w=[];x!==h.length;++x){var _=h[x].trim().split(":");if(_[0]==="cell"){var v=Vt(_[1]);if(w.length<=v.r)for(g=w.length;g<=v.r;++g)w[g]||(w[g]=[]);switch(g=v.r,p=v.c,_[2]){case"t":w[g][p]=e(_[3]);break;case"v":w[g][p]=+_[3];break;case"vtf":var R=_[_.length-1];case"vtc":switch(_[3]){case"nl":w[g][p]=!!+_[4];break;default:w[g][p]=+_[4];break}_[2]=="vtf"&&(w[g][p]=[w[g][p],R])}}}return m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),w}function a(f,m){return si(r(f,m),m)}function s(f,m){return Us(a(f,m),m)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var m=[],h=[],g,p="",x=Yr(f["!ref"]),w=Array.isArray(f),_=x.s.r;_<=x.e.r;++_)for(var v=x.s.c;v<=x.e.c;++v)if(p=at({r:_,c:v}),g=w?(f[_]||[])[v]:f[p],!(!g||g.v==null||g.t==="z")){switch(h=["cell",p,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var R=xr(zt(g.v));h[2]="vtc",h[3]="nd",h[4]=""+R,h[5]=g.w||fa(g.z||Ze[14],R);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function u(f){return[i,o,c,o,d(f),l].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}}(),Jn=function(){function e(u,f,m,h,g){g.raw?f[m][h]=u:u===""||(u==="TRUE"?f[m][h]=!0:u==="FALSE"?f[m][h]=!1:isNaN(La(u))?isNaN(Kn(u).getDate())?f[m][h]=u:f[m][h]=zt(u):f[m][h]=La(u))}function t(u,f){var m=f||{},h=[];if(!u||u.length===0)return h;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var x=10,w=0,_=0;_<=p;++_)w=g[_].indexOf(" "),w==-1?w=g[_].length:w++,x=Math.max(x,w);for(_=0;_<=p;++_){h[_]=[];var v=0;for(e(g[_].slice(0,x).trim(),h,_,v,m),v=1;v<=(g[_].length-x)/10+1;++v)e(g[_].slice(x+(v-1)*10,x+v*10).trim(),h,_,v,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},m=!1,h=0,g=0;h<u.length;++h)(g=u.charCodeAt(h))==34?m=!m:!m&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=a;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(p,x){return p[0]-x[0]||a[p[1]]-a[x[1]]}),r[g.pop()[1]]||44}function i(u,f){var m=f||{},h="",g=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=s(u.slice(0,1024)):m&&m.FS?h=m.FS:h=s(u.slice(0,1024));var x=0,w=0,_=0,v=0,R=0,q=h.charCodeAt(0),U=!1,P=0,X=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var G=m.dateNF!=null?tv(m.dateNF):null;function le(){var se=u.slice(v,R),V={};if(se.charAt(0)=='"'&&se.charAt(se.length-1)=='"'&&(se=se.slice(1,-1).replace(/""/g,'"')),se.length===0)V.t="z";else if(m.raw)V.t="s",V.v=se;else if(se.trim().length===0)V.t="s",V.v=se;else if(se.charCodeAt(0)==61)se.charCodeAt(1)==34&&se.charCodeAt(se.length-1)==34?(V.t="s",V.v=se.slice(2,-1).replace(/""/g,'"')):C_(se)?(V.t="n",V.f=se.slice(1)):(V.t="s",V.v=se);else if(se=="TRUE")V.t="b",V.v=!0;else if(se=="FALSE")V.t="b",V.v=!1;else if(!isNaN(_=La(se)))V.t="n",m.cellText!==!1&&(V.w=se),V.v=_;else if(!isNaN(Kn(se).getDate())||G&&se.match(G)){V.z=m.dateNF||Ze[14];var ye=0;G&&se.match(G)&&(se=rv(se,m.dateNF,se.match(G)||[]),ye=1),m.cellDates?(V.t="d",V.v=zt(se,ye)):(V.t="n",V.v=xr(zt(se,ye))),m.cellText!==!1&&(V.w=fa(V.z,V.v instanceof Date?xr(V.v):V.v)),m.cellNF||delete V.z}else V.t="s",V.v=se;if(V.t=="z"||(m.dense?(g[x]||(g[x]=[]),g[x][w]=V):g[at({c:w,r:x})]=V),v=R+1,X=u.charCodeAt(v),p.e.c<w&&(p.e.c=w),p.e.r<x&&(p.e.r=x),P==q)++w;else if(w=0,++x,m.sheetRows&&m.sheetRows<=x)return!0}e:for(;R<u.length;++R)switch(P=u.charCodeAt(R)){case 34:X===34&&(U=!U);break;case q:case 10:case 13:if(!U&&le())break e;break}return R-v>0&&le(),g["!ref"]=dt(p),g}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):si(t(u,f),f)}function c(u,f){var m="",h=f.type=="string"?[0,0,0,0]:w0(u,f);switch(f.type){case"base64":m=ua(u);break;case"binary":m=u;break;case"buffer":f.codepage==65001?m=u.toString("utf8"):f.codepage&&typeof Et<"u"?m=Et.utils.decode(f.codepage,u):m=xt&&Buffer.isBuffer(u)?u.toString("binary"):Bs(u);break;case"array":m=on(u);break;case"string":m=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=Rt(m.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?m=Rt(m):f.type=="binary"&&typeof Et<"u"&&f.codepage&&(m=Et.utils.decode(f.codepage,Et.utils.encode(28591,m))),m.slice(0,19)=="socialcalc:version:"?Eh.to_sheet(f.type=="string"?m:Rt(m),f):o(m,f)}function l(u,f){return Us(c(u,f),f)}function d(u){for(var f=[],m=kt(u["!ref"]),h,g=Array.isArray(u),p=m.s.r;p<=m.e.r;++p){for(var x=[],w=m.s.c;w<=m.e.c;++w){var _=at({r:p,c:w});if(h=g?(u[p]||[])[w]:u[_],!h||h.v==null){x.push("          ");continue}for(var v=(h.w||(Ya(h),h.w)||"").slice(0,10);v.length<10;)v+=" ";x.push(v+(w===0?" ":""))}f.push(x.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:c,from_sheet:d}}();function pb(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=kh.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Jn.to_workbook(e,t)}}var rn=function(){function e(k,B,E){if(k){Cr(k,k.l||0);for(var D=E.Enum||He;k.l<k.length;){var z=k.read_shift(2),oe=D[z]||D[65535],J=k.read_shift(2),ce=k.l+J,he=oe.f&&oe.f(k,J,E);if(k.l=ce,B(he,oe,z))return}}}function t(k,B){switch(B.type){case"base64":return r(ca(ua(k)),B);case"binary":return r(ca(k),B);case"buffer":case"array":return r(k,B)}throw"Unsupported type "+B.type}function r(k,B){if(!k)return k;var E=B||{},D=E.dense?[]:{},z="Sheet1",oe="",J=0,ce={},he=[],De=[],j={s:{r:0,c:0},e:{r:0,c:0}},de=E.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)E.Enum=He,e(k,function(L,Y,ke){switch(ke){case 0:E.vers=L,L>=4096&&(E.qpro=!0);break;case 6:j=L;break;case 204:L&&(oe=L);break;case 222:oe=L;break;case 15:case 51:E.qpro||(L[1].v=L[1].v.slice(1));case 13:case 14:case 16:ke==14&&(L[2]&112)==112&&(L[2]&15)>1&&(L[2]&15)<15&&(L[1].z=E.dateNF||Ze[14],E.cellDates&&(L[1].t="d",L[1].v=lc(L[1].v))),E.qpro&&L[3]>J&&(D["!ref"]=dt(j),ce[z]=D,he.push(z),D=E.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},J=L[3],z=oe||"Sheet"+(J+1),oe="");var Pe=E.dense?(D[L[0].r]||[])[L[0].c]:D[at(L[0])];if(Pe){Pe.t=L[1].t,Pe.v=L[1].v,L[1].z!=null&&(Pe.z=L[1].z),L[1].f!=null&&(Pe.f=L[1].f);break}E.dense?(D[L[0].r]||(D[L[0].r]=[]),D[L[0].r][L[0].c]=L[1]):D[at(L[0])]=L[1];break}},E);else if(k[2]==26||k[2]==14)E.Enum=Ue,k[2]==14&&(E.qpro=!0,k.l=0),e(k,function(L,Y,ke){switch(ke){case 204:z=L;break;case 22:L[1].v=L[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(L[3]>J&&(D["!ref"]=dt(j),ce[z]=D,he.push(z),D=E.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},J=L[3],z="Sheet"+(J+1)),de>0&&L[0].r>=de)break;E.dense?(D[L[0].r]||(D[L[0].r]=[]),D[L[0].r][L[0].c]=L[1]):D[at(L[0])]=L[1],j.e.c<L[0].c&&(j.e.c=L[0].c),j.e.r<L[0].r&&(j.e.r=L[0].r);break;case 27:L[14e3]&&(De[L[14e3][0]]=L[14e3][1]);break;case 1537:De[L[0]]=L[1],L[0]==J&&(z=L[1]);break}},E);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(D["!ref"]=dt(j),ce[oe||z]=D,he.push(oe||z),!De.length)return{SheetNames:he,Sheets:ce};for(var fe={},re=[],xe=0;xe<De.length;++xe)ce[he[xe]]?(re.push(De[xe]||he[xe]),fe[De[xe]]=ce[De[xe]]||ce[he[xe]]):(re.push(De[xe]),fe[De[xe]]={"!ref":"A1"});return{SheetNames:re,Sheets:fe}}function a(k,B){var E=B||{};if(+E.codepage>=0&&Sa(+E.codepage),E.type=="string")throw new Error("Cannot write WK1 to JS string");var D=sa(),z=kt(k["!ref"]),oe=Array.isArray(k),J=[];Me(D,0,i(1030)),Me(D,6,l(z));for(var ce=Math.min(z.e.r,8191),he=z.s.r;he<=ce;++he)for(var De=Kt(he),j=z.s.c;j<=z.e.c;++j){he===z.s.r&&(J[j]=Ht(j));var de=J[j]+De,fe=oe?(k[he]||[])[j]:k[de];if(!(!fe||fe.t=="z"))if(fe.t=="n")(fe.v|0)==fe.v&&fe.v>=-32768&&fe.v<=32767?Me(D,13,h(he,j,fe.v)):Me(D,14,p(he,j,fe.v));else{var re=Ya(fe);Me(D,15,f(he,j,re.slice(0,239)))}}return Me(D,1),D.end()}function s(k,B){var E=B||{};if(+E.codepage>=0&&Sa(+E.codepage),E.type=="string")throw new Error("Cannot write WK3 to JS string");var D=sa();Me(D,0,o(k));for(var z=0,oe=0;z<k.SheetNames.length;++z)(k.Sheets[k.SheetNames[z]]||{})["!ref"]&&Me(D,27,ae(k.SheetNames[z],oe++));var J=0;for(z=0;z<k.SheetNames.length;++z){var ce=k.Sheets[k.SheetNames[z]];if(!(!ce||!ce["!ref"])){for(var he=kt(ce["!ref"]),De=Array.isArray(ce),j=[],de=Math.min(he.e.r,8191),fe=he.s.r;fe<=de;++fe)for(var re=Kt(fe),xe=he.s.c;xe<=he.e.c;++xe){fe===he.s.r&&(j[xe]=Ht(xe));var L=j[xe]+re,Y=De?(ce[fe]||[])[xe]:ce[L];if(!(!Y||Y.t=="z"))if(Y.t=="n")Me(D,23,le(fe,xe,J,Y.v));else{var ke=Ya(Y);Me(D,22,P(fe,xe,J,ke.slice(0,239)))}}++J}}return Me(D,1),D.end()}function i(k){var B=be(2);return B.write_shift(2,k),B}function o(k){var B=be(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var E=0,D=0,z=0,oe=0;oe<k.SheetNames.length;++oe){var J=k.SheetNames[oe],ce=k.Sheets[J];if(!(!ce||!ce["!ref"])){++z;var he=Yr(ce["!ref"]);E<he.e.r&&(E=he.e.r),D<he.e.c&&(D=he.e.c)}}return E>8191&&(E=8191),B.write_shift(2,E),B.write_shift(1,z),B.write_shift(1,D),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function c(k,B,E){var D={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&E.qpro?(D.s.c=k.read_shift(1),k.l++,D.s.r=k.read_shift(2),D.e.c=k.read_shift(1),k.l++,D.e.r=k.read_shift(2),D):(D.s.c=k.read_shift(2),D.s.r=k.read_shift(2),B==12&&E.qpro&&(k.l+=2),D.e.c=k.read_shift(2),D.e.r=k.read_shift(2),B==12&&E.qpro&&(k.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function l(k){var B=be(8);return B.write_shift(2,k.s.c),B.write_shift(2,k.s.r),B.write_shift(2,k.e.c),B.write_shift(2,k.e.r),B}function d(k,B,E){var D=[{c:0,r:0},{t:"n",v:0},0,0];return E.qpro&&E.vers!=20768?(D[0].c=k.read_shift(1),D[3]=k.read_shift(1),D[0].r=k.read_shift(2),k.l+=2):(D[2]=k.read_shift(1),D[0].c=k.read_shift(2),D[0].r=k.read_shift(2)),D}function u(k,B,E){var D=k.l+B,z=d(k,B,E);if(z[1].t="s",E.vers==20768){k.l++;var oe=k.read_shift(1);return z[1].v=k.read_shift(oe,"utf8"),z}return E.qpro&&k.l++,z[1].v=k.read_shift(D-k.l,"cstr"),z}function f(k,B,E){var D=be(7+E.length);D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,k),D.write_shift(1,39);for(var z=0;z<D.length;++z){var oe=E.charCodeAt(z);D.write_shift(1,oe>=128?95:oe)}return D.write_shift(1,0),D}function m(k,B,E){var D=d(k,B,E);return D[1].v=k.read_shift(2,"i"),D}function h(k,B,E){var D=be(7);return D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,k),D.write_shift(2,E,"i"),D}function g(k,B,E){var D=d(k,B,E);return D[1].v=k.read_shift(8,"f"),D}function p(k,B,E){var D=be(13);return D.write_shift(1,255),D.write_shift(2,B),D.write_shift(2,k),D.write_shift(8,E,"f"),D}function x(k,B,E){var D=k.l+B,z=d(k,B,E);if(z[1].v=k.read_shift(8,"f"),E.qpro)k.l=D;else{var oe=k.read_shift(2);R(k.slice(k.l,k.l+oe),z),k.l+=oe}return z}function w(k,B,E){var D=B&32768;return B&=-32769,B=(D?k:0)+(B>=8192?B-16384:B),(D?"":"$")+(E?Ht(B):Kt(B))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(k,B){Cr(k,0);for(var E=[],D=0,z="",oe="",J="",ce="";k.l<k.length;){var he=k[k.l++];switch(he){case 0:E.push(k.read_shift(8,"f"));break;case 1:oe=w(B[0].c,k.read_shift(2),!0),z=w(B[0].r,k.read_shift(2),!1),E.push(oe+z);break;case 2:{var De=w(B[0].c,k.read_shift(2),!0),j=w(B[0].r,k.read_shift(2),!1);oe=w(B[0].c,k.read_shift(2),!0),z=w(B[0].r,k.read_shift(2),!1),E.push(De+j+":"+oe+z)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:E.push("("+E.pop()+")");break;case 5:E.push(k.read_shift(2));break;case 6:{for(var de="";he=k[k.l++];)de+=String.fromCharCode(he);E.push('"'+de.replace(/"/g,'""')+'"')}break;case 8:E.push("-"+E.pop());break;case 23:E.push("+"+E.pop());break;case 22:E.push("NOT("+E.pop()+")");break;case 20:case 21:ce=E.pop(),J=E.pop(),E.push(["AND","OR"][he-20]+"("+J+","+ce+")");break;default:if(he<32&&v[he])ce=E.pop(),J=E.pop(),E.push(J+v[he]+ce);else if(_[he]){if(D=_[he][1],D==69&&(D=k[k.l++]),D>E.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+E.join("|")+"|");return}var fe=E.slice(-D);E.length-=D,E.push(_[he][0]+"("+fe.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}E.length==1?B[1].f=""+E[0]:console.error("WK1 bad formula parse |"+E.join("|")+"|")}function q(k){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=k.read_shift(2),B[3]=k[k.l++],B[0].c=k[k.l++],B}function U(k,B){var E=q(k);return E[1].t="s",E[1].v=k.read_shift(B-4,"cstr"),E}function P(k,B,E,D){var z=be(6+D.length);z.write_shift(2,k),z.write_shift(1,E),z.write_shift(1,B),z.write_shift(1,39);for(var oe=0;oe<D.length;++oe){var J=D.charCodeAt(oe);z.write_shift(1,J>=128?95:J)}return z.write_shift(1,0),z}function X(k,B){var E=q(k);E[1].v=k.read_shift(2);var D=E[1].v>>1;if(E[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return E[1].v=D,E}function G(k,B){var E=q(k),D=k.read_shift(4),z=k.read_shift(4),oe=k.read_shift(2);if(oe==65535)return D===0&&z===3221225472?(E[1].t="e",E[1].v=15):D===0&&z===3489660928?(E[1].t="e",E[1].v=42):E[1].v=0,E;var J=oe&32768;return oe=(oe&32767)-16446,E[1].v=(1-J*2)*(z*Math.pow(2,oe+32)+D*Math.pow(2,oe)),E}function le(k,B,E,D){var z=be(14);if(z.write_shift(2,k),z.write_shift(1,E),z.write_shift(1,B),D==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var oe=0,J=0,ce=0,he=0;return D<0&&(oe=1,D=-D),J=Math.log2(D)|0,D/=Math.pow(2,J-31),he=D>>>0,he&2147483648||(D/=2,++J,he=D>>>0),D-=he,he|=2147483648,he>>>=0,D*=Math.pow(2,32),ce=D>>>0,z.write_shift(4,ce),z.write_shift(4,he),J+=16383+(oe?32768:0),z.write_shift(2,J),z}function se(k,B){var E=G(k);return k.l+=B-14,E}function V(k,B){var E=q(k),D=k.read_shift(4);return E[1].v=D>>6,E}function ye(k,B){var E=q(k),D=k.read_shift(8,"f");return E[1].v=D,E}function Ee(k,B){var E=ye(k);return k.l+=B-10,E}function ve(k,B){return k[k.l+B-1]==0?k.read_shift(B,"cstr"):""}function Fe(k,B){var E=k[k.l++];E>B-1&&(E=B-1);for(var D="";D.length<E;)D+=String.fromCharCode(k[k.l++]);return D}function Te(k,B,E){if(!(!E.qpro||B<21)){var D=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var z=k.read_shift(B-21,"cstr");return[D,z]}}function $e(k,B){for(var E={},D=k.l+B;k.l<D;){var z=k.read_shift(2);if(z==14e3){for(E[z]=[0,""],E[z][0]=k.read_shift(2);k[k.l];)E[z][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return E}function ae(k,B){var E=be(5+k.length);E.write_shift(2,14e3),E.write_shift(2,B);for(var D=0;D<k.length;++D){var z=k.charCodeAt(D);E[E.l++]=z>127?95:z}return E[E.l++]=0,E}var He={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:Fe},65535:{n:""}},Ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:G},24:{n:"NUMBER18",f:X},25:{n:"FORMULA19",f:se},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:$e},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ye},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Te},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function gb(e){var t={},r=e.match(zr),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=nt(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Il[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var vb=function(){var e=Mi("t"),t=Mi("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:At(o[1])},l=i.match(t);return l&&(c.s=gb(l[1])),c}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(c){return c.v})}}(),yb=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var c=[];s.u&&c.push("text-decoration: underline;"),s.uval&&c.push("text-underline-style:"+s.uval+";"),s.sz&&c.push("font-size:"+s.sz+"pt;"),s.outline&&c.push("text-effect: outline;"),s.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),bb=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,wb=/<(?:\w+:)?r>/,_b=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function o0(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=At(Rt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Rt(e),r&&(a.h=Hl(a.t))):e.match(wb)&&(a.r=Rt(e),a.t=At(Rt((e.replace(_b,"").match(bb)||[]).join("").replace(zr,""))),r&&(a.h=yb(vb(a.r)))),a):{t:""}}var Sb=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Nb=/<(?:\w+:)?(?:si|sstItem)>/g,kb=/<\/(?:\w+:)?(?:si|sstItem)>/;function jb(e,t){var r=[],a="";if(!e)return r;var s=e.match(Sb);if(s){a=s[2].replace(Nb,"").split(kb);for(var i=0;i!=a.length;++i){var o=o0(a[i].trim(),t);o!=null&&(r[r.length]=o)}s=nt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Eb=/^\s|\s$|[\t\n\r]/;function Th(e,t){if(!t.bookSST)return"";var r=[rr];r[r.length]=Re("sst",null,{xmlns:pn[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(Eb)&&(i+=' xml:space="preserve"'),i+=">"+It(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Tb(e){return[e.read_shift(4),e.read_shift(4)]}function Ab(e,t){var r=[],a=!1;return ms(e,function(i,o,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function Cb(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Fb=qv;function Pb(e){var t=sa();je(t,159,Cb(e));for(var r=0;r<e.length;++r)je(t,19,Fb(e[r]));return je(t,160),t.end()}function Ah(e){if(typeof Et<"u")return Et.utils.encode(sn,e);for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function fs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Ob(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=fs(e,4),t.U=fs(e,4),t.W=fs(e,4),t}function Db(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Ib(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Db(e));return t}function Rb(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Lb(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=fs(e,4),t.U=fs(e,4),t.W=fs(e,4),t}function Mb(e){var t=Lb(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Ch(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Fh(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Bb(e){var t=fs(e);switch(t.Minor){case 2:return[t.Minor,Ub(e)];case 3:return[t.Minor,qb()];case 4:return[t.Minor,$b(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Ub(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=Ch(e,r),s=Fh(e,e.length-e.l);return{t:"Std",h:a,v:s}}function qb(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $b(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(zr,function(i){var o=nt(i);switch(Qa(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function Hb(e,t){var r={},a=r.EncryptionVersionInfo=fs(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=Ch(e,s),t-=s,r.EncryptionVerifier=Fh(e,t),r}function zb(e){var t={},r=t.EncryptionVersionInfo=fs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function c0(e){var t=0,r,a=Ah(e),s=a.length+1,i,o,c,l,d;for(r=Os(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)o=r[i],c=t&16384?1:0,l=t<<1&32767,d=c|l,t=d^o;return t^52811}var Ph=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,c){return a(o^c)},i=function(o){for(var c=t[o.length-1],l=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(c^=r[l]),u*=2,--l;return c};return function(o){for(var c=Ah(o),l=i(c),d=c.length,u=Os(16),f=0;f!=16;++f)u[f]=0;var m,h,g;for((d&1)===1&&(m=l>>8,u[d]=s(e[0],m),--d,m=l&255,h=c[c.length-1],u[d]=s(h,m));d>0;)--d,m=l>>8,u[d]=s(c[d],m),--d,m=l&255,u[d]=s(c[d],m);for(d=15,g=15-c.length;g>0;)m=l>>8,u[d]=s(e[g],m),--d,--g,m=l&255,u[d]=s(c[d],m),--d,--g;return u}}(),Wb=function(e,t,r,a,s){s||(s=t),a||(a=Ph(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,a]},Vb=function(e){var t=0,r=Ph(e);return function(a){var s=Wb("",a,t,r);return t=s[1],s[0]}};function Gb(e,t,r,a){var s={key:or(e),verificationBytes:or(e)};return r.password&&(s.verifier=c0(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=Vb(r.password)),s}function Xb(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=zb(e):a.Data=Hb(e,t),a}function Kb(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Xb(e,t-2,a):Gb(e,r.biff>=8?t:t-2,r,a),a}var Oh=function(){function e(s,i){switch(i.type){case"base64":return t(ua(s),i);case"binary":return t(s,i);case"buffer":return t(xt&&Buffer.isBuffer(s)?s.toString("binary"):Bs(s),i);case"array":return t(on(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},c=o.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(c)&&(c[f]=[]);for(var m=/\\\w+\b/g,h=0,g,p=-1;g=m.exec(u);){switch(g[0]){case"\\cell":var x=u.slice(h,m.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++p,x.length){var w={v:x,t:"s"};Array.isArray(c)?c[f][p]=w:c[at({r:f,c:p})]=w}break}h=m.lastIndex}p>d.e.c&&(d.e.c=p)}),c["!ref"]=dt(d),c}function r(s,i){return Us(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=kt(s["!ref"]),c,l=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=at({r:d,c:u});c=l?(s[d]||[])[u]:s[f],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Ya(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Jb(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function $i(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Yb(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),o=s-i;if(o===0)return[0,0,t];var c=0,l=0,d=s+i;switch(l=o/(d>1?2-d:d),s){case t:c=((r-a)/o+6)%6;break;case r:c=(a-t)/o+2;break;case a:c=(t-r)/o+4;break}return[c/6,l,d/2]}function Qb(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],c=6*t,l;if(r!==0)switch(c|0){case 0:case 6:l=s*c,o[0]+=s,o[1]+=l;break;case 1:l=s*(2-c),o[0]+=l,o[1]+=s;break;case 2:l=s*(c-2),o[1]+=s,o[2]+=l;break;case 3:l=s*(4-c),o[1]+=l,o[2]+=s;break;case 4:l=s*(c-4),o[2]+=s,o[0]+=l;break;case 5:l=s*(6-c),o[2]+=l,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Go(e,t){if(t===0)return e;var r=Yb(Jb(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),$i(Qb(r))}var Dh=6,Zb=15,ew=1,Mr=Dh;function Hi(e){return Math.floor((e+Math.round(128/Mr)/256)*Mr)}function zi(e){return Math.floor((e-5)/Mr*100+.5)/100}function Xo(e){return Math.round((e*Mr+5)/Mr*256)/256}function Bc(e){return Xo(zi(Hi(e)))}function l0(e){var t=Math.abs(e-Bc(e)),r=Mr;if(t>.005)for(Mr=ew;Mr<Zb;++Mr)Math.abs(e-Bc(e))<=t&&(t=Math.abs(e-Bc(e)),r=Mr);Mr=r}function Ds(e){e.width?(e.wpx=Hi(e.width),e.wch=zi(e.wpx),e.MDW=Mr):e.wpx?(e.wch=zi(e.wpx),e.width=Xo(e.wch),e.MDW=Mr):typeof e.wch=="number"&&(e.width=Xo(e.wch),e.wpx=Hi(e.width),e.MDW=Mr),e.customWidth&&delete e.customWidth}var tw=96,Ih=tw;function Wi(e){return e*96/Ih}function Yn(e){return e*Ih/96}var rw={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function aw(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(zr)||[]).forEach(function(o){var c=nt(o);switch(Qa(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},c.diagonalUp&&(s.diagonalUp=$t(c.diagonalUp)),c.diagonalDown&&(s.diagonalDown=$t(c.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function sw(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(zr)||[]).forEach(function(o){var c=nt(o);switch(Qa(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":c.patternType&&(s.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),c.indexed&&(s.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(s.bgColor.theme=parseInt(c.theme,10)),c.tint&&(s.bgColor.tint=parseFloat(c.tint)),c.rgb&&(s.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),c.theme&&(s.fgColor.theme=parseInt(c.theme,10)),c.tint&&(s.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(s.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function nw(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(zr)||[]).forEach(function(o){var c=nt(o);switch(Qa(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":c.val&&(s.name=Rt(c.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=c.val?$t(c.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=c.val?$t(c.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(c.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=c.val?$t(c.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=c.val?$t(c.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=c.val?$t(c.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=c.val?$t(c.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=c.val?$t(c.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":c.val&&(s.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(s.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(s.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(s.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Il[parseInt(c.val,10)];break;case"<color":if(s.color||(s.color={}),c.auto&&(s.color.auto=$t(c.auto)),c.rgb)s.color.rgb=c.rgb.slice(-6);else if(c.indexed){s.color.index=parseInt(c.indexed,10);var l=en[s.color.index];s.color.index==81&&(l=en[1]),l||(l=en[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else c.theme&&(s.color.theme=parseInt(c.theme,10),c.tint&&(s.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Go(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function iw(e,t,r){t.NumberFmt=[];for(var a=Yt(Ze),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Ze[a[s]];var i=e[0].match(zr);if(i)for(s=0;s<i.length;++s){var o=nt(i[s]);switch(Qa(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=At(Rt(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=c,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=c}Ja(c,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function ow(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Re("numFmt",null,{numFmtId:a,formatCode:It(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Re("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ko=["numFmtId","fillId","fontId","borderId","xfId"],jo=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function cw(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(zr)||[]).forEach(function(i){var o=nt(i),c=0;switch(Qa(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<ko.length;++c)a[ko[c]]&&(a[ko[c]]=parseInt(a[ko[c]],10));for(c=0;c<jo.length;++c)a[jo[c]]&&(a[jo[c]]=$t(a[jo[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=$t(o.wrapText)),a.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function lw(e){var t=[];return t[t.length]=Re("cellXfs",null),e.forEach(function(r){t[t.length]=Re("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Re("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var dw=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,l,d){var u={};if(!c)return u;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=c.match(t))&&iw(f,u,d),(f=c.match(s))&&nw(f,u,l,d),(f=c.match(a))&&sw(f,u,l,d),(f=c.match(i))&&aw(f,u,l,d),(f=c.match(r))&&cw(f,u,d),u}}();function Rh(e,t){var r=[rr,Re("styleSheet",null,{xmlns:pn[0],"xmlns:vt":mr.vt})],a;return e.SSF&&(a=ow(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=lw(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uw(e,t){var r=e.read_shift(2),a=$r(e);return[r,a]}function fw(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),br(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function hw(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=Xv(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var c=e.read_shift(1);c>0&&(a.family=c);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=Gv(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=$r(e),a}function mw(e,t){t||(t=be(25+4*32)),t.write_shift(2,e.sz*20),Kv(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),zo(e.color,t);var a=0;return e.scheme=="major"&&(a=1),e.scheme=="minor"&&(a=2),t.write_shift(1,a),br(e.name,t),t.length>t.l?t.slice(0,t.l):t}var xw=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Uc,pw=Hr;function eu(e,t){t||(t=be(4*3+8*7+16*1)),Uc||(Uc=oc(xw));var r=Uc[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(zo({auto:1},t),zo({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function gw(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function Lh(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function hi(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var vw=Hr;function yw(e,t){return t||(t=be(51)),t.write_shift(1,0),hi(null,t),hi(null,t),hi(null,t),hi(null,t),hi(null,t),t.length>t.l?t.slice(0,t.l):t}function bw(e,t){return t||(t=be(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Ho(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ww(e,t,r){var a=be(2052);return a.write_shift(4,e),Ho(t,a),Ho(r,a),a.length>a.l?a.slice(0,a.l):a}function _w(e,t,r){var a={};a.NumberFmt=[];for(var s in Ze)a.NumberFmt[s]=Ze[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return ms(e,function(l,d,u){switch(u){case 44:a.NumberFmt[l[0]]=l[1],Ja(l[1],l[0]);break;case 43:a.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Go(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function Sw(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(je(e,615,Ma(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&je(e,44,fw(s,t[s]))}),je(e,616))}}function Nw(e){var t=1;je(e,611,Ma(t)),je(e,43,mw({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),je(e,612)}function kw(e){var t=2;je(e,603,Ma(t)),je(e,45,eu({patternType:"none"})),je(e,45,eu({patternType:"gray125"})),je(e,604)}function jw(e){var t=1;je(e,613,Ma(t)),je(e,46,yw()),je(e,614)}function Ew(e){var t=1;je(e,626,Ma(t)),je(e,47,Lh({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),je(e,627)}function Tw(e,t){je(e,617,Ma(t.length)),t.forEach(function(r){je(e,47,Lh(r,0))}),je(e,618)}function Aw(e){var t=1;je(e,619,Ma(t)),je(e,48,bw({xfId:0,builtinId:0,name:"Normal"})),je(e,620)}function Cw(e){var t=0;je(e,505,Ma(t)),je(e,506)}function Fw(e){var t=0;je(e,508,ww(t,"TableStyleMedium9","PivotStyleMedium4")),je(e,509)}function Pw(e,t){var r=sa();return je(r,278),Sw(r,e.SSF),Nw(r),kw(r),jw(r),Ew(r),Tw(r,t.cellXfs),Aw(r),Cw(r),Fw(r),je(r,279),r.end()}var Ow=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Dw(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(zr)||[]).forEach(function(s){var i=nt(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ow.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Iw(){}function Rw(){}var Lw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Mw=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Bw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Uw(e,t,r){t.themeElements={};var a;[["clrScheme",Lw,Dw],["fontScheme",Mw,Iw],["fmtScheme",Bw,Rw]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var qw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mh(e,t){(!e||e.length===0)&&(e=d0());var r,a={};if(!(r=e.match(qw)))throw new Error("themeElements not found in theme");return Uw(r[0],a,t),a.raw=e,a}function d0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[rr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $w(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=Df(i,{type:"array"})}catch{return}var c=la(o,"theme/theme/theme1.xml",!0);if(c)return Mh(c,r)}}function Hw(e){return e.read_shift(4)}function zw(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ww(e,4);break;case 2:t.xclrValue=gh(e);break;case 3:t.xclrValue=Hw(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ww(e,t){return Hr(e,t)}function Vw(e,t){return Hr(e,t)}function Gw(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=zw(e);break;case 6:a[1]=Vw(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Xw(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Gw(e,r-e.l));return{ixfe:a,ext:i}}function Kw(e,t){t.forEach(function(r){switch(r[0]){}})}function Jw(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$r(e)}}function Yw(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),br(e.name,t),t.slice(0,t.l)}function Qw(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Zw(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function e_(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),br(t,r),r.slice(0,r.l)}function t_(e){return e.l+=4,e.read_shift(4)!=0}function r_(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}function a_(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,c=2;return ms(e,function(l,d,u){switch(u){case 335:a.Types.push({name:l.name});break;case 51:l.forEach(function(f){c==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):c==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:c=l?1:0;break;case 338:c=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function s_(){var e=sa();return je(e,332),je(e,334,Ma(1)),je(e,335,Yw({name:"XLDAPR",version:12e4,flags:3496657072})),je(e,336),je(e,339,e_(1,"XLDAPR")),je(e,52),je(e,35,Ma(514)),je(e,4096,Ma(0)),je(e,4097,_a(1)),je(e,36),je(e,53),je(e,340),je(e,337,r_(1,!0)),je(e,51,Zw([[1,0]])),je(e,338),je(e,333),e.end()}function n_(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,o;return e.replace(zr,function(c){var l=nt(c);switch(Qa(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==l.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[l.t-1].name,index:+l.v}):i==0&&a.Value.push({type:a.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return c}),a}function Bh(){var e=[rr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function i_(e){var t=[];if(!e)return t;var r=1;return(e.match(zr)||[]).forEach(function(a){var s=nt(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function o_(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=at(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function c_(e,t,r){var a=[];return ms(e,function(i,o,c){switch(c){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function l_(e,t,r,a){if(!e)return e;var s=a||{},i=!1;ms(e,function(c,l,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function d_(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Hn=1024;function Uh(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Re("xml",null,{"xmlns:v":oa.v,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:mv":oa.mv}).replace(/\/>/,">"),Re("o:shapelayout",Re("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Re("v:shapetype",[Re("v:stroke",null,{joinstyle:"miter"}),Re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Hn<e*1e3;)Hn+=1e3;return t.forEach(function(i){var o=Vt(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var l=c.type=="gradient"?Re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Re("v:fill",l,c),u={on:"t",obscured:"t"};++Hn,s=s.concat(["<v:shape"+Bi({id:"_x0000_s"+Hn,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Re("v:shadow",null,u),Re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fr("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Fr("x:AutoFill","False"),Fr("x:Row",String(o.r)),Fr("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function tu(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(o){var c=Vt(o.ref);if(s?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[o.ref],!i){i={t:"z"},s?e[c.r][c.c]=i:e[o.ref]=i;var l=kt(e["!ref"]||"BDWGO1000001:A1");l.s.r>c.r&&(l.s.r=c.r),l.e.r<c.r&&(l.e.r=c.r),l.s.c>c.c&&(l.s.c=c.c),l.e.c<c.c&&(l.e.c=c.c);var d=dt(l);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function u_(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var l=nt(c[0]),d={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Vt(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!f&&!!f[1]&&o0(f[1])||{r:"",t:"",h:""};d.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),d.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=m.h),a.push(d)}}}}),a}function qh(e){var t=[rr,Re("comments",null,{xmlns:pn[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=It(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(l){l.a&&(s=r.indexOf(It(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Fr("t",It(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)o+=`Reply:
    `+i[c]+`
`;t.push(Fr("t",It(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function f_(e,t){var r=[],a=!1,s={},i=0;return e.replace(zr,function(c,l){var d=nt(c);switch(Qa(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+c.length;break;case"</text>":s.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function h_(e,t,r){var a=[rr,Re("ThreadedComments",null,{xmlns:mr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=l.id:l.parentId=i,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Re("threadedComment",Fr("text",o.t||""),l))})}),a.push("</ThreadedComments>"),a.join("")}function m_(e,t){var r=[],a=!1;return e.replace(zr,function(i){var o=nt(i);switch(Qa(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function x_(e){var t=[rr,Re("personList",null,{xmlns:mr.TCMNT,"xmlns:x":pn[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Re("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function p_(e){var t={};t.iauthor=e.read_shift(4);var r=bn(e);return t.rfx=r.s,t.ref=at(r.s),e.l+=16,t}function g_(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),ni(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var v_=$r;function y_(e){return br(e.slice(0,54))}function b_(e,t){var r=[],a=[],s={},i=!1;return ms(e,function(c,l,d){switch(d){case 632:a.push(c);break;case 635:s=c;break;case 637:s.t=c.t,s.h=c.h,s.r=c.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function w_(e){var t=sa(),r=[];return je(t,628),je(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),je(t,632,y_(s.a)))})}),je(t,631),je(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Vt(a[0]),e:Vt(a[0])};je(t,635,g_([i,s])),s.t&&s.t.length>0&&je(t,637,Hv(s)),je(t,636),delete s.iauthor})}),je(t,634),je(t,629),t.end()}var __="application/vnd.ms-office.vbaProject";function S_(e){var t=Ye.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ye.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Ye.write(t)}function N_(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ye.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var $h=["xlsb","xlsm","xlam","biff8","xla"];function k_(){return{"!type":"dialog"}}function j_(){return{"!type":"dialog"}}function E_(){return{"!type":"macro"}}function T_(){return{"!type":"macro"}}var Vn=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,o){var c=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return c?u+=t.c:--u,l?d+=t.r:--d,s+(c?"":"$")+Ht(u)+(l?"":"$")+Kt(d)}return function(s,i){return t=i,s.replace(e,r)}}(),u0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,f0=function(){return function(t,r){return t.replace(u0,function(a,s,i,o,c,l){var d=Ql(o)-(i?0:r.c),u=Yl(l)-(c?0:r.r),f=u==0?"":c?u+1:"["+u+"]",m=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+m})}}();function Hh(e,t){return e.replace(u0,function(r,a,s,i,o,c){return a+(s=="$"?s+i:Ht(Ql(i)+t.c))+(o=="$"?o+c:Kt(Yl(c)+t.r))})}function A_(e,t,r){var a=Yr(t),s=a.s,i=Vt(r),o={r:i.r-s.r,c:i.c-s.c};return Hh(e,o)}function C_(e){return e.length!=1}function ru(e){return e.replace(/_xlfn\./g,"")}function nr(e){e.l+=1}function Is(e,t){var r=e.read_shift(t==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function zh(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Wh(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),o=Is(e,2),c=Is(e,2);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Wh(e){var t=Is(e,2),r=Is(e,2),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function F_(e,t,r){if(r.biff<8)return Wh(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Is(e,2),o=Is(e,2);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Vh(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return P_(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Is(e,2);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function P_(e){var t=Is(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function O_(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function D_(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return I_(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:c}}function I_(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function R_(e,t,r){var a=(e[e.l++]&96)>>5,s=zh(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function L_(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=zh(e,i,r);return[a,s,o]}function M_(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function B_(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function U_(e,t,r){var a=(e[e.l++]&96)>>5,s=F_(e,t-1,r);return[a,s]}function q_(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function au(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function $_(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function H_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function z_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function W_(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function V_(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Gh(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function G_(e){return e.read_shift(2),Gh(e)}function X_(e){return e.read_shift(2),Gh(e)}function K_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=Vh(e,0,r);return[a,s]}function J_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=D_(e,0,r);return[a,s]}function Y_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Vh(e,0,r);return[a,s,i]}function Q_(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[t3[s],Jh[s],a]}function Z_(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:e4(e);return[s,(i[0]===0?Jh:e3)[i[1]]]}function e4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function t4(e,t,r){e.l+=r&&r.biff==2?3:4}function r4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function a4(e){return e.l++,xs[e.read_shift(1)]}function s4(e){return e.l++,e.read_shift(2)}function n4(e){return e.l++,e.read_shift(1)!==0}function i4(e){return e.l++,Br(e)}function o4(e,t,r){return e.l++,to(e,t-1,r)}function c4(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=tr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=xs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Br(e);break;case 2:r[1]=wn(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function l4(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?bn:uc)(e));return s}function d4(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var c=0;c!=s;++c)o[i][c]=c4(e,r.biff);return o}function u4(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function f4(e,t,r){if(r.biff==5)return h4(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function h4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function m4(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function x4(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function p4(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function g4(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var v4=Hr,y4=Hr,b4=Hr;function ao(e,t,r){return e.l+=2,[O_(e)]}function h0(e){return e.l+=6,[]}var w4=ao,_4=h0,S4=h0,N4=ao;function Xh(e){return e.l+=2,[or(e),e.read_shift(2)&1]}var k4=ao,j4=Xh,E4=h0,T4=ao,A4=ao,C4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function F4(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=C4[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:i}}function P4(e){return e.l+=2,[e.read_shift(4)]}function O4(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function D4(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function I4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function R4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function L4(e){return e.l+=4,[0,0]}var su={1:{n:"PtgExp",f:r4},2:{n:"PtgTbl",f:b4},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:o4},26:{n:"PtgSheet",f:O4},27:{n:"PtgEndSheet",f:D4},28:{n:"PtgErr",f:a4},29:{n:"PtgBool",f:n4},30:{n:"PtgInt",f:s4},31:{n:"PtgNum",f:i4},32:{n:"PtgArray",f:q_},33:{n:"PtgFunc",f:Q_},34:{n:"PtgFuncVar",f:Z_},35:{n:"PtgName",f:u4},36:{n:"PtgRef",f:K_},37:{n:"PtgArea",f:R_},38:{n:"PtgMemArea",f:m4},39:{n:"PtgMemErr",f:v4},40:{n:"PtgMemNoMem",f:y4},41:{n:"PtgMemFunc",f:x4},42:{n:"PtgRefErr",f:p4},43:{n:"PtgAreaErr",f:M_},44:{n:"PtgRefN",f:J_},45:{n:"PtgAreaN",f:U_},46:{n:"PtgMemAreaN",f:I4},47:{n:"PtgMemNoMemN",f:R4},57:{n:"PtgNameX",f:f4},58:{n:"PtgRef3d",f:Y_},59:{n:"PtgArea3d",f:L_},60:{n:"PtgRefErr3d",f:g4},61:{n:"PtgAreaErr3d",f:B_},255:{}},M4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},B4={1:{n:"PtgElfLel",f:Xh},2:{n:"PtgElfRw",f:T4},3:{n:"PtgElfCol",f:w4},6:{n:"PtgElfRwV",f:A4},7:{n:"PtgElfColV",f:N4},10:{n:"PtgElfRadical",f:k4},11:{n:"PtgElfRadicalS",f:E4},13:{n:"PtgElfColS",f:_4},15:{n:"PtgElfColSV",f:S4},16:{n:"PtgElfRadicalLel",f:j4},25:{n:"PtgList",f:F4},29:{n:"PtgSxName",f:P4},255:{}},U4={0:{n:"PtgAttrNoop",f:L4},1:{n:"PtgAttrSemi",f:V_},2:{n:"PtgAttrIf",f:z_},4:{n:"PtgAttrChoose",f:$_},8:{n:"PtgAttrGoto",f:H_},16:{n:"PtgAttrSum",f:t4},32:{n:"PtgAttrBaxcel",f:au},33:{n:"PtgAttrBaxcel",f:au},64:{n:"PtgAttrSpace",f:G_},65:{n:"PtgAttrSpaceSemi",f:X_},128:{n:"PtgAttrIfError",f:W_},255:{}};function so(e,t,r,a){if(a.biff<8)return Hr(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=d4(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=l4(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(Hr(e,t)),i}function no(e,t,r){for(var a=e.l+t,s,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],s=su[i]||su[M4[i]],(i===24||i===25)&&(s=(i===24?B4:U4)[e[e.l+1]]),!s||!s.f?Hr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function q4(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var $4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function H4(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Kh(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function nu(e,t,r){var a=Kh(e,t,r);return a=="#REF"?a:H4(a,r)}function Lr(e,t,r,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},c=[],l,d,u,f=0,m=0,h,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,x="",w=0,_=e[0].length;w<_;++w){var v=e[0][w];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=c.pop(),d=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:x=Xt(" ",e[0][p][1][1]);break;case 1:x=Xt("\r",e[0][p][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+x,p=-1}c.push(d+$4[v[0]]+l);break;case"PtgIsect":l=c.pop(),d=c.pop(),c.push(d+" "+l);break;case"PtgUnion":l=c.pop(),d=c.pop(),c.push(d+","+l);break;case"PtgRange":l=c.pop(),d=c.pop(),c.push(d+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ki(v[1][1],o,s),c.push(ji(u,i));break;case"PtgRefN":u=r?ki(v[1][1],r,s):v[1][1],c.push(ji(u,i));break;case"PtgRef3d":f=v[1][1],u=ki(v[1][2],o,s),g=nu(a,f,s),c.push(g+"!"+ji(u,i));break;case"PtgFunc":case"PtgFuncVar":var R=v[1][0],q=v[1][1];R||(R=0),R&=127;var U=R==0?[]:c.slice(-R);c.length-=R,q==="User"&&(q=U.shift()),c.push(q+"("+U.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":h=Dd(v[1][1],r?{s:r}:o,s),c.push(Rc(h,s));break;case"PtgArea":h=Dd(v[1][1],o,s),c.push(Rc(h,s));break;case"PtgArea3d":f=v[1][1],h=v[1][2],g=nu(a,f,s),c.push(g+"!"+Rc(h,s));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=v[1][2];var P=(a.names||[])[m-1]||(a[0]||[])[m],X=P?P.Name:"SH33TJSNAME"+String(m);X&&X.slice(0,6)=="_xlfn."&&!s.xlfn&&(X=X.slice(6)),c.push(X);break;case"PtgNameX":var G=v[1][1];m=v[1][2];var le;if(s.biff<=5)G<0&&(G=-G),a[G]&&(le=a[G][m]);else{var se="";if(((a[G]||[])[0]||[])[0]==14849||(((a[G]||[])[0]||[])[0]==1025?a[G][m]&&a[G][m].itab>0&&(se=a.SheetNames[a[G][m].itab-1]+"!"):se=a.SheetNames[m-1]+"!"),a[G]&&a[G][m])se+=a[G][m].Name;else if(a[0]&&a[0][m])se+=a[0][m].Name;else{var V=(Kh(a,G,s)||"").split(";;");V[m-1]?se=V[m-1]:se+="SH33TJSERRX"}c.push(se);break}le||(le={Name:"SH33TJSERRY"}),c.push(le.Name);break;case"PtgParen":var ye="(",Ee=")";if(p>=0){switch(x="",e[0][p][1][0]){case 2:ye=Xt(" ",e[0][p][1][1])+ye;break;case 3:ye=Xt("\r",e[0][p][1][1])+ye;break;case 4:Ee=Xt(" ",e[0][p][1][1])+Ee;break;case 5:Ee=Xt("\r",e[0][p][1][1])+Ee;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(ye+c.pop()+Ee);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var ve={c:r.c,r:r.r};if(a.sharedf[at(u)]){var Fe=a.sharedf[at(u)];c.push(Lr(Fe,o,ve,a,s))}else{var Te=!1;for(l=0;l!=a.arrayf.length;++l)if(d=a.arrayf[l],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){c.push(Lr(d[1],o,ve,a,s)),Te=!0;break}Te||c.push(v[1])}break;case"PtgArray":c.push("{"+q4(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var $e=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&$e.indexOf(e[0][w][0])==-1){v=e[0][p];var ae=!0;switch(v[1][0]){case 4:ae=!1;case 0:x=Xt(" ",v[1][1]);break;case 5:ae=!1;case 1:x=Xt("\r",v[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((ae?x:"")+c.pop()+(ae?"":x)),p=-1}}if(c.length>1&&s.WTF)throw new Error("bad formula stack");return c[0]}function z4(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Hr(e,t-2)];var c=no(e,o,r);return t!==o+s&&(i=so(e,t-o-s,c,r)),e.l=a,[c,i]}function W4(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Hr(e,t-2)];var c=no(e,o,r);return t!==o+s&&(i=so(e,t-o-s,c,r)),e.l=a,[c,i]}function V4(e,t,r,a){var s=e.l+t,i=no(e,a,r),o;return s!==e.l&&(o=so(e,s-e.l,i,r)),[i,o]}function G4(e,t,r){var a=e.l+t,s,i=e.read_shift(2),o=no(e,i,r);return i==65535?[[],Hr(e,t-2)]:(t!==i+2&&(s=so(e,a-i-2,o,r)),[o,s])}function X4(e){var t;if(ds(e,e.l+6)!==65535)return[Br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function K4(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return cn(e);return cn(0)}function qc(e,t,r){var a=e.l+t,s=Za(e);r.biff==2&&++e.l;var i=X4(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=W4(e,a-e.l,r);return{cell:s,val:i[0],formula:c,shared:o>>3&1,tt:i[1]}}function J4(e,t,r,a,s){var i=dn(t,r,s),o=K4(e.v),c=be(6),l=33;c.write_shift(2,l),c.write_shift(4,0);for(var d=be(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=yr([i,o,c,d]);return f}function fc(e,t,r){var a=e.read_shift(4),s=no(e,a,r),i=e.read_shift(4),o=i>0?so(e,i,s,r):null;return[s,o]}var Y4=fc,hc=fc,Q4=fc,Z4=fc,e3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Jh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},t3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function iu(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function r3(e){var t="of:="+e.replace(u0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $c(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function a3(e){return e.replace(/\./,"!")}var Ti={},Gn={},Ai=typeof Map<"u";function m0(e,t,r){var a=0,s=e.length;if(r){if(Ai?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ai?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Ai?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function mc(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Mr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=zi(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=Xo(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function an(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function qs(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Ja(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Yh(e,t,r,a,s,i){try{a.cellNF&&(e.z=Ze[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=zt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ze[t]==null&&Ja(ev[t]||"General",t),e.t==="e")e.w=e.w||xs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Li(e.v);else if(e.t==="d"){var o=xr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Li(o)}else{if(e.v===void 0)return"";e.w=nn(e.v,Gn)}else e.t==="d"?e.w=fa(t,xr(e.v),Gn):e.w=fa(t,e.v,Gn)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Go(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Go(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function s3(e,t,r){if(e&&e["!ref"]){var a=kt(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function n3(e,t){var r=kt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=dt(r))}var i3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,o3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,c3=/<(?:\w:)?hyperlink [^>]*>/mg,l3=/"(\w*:\w*)"/,d3=/<(?:\w:)?col\b[^>]*[\/]?>/g,u3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,f3=/<(?:\w:)?pageMargins[^>]*\/>/g,Qh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,h3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,m3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function x3(e,t,r,a,s,i,o){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(o3);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var m=d.match(Qh);m?x0(m[0],c,s,r):(m=d.match(h3))&&g3(m[0],m[1]||"",c,s,r);var h=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=d.slice(h,h+50).match(l3);g&&n3(c,g[1])}var p=d.match(m3);p&&p[1]&&C3(p[1],s);var x=[];if(t.cellStyles){var w=d.match(d3);w&&k3(x,w)}f&&O3(f[1],c,t,l,i,o);var _=u.match(u3);_&&(c["!autofilter"]=E3(_[0]));var v=[],R=u.match(i3);if(R)for(h=0;h!=R.length;++h)v[h]=kt(R[h].slice(R[h].indexOf('"')+1));var q=u.match(c3);q&&_3(c,q,a);var U=u.match(f3);if(U&&(c["!margins"]=S3(nt(U[0]))),!c["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(c["!ref"]=dt(l)),t.sheetRows>0&&c["!ref"]){var P=kt(c["!ref"]);t.sheetRows<=+P.e.r&&(P.e.r=t.sheetRows-1,P.e.r>l.e.r&&(P.e.r=l.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>l.e.c&&(P.e.c=l.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),c["!fullref"]=c["!ref"],c["!ref"]=dt(P))}return x.length>0&&(c["!cols"]=x),v.length>0&&(c["!merges"]=v),c}function p3(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function x0(e,t,r,a){var s=nt(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=At(Rt(s.codeName)))}function g3(e,t,r,a,s){x0(e.slice(0,e.indexOf(">")),r,a,s)}function v3(e,t,r,a,s){var i=!1,o={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,o.codeName=Ka(It(l))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),c=(c||"")+Re("outlinePr",null,d)}!i&&!c||(s[s.length]=Re("sheetPr",c,o))}var y3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],b3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function w3(e){var t={sheet:1};return y3.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),b3.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=c0(e.password).toString(16).toUpperCase()),Re("sheetProtection",null,t)}function _3(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=nt(Rt(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+At(i.location))):(i.Target="#"+At(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=kt(i.ref),l=c.s.r;l<=c.e.r;++l)for(var d=c.s.c;d<=c.e.c;++d){var u=at({c:d,r:l});a?(e[l]||(e[l]=[]),e[l][d]||(e[l][d]={t:"z",v:void 0}),e[l][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function S3(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function N3(e){return an(e),Re("pageMargins",null,e)}function k3(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=nt(t[a],!0);s.hidden&&(s.hidden=$t(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,l0(s.width)),Ds(s);i<=o;)e[i++]=Lt(s)}}function j3(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=Re("col",null,mc(s,a)));return r[r.length]="</cols>",r.join("")}function E3(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function T3(e,t,r,a){var s=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Yr(s);o.s.r==o.e.r&&(o.e.r=Yr(t["!ref"]).e.r,s=dt(o));for(var c=0;c<i.length;++c){var l=i[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Re("autoFilter",null,{ref:s})}var A3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function C3(e,t){t.Views||(t.Views=[{}]),(e.match(A3)||[]).forEach(function(r,a){var s=nt(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),$t(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function F3(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Re("sheetViews",Re("sheetView",null,s),{})}function P3(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=xs[e.v];break;case"d":a&&a.cellDates?s=zt(e.v,-1).toISOString():(e=Lt(e),e.t="n",s=""+(e.v=xr(zt(e.v)))),typeof e.z>"u"&&(e.z=Ze[14]);break;default:s=e.v;break}var c=Fr("v",It(s)),l={r:t},d=qs(a.cellXfs,e,a);switch(d!==0&&(l.s=d),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Fr("v",""+m0(a.Strings,e.v,a.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Re("f",It(e.f),u)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Re("c",c,l)}var O3=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Mi("v"),o=Mi("f");return function(l,d,u,f,m,h){for(var g=0,p="",x=[],w=[],_=0,v=0,R=0,q="",U,P,X=0,G=0,le,se,V=0,ye=0,Ee=Array.isArray(h.CellXf),ve,Fe=[],Te=[],$e=Array.isArray(d),ae=[],He={},Ue=!1,k=!!u.sheetStubs,B=l.split(t),E=0,D=B.length;E!=D;++E){p=B[E].trim();var z=p.length;if(z!==0){var oe=0;e:for(g=0;g<z;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(P=nt(p.slice(oe,g),!0),X=P.r!=null?parseInt(P.r,10):X+1,G=-1,u.sheetRows&&u.sheetRows<X)continue;He={},Ue=!1,P.ht&&(Ue=!0,He.hpt=parseFloat(P.ht),He.hpx=Yn(He.hpt)),P.hidden=="1"&&(Ue=!0,He.hidden=!0),P.outlineLevel!=null&&(Ue=!0,He.level=+P.outlineLevel),Ue&&(ae[X-1]=He)}break;case"<":oe=g;break}if(oe>=g)break;if(P=nt(p.slice(oe,g),!0),X=P.r!=null?parseInt(P.r,10):X+1,G=-1,!(u.sheetRows&&u.sheetRows<X)){f.s.r>X-1&&(f.s.r=X-1),f.e.r<X-1&&(f.e.r=X-1),u&&u.cellStyles&&(He={},Ue=!1,P.ht&&(Ue=!0,He.hpt=parseFloat(P.ht),He.hpx=Yn(He.hpt)),P.hidden=="1"&&(Ue=!0,He.hidden=!0),P.outlineLevel!=null&&(Ue=!0,He.level=+P.outlineLevel),Ue&&(ae[X-1]=He)),x=p.slice(g).split(e);for(var J=0;J!=x.length&&x[J].trim().charAt(0)=="<";++J);for(x=x.slice(J),g=0;g!=x.length;++g)if(p=x[g].trim(),p.length!==0){if(w=p.match(r),_=g,v=0,R=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,w!=null&&w.length===2){for(_=0,q=w[1],v=0;v!=q.length&&!((R=q.charCodeAt(v)-64)<1||R>26);++v)_=26*_+R;--_,G=_}else++G;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,P=nt(p.slice(0,v),!0),P.r||(P.r=at({r:X-1,c:G})),q=p.slice(v),U={t:""},(w=q.match(i))!=null&&w[1]!==""&&(U.v=At(w[1])),u.cellFormula){if((w=q.match(o))!=null&&w[1]!==""){if(U.f=At(Rt(w[1])).replace(/\r\n/g,`
`),u.xlfn||(U.f=ru(U.f)),w[0].indexOf('t="array"')>-1)U.F=(q.match(s)||[])[1],U.F.indexOf(":")>-1&&Fe.push([kt(U.F),U.F]);else if(w[0].indexOf('t="shared"')>-1){se=nt(w[0]);var ce=At(Rt(w[1]));u.xlfn||(ce=ru(ce)),Te[parseInt(se.si,10)]=[se,ce,P.r]}}else(w=q.match(/<f[^>]*\/>/))&&(se=nt(w[0]),Te[se.si]&&(U.f=A_(Te[se.si][1],Te[se.si][2],P.r)));var he=Vt(P.r);for(v=0;v<Fe.length;++v)he.r>=Fe[v][0].s.r&&he.r<=Fe[v][0].e.r&&he.c>=Fe[v][0].s.c&&he.c<=Fe[v][0].e.c&&(U.F=Fe[v][1])}if(P.t==null&&U.v===void 0)if(U.f||U.F)U.v=0,U.t="n";else if(k)U.t="z";else continue;else U.t=P.t||"n";switch(f.s.c>G&&(f.s.c=G),f.e.c<G&&(f.e.c=G),U.t){case"n":if(U.v==""||U.v==null){if(!k)continue;U.t="z"}else U.v=parseFloat(U.v);break;case"s":if(typeof U.v>"u"){if(!k)continue;U.t="z"}else le=Ti[parseInt(U.v,10)],U.v=le.t,U.r=le.r,u.cellHTML&&(U.h=le.h);break;case"str":U.t="s",U.v=U.v!=null?Rt(U.v):"",u.cellHTML&&(U.h=Hl(U.v));break;case"inlineStr":w=q.match(a),U.t="s",w!=null&&(le=o0(w[1]))?(U.v=le.t,u.cellHTML&&(U.h=le.h)):U.v="";break;case"b":U.v=$t(U.v);break;case"d":u.cellDates?U.v=zt(U.v,1):(U.v=xr(zt(U.v,1)),U.t="n");break;case"e":(!u||u.cellText!==!1)&&(U.w=U.v),U.v=eh[U.v];break}if(V=ye=0,ve=null,Ee&&P.s!==void 0&&(ve=h.CellXf[P.s],ve!=null&&(ve.numFmtId!=null&&(V=ve.numFmtId),u.cellStyles&&ve.fillId!=null&&(ye=ve.fillId))),Yh(U,V,ye,u,m,h),u.cellDates&&Ee&&U.t=="n"&&xn(Ze[V])&&(U.t="d",U.v=lc(U.v)),P.cm&&u.xlmeta){var De=(u.xlmeta.Cell||[])[+P.cm-1];De&&De.type=="XLDAPR"&&(U.D=!0)}if($e){var j=Vt(P.r);d[j.r]||(d[j.r]=[]),d[j.r][j.c]=U}else d[P.r]=U}}}}ae.length>0&&(d["!rows"]=ae)}}();function D3(e,t,r,a){var s=[],i=[],o=kt(e["!ref"]),c="",l,d="",u=[],f=0,m=0,h=e["!rows"],g=Array.isArray(e),p={r:d},x,w=-1;for(m=o.s.c;m<=o.e.c;++m)u[m]=Ht(m);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=Kt(f),m=o.s.c;m<=o.e.c;++m){l=u[m]+d;var _=g?(e[f]||[])[m]:e[l];_!==void 0&&(c=P3(_,l,e,t))!=null&&i.push(c)}(i.length>0||h&&h[f])&&(p={r:d},h&&h[f]&&(x=h[f],x.hidden&&(p.hidden=1),w=-1,x.hpx?w=Wi(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(p.ht=w,p.customHeight=1),x.level&&(p.outlineLevel=x.level)),s[s.length]=Re("row",i.join(""),p))}if(h)for(;f<h.length;++f)h&&h[f]&&(p={r:f+1},x=h[f],x.hidden&&(p.hidden=1),w=-1,x.hpx?w=Wi(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(p.ht=w,p.customHeight=1),x.level&&(p.outlineLevel=x.level),s[s.length]=Re("row","",p));return s.join("")}function Zh(e,t,r,a){var s=[rr,Re("worksheet",null,{xmlns:pn[0],"xmlns:r":mr.r})],i=r.SheetNames[e],o=0,c="",l=r.Sheets[i];l==null&&(l={});var d=l["!ref"]||"A1",u=kt(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=dt(u)}a||(a={}),l["!comments"]=[];var f=[];v3(l,r,e,t,s),s[s.length]=Re("dimension",null,{ref:d}),s[s.length]=F3(l,t,e,r),t.sheetFormat&&(s[s.length]=Re("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=j3(l,l["!cols"])),s[o=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(c=D3(l,t),c.length>0&&(s[s.length]=c)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),l["!protect"]&&(s[s.length]=w3(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=T3(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=p3(l["!merges"]));var m=-1,h,g=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Dt(a,-1,It(p[1].Target).replace(/#.*$/,""),gt.HLINK),h["r:id"]="rId"+g),(m=p[1].Target.indexOf("#"))>-1&&(h.location=It(p[1].Target.slice(m+1))),p[1].Tooltip&&(h.tooltip=It(p[1].Tooltip)),s[s.length]=Re("hyperlink",null,h))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=N3(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Fr("ignoredErrors",Re("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(g=Dt(a,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),s[s.length]=Re("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=f),l["!comments"].length>0&&(g=Dt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),s[s.length]=Re("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function I3(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function R3(e,t,r){var a=be(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=Wi(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var c=0,l=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,m=-1,h=u<<10;h<u+1<<10;++h){d.c=h;var g=Array.isArray(r)?(r[d.r]||[])[d.c]:r[at(d)];g&&(f<0&&(f=h),m=h)}f<0||(++c,a.write_shift(4,f),a.write_shift(4,m))}var p=a.l;return a.l=l,a.write_shift(4,c),a.l=p,a.length>a.l?a.slice(0,a.l):a}function L3(e,t,r,a){var s=R3(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&je(e,0,s)}var M3=bn,B3=ni;function U3(){}function q3(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=zv(e),r}function $3(e,t,r){r==null&&(r=be(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return zo({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Kf(e,r),r.slice(0,r.l)}function H3(e){var t=ja(e);return[t]}function z3(e,t,r){return r==null&&(r=be(8)),gn(t,r)}function W3(e){var t=vn(e);return[t]}function V3(e,t,r){return r==null&&(r=be(4)),yn(t,r)}function G3(e){var t=ja(e),r=e.read_shift(1);return[t,r,"b"]}function X3(e,t,r){return r==null&&(r=be(9)),gn(t,r),r.write_shift(1,e.v?1:0),r}function K3(e){var t=vn(e),r=e.read_shift(1);return[t,r,"b"]}function J3(e,t,r){return r==null&&(r=be(5)),yn(t,r),r.write_shift(1,e.v?1:0),r}function Y3(e){var t=ja(e),r=e.read_shift(1);return[t,r,"e"]}function Q3(e,t,r){return r==null&&(r=be(9)),gn(t,r),r.write_shift(1,e.v),r}function Z3(e){var t=vn(e),r=e.read_shift(1);return[t,r,"e"]}function eS(e,t,r){return r==null&&(r=be(8)),yn(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function tS(e){var t=ja(e),r=e.read_shift(4);return[t,r,"s"]}function rS(e,t,r){return r==null&&(r=be(12)),gn(t,r),r.write_shift(4,t.v),r}function aS(e){var t=vn(e),r=e.read_shift(4);return[t,r,"s"]}function sS(e,t,r){return r==null&&(r=be(8)),yn(t,r),r.write_shift(4,t.v),r}function nS(e){var t=ja(e),r=Br(e);return[t,r,"n"]}function iS(e,t,r){return r==null&&(r=be(16)),gn(t,r),cn(e.v,r),r}function em(e){var t=vn(e),r=Br(e);return[t,r,"n"]}function oS(e,t,r){return r==null&&(r=be(12)),yn(t,r),cn(e.v,r),r}function cS(e){var t=ja(e),r=r0(e);return[t,r,"n"]}function lS(e,t,r){return r==null&&(r=be(12)),gn(t,r),Jf(e.v,r),r}function dS(e){var t=vn(e),r=r0(e);return[t,r,"n"]}function uS(e,t,r){return r==null&&(r=be(8)),yn(t,r),Jf(e.v,r),r}function fS(e){var t=ja(e),r=Zl(e);return[t,r,"is"]}function hS(e){var t=ja(e),r=$r(e);return[t,r,"str"]}function mS(e,t,r){return r==null&&(r=be(12+4*e.v.length)),gn(t,r),br(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xS(e){var t=vn(e),r=$r(e);return[t,r,"str"]}function pS(e,t,r){return r==null&&(r=be(8+4*e.v.length)),yn(t,r),br(e.v,r),r.length>r.l?r.slice(0,r.l):r}function gS(e,t,r){var a=e.l+t,s=ja(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var c=hc(e,a-e.l,r);o[3]=Lr(c,null,s,r.supbooks,r)}else e.l=a;return o}function vS(e,t,r){var a=e.l+t,s=ja(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var c=hc(e,a-e.l,r);o[3]=Lr(c,null,s,r.supbooks,r)}else e.l=a;return o}function yS(e,t,r){var a=e.l+t,s=ja(e);s.r=r["!row"];var i=Br(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var c=hc(e,a-e.l,r);o[3]=Lr(c,null,s,r.supbooks,r)}else e.l=a;return o}function bS(e,t,r){var a=e.l+t,s=ja(e);s.r=r["!row"];var i=$r(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var c=hc(e,a-e.l,r);o[3]=Lr(c,null,s,r.supbooks,r)}else e.l=a;return o}var wS=bn,_S=ni;function SS(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function NS(e,t){var r=e.l+t,a=bn(e),s=e0(e),i=$r(e),o=$r(e),c=$r(e);e.l=r;var l={rfx:a,relId:s,loc:i,display:c};return o&&(l.Tooltip=o),l}function kS(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ni({s:Vt(e[0]),e:Vt(e[0])},r),t0("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return br(s||"",r),br(e[1].Tooltip||"",r),br("",r),r.slice(0,r.l)}function jS(){}function ES(e,t,r){var a=e.l+t,s=Yf(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var c=Y4(e,a-e.l,r);o[1]=c}else e.l=a;return o}function TS(e,t,r){var a=e.l+t,s=bn(e),i=[s];if(r.cellFormula){var o=Z4(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function AS(e,t,r){r==null&&(r=be(18));var a=mc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var tm=["left","right","top","bottom","header","footer"];function CS(e){var t={};return tm.forEach(function(r){t[r]=Br(e)}),t}function FS(e,t){return t==null&&(t=be(6*8)),an(e),tm.forEach(function(r){cn(e[r],t)}),t}function PS(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function OS(e,t,r){r==null&&(r=be(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function DS(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),ni(e,t),t}function IS(e,t){return t==null&&(t=be(16*4+2)),t.write_shift(2,e.password?c0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RS(){}function LS(){}function MS(e,t,r,a,s,i,o){if(!e)return e;var c=t||{};a||(a={"!id":{}});var l=c.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,m=!1,h,g,p,x,w,_,v,R,q,U=[];c.biff=12,c["!row"]=0;var P=0,X=!1,G=[],le={},se=c.supbooks||s.supbooks||[[]];if(se.sharedf=le,se.arrayf=G,se.SheetNames=s.SheetNames||s.Sheets.map(function($e){return $e.name}),!c.supbooks&&(c.supbooks=se,s.Names))for(var V=0;V<s.Names.length;++V)se[0][V+1]=s.Names[V];var ye=[],Ee=[],ve=!1;Vi[16]={n:"BrtShortReal",f:em};var Fe;if(ms(e,function(ae,He,Ue){if(!m)switch(Ue){case 148:d=ae;break;case 0:h=ae,c.sheetRows&&c.sheetRows<=h.r&&(m=!0),R=Kt(x=h.r),c["!row"]=h.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Yn(ae.hpt)),Ee[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:ae[2]},ae[2]){case"n":g.v=ae[1];break;case"s":v=Ti[ae[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!ae[1];break;case"e":g.v=ae[1],c.cellText!==!1&&(g.w=xs[g.v]);break;case"str":g.t="s",g.v=ae[1];break;case"is":g.t="s",g.v=ae[1].t;break}if((p=o.CellXf[ae[0].iStyleRef])&&Yh(g,p.numFmtId,null,c,i,o),w=ae[0].c==-1?w+1:ae[0].c,c.dense?(l[x]||(l[x]=[]),l[x][w]=g):l[Ht(w)+R]=g,c.cellFormula){for(X=!1,P=0;P<G.length;++P){var k=G[P];h.r>=k[0].s.r&&h.r<=k[0].e.r&&w>=k[0].s.c&&w<=k[0].e.c&&(g.F=dt(k[0]),X=!0)}!X&&ae.length>3&&(g.f=ae[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>w&&(u.s.c=w),u.e.r<h.r&&(u.e.r=h.r),u.e.c<w&&(u.e.c=w),c.cellDates&&p&&g.t=="n"&&xn(Ze[p.numFmtId])){var B=Ts(g.v);B&&(g.t="d",g.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}Fe&&(Fe.type=="XLDAPR"&&(g.D=!0),Fe=void 0);break;case 1:case 12:if(!c.sheetStubs||f)break;g={t:"z",v:void 0},w=ae[0].c==-1?w+1:ae[0].c,c.dense?(l[x]||(l[x]=[]),l[x][w]=g):l[Ht(w)+R]=g,u.s.r>h.r&&(u.s.r=h.r),u.s.c>w&&(u.s.c=w),u.e.r<h.r&&(u.e.r=h.r),u.e.c<w&&(u.e.c=w),Fe&&(Fe.type=="XLDAPR"&&(g.D=!0),Fe=void 0);break;case 176:U.push(ae);break;case 49:Fe=((c.xlmeta||{}).Cell||[])[ae-1];break;case 494:var E=a["!id"][ae.relId];for(E?(ae.Target=E.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=E):ae.relId==""&&(ae.Target="#"+ae.loc),x=ae.rfx.s.r;x<=ae.rfx.e.r;++x)for(w=ae.rfx.s.c;w<=ae.rfx.e.c;++w)c.dense?(l[x]||(l[x]=[]),l[x][w]||(l[x][w]={t:"z",v:void 0}),l[x][w].l=ae):(_=at({c:w,r:x}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=ae);break;case 426:if(!c.cellFormula)break;G.push(ae),q=c.dense?l[x][w]:l[Ht(w)+R],q.f=Lr(ae[1],u,{r:h.r,c:w},se,c),q.F=dt(ae[0]);break;case 427:if(!c.cellFormula)break;le[at(ae[0].s)]=ae[1],q=c.dense?l[x][w]:l[Ht(w)+R],q.f=Lr(ae[1],u,{r:h.r,c:w},se,c);break;case 60:if(!c.cellStyles)break;for(;ae.e>=ae.s;)ye[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},ve||(ve=!0,l0(ae.w/256)),Ds(ye[ae.e+1]);break;case 161:l["!autofilter"]={ref:dt(ae)};break;case 476:l["!margins"]=ae;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),ae.name&&(s.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(l["!outline"]={above:ae.above,left:ae.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),ae.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!He.T){if(!f||c.WTF)throw new Error("Unexpected record 0x"+Ue.toString(16))}}},c),delete c.supbooks,delete c["!row"],!l["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(l["!ref"]=dt(d||u)),c.sheetRows&&l["!ref"]){var Te=kt(l["!ref"]);c.sheetRows<=+Te.e.r&&(Te.e.r=c.sheetRows-1,Te.e.r>u.e.r&&(Te.e.r=u.e.r),Te.e.r<Te.s.r&&(Te.s.r=Te.e.r),Te.e.c>u.e.c&&(Te.e.c=u.e.c),Te.e.c<Te.s.c&&(Te.s.c=Te.e.c),l["!fullref"]=l["!ref"],l["!ref"]=dt(Te))}return U.length>0&&(l["!merges"]=U),ye.length>0&&(l["!cols"]=ye),Ee.length>0&&(l["!rows"]=Ee),l}function BS(e,t,r,a,s,i,o){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Lt(t),t.z=t.z||Ze[14],t.v=xr(zt(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var l={r,c:a};switch(l.s=qs(s.cellXfs,t,s),t.l&&i["!links"].push([at(l),t.l]),t.c&&i["!comments"].push([at(l),t.c]),t.t){case"s":case"str":return s.bookSST?(c=m0(s.Strings,t.v,s.revStrings),l.t="s",l.v=c,o?je(e,18,sS(t,l)):je(e,7,rS(t,l))):(l.t="str",o?je(e,17,pS(t,l)):je(e,6,mS(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?je(e,13,uS(t,l)):je(e,2,lS(t,l)):o?je(e,16,oS(t,l)):je(e,5,iS(t,l)),!0;case"b":return l.t="b",o?je(e,15,J3(t,l)):je(e,4,X3(t,l)),!0;case"e":return l.t="e",o?je(e,14,eS(t,l)):je(e,3,Q3(t,l)),!0}return o?je(e,12,V3(t,l)):je(e,1,z3(t,l)),!0}function US(e,t,r,a){var s=kt(t["!ref"]||"A1"),i,o="",c=[];je(e,145);var l=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){o=Kt(u),L3(e,t,s,u);var f=!1;if(u<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){u===s.s.r&&(c[m]=Ht(m)),i=c[m]+o;var h=l?(t[u]||[])[m]:t[i];if(!h){f=!1;continue}f=BS(e,h,u,m,a,t,f)}}je(e,146)}function qS(e,t){!t||!t["!merges"]||(je(e,177,SS(t["!merges"].length)),t["!merges"].forEach(function(r){je(e,176,_S(r))}),je(e,178))}function $S(e,t){!t||!t["!cols"]||(je(e,390),t["!cols"].forEach(function(r,a){r&&je(e,60,AS(a,r))}),je(e,391))}function HS(e,t){!t||!t["!ref"]||(je(e,648),je(e,649,DS(kt(t["!ref"]))),je(e,650))}function zS(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=Dt(r,-1,a[1].Target.replace(/#.*$/,""),gt.HLINK);je(e,494,kS(a,s))}}),delete t["!links"]}function WS(e,t,r,a){if(t["!comments"].length>0){var s=Dt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);je(e,551,t0("rId"+s)),t["!legacy"]=s}}function VS(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:dt(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=Yr(i);c.s.r==c.e.r&&(c.e.r=Yr(t["!ref"]).e.r,i=dt(c));for(var l=0;l<o.length;++l){var d=o[l];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),je(e,161,ni(kt(i))),je(e,162)}}function GS(e,t,r){je(e,133),je(e,137,OS(t,r)),je(e,138),je(e,134)}function XS(e,t){t["!protect"]&&je(e,535,IS(t["!protect"]))}function KS(e,t,r,a){var s=sa(),i=r.SheetNames[e],o=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var l=kt(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],je(s,129),(r.vbaraw||o["!outline"])&&je(s,147,$3(c,o["!outline"])),je(s,148,B3(l)),GS(s,o,r.Workbook),$S(s,o),US(s,o,e,t),XS(s,o),VS(s,o,r,e),qS(s,o),zS(s,o,a),o["!margins"]&&je(s,476,FS(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&HS(s,o),WS(s,o,e,a),je(s,130),s.end()}function JS(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=At((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function YS(e,t,r,a,s,i){var o=i||{"!type":"chart"};if(!e)return i;var c=0,l=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var m=JS(f);u.s.r=u.s.c=0,u.e.c=c,d=Ht(c),m[0].forEach(function(h,g){o[d+Kt(g)]={t:"n",v:h,z:m[1]},l=g}),u.e.r<l&&(u.e.r=l),++c}),c>0&&(o["!ref"]=dt(u)),o}function QS(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(Qh);return c&&x0(c[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function ZS(e,t){e.l+=10;var r=$r(e);return{name:r}}function e6(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ms(e,function(l,d,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var p0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],t6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],r6=[],a6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ou(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=$t(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function cu(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=$t(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function rm(e){cu(e.WBProps,p0),cu(e.CalcPr,a6),ou(e.WBView,t6),ou(e.Sheets,r6),Gn.date1904=$t(e.WBProps.date1904)}function s6(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var n6="][*?/\\".split("");function am(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return n6.forEach(function(a){if(e.indexOf(a)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function i6(e,t,r){e.forEach(function(a,s){am(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function sm(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];i6(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)s3(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var o6=/<\w+:workbook/;function c6(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(e.replace(zr,function(l,d){var u=nt(l);switch(Qa(u[0])){case"<?xml":break;case"<workbook":l.match(o6)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":p0.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=$t(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Rt(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=At(Rt(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Rt(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),$t(u.hidden||"0")&&(i.Hidden=!0),o=d+l.length;break;case"</definedName>":i.Ref=At(Rt(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),pn.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return rm(r),r}function nm(e){var t=[rr];t[t.length]=Re("workbook",null,{xmlns:pn[0],"xmlns:r":mr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(p0.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Re("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:It(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Re("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var l={name:c.Name};c.Comment&&(l.comment=c.Comment),c.Sheet!=null&&(l.localSheetId=""+c.Sheet),c.Hidden&&(l.hidden="1"),c.Ref&&(t[t.length]=Re("definedName",It(c.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function l6(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hl(e),r.name=$r(e),r}function d6(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),t0(e.strRelID,t),br(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function u6(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?$r(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function f6(e,t){t||(t=be(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Kf(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function h6(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function m6(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=Wv(e),o=Q4(e,0,r),c=e0(e);e.l=a;var l={Name:i,Ptg:o};return s<268435455&&(l.Sheet=s),c&&(l.Comment=c),l}function x6(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],Vi[16]={n:"BrtFRTArchID$",f:h6},ms(e,function(l,d,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Lr(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),rm(r),r.Names=i,r.supbooks=o,r}function p6(e,t){je(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};je(e,156,d6(s))}je(e,144)}function g6(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return br("SheetJS",t),br(Ii.version,t),br(Ii.version,t),br("7262",t),t.length>t.l?t.slice(0,t.l):t}function v6(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function y6(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(je(e,135),je(e,158,v6(s)),je(e,136))}}function b6(e,t){var r=sa();return je(r,131),je(r,128,g6()),je(r,153,f6(e.Workbook&&e.Workbook.WBProps||null)),y6(r,e),p6(r,e),je(r,132),r.end()}function w6(e,t,r){return t.slice(-4)===".bin"?x6(e,r):c6(e,r)}function _6(e,t,r,a,s,i,o,c){return t.slice(-4)===".bin"?MS(e,a,r,s,i,o,c):x3(e,a,r,s,i,o,c)}function S6(e,t,r,a,s,i,o,c){return t.slice(-4)===".bin"?e6(e,a,r,s,i):QS(e,a,r,s,i)}function N6(e,t,r,a,s,i,o,c){return t.slice(-4)===".bin"?E_():T_()}function k6(e,t,r,a,s,i,o,c){return t.slice(-4)===".bin"?k_():j_()}function j6(e,t,r,a){return t.slice(-4)===".bin"?_w(e,r,a):dw(e,r,a)}function E6(e,t,r){return Mh(e,r)}function T6(e,t,r){return t.slice(-4)===".bin"?Ab(e,r):jb(e,r)}function A6(e,t,r){return t.slice(-4)===".bin"?b_(e,r):u_(e,r)}function C6(e,t,r){return t.slice(-4)===".bin"?c_(e):i_(e)}function F6(e,t,r,a){return r.slice(-4)===".bin"?l_(e,t,r,a):void 0}function P6(e,t,r){return t.slice(-4)===".bin"?a_(e,t,r):n_(e,t,r)}function O6(e,t,r){return(t.slice(-4)===".bin"?b6:nm)(e)}function D6(e,t,r,a,s){return(t.slice(-4)===".bin"?KS:Zh)(e,r,a,s)}function I6(e,t,r){return(t.slice(-4)===".bin"?Pw:Rh)(e,r)}function R6(e,t,r){return(t.slice(-4)===".bin"?Pb:Th)(e,r)}function L6(e,t,r){return(t.slice(-4)===".bin"?w_:qh)(e)}function M6(e){return(e.slice(-4)===".bin"?s_:Bh)()}var im=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,om=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Oa(e,t){var r=e.split(/\s+/),a=[];if(t||(a[0]=r[0]),r.length===1)return a;var s=e.match(im),i,o,c,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(om),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),a[c]=i[2].slice(1,i[2].length-1));return a}function B6(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(im),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(om),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Ci;function U6(e,t){var r=Ci[e]||At(e);return r==="General"?nn(t):fa(r,t)}function q6(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$t(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=zt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[At(t)]=s}function $6(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Li(e.v):e.w=nn(e.v):e.w=U6(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Ci[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&xn(a)){var s=Ts(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function H6(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=rw[a.Pattern]||a.Pattern)}e[t.ID]=t}function z6(e,t,r,a,s,i,o,c,l,d){var u="General",f=a.StyleID,m={};d=d||{};var h=[],g=0;for(f===void 0&&c&&(f=c.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=$t(e);break;case"String":a.t="s",a.r=kd(At(e)),a.v=e.indexOf("<")>-1?At(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(zt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=At(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=eh[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=kd(t||e));break}if($6(a,u,d),d.cellFormula!==!1)if(a.Formula){var p=At(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=Vn(p,s),delete a.Formula,a.ArrayRange=="RC"?a.F=Vn("RC:RC",s):a.ArrayRange&&(a.F=Vn(a.ArrayRange,s),l.push([kt(a.F),a.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(a.F=l[g][1]);d.cellStyles&&(h.forEach(function(x){!m.patternType&&x.patternType&&(m.patternType=x.patternType)}),a.s=m),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function W6(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hc(e,t){var r=t||{};ri();var a=$n(zl(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Et<"u"?a=Et.utils.decode(65001,Ro(a)):a=Rt(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Lt(r);return o.type="string",Jn.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Y){s.indexOf("<"+Y)>=0&&(i=!0)}),i)return EN(a,r);Ci={"General Number":"General","General Date":Ze[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ze[15],"Short Date":Ze[14],"Long Time":Ze[19],"Medium Time":Ze[18],"Short Time":Ze[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ze[2],Standard:Ze[4],Percent:Ze[10],Scientific:Ze[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,l=[],d,u={},f=[],m=r.dense?[]:{},h="",g={},p={},x=Oa('<Data ss:Type="String">'),w=0,_=0,v=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},q={},U={},P="",X=0,G=[],le={},se={},V=0,ye=[],Ee=[],ve={},Fe=[],Te,$e=!1,ae=[],He=[],Ue={},k=0,B=0,E={Sheets:[],WBProps:{date1904:!1}},D={};Ui.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";c=Ui.exec(a);)switch(c[3]=(z=c[3]).toLowerCase()){case"data":if(z=="data"){if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break}if(l[l.length-1][1])break;c[1]==="/"?z6(a.slice(w,c.index),P,x,l[l.length-1][0]=="comment"?ve:g,{c:_,r:v},q,Fe[_],p,ae,r):(P="",x=Oa(c[0]),w=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ee.length>0&&(g.c=Ee),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(m[v]||(m[v]=[]),m[v][_]=g):m[Ht(_)+Kt(v)]=g),g.HRef&&(g.l={Target:At(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(k=_+(parseInt(g.MergeAcross,10)|0),B=v+(parseInt(g.MergeDown,10)|0),G.push({s:{c:_,r:v},e:{c:k,r:B}})),!r.sheetStubs)g.MergeAcross?_=k+1:++_;else if(g.MergeAcross||g.MergeDown){for(var oe=_;oe<=k;++oe)for(var J=v;J<=B;++J)(oe>_||J>v)&&(r.dense?(m[J]||(m[J]=[]),m[J][oe]={t:"z"}):m[Ht(oe)+Kt(J)]={t:"z"});_=k+1}else++_;else g=B6(c[0]),g.Index&&(_=+g.Index-1),_<R.s.c&&(R.s.c=_),_>R.e.c&&(R.e.c=_),c[0].slice(-2)==="/>"&&++_,Ee=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<R.s.r&&(R.s.r=v),v>R.e.r&&(R.e.r=v),c[0].slice(-2)==="/>"&&(p=Oa(c[0]),p.Index&&(v=+p.Index-1)),_=0,++v):(p=Oa(c[0]),p.Index&&(v=+p.Index-1),Ue={},(p.AutoFitHeight=="0"||p.Height)&&(Ue.hpx=parseInt(p.Height,10),Ue.hpt=Wi(Ue.hpx),He[v]=Ue),p.Hidden=="1"&&(Ue.hidden=!0,He[v]=Ue));break;case"worksheet":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));f.push(h),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(m["!ref"]=dt(R),r.sheetRows&&r.sheetRows<=R.e.r&&(m["!fullref"]=m["!ref"],R.e.r=r.sheetRows-1,m["!ref"]=dt(R))),G.length&&(m["!merges"]=G),Fe.length>0&&(m["!cols"]=Fe),He.length>0&&(m["!rows"]=He),u[h]=m}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,l.push([c[3],!1]),d=Oa(c[0]),h=At(d.Name),m=r.dense?[]:{},G=[],ae=[],He=[],D={name:h,Hidden:0},E.Sheets.push(D);break;case"table":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;l.push([c[3],!1]),Fe=[],$e=!1}break;case"style":c[1]==="/"?H6(q,U,r):U=Oa(c[0]);break;case"numberformat":U.nf=At(Oa(c[0]).Format||"General"),Ci[U.nf]&&(U.nf=Ci[U.nf]);for(var ce=0;ce!=392&&Ze[ce]!=U.nf;++ce);if(ce==392){for(ce=57;ce!=392;++ce)if(Ze[ce]==null){Ja(U.nf,ce);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Te=Oa(c[0]),Te.Hidden&&(Te.hidden=!0,delete Te.Hidden),Te.Width&&(Te.wpx=parseInt(Te.Width,10)),!$e&&Te.wpx>10){$e=!0,Mr=Dh;for(var he=0;he<Fe.length;++he)Fe[he]&&Ds(Fe[he])}$e&&Ds(Te),Fe[Te.Index-1||Fe.length]=Te;for(var De=0;De<+Te.Span;++De)Fe[Fe.length]=Lt(Te);break;case"namedrange":if(c[1]==="/")break;E.Names||(E.Names=[]);var j=nt(c[0]),de={Name:j.Name,Ref:Vn(j.RefersTo.slice(1),{r:0,c:0})};E.Sheets.length>0&&(de.Sheet=E.Sheets.length-1),E.Names.push(de);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?P+=a.slice(X,c.index):X=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;U.Interior=Oa(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?p2(le,z,a.slice(V,c.index)):V=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else l.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));W6(ve),Ee.push(ve)}else l.push([c[3],!1]),d=Oa(c[0]),ve={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var fe=Oa(c[0]);m["!autofilter"]={ref:Vn(fe.Range).replace(/\$/g,"")},l.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=l.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&l.push([c[3],!0]);break;case"null":break;default:if(l.length==0&&c[3]=="document"||l.length==0&&c[3]=="uof")return hu(a,r);var re=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(c[3]){case"date1904":E.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(V,c.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else V=c.index+c[0].length;break;case"header":m["!margins"]||an(m["!margins"]={},"xlml"),isNaN(+nt(c[0]).Margin)||(m["!margins"].header=+nt(c[0]).Margin);break;case"footer":m["!margins"]||an(m["!margins"]={},"xlml"),isNaN(+nt(c[0]).Margin)||(m["!margins"].footer=+nt(c[0]).Margin);break;case"pagemargins":var xe=nt(c[0]);m["!margins"]||an(m["!margins"]={},"xlml"),isNaN(+xe.Top)||(m["!margins"].top=+xe.Top),isNaN(+xe.Left)||(m["!margins"].left=+xe.Left),isNaN(+xe.Right)||(m["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(m["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":E.Views||(E.Views=[]),E.Views[0]||(E.Views[0]={}),E.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||c[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?q6(se,z,ye,a.slice(V,c.index)):(ye=c,V=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+l.join("|")}var L={};return!r.bookSheets&&!r.bookProps&&(L.Sheets=u),L.SheetNames=f,L.Workbook=E,L.SSF=Lt(Ze),L.Props=le,L.Custprops=se,L}function bl(e,t){switch(y0(t=t||{}),t.type||"base64"){case"base64":return Hc(ua(e),t);case"binary":case"buffer":case"file":return Hc(e,t);case"array":return Hc(Bs(e),t)}}function V6(e,t){var r=[];return e.Props&&r.push(g2(e.Props,t)),e.Custprops&&r.push(v2(e.Props,e.Custprops)),r.join("")}function G6(){return""}function X6(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(Re("NumberFormat",null,{"ss:Format":It(Ze[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(Re("Style",i.join(""),o))}),Re("Styles",r.join(""))}function cm(e){return Re("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+f0(e.Ref,{r:0,c:0})})}function K6(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(cm(s)))}return Re("Names",r.join(""))}function J6(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],o=0;o<s.length;++o){var c=s[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(cm(c)))}return i.join("")}function Y6(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Re("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Re("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Re("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(Re("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Fr("ProtectContents","True")),e["!protect"].objects&&s.push(Fr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Fr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Fr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":Re("WorksheetOptions",s.join(""),{xmlns:oa.x})}function Q6(e){return e.map(function(t){var r=bv(t.t||""),a=Re("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Re("Comment",a,{"ss:Author":t.a})}).join("")}function Z6(e,t,r,a,s,i,o){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+It(f0(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=Vt(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=It(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=It(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(c["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(c["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",m="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",m=String(e.v);break;case"b":f="Boolean",m=e.v?"1":"0";break;case"e":f="Error",m=xs[e.v];break;case"d":f="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ze[14]);break;case"s":f="String",m=yv(e.v||"");break}var h=qs(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+h),c["ss:Index"]=o.c+1;var g=e.v!=null?m:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=Q6(e.c)),Re("Cell",p,c)}function eN(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Yn(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tN(e,t,r,a){if(!e["!ref"])return"";var s=kt(e["!ref"]),i=e["!merges"]||[],o=0,c=[];e["!cols"]&&e["!cols"].forEach(function(x,w){Ds(x);var _=!!x.width,v=mc(w,x),R={"ss:Index":w+1};_&&(R["ss:Width"]=Hi(v.width)),x.hidden&&(R["ss:Hidden"]="1"),c.push(Re("Column",null,R))});for(var l=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[eN(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var m=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(m=!0);break}if(!m){var h={r:d,c:f},g=at(h),p=l?(e[d]||[])[f]:e[g];u.push(Z6(p,g,e,t,r,a,h))}}u.push("</Row>"),u.length>2&&c.push(u.join(""))}return c.join("")}function rN(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?J6(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?tN(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(Y6(i,t,e,r)),a.join("")}function aN(e,t){t||(t={}),e.SSF||(e.SSF=Lt(Ze)),e.SSF&&(ri(),Zi(e.SSF),t.revssf=cc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(V6(e,t)),r.push(G6()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Re("Worksheet",rN(a,t,e),{"ss:Name":It(e.SheetNames[a])}));return r[2]=X6(e,t),r[3]=K6(e),rr+Re("Workbook",r.join(""),{xmlns:oa.ss,"xmlns:o":oa.o,"xmlns:x":oa.x,"xmlns:ss":oa.ss,"xmlns:dt":oa.dt,"xmlns:html":oa.html})}function sN(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Jv(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Yv(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nN=[60,1084,2066,2165,2175];function iN(e,t,r,a,s){var i=a,o=[],c=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(c)}o.push(c),r.l+=i;for(var l=ds(r,r.l),d=wl[l],u=0;d!=null&&nN.indexOf(l)>-1;)i=ds(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),c=r.slice(u,r.l+4+i),o.push(c),r.l+=4+i,d=wl[l=ds(r,r.l)];var f=yr(o);Cr(f,0);var m=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(m),m+=o[h].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function za(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ze[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xs[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Li(e.v):e.w=nn(e.v):e.w=fa(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&xn(Ze[a]||String(a))){var s=Ts(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Eo(e,t,r){return{v:e,ixfe:t,t:r}}function oN(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},o={},c=null,l=[],d="",u={},f,m="",h,g,p,x,w={},_=[],v,R,q=[],U=[],P={Sheets:[],WBProps:{date1904:!1},Views:[{}]},X={},G=function(Ke){return Ke<8?en[Ke]:Ke<64&&U[Ke-8]||en[Ke]},le=function(Ke,vt,yt){var mt=vt.XF.data;if(!(!mt||!mt.patternType||!yt||!yt.cellStyles)){vt.s={},vt.s.patternType=mt.patternType;var lr;(lr=$i(G(mt.icvFore)))&&(vt.s.fgColor={rgb:lr}),(lr=$i(G(mt.icvBack)))&&(vt.s.bgColor={rgb:lr})}},se=function(Ke,vt,yt){if(!(Ue>1)&&!(yt.sheetRows&&Ke.r>=yt.sheetRows)){if(yt.cellStyles&&vt.XF&&vt.XF.data&&le(Ke,vt,yt),delete vt.ixfe,delete vt.XF,f=Ke,m=at(Ke),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<o.s.r&&(o.s.r=Ke.r),Ke.c<o.s.c&&(o.s.c=Ke.c),Ke.r+1>o.e.r&&(o.e.r=Ke.r+1),Ke.c+1>o.e.c&&(o.e.c=Ke.c+1),yt.cellFormula&&vt.f){for(var mt=0;mt<_.length;++mt)if(!(_[mt][0].s.c>Ke.c||_[mt][0].s.r>Ke.r)&&!(_[mt][0].e.c<Ke.c||_[mt][0].e.r<Ke.r)){vt.F=dt(_[mt][0]),(_[mt][0].s.c!=Ke.c||_[mt][0].s.r!=Ke.r)&&delete vt.f,vt.f&&(vt.f=""+Lr(_[mt][1],o,Ke,ae,V));break}}yt.dense?(s[Ke.r]||(s[Ke.r]=[]),s[Ke.r][Ke.c]=vt):s[m]=vt}},V={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var ye,Ee=[],ve=[],Fe=[],Te=[],$e=!1,ae=[];ae.SheetNames=V.snames,ae.sharedf=V.sharedf,ae.arrayf=V.arrayf,ae.names=[],ae.XTI=[];var He=0,Ue=0,k=0,B=[],E=[],D;V.codepage=1200,Sa(1200);for(var z=!1;e.l<e.length-1;){var oe=e.l,J=e.read_shift(2);if(J===0&&He===10)break;var ce=e.l===e.length?0:e.read_shift(2),he=wl[J];if(he&&he.f){if(t.bookSheets&&He===133&&J!==133)break;if(He=J,he.r===2||he.r==12){var De=e.read_shift(2);if(ce-=2,!V.enc&&De!==J&&((De&255)<<8|De>>8)!==J)throw new Error("rt mismatch: "+De+"!="+J);he.r==12&&(e.l+=10,ce-=10)}var j={};if(J===10?j=he.f(e,ce,V):j=iN(J,he,e,ce,V),Ue==0&&[9,521,1033,2057].indexOf(He)===-1)continue;switch(J){case 34:r.opts.Date1904=P.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=j,!t.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=j;break;case 66:var de=Number(j);switch(de){case 21010:de=1200;break;case 32768:de=1e4;break;case 32769:de=1252;break}Sa(V.codepage=de),z=!0;break;case 317:V.rrtabid=j;break;case 25:V.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:V.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(s["!type"]="dialog"),j.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),j.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:q.push(j);break;case 430:ae.push([j]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(j);break;case 24:case 536:D={Name:j.Name,Ref:Lr(j.rgce,o,null,ae,V)},j.itab>0&&(D.Sheet=j.itab-1),ae.names.push(D),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(E[j.itab-1]={ref:dt(j.rgce[0][0][1][2])});break;case 22:V.ExternCount=j;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(j),ae.XTI=ae.XTI.concat(j);break;case 2196:if(V.biff<8)break;D!=null&&(D.Comment=j[1]);break;case 18:s["!protect"]=j;break;case 19:j!==0&&V.WTF&&console.error("Password verifier: "+j);break;case 133:i[j.pos]=j,V.snames.push(j.name);break;case 10:{if(--Ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=dt(o),t.sheetRows&&t.sheetRows<=o.e.r){var fe=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=dt(o),o.e.r=fe}o.e.r++,o.e.c++}Ee.length>0&&(s["!merges"]=Ee),ve.length>0&&(s["!objects"]=ve),Fe.length>0&&(s["!cols"]=Fe),Te.length>0&&(s["!rows"]=Te),P.Sheets.push(X)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),V.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(V.biff=5,z=!0,Sa(V.codepage=28591)),V.biff==8&&j.BIFFVer==0&&j.dt==16&&(V.biff=2),Ue++)break;if(s=t.dense?[]:{},V.biff<8&&!z&&(z=!0,Sa(V.codepage=t.codepage||1252)),V.biff<5||j.BIFFVer==0&&j.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:e.l-ce,name:d};i[re.pos]=re,V.snames.push(d)}else d=(i[oe]||{name:""}).name;j.dt==32&&(s["!type"]="chart"),j.dt==64&&(s["!type"]="macro"),Ee=[],ve=[],V.arrayf=_=[],Fe=[],Te=[],$e=!1,X={Hidden:(i[oe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[j.r]||[])[j.c]:s[at({c:j.c,r:j.r})])&&++j.c,v={ixfe:j.ixfe,XF:q[j.ixfe]||{},v:j.val,t:"n"},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t);break;case 5:case 517:v={ixfe:j.ixfe,XF:q[j.ixfe],v:j.val,t:j.t},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t);break;case 638:v={ixfe:j.ixfe,XF:q[j.ixfe],v:j.rknum,t:"n"},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t);break;case 189:for(var xe=j.c;xe<=j.C;++xe){var L=j.rkrec[xe-j.c][0];v={ixfe:L,XF:q[L],v:j.rkrec[xe-j.c][1],t:"n"},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:xe,r:j.r},v,t)}break;case 6:case 518:case 1030:{if(j.val=="String"){c=j;break}if(v=Eo(j.val,j.cell.ixfe,j.tt),v.XF=q[v.ixfe],t.cellFormula){var Y=j.formula;if(Y&&Y[0]&&Y[0][0]&&Y[0][0][0]=="PtgExp"){var ke=Y[0][0][1][0],Pe=Y[0][0][1][1],Ge=at({r:ke,c:Pe});w[Ge]?v.f=""+Lr(j.formula,o,j.cell,ae,V):v.F=((t.dense?(s[ke]||[])[Pe]:s[Ge])||{}).F}else v.f=""+Lr(j.formula,o,j.cell,ae,V)}k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se(j.cell,v,t),c=j}break;case 7:case 519:if(c)c.val=j,v=Eo(j,c.cell.ixfe,"s"),v.XF=q[v.ixfe],t.cellFormula&&(v.f=""+Lr(c.formula,o,c.cell,ae,V)),k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se(c.cell,v,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(j);var et=at(j[0].s);if(h=t.dense?(s[j[0].s.r]||[])[j[0].s.c]:s[et],t.cellFormula&&h){if(!c||!et||!h)break;h.f=""+Lr(j[1],o,j[0],ae,V),h.F=dt(j[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!c)break;w[at(c.cell)]=j[0],h=t.dense?(s[c.cell.r]||[])[c.cell.c]:s[at(c.cell)],(h||{}).f=""+Lr(j[0],o,f,ae,V)}}break;case 253:v=Eo(l[j.isst].t,j.ixfe,"s"),l[j.isst].h&&(v.h=l[j.isst].h),v.XF=q[v.ixfe],k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:j.ixfe,XF:q[j.ixfe],t:"z"},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t));break;case 190:if(t.sheetStubs)for(var Pt=j.c;Pt<=j.C;++Pt){var qe=j.ixfe[Pt-j.c];v={ixfe:qe,XF:q[qe],t:"z"},k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:Pt,r:j.r},v,t)}break;case 214:case 516:case 4:v=Eo(j.val,j.ixfe,"s"),v.XF=q[v.ixfe],k>0&&(v.z=B[v.ixfe>>8&63]),za(v,t,r.opts.Date1904),se({c:j.c,r:j.r},v,t);break;case 0:case 512:Ue===1&&(o=j);break;case 252:l=j;break;case 1054:if(V.biff==4){B[k++]=j[1];for(var ht=0;ht<k+163&&Ze[ht]!=j[1];++ht);ht>=163&&Ja(j[1],k+163)}else Ja(j[1],j[0]);break;case 30:{B[k++]=j;for(var ot=0;ot<k+163&&Ze[ot]!=j;++ot);ot>=163&&Ja(j,k+163)}break;case 229:Ee=Ee.concat(j);break;case 93:ve[j.cmo[0]]=V.lastobj=j;break;case 438:V.lastobj.TxO=j;break;case 127:V.lastobj.ImData=j;break;case 440:for(x=j[0].s.r;x<=j[0].e.r;++x)for(p=j[0].s.c;p<=j[0].e.c;++p)h=t.dense?(s[x]||[])[p]:s[at({c:p,r:x})],h&&(h.l=j[1]);break;case 2048:for(x=j[0].s.r;x<=j[0].e.r;++x)for(p=j[0].s.c;p<=j[0].e.c;++p)h=t.dense?(s[x]||[])[p]:s[at({c:p,r:x})],h&&h.l&&(h.l.Tooltip=j[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;h=t.dense?(s[j[0].r]||[])[j[0].c]:s[at(j[0])];var wt=ve[j[2]];h||(t.dense?(s[j[0].r]||(s[j[0].r]=[]),h=s[j[0].r][j[0].c]={t:"z"}):h=s[at(j[0])]={t:"z"},o.e.r=Math.max(o.e.r,j[0].r),o.s.r=Math.min(o.s.r,j[0].r),o.e.c=Math.max(o.e.c,j[0].c),o.s.c=Math.min(o.s.c,j[0].c)),h.c||(h.c=[]),g={a:j[1],t:wt.TxO.t},h.c.push(g)}break;case 2173:Kw(q[j.ixfe],j.ext);break;case 125:{if(!V.cellStyles)break;for(;j.e>=j.s;)Fe[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},$e||($e=!0,l0(j.w/256)),Ds(Fe[j.e+1])}break;case 520:{var jt={};j.level!=null&&(Te[j.r]=jt,jt.level=j.level),j.hidden&&(Te[j.r]=jt,jt.hidden=!0),j.hpt&&(Te[j.r]=jt,jt.hpt=j.hpt,jt.hpx=Yn(j.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||an(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=j;break;case 161:s["!margins"]||an(s["!margins"]={}),s["!margins"].header=j.header,s["!margins"].footer=j.footer;break;case 574:j.RTL&&(P.Views[0].RTL=!0);break;case 146:U=j;break;case 2198:ye=j;break;case 140:R=j;break;case 442:d?X.CodeName=j||X.name:P.WBProps.CodeName=j||"ThisWorkbook";break}}else he||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=ce}return r.SheetNames=Yt(i).sort(function(Ft,Ke){return Number(Ft)-Number(Ke)}).map(function(Ft){return i[Ft].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&E.forEach(function(Ft,Ke){r.Sheets[r.SheetNames[Ke]]["!autofilter"]=Ft}),r.Strings=l,r.SSF=Lt(Ze),V.enc&&(r.Encryption=V.enc),ye&&(r.Themes=ye),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),ae.names.length>0&&(P.Names=ae.names),r.Workbook=P,r}var Fi={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function cN(e,t,r){var a=Ye.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=Hd(a,ml,Fi.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var o=Ye.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=Hd(o,xl,Fi.SI);for(var l in c)t[l]==null&&(t[l]=c[l])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(ih(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function lN(e,t){var r=[],a=[],s=[],i=0,o,c=yd(ml,"n"),l=yd(xl,"n");if(e.Props)for(o=Yt(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?a:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=Yt(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(c,o[i])?r:Object.prototype.hasOwnProperty.call(l,o[i])?a:s).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)hh.indexOf(s[i][0])>-1||nh.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&Ye.utils.cfb_add(t,"/SummaryInformation",zd(a,Fi.SI,l,xl)),(r.length||d.length)&&Ye.utils.cfb_add(t,"/DocumentSummaryInformation",zd(r,Fi.DSI,c,ml,d.length?d:null,Fi.UDI))}function g0(e,t){t||(t={}),y0(t),ic(),t.codepage&&nc(t.codepage);var r,a;if(e.FullPaths){if(Ye.find(e,"/encryption"))throw new Error("File is password-protected");r=Ye.find(e,"!CompObj"),a=Ye.find(e,"/Workbook")||Ye.find(e,"/Book")}else{switch(t.type){case"base64":e=ca(ua(e));break;case"binary":e=ca(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Cr(e,0),a={content:e}}var s,i;if(r&&sN(r),t.bookProps&&!t.bookSheets)s={};else{var o=xt?"buffer":"array";if(a&&a.content)s=oN(a.content,t);else if((i=Ye.find(e,"PerfectOffice_MAIN"))&&i.content)s=rn.to_workbook(i.content,(t.type=o,t));else if((i=Ye.find(e,"NativeContent_MAIN"))&&i.content)s=rn.to_workbook(i.content,(t.type=o,t));else throw(i=Ye.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ye.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=S_(e))}var c={};return e.FullPaths&&cN(e,c,t),s.Props=s.Custprops=c,t.bookFiles&&(s.cfb=e),s}function dN(e,t){var r=t||{},a=Ye.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ye.utils.cfb_add(a,s,lm(e,r)),r.biff==8&&(e.Props||e.Custprops)&&lN(e,a),r.biff==8&&e.vbaraw&&N_(a,Ye.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var Vi={0:{f:I3},1:{f:H3},2:{f:cS},3:{f:Y3},4:{f:G3},5:{f:nS},6:{f:hS},7:{f:tS},8:{f:bS},9:{f:yS},10:{f:gS},11:{f:vS},12:{f:W3},13:{f:dS},14:{f:Z3},15:{f:K3},16:{f:em},17:{f:xS},18:{f:aS},19:{f:Zl},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:m6},40:{},42:{},43:{f:hw},44:{f:uw},45:{f:pw},46:{f:vw},47:{f:gw},48:{},49:{f:Mv},50:{},51:{f:Qw},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Nh},62:{f:fS},63:{f:o_},64:{f:RS},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:PS},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:q3},148:{f:M3,p:16},151:{f:jS},152:{},153:{f:u6},154:{},155:{},156:{f:l6},157:{},158:{},159:{T:1,f:Tb},160:{T:-1},161:{T:1,f:bn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wS},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Jw},336:{T:-1},337:{f:t_,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Sh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ES},427:{f:TS},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CS},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:U3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NS},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:v_},633:{T:1},634:{T:-1},635:{T:1,f:p_},636:{T:-1},637:{f:$v},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:ZS},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:LS},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wl={6:{f:qc},10:{f:Ns},12:{f:or},13:{f:or},14:{f:tr},15:{f:tr},16:{f:Br},17:{f:tr},18:{f:tr},19:{f:or},20:{f:Jd},21:{f:Jd},23:{f:Sh},24:{f:Qd},25:{f:tr},26:{},27:{},28:{f:Ly},29:{},34:{f:tr},35:{f:Yd},38:{f:Br},39:{f:Br},40:{f:Br},41:{f:Br},42:{f:tr},43:{f:tr},47:{f:Kb},49:{f:dy},51:{f:or},60:{},61:{f:ny},64:{f:tr},65:{f:ly},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:X2},93:{f:Uy},94:{},95:{f:tr},96:{},97:{},99:{f:tr},125:{f:Nh},128:{f:ky},129:{f:J2},130:{f:or},131:{f:tr},132:{f:tr},133:{f:Y2},134:{},140:{f:Xy},141:{f:or},144:{},146:{f:Yy},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:sb},161:{f:eb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wy},190:{f:_y},193:{f:Ns},197:{},198:{},199:{},200:{},201:{},202:{f:tr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:tr},222:{},224:{f:Ny},225:{f:G2},226:{f:Ns},227:{},229:{f:My},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z2},253:{f:fy},255:{f:ty},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:tr},353:{f:Ns},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Cy},431:{f:tr},432:{},433:{},434:{},437:{},438:{f:Hy},439:{f:tr},440:{f:zy},441:{},442:{f:ro},443:{},444:{f:or},445:{},446:{},448:{f:Ns},449:{f:sy,r:2},450:{f:Ns},512:{f:Gd},513:{f:ab},515:{f:Ty},516:{f:my},517:{f:Kd},519:{f:nb},520:{f:ry},523:{},545:{f:Zd},549:{f:Vd},566:{},574:{f:oy},638:{f:by},659:{},1048:{},1054:{f:py},1084:{},1212:{f:Dy},2048:{f:Vy},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:No},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ns},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Qy,r:12},2173:{f:Xw,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:tr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Oy,r:12},2197:{},2198:{f:$w,r:12},2199:{},2200:{},2201:{},2202:{f:Iy,r:12},2203:{f:Ns},2204:{},2205:{},2206:{},2207:{},2211:{f:ay},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:tb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Jy},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Gd},1:{},2:{f:db},3:{f:cb},4:{f:ob},5:{f:Kd},7:{f:fb},8:{},9:{f:No},11:{},22:{f:or},30:{f:vy},31:{},32:{},33:{f:Zd},36:{},37:{f:Vd},50:{f:hb},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:ib},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:mb},223:{},234:{},354:{},421:{},518:{f:qc},521:{f:No},536:{f:Qd},547:{f:Yd},561:{},579:{},1030:{f:qc},1033:{f:No},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Me(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Jl(r)&&e.push(r)}}function uN(e,t,r,a){var s=a||(r||[]).length||0;if(s<=8224)return Me(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],c=0,l=0,d=0;d+(o[c]||8224)<=8224;)d+=o[c]||8224,c++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(l,l+d)),l+=d;l<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[c]||8224)<=8224;)d+=o[c]||8224,c++;u.write_shift(2,d),e.push(r.slice(l,l+d)),l+=d}}}function io(e,t,r){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function fN(e,t,r,a){var s=be(9);return io(s,e,t),xh(r,a||"b",s),s}function hN(e,t,r){var a=be(8+2*r.length);return io(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function mN(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?xr(zt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Me(e,2,ub(r,a,s)):Me(e,3,lb(r,a,s));return;case"b":case"e":Me(e,5,fN(r,a,t.v,t.t));return;case"s":case"str":Me(e,4,hN(r,a,(t.v||"").slice(0,255)));return}Me(e,1,io(null,r,a))}function xN(e,t,r,a){var s=Array.isArray(t),i=kt(t["!ref"]||"A1"),o,c="",l=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=dt(i)}for(var d=i.s.r;d<=i.e.r;++d){c=Kt(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(l[u]=Ht(u)),o=l[u]+c;var f=s?(t[d]||[])[u]:t[o];f&&mN(e,f,d,u)}}}function pN(e,t){for(var r=t||{},a=sa(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Me(a,r.biff==4?1033:r.biff==3?521:9,i0(e,16,r)),xN(a,e.Sheets[e.SheetNames[s]],s,r),Me(a,10),a.end()}function gN(e,t,r){Me(e,49,uy({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function vN(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Me(e,1054,gy(s,t[s],r))})}function yN(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Me(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),bh(kt(t["!ref"]||"A1"),r),r.write_shift(4,4),Me(e,2152,r)}function bN(e,t){for(var r=0;r<16;++r)Me(e,224,Xd({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Me(e,224,Xd(a,0,t))})}function wN(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Me(e,440,Wy(a)),a[1].Tooltip&&Me(e,2048,Gy(a))}delete t["!links"]}function _N(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Me(e,125,Zy(mc(s,a),s))})}}function SN(e,t,r,a,s){var i=16+qs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Me(e,513,dn(r,a,i));return}if(t.bf)Me(e,6,J4(t,r,a,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?xr(zt(t.v)):t.v;Me(e,515,Ay(r,a,o,i));break;case"b":case"e":Me(e,517,Ey(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var c=m0(s.Strings,t.v,s.revStrings);Me(e,253,hy(r,a,c,i))}else Me(e,516,xy(r,a,(t.v||"").slice(0,255),i,s));break;default:Me(e,513,dn(r,a,i))}}function NN(e,t,r){var a=sa(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},l=Array.isArray(i),d=t.biff==8,u,f="",m=[],h=kt(i["!ref"]||"A1"),g=d?65536:16384;if(h.e.c>255||h.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,g-1)}Me(a,2057,i0(r,16,t)),Me(a,13,_a(1)),Me(a,12,_a(100)),Me(a,15,Jr(!0)),Me(a,17,Jr(!1)),Me(a,16,cn(.001)),Me(a,95,Jr(!0)),Me(a,42,Jr(!1)),Me(a,43,Jr(!1)),Me(a,130,_a(1)),Me(a,128,jy([0,0])),Me(a,131,Jr(!1)),Me(a,132,Jr(!1)),d&&_N(a,i["!cols"]),Me(a,512,yy(h,t)),d&&(i["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){f=Kt(p);for(var x=h.s.c;x<=h.e.c;++x){p===h.s.r&&(m[x]=Ht(x)),u=m[x]+f;var w=l?(i[p]||[])[x]:i[u];w&&(SN(a,w,p,x,t),d&&w.l&&i["!links"].push([u,w.l]))}}var _=c.CodeName||c.name||s;return d&&Me(a,574,cy((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Me(a,229,By(i["!merges"])),d&&wN(a,i),Me(a,442,ph(_)),d&&yN(a,i),Me(a,10),a.end()}function kN(e,t,r){var a=sa(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},c=r.biff==8,l=r.biff==5;if(Me(a,2057,i0(e,5,r)),r.bookType=="xla"&&Me(a,135),Me(a,225,c?_a(1200):null),Me(a,193,E2(2)),l&&Me(a,191),l&&Me(a,192),Me(a,226),Me(a,92,K2("SheetJS",r)),Me(a,66,_a(c?1200:1252)),c&&Me(a,353,_a(0)),c&&Me(a,448),Me(a,317,rb(e.SheetNames.length)),c&&e.vbaraw&&Me(a,211),c&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Me(a,442,ph(d))}Me(a,156,_a(17)),Me(a,25,Jr(!1)),Me(a,18,Jr(!1)),Me(a,19,_a(0)),c&&Me(a,431,Jr(!1)),c&&Me(a,444,_a(0)),Me(a,61,iy()),Me(a,64,Jr(!1)),Me(a,141,_a(0)),Me(a,34,Jr(s6(e)=="true")),Me(a,14,Jr(!0)),c&&Me(a,439,Jr(!1)),Me(a,218,_a(0)),gN(a,e,r),vN(a,e.SSF,r),bN(a,r),c&&Me(a,352,Jr(!1));var u=a.end(),f=sa();c&&Me(f,140,Ky()),c&&r.Strings&&uN(f,252,ey(r.Strings)),Me(f,10);var m=f.end(),h=sa(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(c?12:11)+(c?2:1)*e.SheetNames[p].length;var x=u.length+g+m.length;for(p=0;p<e.SheetNames.length;++p){var w=i[p]||{};Me(h,133,Q2({pos:x,hs:w.Hidden||0,dt:0,name:e.SheetNames[p]},r)),x+=t[p].length}var _=h.end();if(g!=_.length)throw new Error("BS8 "+g+" != "+_.length);var v=[];return u.length&&v.push(u),_.length&&v.push(_),m.length&&v.push(m),yr(v)}function jN(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Lt(Ze)),e&&e.SSF&&(ri(),Zi(e.SSF),r.revssf=cc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,b0(r),r.cellXfs=[],qs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=NN(s,r,e);return a.unshift(kN(e,a,r)),yr(a)}function lm(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=Yr(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return jN(e,t);case 4:case 3:case 2:return pN(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function lu(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,c=i&&i.index||e.length,l=fv(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(o=0;o<l.length;++o){var p=l[o].trim(),x=p.slice(0,3).toLowerCase();if(x=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(x!="<td"&&x!="<th")){var w=p.split(/<\/t[dh]>/i);for(c=0;c<w.length;++c){var _=w[c].trim();if(_.match(/<t[dh]/i)){for(var v=_,R=0;v.charAt(0)=="<"&&(R=v.indexOf(">"))>-1;)v=v.slice(R+1);for(var q=0;q<g.length;++q){var U=g[q];U.s.c==u&&U.s.r<d&&d<=U.e.r&&(u=U.e.c+1,q=-1)}var P=nt(_.slice(0,_.indexOf(">")));m=P.colspan?+P.colspan:1,((f=+P.rowspan)>1||m>1)&&g.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+m-1}});var X=P.t||P["data-t"]||"";if(!v.length){u+=m;continue}if(v=Lf(v),h.s.r>d&&(h.s.r=d),h.e.r<d&&(h.e.r=d),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!v.length){u+=m;continue}var G={t:"s",v};r.raw||!v.trim().length||X=="s"||(v==="TRUE"?G={t:"b",v:!0}:v==="FALSE"?G={t:"b",v:!1}:isNaN(La(v))?isNaN(Kn(v).getDate())||(G={t:"d",v:zt(v)},r.cellDates||(G={t:"n",v:xr(G.v)}),G.z=r.dateNF||Ze[14]):G={t:"n",v:La(v)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=G):a[at({r:d,c:u})]=G,u+=m}}}}return a["!ref"]=dt(h),g.length&&(a["!merges"]=g),a}function dm(e,t,r,a){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,l=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){c=-1;break}c=s[d].e.r-s[d].s.r+1,l=s[d].e.c-s[d].s.c+1;break}if(!(c<0)){var u=at({r,c:o}),f=a.dense?(e[r]||[])[o]:e[u],m=f&&f.v!=null&&(f.h||Hl(f.w||(Ya(f),f.w)||""))||"",h={};c>1&&(h.rowspan=c),l>1&&(h.colspan=l),a.editable?m='<span contenteditable="true">'+m+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+f.l.Target+'">'+m+"</a>")),h.id=(a.id||"sjs")+"-"+u,i.push(Re("td",m,h))}}var g="<tr>";return g+i.join("")+"</tr>"}var um='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fm="</body></html>";function EN(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Us(lu(r[0],t),t);var a=k0();return r.forEach(function(s,i){j0(a,lu(s,t),"Sheet"+(i+1))}),a}function hm(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function mm(e,t){var r=t||{},a=r.header!=null?r.header:um,s=r.footer!=null?r.footer:fm,i=[a],o=Yr(e["!ref"]);r.dense=Array.isArray(e),i.push(hm(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)i.push(dm(e,o,c,r));return i.push("</table>"+s),i.join("")}function xm(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?Vt(a.origin):a.origin;s=o.r,i=o.c}var c=t.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=Yr(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],m=0,h=e["!rows"]||(e["!rows"]=[]),g=0,p=0,x=0,w=0,_=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<c.length&&p<l;++g){var R=c[g];if(du(R)){if(a.display)continue;h[p]={hidden:!0}}var q=R.children;for(x=w=0;x<q.length;++x){var U=q[x];if(!(a.display&&du(U))){var P=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):Lf(U.innerHTML),X=U.getAttribute("data-z")||U.getAttribute("z");for(m=0;m<f.length;++m){var G=f[m];G.s.c==w+i&&G.s.r<p+s&&p+s<=G.e.r&&(w=G.e.c+1-i,m=-1)}v=+U.getAttribute("colspan")||1,((_=+U.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+s,c:w+i},e:{r:p+s+(_||1)-1,c:w+i+(v||1)-1}});var le={t:"s",v:P},se=U.getAttribute("data-t")||U.getAttribute("t")||"";P!=null&&(P.length==0?le.t=se||"z":a.raw||P.trim().length==0||se=="s"||(P==="TRUE"?le={t:"b",v:!0}:P==="FALSE"?le={t:"b",v:!1}:isNaN(La(P))?isNaN(Kn(P).getDate())||(le={t:"d",v:zt(P)},a.cellDates||(le={t:"n",v:xr(le.v)}),le.z=a.dateNF||Ze[14]):le={t:"n",v:La(P)})),le.z===void 0&&X!=null&&(le.z=X);var V="",ye=U.getElementsByTagName("A");if(ye&&ye.length)for(var Ee=0;Ee<ye.length&&!(ye[Ee].hasAttribute("href")&&(V=ye[Ee].getAttribute("href"),V.charAt(0)!="#"));++Ee);V&&V.charAt(0)!="#"&&(le.l={Target:V}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][w+i]=le):e[at({c:w+i,r:p+s})]=le,d.e.c<w+i&&(d.e.c=w+i),w+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+s),e["!ref"]=dt(d),p>=l&&(e["!fullref"]=dt((d.e.r=c.length-g+p-1+s,d))),e}function pm(e,t){var r=t||{},a=r.dense?[]:{};return xm(a,e,t)}function TN(e,t){return Us(pm(e,t),t)}function du(e){var t="",r=AN(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function AN(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function CN(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=At(t.replace(/<[^>]*>/g,""));return[r]}var uu={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gm(e,t){var r=t||{},a=zl(e),s=[],i,o,c={name:""},l="",d=0,u,f,m={},h=[],g=r.dense?[]:{},p,x,w={value:""},_="",v=0,R=[],q=-1,U=-1,P={s:{r:1e6,c:1e7},e:{r:0,c:0}},X=0,G={},le=[],se={},V=0,ye=0,Ee=[],ve=1,Fe=1,Te=[],$e={Names:[]},ae={},He=["",""],Ue=[],k={},B="",E=0,D=!1,z=!1,oe=0;for(Ui.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Ui.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(P.e.c>=P.s.c&&P.e.r>=P.s.r?g["!ref"]=dt(P):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=P.e.r&&(g["!fullref"]=g["!ref"],P.e.r=r.sheetRows-1,g["!ref"]=dt(P)),le.length&&(g["!merges"]=le),Ee.length&&(g["!rows"]=Ee),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),m[u.name]=g,z=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=nt(p[0],!1),q=U=-1,P.s.r=P.s.c=1e7,P.e.r=P.e.c=0,g=r.dense?[]:{},le=[],Ee=[],z=!0);break;case"table-row-group":p[1]==="/"?--X:++X;break;case"table-row":case"":if(p[1]==="/"){q+=ve,ve=1;break}if(f=nt(p[0],!1),f.?q=f.-1:q==-1&&(q=0),ve=+f["number-rows-repeated"]||1,ve<10)for(oe=0;oe<ve;++oe)X>0&&(Ee[q+oe]={level:X});U=-1;break;case"covered-table-cell":p[1]!=="/"&&++U,r.sheetStubs&&(r.dense?(g[q]||(g[q]=[]),g[q][U]={t:"z"}):g[at({r:q,c:U})]={t:"z"}),_="",R=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++U,w=nt(p[0],!1),Fe=parseInt(w["number-columns-repeated"]||"1",10),x={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(x.f=iu(At(w.formula))),(w.||w["value-type"])=="string"&&(x.t="s",x.v=At(w["string-value"]||""),r.dense?(g[q]||(g[q]=[]),g[q][U]=x):g[at({r:q,c:U})]=x),U+=Fe-1;else if(p[1]!=="/"){++U,_="",v=0,R=[],Fe=1;var J=ve?q+ve-1:q;if(U>P.e.c&&(P.e.c=U),U<P.s.c&&(P.s.c=U),q<P.s.r&&(P.s.r=q),J>P.e.r&&(P.e.r=J),w=nt(p[0],!1),Ue=[],k={},x={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=At(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(V=parseInt(w["number-matrix-rows-spanned"],10)||0,ye=parseInt(w["number-matrix-columns-spanned"],10)||0,se={s:{r:q,c:U},e:{r:q+V-1,c:U+ye-1}},x.F=dt(se),Te.push([se,x.F])),w.formula)x.f=iu(w.formula);else for(oe=0;oe<Te.length;++oe)q>=Te[oe][0].s.r&&q<=Te[oe][0].e.r&&U>=Te[oe][0].s.c&&U<=Te[oe][0].e.c&&(x.F=Te[oe][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(V=parseInt(w["number-rows-spanned"],10)||0,ye=parseInt(w["number-columns-spanned"],10)||0,se={s:{r:q,c:U},e:{r:q+V-1,c:U+ye-1}},le.push(se)),w["number-columns-repeated"]&&(Fe=parseInt(w["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=$t(w["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(w.value);break;case"percentage":x.t="n",x.v=parseFloat(w.value);break;case"currency":x.t="n",x.v=parseFloat(w.value);break;case"date":x.t="d",x.v=zt(w["date-value"]),r.cellDates||(x.t="n",x.v=xr(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=lv(w["time-value"])/86400,r.cellDates&&(x.t="d",x.v=lc(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(w.);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",w["string-value"]!=null&&(_=At(w["string-value"]),R=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(D=!1,x.t==="s"&&(x.v=_||"",R.length&&(x.R=R),D=v==0),ae.Target&&(x.l=ae),Ue.length>0&&(x.c=Ue,Ue=[]),_&&r.cellText!==!1&&(x.w=_),D&&(x.t="z",delete x.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=q))for(var ce=0;ce<ve;++ce){if(Fe=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(g[q+ce]||(g[q+ce]=[]),g[q+ce][U]=ce==0?x:Lt(x);--Fe>0;)g[q+ce][U+Fe]=Lt(x);else for(g[at({r:q+ce,c:U})]=x;--Fe>0;)g[at({r:q+ce,c:U+Fe})]=Lt(x);P.e.c<=U&&(P.e.c=U)}Fe=parseInt(w["number-columns-repeated"]||"1",10),U+=Fe-1,Fe=0,x={},_="",R=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;k.t=_,R.length&&(k.R=R),k.a=B,Ue.push(k)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);B="",E=0,_="",v=0,R=[];break;case"creator":p[1]==="/"?B=a.slice(E,p.index):E=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);_="",v=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(G[c.name]=l,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(l="",c=nt(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=nt(p[0],!1),l+=uu[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=nt(p[0],!1),l+=uu[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=nt(p[0],!1),He=$c(o["cell-range-address"]);var he={Name:o.name,Ref:He[0]+"!"+He[1]};z&&(he.Sheet=h.length),$e.Names.push(he);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!w||!w["string-value"])){var De=CN(a.slice(v,p.index));_=(_.length>0?_+`
`:"")+De[0]}else nt(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{He=$c(nt(p[0])["target-range-address"]),m[He[0]]["!autofilter"]={ref:He[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(ae=nt(p[0],!1),!ae.href)break;ae.Target=At(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(He=$c(ae.Target.slice(1)),ae.Target="#"+He[0]+"!"+He[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var j={Sheets:m,SheetNames:h,Workbook:$e};return r.bookSheets&&delete j.Sheets,j}function fu(e,t){t=t||{},wa(e,"META-INF/manifest.xml")&&c2(ir(e,"META-INF/manifest.xml"),t);var r=la(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=gm(Rt(r),t);return wa(e,"meta.xml")&&(a.Props=ah(ir(e,"meta.xml"))),a}function hu(e,t){return gm(e,t)}var FN=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return rr+t}}(),mu=function(){var e=function(i){return It(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,c){var l=[];l.push('      <table:table table:name="'+It(o.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,u=0,f=Yr(i["!ref"]||"A1"),m=i["!merges"]||[],h=0,g=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)l.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",x=i["!rows"]||[];for(d=0;d<f.s.r;++d)p=x[d]?' table:style-name="ro'+x[d].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=x[d]?' table:style-name="ro'+x[d].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)l.push(t);for(;u<=f.e.c;++u){var w=!1,_={},v="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>u)&&!(m[h].s.r>d)&&!(m[h].e.c<u)&&!(m[h].e.r<d)){(m[h].s.c!=u||m[h].s.r!=d)&&(w=!0),_["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,_["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(w){l.push(r);continue}var R=at({r:d,c:u}),q=g?(i[d]||[])[u]:i[R];if(q&&q.f&&(_["table:formula"]=It(r3(q.f)),q.F&&q.F.slice(0,R.length)==R)){var U=Yr(q.F);_["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,_["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!q){l.push(t);continue}switch(q.t){case"b":v=q.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=q.v?"true":"false";break;case"n":v=q.w||String(q.v||0),_["office:value-type"]="float",_["office:value"]=q.v||0;break;case"s":case"str":v=q.v==null?"":q.v,_["office:value-type"]="string";break;case"d":v=q.w||zt(q.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=zt(q.v).toISOString(),_["table:style-name"]="ce1";break;default:l.push(t);continue}var P=e(v);if(q.l&&q.l.Target){var X=q.l.Target;X=X.charAt(0)=="#"?"#"+a3(X.slice(1)):X,X.charAt(0)!="#"&&!X.match(/^\w+:/)&&(X="../"+X),P=Re("text:a",P,{"xlink:href":X.replace(/&/g,"&amp;")})}l.push("          "+Re("table:table-cell",Re("text:p",P,{}),_)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ds(f),f.ods=c;var m=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),i.push(`  </style:style>
`),++c}}});var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=l;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,c){var l=[rr],d=Bi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Bi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(l.push("<office:document"+d+u+`>
`),l.push(rh().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+d+`>
`),s(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)l.push(a(o.Sheets[o.SheetNames[f]],o,f));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),c.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function vm(e,t){if(t.bookType=="fods")return mu(e,t);var r=Ul(),a="",s=[],i=[];return a="mimetype",ut(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",ut(r,a,mu(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",ut(r,a,FN(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",ut(r,a,rr+rh()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",ut(r,a,u2(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",ut(r,a,l2(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function un(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _l(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Rt(Bs(e))}function PN(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ca(Ka(e))}function ON(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Rs(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function xu(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function DN(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function IN(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function Gi(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Ot(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Jt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ct(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=Gi(e,r),i=s&7;s=Math.floor(s/8);var o=0,c;if(s==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);c=e.slice(l,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Gi(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:c,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Ar(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(Ot(a*8+s.type)),s.type==2&&t.push(Ot(s.data.length)),t.push(s.data))})}),Rs(t)}function v0(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function va(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=Gi(e,a),i=Ct(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:Jt(i[1][0].data),messages:[]};i[2].forEach(function(c){var l=Ct(c.data),d=Jt(l[3][0].data);o.messages.push({meta:l,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Jt(i[3][0].data)>>>0>0),r.push(o)}return r}function Rn(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Ot(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Ot(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Ot(o.data.length)}],a[2].push({data:Ar(o.meta),type:2})});var i=Ar(a);t.push(Ot(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),Rs(t)}function RN(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Gi(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Rs(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(d>=l)for(s.push(s[0].slice(-l)),d-=l;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-l,-l+d))}}var u=Rs(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function ya(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(RN(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Rs(t)}function Ln(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=Ot(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return Rs(t)}function LN(e,t,r,a){var s=un(e),i=s.getUint32(4,!0),o=(a>1?12:8)+xu(i&(a>1?3470:398))*4,c=-1,l=-1,d=NaN,u=new Date(2001,0,1);i&512&&(c=s.getUint32(o,!0),o+=4),o+=xu(i&(a>1?12288:4096))*4,i&16&&(l=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(c>-1)f={t:"s",v:r[c]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function MN(e,t,r){var a=un(e),s=a.getUint32(8,!0),i=12,o=-1,c=-1,l=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(l=DN(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(c=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function zc(e,t){var r=new Uint8Array(32),a=un(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,IN(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function Wc(e,t){var r=new Uint8Array(32),a=un(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function BN(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return LN(e,t,r,e[0]);case 5:return MN(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rr(e){var t=Ct(e);return Gi(t[1][0].data)}function pu(e,t){var r=Ct(t.data),a=Jt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var c=Ct(o.data),l=Jt(c[1][0].data)>>>0;switch(a){case 1:i[l]=_l(c[3][0].data);break;case 8:{var d=e[Rr(c[9][0].data)][0],u=Ct(d.data),f=e[Rr(u[1][0].data)][0],m=Jt(f.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=Ct(f.data);i[l]=h[3].map(function(g){return _l(g.data)}).join("")}break}}),i}function UN(e,t){var r,a,s,i,o,c,l,d,u,f,m,h,g,p,x=Ct(e),w=Jt(x[1][0].data)>>>0,_=Jt(x[2][0].data)>>>0,v=((a=(r=x[8])==null?void 0:r[0])==null?void 0:a.data)&&Jt(x[8][0].data)>0||!1,R,q;if((i=(s=x[7])==null?void 0:s[0])!=null&&i.data&&t!=0)R=(c=(o=x[7])==null?void 0:o[0])==null?void 0:c.data,q=(d=(l=x[6])==null?void 0:l[0])==null?void 0:d.data;else if((f=(u=x[4])==null?void 0:u[0])!=null&&f.data&&t!=1)R=(h=(m=x[4])==null?void 0:m[0])==null?void 0:h.data,q=(p=(g=x[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var U=v?4:1,P=un(R),X=[],G=0;G<R.length/2;++G){var le=P.getUint16(G*2,!0);le<65535&&X.push([G,le])}if(X.length!=_)throw"Expected ".concat(_," cells, found ").concat(X.length);var se=[];for(G=0;G<X.length-1;++G)se[X[G][0]]=q.subarray(X[G][1]*U,X[G+1][1]*U);return X.length>=1&&(se[X[X.length-1][0]]=q.subarray(X[X.length-1][1]*U)),{R:w,cells:se}}function qN(e,t){var r,a=Ct(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Jt(a[7][0].data)>>>0>0?1:0:-1,i=v0(a[5],function(o){return UN(o,s)});return{nrows:Jt(a[4][0].data)>>>0,data:i.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(l,d){if(o[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));o[c.R][d]=l}),o},[])}}function $N(e,t,r){var a,s=Ct(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Jt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Jt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=dt(i);var o=Ct(s[4][0].data),c=pu(e,e[Rr(o[4][0].data)][0]),l=(a=o[17])!=null&&a[0]?pu(e,e[Rr(o[17][0].data)][0]):[],d=Ct(o[3][0].data),u=0;d[1].forEach(function(f){var m=Ct(f.data),h=e[Rr(m[2][0].data)][0],g=Jt(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=qN(e,h);p.data.forEach(function(x,w){x.forEach(function(_,v){var R=at({r:u+w,c:v}),q=BN(_,c,l);q&&(r[R]=q)})}),u+=p.nrows})}function HN(e,t){var r=Ct(t.data),a={"!ref":"A1"},s=e[Rr(r[2][0].data)],i=Jt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return $N(e,s[0],a),a}function zN(e,t){var r,a=Ct(t.data),s={name:(r=a[1])!=null&&r[0]?_l(a[1][0].data):"",sheets:[]},i=v0(a[2],Rr);return i.forEach(function(o){e[o].forEach(function(c){var l=Jt(c.meta[1][0].data);l==6e3&&s.sheets.push(HN(e,c))})}),s}function WN(e,t){var r=k0(),a=Ct(t.data),s=v0(a[1],Rr);if(s.forEach(function(i){e[i].forEach(function(o){var c=Jt(o.meta[1][0].data);if(c==2){var l=zN(e,o);l.sheets.forEach(function(d,u){j0(r,d,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Vc(e){var t,r,a,s,i={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var d;try{d=ya(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=va(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var c=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Jt(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||o.forEach(function(l){i[l].forEach(function(d){var u=Jt(d.meta[1][0].data)>>>0;if(u==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return WN(i,c)}function VN(e,t,r){var a,s,i,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Jt(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var l=0,d=un(e[7][0].data),u=0,f=[],m=un(e[4][0].data),h=0,g=[],p=0;p<t.length;++p){if(t[p]==null){d.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),m.setUint16(p*2,h,!0);var x,w;switch(typeof t[p]){case"string":x=zc({t:"s",v:t[p]},r),w=Wc({t:"s",v:t[p]},r);break;case"number":x=zc({t:"n",v:t[p]},r),w=Wc({t:"n",v:t[p]},r);break;case"boolean":x=zc({t:"b",v:t[p]},r),w=Wc({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(x),u+=x.length,g.push(w),h+=w.length,++l}for(e[2][0].data=Ot(l);p<e[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return e[6][0].data=Rs(f),e[3][0].data=Rs(g),l}function GN(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Yr(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(dt(a)));var i=Ko(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(B){return B.forEach(function(E){typeof E=="string"&&o.push(E)})});var c={},l=[],d=Ye.read(t.numbers,{type:"base64"});d.FileIndex.map(function(B,E){return[B,d.FullPaths[E]]}).forEach(function(B){var E=B[0],D=B[1];if(E.type==2&&E.name.match(/\.iwa/)){var z=E.content,oe=ya(z),J=va(oe);J.forEach(function(ce){l.push(ce.id),c[ce.id]={deps:[],location:D,type:Jt(ce.messages[0].meta[1][0].data)}})}}),l.sort(function(B,E){return B-E});var u=l.filter(function(B){return B>1}).map(function(B){return[B,Ot(B)]});d.FileIndex.map(function(B,E){return[B,d.FullPaths[E]]}).forEach(function(B){var E=B[0];if(B[1],!!E.name.match(/\.iwa/)){var D=va(ya(E.content));D.forEach(function(z){z.messages.forEach(function(oe){u.forEach(function(J){z.messages.some(function(ce){return Jt(ce.meta[1][0].data)!=11006&&ON(ce.data,J[1])})&&c[J[0]].deps.push(z.id)})})})}});for(var f=Ye.find(d,c[1].location),m=va(ya(f.content)),h,g=0;g<m.length;++g){var p=m[g];p.id==1&&(h=p)}var x=Rr(Ct(h.messages[0].data)[1][0].data);for(f=Ye.find(d,c[x].location),m=va(ya(f.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(h=p);for(x=Rr(Ct(h.messages[0].data)[2][0].data),f=Ye.find(d,c[x].location),m=va(ya(f.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(h=p);for(x=Rr(Ct(h.messages[0].data)[2][0].data),f=Ye.find(d,c[x].location),m=va(ya(f.content)),g=0;g<m.length;++g)p=m[g],p.id==x&&(h=p);var w=Ct(h.messages[0].data);{w[6][0].data=Ot(a.e.r+1),w[7][0].data=Ot(a.e.c+1);var _=Rr(w[46][0].data),v=Ye.find(d,c[_].location),R=va(ya(v.content));{for(var q=0;q<R.length&&R[q].id!=_;++q);if(R[q].id!=_)throw"Bad ColumnRowUIDMapArchive";var U=Ct(R[q].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var P=0;P<=a.e.c;++P){var X=[];X[1]=X[2]=[{type:0,data:Ot(P+420690)}],U[1].push({type:2,data:Ar(X)}),U[2].push({type:0,data:Ot(P)}),U[3].push({type:0,data:Ot(P)})}U[4]=[],U[5]=[],U[6]=[];for(var G=0;G<=a.e.r;++G)X=[],X[1]=X[2]=[{type:0,data:Ot(G+726270)}],U[4].push({type:2,data:Ar(X)}),U[5].push({type:0,data:Ot(G)}),U[6].push({type:0,data:Ot(G)});R[q].messages[0].data=Ar(U)}v.content=Ln(Rn(R)),v.size=v.content.length,delete w[46];var le=Ct(w[4][0].data);{le[7][0].data=Ot(a.e.r+1);var se=Ct(le[1][0].data),V=Rr(se[2][0].data);v=Ye.find(d,c[V].location),R=va(ya(v.content));{if(R[0].id!=V)throw"Bad HeaderStorageBucket";var ye=Ct(R[0].messages[0].data);for(G=0;G<i.length;++G){var Ee=Ct(ye[2][0].data);Ee[1][0].data=Ot(G),Ee[4][0].data=Ot(i[G].length),ye[2][G]={type:ye[2][0].type,data:Ar(Ee)}}R[0].messages[0].data=Ar(ye)}v.content=Ln(Rn(R)),v.size=v.content.length;var ve=Rr(le[2][0].data);v=Ye.find(d,c[ve].location),R=va(ya(v.content));{if(R[0].id!=ve)throw"Bad HeaderStorageBucket";for(ye=Ct(R[0].messages[0].data),P=0;P<=a.e.c;++P)Ee=Ct(ye[2][0].data),Ee[1][0].data=Ot(P),Ee[4][0].data=Ot(a.e.r+1),ye[2][P]={type:ye[2][0].type,data:Ar(Ee)};R[0].messages[0].data=Ar(ye)}v.content=Ln(Rn(R)),v.size=v.content.length;var Fe=Rr(le[4][0].data);(function(){for(var B=Ye.find(d,c[Fe].location),E=va(ya(B.content)),D,z=0;z<E.length;++z){var oe=E[z];oe.id==Fe&&(D=oe)}var J=Ct(D.messages[0].data);{J[3]=[];var ce=[];o.forEach(function(j,de){ce[1]=[{type:0,data:Ot(de)}],ce[2]=[{type:0,data:Ot(1)}],ce[3]=[{type:2,data:PN(j)}],J[3].push({type:2,data:Ar(ce)})})}D.messages[0].data=Ar(J);var he=Rn(E),De=Ln(he);B.content=De,B.size=B.content.length})();var Te=Ct(le[3][0].data);{var $e=Te[1][0];delete Te[2];var ae=Ct($e.data);{var He=Rr(ae[2][0].data);(function(){for(var B=Ye.find(d,c[He].location),E=va(ya(B.content)),D,z=0;z<E.length;++z){var oe=E[z];oe.id==He&&(D=oe)}var J=Ct(D.messages[0].data);{delete J[6],delete Te[7];var ce=new Uint8Array(J[5][0].data);J[5]=[];for(var he=0,De=0;De<=a.e.r;++De){var j=Ct(ce);he+=VN(j,i[De],o),j[1][0].data=Ot(De),J[5].push({data:Ar(j),type:2})}J[1]=[{type:0,data:Ot(a.e.c+1)}],J[2]=[{type:0,data:Ot(a.e.r+1)}],J[3]=[{type:0,data:Ot(he)}],J[4]=[{type:0,data:Ot(a.e.r+1)}]}D.messages[0].data=Ar(J);var de=Rn(E),fe=Ln(de);B.content=fe,B.size=B.content.length})()}$e.data=Ar(ae)}le[3][0].data=Ar(Te)}w[4][0].data=Ar(le)}h.messages[0].data=Ar(w);var Ue=Rn(m),k=Ln(Ue);return f.content=k,f.size=f.content.length,d}function ym(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function y0(e){ym([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function b0(e){ym([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function XN(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function KN(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,XN(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function JN(e,t,r,a,s,i,o,c,l,d,u,f){try{i[a]=Ei(la(e,r,!0),t);var m=ir(e,t),h;switch(c){case"sheet":h=_6(m,t,s,l,i[a],d,u,f);break;case"chart":if(h=S6(m,t,s,l,i[a],d,u,f),!h||!h["!drawel"])break;var g=vi(h["!drawel"].Target,t),p=qi(g),x=d_(la(e,g,!0),Ei(la(e,p,!0),g)),w=vi(x,g),_=qi(w);h=YS(la(e,w,!0),w,l,Ei(la(e,_,!0),w),d,h);break;case"macro":h=N6(m,t,s,l,i[a],d,u,f);break;case"dialog":h=k6(m,t,s,l,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=h;var v=[];i&&i[a]&&Yt(i[a]).forEach(function(R){var q="";if(i[a][R].Type==gt.CMNT){q=vi(i[a][R].Target,t);var U=A6(ir(e,q,!0),q,l);if(!U||!U.length)return;tu(h,U,!1)}i[a][R].Type==gt.TCMNT&&(q=vi(i[a][R].Target,t),v=v.concat(f_(ir(e,q,!0),l)))}),v&&v.length&&tu(h,v,!0,l.people||[])}catch(R){if(l.WTF)throw R}}function pa(e){return e.charAt(0)=="/"?e.slice(1):e}function bm(e,t){if(ri(),t=t||{},y0(t),wa(e,"META-INF/manifest.xml")||wa(e,"objectdata.xml"))return fu(e,t);if(wa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vc<"u"){if(e.FileIndex)return Vc(e);var r=Ye.utils.cfb_new();return _d(e).forEach(function(Ee){ut(r,Ee,Of(e,Ee))}),Vc(r)}throw new Error("Unsupported NUMBERS file")}if(!wa(e,"[Content_Types].xml"))throw wa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):wa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=_d(e),s=i2(la(e,"[Content_Types].xml")),i=!1,o,c;if(s.workbooks.length===0&&(c="xl/workbook.xml",ir(e,c,!0)&&s.workbooks.push(c)),s.workbooks.length===0){if(c="xl/workbook.bin",!ir(e,c,!0))throw new Error("Could not find workbook");s.workbooks.push(c),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},d={};if(!t.bookSheets&&!t.bookProps){if(Ti=[],s.sst)try{Ti=T6(ir(e,pa(s.sst)),s.sst,t)}catch(Ee){if(t.WTF)throw Ee}t.cellStyles&&s.themes.length&&(l=E6(la(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=j6(ir(e,pa(s.style)),s.style,l,t))}s.links.map(function(Ee){try{var ve=Ei(la(e,qi(pa(Ee))),Ee);return F6(ir(e,pa(Ee)),ve,Ee,t)}catch{}});var u=w6(ir(e,pa(s.workbooks[0])),s.workbooks[0],t),f={},m="";s.coreprops.length&&(m=ir(e,pa(s.coreprops[0]),!0),m&&(f=ah(m)),s.extprops.length!==0&&(m=ir(e,pa(s.extprops[0]),!0),m&&h2(m,f,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(m=la(e,pa(s.custprops[0]),!0),m&&(h=x2(m,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(ve){return ve.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=h),t.bookSheets&&typeof o<"u"&&(g.SheetNames=o),t.bookSheets?g.SheetNames:t.bookProps))return g;o={};var p={};t.bookDeps&&s.calcchain&&(p=C6(ir(e,pa(s.calcchain)),s.calcchain));var x=0,w={},_,v;{var R=u.Sheets;f.Worksheets=R.length,f.SheetNames=[];for(var q=0;q!=R.length;++q)f.SheetNames[q]=R[q].name}var U=i?"bin":"xml",P=s.workbooks[0].lastIndexOf("/"),X=(s.workbooks[0].slice(0,P+1)+"_rels/"+s.workbooks[0].slice(P+1)+".rels").replace(/^\//,"");wa(e,X)||(X="xl/_rels/workbook."+U+".rels");var G=Ei(la(e,X,!0),X.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=P6(ir(e,pa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=m_(ir(e,pa(s.people[0])),t)),G&&(G=KN(G,u.Sheets));var le=ir(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=f.Worksheets;++x){var se="sheet";if(G&&G[x]?(_="xl/"+G[x][1].replace(/[\/]?xl\//,""),wa(e,_)||(_=G[x][1]),wa(e,_)||(_=X.replace(/_rels\/.*$/,"")+G[x][1]),se=G[x][2]):(_="xl/worksheets/sheet"+(x+1-le)+"."+U,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(f.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,ye=0;ye!=t.sheets.length;++ye)typeof t.sheets[ye]=="number"&&t.sheets[ye]==x&&(V=1),typeof t.sheets[ye]=="string"&&t.sheets[ye].toLowerCase()==f.SheetNames[x].toLowerCase()&&(V=1);if(!V)continue e}}JN(e,_,v,f.SheetNames[x],x,w,o,se,t,u,l,d)}return g={Directory:s,Workbook:u,Props:f,Custprops:h,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Ti,Styles:d,Themes:l,SSF:Lt(Ze)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(Ee,ve){Ee=Ee.replace(/^Root Entry[\/]/,""),g.keys.push(Ee),g.files[Ee]=e.FileIndex[ve]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=ir(e,pa(s.vba[0]),!0):s.defaults&&s.defaults.bin===__&&(g.vbaraw=ir(e,"xl/vbaProject.bin",!0))),g}function YN(e,t){var r=t||{},a="Workbook",s=Ye.find(e,a);try{if(a="/!DataSpaces/Version",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Ob(s.content),a="/!DataSpaces/DataSpaceMap",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Ib(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Rb(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);Mb(s.content)}catch{}if(a="/EncryptionInfo",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Bb(s.content);if(a="/EncryptedPackage",s=Ye.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],s.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function QN(e,t){return t.bookType=="ods"?vm(e,t):t.bookType=="numbers"?GN(e,t):t.bookType=="xlsb"?ZN(e,t):wm(e,t)}function ZN(e,t){Hn=1024,e&&!e.SSF&&(e.SSF=Lt(Ze)),e&&e.SSF&&(ri(),Zi(e.SSF),t.revssf=cc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ai?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=$h.indexOf(t.bookType)>-1,s=s0();b0(t=t||{});var i=Ul(),o="",c=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ut(i,o,sh(e.Props,t)),s.coreprops.push(o),Dt(t.rels,2,o,gt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&l.push(e.SheetNames[d]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ut(i,o,oh(e.Props)),s.extprops.push(o),Dt(t.rels,3,o,gt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ut(i,o,ch(e.Custprops)),s.custprops.push(o),Dt(t.rels,4,o,gt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var u={"!id":{}},f=e.Sheets[e.SheetNames[c-1]],m=(f||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,ut(i,o,D6(c-1,o,t,e,u)),s.sheets.push(o),Dt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0])}if(f){var h=f["!comments"],g=!1,p="";h&&h.length>0&&(p="xl/comments"+c+"."+r,ut(i,p,L6(h,p)),s.comments.push(p),Dt(u,-1,"../comments"+c+"."+r,gt.CMNT),g=!0),f["!legacy"]&&g&&ut(i,"xl/drawings/vmlDrawing"+c+".vml",Uh(c,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&ut(i,qi(o),Wn(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ut(i,o,R6(t.Strings,o,t)),s.strs.push(o),Dt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),o="xl/workbook."+r,ut(i,o,O6(e,o)),s.workbooks.push(o),Dt(t.rels,1,o,gt.WB),o="xl/theme/theme1.xml",ut(i,o,d0(e.Themes,t)),s.themes.push(o),Dt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),o="xl/styles."+r,ut(i,o,I6(e,o,t)),s.styles.push(o),Dt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ut(i,o,e.vbaraw),s.vba.push(o),Dt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),o="xl/metadata."+r,ut(i,o,M6(o)),s.metadata.push(o),Dt(t.wbrels,-1,"metadata."+r,gt.XLMETA),ut(i,"[Content_Types].xml",th(s,t)),ut(i,"_rels/.rels",Wn(t.rels)),ut(i,"xl/_rels/workbook."+r+".rels",Wn(t.wbrels)),delete t.revssf,delete t.ssf,i}function wm(e,t){Hn=1024,e&&!e.SSF&&(e.SSF=Lt(Ze)),e&&e.SSF&&(ri(),Zi(e.SSF),t.revssf=cc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ai?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=$h.indexOf(t.bookType)>-1,s=s0();b0(t=t||{});var i=Ul(),o="",c=0;if(t.cellXfs=[],qs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ut(i,o,sh(e.Props,t)),s.coreprops.push(o),Dt(t.rels,2,o,gt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&l.push(e.SheetNames[d]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ut(i,o,oh(e.Props)),s.extprops.push(o),Dt(t.rels,3,o,gt.EXT_PROPS),e.Custprops!==e.Props&&Yt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ut(i,o,ch(e.Custprops)),s.custprops.push(o),Dt(t.rels,4,o,gt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},m=e.Sheets[e.SheetNames[c-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,ut(i,o,Zh(c-1,t,e,f)),s.sheets.push(o),Dt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0])}if(m){var g=m["!comments"],p=!1,x="";if(g&&g.length>0){var w=!1;g.forEach(function(_){_[1].forEach(function(v){v.T==!0&&(w=!0)})}),w&&(x="xl/threadedComments/threadedComment"+c+"."+r,ut(i,x,h_(g,u,t)),s.threadedcomments.push(x),Dt(f,-1,"../threadedComments/threadedComment"+c+"."+r,gt.TCMNT)),x="xl/comments"+c+"."+r,ut(i,x,qh(g)),s.comments.push(x),Dt(f,-1,"../comments"+c+"."+r,gt.CMNT),p=!0}m["!legacy"]&&p&&ut(i,"xl/drawings/vmlDrawing"+c+".vml",Uh(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}f["!id"].rId1&&ut(i,qi(o),Wn(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ut(i,o,Th(t.Strings,t)),s.strs.push(o),Dt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),o="xl/workbook."+r,ut(i,o,nm(e)),s.workbooks.push(o),Dt(t.rels,1,o,gt.WB),o="xl/theme/theme1.xml",ut(i,o,d0(e.Themes,t)),s.themes.push(o),Dt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),o="xl/styles."+r,ut(i,o,Rh(e,t)),s.styles.push(o),Dt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",ut(i,o,e.vbaraw),s.vba.push(o),Dt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),o="xl/metadata."+r,ut(i,o,Bh()),s.metadata.push(o),Dt(t.wbrels,-1,"metadata."+r,gt.XLMETA),u.length>1&&(o="xl/persons/person.xml",ut(i,o,x_(u)),s.people.push(o),Dt(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),ut(i,"[Content_Types].xml",th(s,t)),ut(i,"_rels/.rels",Wn(t.rels)),ut(i,"xl/_rels/workbook."+r+".rels",Wn(t.wbrels)),delete t.revssf,delete t.ssf,i}function w0(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ua(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ek(e,t){return Ye.find(e,"EncryptedPackage")?YN(e,t):g0(e,t)}function tk(e,t){var r,a=e,s=t||{};return s.type||(s.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Df(a,s),bm(r,s)}function _m(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bl(e.slice(r),t);default:break e}return Jn.to_workbook(e,t)}function rk(e,t){var r="",a=w0(e,t);switch(t.type){case"base64":r=ua(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=on(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Rt(r)),t.type="binary",_m(r,t)}function ak(e,t){var r=e;return t.type=="base64"&&(r=ua(r)),r=Et.utils.decode(1200,r.slice(2),"str"),t.type="binary",_m(r,t)}function sk(e){return e.match(/[^\x00-\x7F]/)?Ka(e):e}function Gc(e,t,r,a){return a?(r.type="string",Jn.to_workbook(e,r)):Jn.to_workbook(t,r)}function Qn(e,t){ic();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Qn(new Uint8Array(e),(r=Lt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Gn={},r.dateNF&&(Gn.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",a=iv(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=sk(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Lt(r),r.type="array",Qn(Rl(a),r)}switch((s=w0(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return ek(Ye.read(a,r),r);break;case 9:if(s[1]<=8)return g0(a,r);break;case 60:return bl(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return pb(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return jh.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?tk(a,r):Gc(e,a,r,i);case 239:return s[3]===60?bl(a,r):Gc(e,a,r,i);case 255:if(s[1]===254)return ak(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return rn.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return rn.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return yl.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Oh.to_workbook(a,r);break;case 10:case 13:case 32:return rk(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return xb.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?yl.to_workbook(a,r):Gc(e,a,r,i)}function gu(e,t){var r=t||{};return r.type="file",Qn(e,r)}function Sm(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return eo(t.file,Ye.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ye.write(e,t)}function nk(e,t){var r=Lt(t||{}),a=QN(e,r);return Nm(a,r)}function ik(e,t){var r=Lt(t||{}),a=wm(e,r);return Nm(a,r)}function Nm(e,t){var r={},a=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ye.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Qi(s))}return t.password&&typeof encrypt_agile<"u"?Sm(encrypt_agile(s,t.password),t):t.type==="file"?eo(t.file,s):t.type=="string"?Rt(s):s}function ok(e,t){var r=t||{},a=dN(e,r);return Sm(a,r)}function Ga(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return Ri(Ka(a));case"binary":return Ka(a);case"string":return e;case"file":return eo(t.file,a,"utf8");case"buffer":return xt?hs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Ga(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ck(e,t){switch(t.type){case"base64":return Ri(e);case"binary":return e;case"string":return e;case"file":return eo(t.file,e,"binary");case"buffer":return xt?hs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function To(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?Ri(r):t.type=="string"?Rt(r):r;case"file":return eo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function _0(e,t){ic(),sm(e);var r=Lt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=_0(e,r);return r.type="array",Qi(a)}return ik(e,r)}function Zn(e,t){ic(),sm(e);var r=Lt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Zn(e,r);return r.type="array",Qi(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ga(aN(e,r),r);case"slk":case"sylk":return Ga(kh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Ga(mm(e.Sheets[e.SheetNames[s]],r),r);case"txt":return ck(Em(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Ga(N0(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Ga(jh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return To(yl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Ga(Jn.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Ga(Oh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Ga(Eh.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Ga(vm(e,r),r);case"wk1":return To(rn.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return To(rn.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),To(lm(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ok(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nk(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function S0(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function vu(e,t,r){var a=r||{};return a.type="file",a.file=t,S0(a),Zn(e,a)}function lk(e,t,r){var a=r||{};return a.type="file",a.file=t,S0(a),_0(e,a)}function dk(e,t,r,a){var s=r||{};s.type="file",s.file=e,S0(s),s.type="buffer";var i=a;return i instanceof Function||(i=r),Cs.writeFile(e,Zn(t,s),i)}function km(e,t,r,a,s,i,o,c){var l=Kt(r),d=c.defval,u=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),f=!0,m=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=o?e[r][h]:e[a[h]+l];if(g===void 0||g.t===void 0){if(d===void 0)continue;i[h]!=null&&(m[i[h]]=d);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[h]!=null){if(p==null)if(g.t=="e"&&p===null)m[i[h]]=null;else if(d!==void 0)m[i[h]]=d;else if(u&&p===null)m[i[h]]=null;else continue;else m[i[h]]=u&&(g.t!=="n"||g.t==="n"&&c.rawNumbers!==!1)?p:Ya(g,p,c);p!=null&&(f=!1)}}return{row:m,isempty:f}}function Ko(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],o=0,c="",l={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":l=kt(u);break;case"number":l=kt(e["!ref"]),l.s.r=u;break;default:l=u}a>0&&(s=0);var f=Kt(l.s.r),m=[],h=[],g=0,p=0,x=Array.isArray(e),w=l.s.r,_=0,v={};x&&!e[w]&&(e[w]=[]);var R=d.skipHidden&&e["!cols"]||[],q=d.skipHidden&&e["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(R[_]||{}).hidden)switch(m[_]=Ht(_),r=x?e[w][_]:e[m[_]+f],a){case 1:i[_]=_-l.s.c;break;case 2:i[_]=m[_];break;case 3:i[_]=d.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Ya(r,null,d),p=v[o]||0,!p)v[o]=1;else{do c=o+"_"+p++;while(v[c]);v[o]=p,v[c]=1}i[_]=c}for(w=l.s.r+s;w<=l.e.r;++w)if(!(q[w]||{}).hidden){var U=km(e,l,w,m,a,i,x,d);(U.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(h[g++]=U.row)}return h.length=g,h}var yu=/"/g;function jm(e,t,r,a,s,i,o,c){for(var l=!0,d=[],u="",f=Kt(r),m=t.s.c;m<=t.e.c;++m)if(a[m]){var h=c.dense?(e[r]||[])[m]:e[a[m]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(c.rawNumbers&&h.t=="n"?h.v:Ya(h,null,c));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===s||p===i||p===34||c.forceQuotes){u='"'+u.replace(yu,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(yu,'""')+'"')):u="";d.push(u)}return c.blankrows===!1&&l?null:d.join(o)}function N0(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=kt(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,l=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var m=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(m[g]||{}).hidden||(f[g]=Ht(g));for(var p=0,x=s.s.r;x<=s.e.r;++x)(h[x]||{}).hidden||(u=jm(e,s,x,f,o,l,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((p++?c:"")+u)));return delete a.dense,r.join("")}function Em(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=N0(e,t);if(typeof Et>"u"||t.type=="string")return r;var a=Et.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+a}function uk(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=kt(e["!ref"]),i="",o=[],c,l=[],d=Array.isArray(e);for(c=s.s.c;c<=s.e.c;++c)o[c]=Ht(c);for(var u=s.s.r;u<=s.e.r;++u)for(i=Kt(u),c=s.s.c;c<=s.e.c;++c)if(t=o[c]+i,r=d?(e[u]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}l[l.length]=t+"="+a}return l}function Tm(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},o=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var l=typeof a.origin=="string"?Vt(a.origin):a.origin;o=l.r,c=l.c}var d,u={s:{c:0,r:0},e:{c,r:o+t.length-1+s}};if(i["!ref"]){var f=kt(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var m=a.header||[],h=0;t.forEach(function(p,x){Yt(p).forEach(function(w){(h=m.indexOf(w))==-1&&(m[h=m.length]=w);var _=p[w],v="z",R="",q=at({c:c+h,r:o+x+s});d=Xi(i,q),_&&typeof _=="object"&&!(_ instanceof Date)?i[q]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",a.cellDates||(v="n",_=xr(_)),R=a.dateNF||Ze[14]):_===null&&a.nullError&&(v="e",_=0),d?(d.t=v,d.v=_,delete d.w,delete d.R,R&&(d.z=R)):i[q]=d={t:v,v:_},R&&(d.z=R))})}),u.e.c=Math.max(u.e.c,c+m.length-1);var g=Kt(o);if(s)for(h=0;h<m.length;++h)i[Ht(h+c)+g]={t:"s",v:m[h]};return i["!ref"]=dt(u),i}function fk(e,t){return Tm(null,e,t)}function Xi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Vt(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Xi(e,at(t)):Xi(e,at({r:t,c:r||0}))}function hk(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function k0(){return{SheetNames:[],Sheets:{}}}function j0(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(am(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function mk(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=hk(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function xk(e,t){return e.z=t,e}function Am(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function pk(e,t,r){return Am(e,"#"+t,r)}function gk(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function vk(e,t,r,a){for(var s=typeof t!="string"?t:kt(t),i=typeof t=="string"?t:dt(t),o=s.s.r;o<=s.e.r;++o)for(var c=s.s.c;c<=s.e.c;++c){var l=Xi(e,o,c);l.t="n",l.F=i,delete l.v,o==s.s.r&&c==s.s.c&&(l.f=r,a&&(l.D=!0))}return e}var cs={encode_col:Ht,encode_row:Kt,encode_cell:at,encode_range:dt,decode_col:Ql,decode_row:Yl,split_cell:Lv,decode_cell:Vt,decode_range:Yr,format_cell:Ya,sheet_add_aoa:Xf,sheet_add_json:Tm,sheet_add_dom:xm,aoa_to_sheet:si,json_to_sheet:fk,table_to_sheet:pm,table_to_book:TN,sheet_to_csv:N0,sheet_to_txt:Em,sheet_to_json:Ko,sheet_to_html:mm,sheet_to_formulae:uk,sheet_to_row_object_array:Ko,sheet_get_cell:Xi,book_new:k0,book_append_sheet:j0,book_set_sheet_visibility:mk,cell_set_number_format:xk,cell_set_hyperlink:Am,cell_set_internal_link:pk,cell_add_comment:gk,sheet_set_array_formula:vk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},xc;function yk(e){xc=e}function bk(e,t){var r=xc(),a=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var s=kt(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,l=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var m=a.skipHidden&&e["!cols"]||[],h=a.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(m[g]||{}).hidden||(f[g]=Ht(g));var p=s.s.r,x=!1,w=0;return r._read=function(){if(!x)return x=!0,r.push("\uFEFF");for(;p<=s.e.r;)if(++p,!(h[p-1]||{}).hidden&&(u=jm(e,s,p-1,f,o,l,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),u||a.blankrows!==!1)))return r.push((w++?c:"")+u);return r.push(null)},r}function wk(e,t){var r=xc(),a=t||{},s=a.header!=null?a.header:um,i=a.footer!=null?a.footer:fm;r.push(s);var o=Yr(e["!ref"]);a.dense=Array.isArray(e),r.push(hm(e,o,a));var c=o.s.r,l=!1;return r._read=function(){if(c>o.e.r)return l||(l=!0,r.push("</table>"+i)),r.push(null);for(;c<=o.e.r;){r.push(dm(e,o,c,a)),++c;break}},r}function _k(e,t){var r=xc({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var a={t:"n",v:0},s=0,i=1,o=[],c=0,l="",d={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?s=1:u.header==="A"?s=2:Array.isArray(u.header)&&(s=3),typeof f){case"string":d=kt(f);break;case"number":d=kt(e["!ref"]),d.s.r=f;break;default:d=f}s>0&&(i=0);var m=Kt(d.s.r),h=[],g=0,p=Array.isArray(e),x=d.s.r,w=0,_={};p&&!e[x]&&(e[x]=[]);var v=u.skipHidden&&e["!cols"]||[],R=u.skipHidden&&e["!rows"]||[];for(w=d.s.c;w<=d.e.c;++w)if(!(v[w]||{}).hidden)switch(h[w]=Ht(w),a=p?e[x][w]:e[h[w]+m],s){case 1:o[w]=w-d.s.c;break;case 2:o[w]=h[w];break;case 3:o[w]=u.header[w-d.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),l=c=Ya(a,null,u),g=_[c]||0,!g)_[c]=1;else{do l=c+"_"+g++;while(_[l]);_[c]=g,_[l]=1}o[w]=l}return x=d.s.r+i,r._read=function(){for(;x<=d.e.r;)if(!(R[x-1]||{}).hidden){var q=km(e,d,x,h,s,o,p,u);if(++x,q.isempty===!1||(s===1?u.blankrows!==!1:u.blankrows)){r.push(q.row);return}}return r.push(null)},r}var Sk={to_json:_k,to_html:wk,to_csv:bk,set_readable:yk};const Nk=Ii.version,kk=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ye,SSF:Uo,parse_xlscfb:g0,parse_zip:bm,read:Qn,readFile:gu,readFileSync:gu,set_cptable:A1,set_fs:sv,stream:Sk,utils:cs,version:Nk,write:Zn,writeFile:vu,writeFileAsync:dk,writeFileSync:vu,writeFileXLSX:lk,writeXLSX:_0},Symbol.toStringTag,{value:"Module"}));function Xs(e){if(!e)return"";const r=String(e).slice(8).match(/^\d+/),a=r?parseInt(r[0],10):null;return Number.isFinite(a)?`${a} mm`:""}function ss(e){if(!e)return"";const t=String(e).toUpperCase(),r=/^([A-Z]{3})([A-Z0-9]+)/,a=/^([A-Z]{2})([A-Z0-9]+)/;let s="",i="",o=0,c=t.match(r);if(c)s=c[1],i=c[2],o=3;else{if(c=t.match(a),!c)return"";s=c[1],i=c[2],o=4}let l="";for(const d of i)if(/[0-9]/.test(d)?l+=d:d==="O"&&(l+="0"),l.length===o)break;return l.length<o&&(l=l.padEnd(o,"0")),`${s}-${l}`}const jk=()=>{const e=i=>String(i).padStart(2,"0"),t=new Date,r=t.getFullYear(),a=e(t.getMonth()+1),s=e(t.getDate());return`${r}-${a}-${s}`},Ek=()=>{const[e,t]=I.useState(()=>({tipoRelatorio:"producao",dataInicio:jk(),dataFim:"",maquina:"",operador:"",produto:"",ferramenta:"",comprimento:"",formato:"excel",modo:"detalhado"})),[r,a]=I.useState(!0),{items:s}=ft("apontamentos"),{items:i}=ft("apontamentos_parada"),{items:o}=ft("ferramentas_cfg"),{items:c}=ft("maquinas"),{items:l}=ft("lotes"),d=k=>{const B={},E=(oe,J)=>{const ce=(oe?String(oe):"").trim(),he=(J?String(J):"").trim();if(!ce)return he;if(!he)return ce;const De=new Set(ce.split(", ").filter(Boolean).concat(he.split(", ").filter(Boolean)));return Array.from(De).join(", ")},D=["Amarrado_Codigo","Amarrado_Lote","Amarrado_Rack","Amarrado_Produto","Amarrado_PedidoSeq","Amarrado_Pedido","Amarrado_Seq","Amarrado_Romaneio","Amarrado_QtKG","Amarrado_QtdPC","Amarrado_Ferramenta","Amarrado_Comprimento_mm"];for(const oe of k||[]){const J=`${oe.ID_Apont||""}`;B[J]?D.forEach(ce=>{(ce in oe||ce in B[J])&&(B[J][ce]=E(B[J][ce]||"",oe[ce]||""))}):B[J]={...oe}}const z=Object.values(B);return console.log(` Rastreabilidade Compacto: ${k.length} linhas  ${z.length} apontamentos agrupados`),z},u=[{id:1,nome:"Usinagem 01"},{id:2,nome:"Usinagem 02"},{id:3,nome:"Usinagem 03"}],f=I.useMemo(()=>Array.from(new Set((s||[]).map(B=>B.operador).filter(Boolean))).map(B=>({id:B,nome:B})),[s]),m=I.useMemo(()=>{const k=new Set;for(const B of s||[]){const E=(B==null?void 0:B.produto)||(B==null?void 0:B.codigoPerfil),D=ss(E);D&&k.add(D)}return Array.from(k).sort()},[s]),h=I.useMemo(()=>{const k=new Set;for(const B of s||[]){const E=(B==null?void 0:B.produto)||(B==null?void 0:B.codigoPerfil),D=Xs(E);D&&k.add(D)}return Array.from(k).sort((B,E)=>String(B).localeCompare(String(E)))},[s]),g=[{id:"producao",nome:"Produo por Perodo"},{id:"producao_usinagem",nome:"Apontamentos - Usinagem: Produo por Perodo"},{id:"producao_embalagem",nome:"Apontamentos - Embalagem: Produo por Perodo"},{id:"paradas",nome:"Paradas de Mquina"},{id:"desempenho",nome:"Desempenho por Operador/Mquina"},{id:"desempenho_usinagem",nome:"Apontamentos - Usinagem: Desempenho por Operador/Mquina"},{id:"desempenho_embalagem",nome:"Apontamentos - Embalagem: Desempenho por Operador/Mquina"},{id:"oee",nome:"OEE Detalhado"},{id:"expedicao",nome:"Estimativa de Expedio"},{id:"produtividade",nome:"Produtividade (Itens)"},{id:"produtividade_usinagem",nome:"Apontamentos - Usinagem: Produtividade (Itens)"},{id:"produtividade_embalagem",nome:"Apontamentos - Embalagem: Produtividade (Itens)"},{id:"rastreabilidade",nome:"Rastreabilidade (Amarrados/Lotes)"}],p=k=>k?String(k).endsWith("_usinagem")?"usinagem":String(k).endsWith("_embalagem")?"embalagem":null:null,x=k=>k?String(k).replace(/_(usinagem|embalagem)$/,""):"",w=k=>{const{name:B,value:E}=k.target;t({...e,[B]:E})},_=k=>{const B=k.cliente||"",E=k.produto||k.codigoPerfil||"",D=k.perfil_longo||"",z=k.comprimento_acabado_mm?`${k.comprimento_acabado_mm} mm`:Xs(E),oe=k.ordemTrabalho||k.pedido_seq||"",J=k.pedido_cliente||"",ce=k.quantidade||"",he=k.rack_ou_pallet||k.rackOuPallet||"",De=k.lote||"",j=`<!DOCTYPE html>
    <html><head><meta charset="utf-8" />
    <style>
      @page { size: A4 landscape; margin: 12mm; }
      body { font-family: Arial, Helvetica, sans-serif; color: #000; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .header { text-align: center; margin-bottom: 10mm; }
      .titulo { font-size: 26pt; font-weight: 800; }
      .sub { margin-top: 4mm; font-size: 12pt; font-weight: 700; }
      table { width: 100%; border-collapse: separate; border-spacing: 0 12mm; }
      th, td { vertical-align: bottom; }
      .label { font-weight: 800; font-size: 18pt; white-space: nowrap; padding-right: 6mm; }
      .valor { border-bottom: 3px solid #000; font-size: 18pt; padding: 0 3mm; height: 14mm; }
      .dupla td { width: 50%; }
    </style>
    </head><body>
      <div class="header">
        <div class="titulo">Formulrio de Identificao do Material Cortado</div>
        <div class="sub">Lote: ${De}</div>
      </div>
      <table>
        <tr><td class="label">CLIENTE:</td><td class="valor">${B}</td></tr>
        <tr><td class="label">ITEM:</td><td class="valor">${E}</td></tr>
        <tr><td class="label">ITEM CLI:</td><td class="valor">${D}</td></tr>
        <tr><td class="label">MEDIDA:</td><td class="valor">${z}</td></tr>
        <tr><td class="label">PEDIDO TECNO:</td><td class="valor">${oe}</td></tr>
        <tr class="dupla">
          <td><span class="label">QTDE:</span> <span class="valor" style="display:inline-block; min-width:60mm;">${ce}</span></td>
          <td><span class="label">PALET:</span> <span class="valor" style="display:inline-block; min-width:60mm;">${he}</span></td>
        </tr>
        <tr><td class="label">PEDIDO CLI:</td><td class="valor">${J}</td></tr>
      </table>
    </body></html>`,de=new Blob([j],{type:"application/msword"}),fe=URL.createObjectURL(de),re=document.createElement("a");re.href=fe,re.download=`identificacao_${De||"apontamento"}.doc`,document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(fe)},v=k=>{if(!k)return"Dados";let B=String(k).replace(/[:\\\/\?\*\[\]]/g,"");return B.length>31&&(B=B.substring(0,31)),B.trim()||"Dados"},R=(k,B,E="Relatrio")=>{if(!k||k.length===0){alert("Sem dados para exportar.");return}try{const D=cs.book_new(),z=cs.json_to_sheet(k),oe=[];Object.keys(k[0]||{}).forEach((fe,re)=>{let xe=fe.length;k.forEach(L=>{const Y=String(L[fe]||"");Y.length>xe&&(xe=Y.length)}),oe[re]={wch:Math.min(xe+2,50)}}),z["!cols"]=oe;const ce=v(E);cs.book_append_sheet(D,z,ce);const he=Zn(D,{bookType:"xlsx",type:"array",cellStyles:!0}),De=new Blob([he],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),j=URL.createObjectURL(De),de=document.createElement("a");de.href=j,de.download=`${B}.xlsx`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(j),console.log(`Excel gerado: ${B}.xlsx com ${k.length} linhas`)}catch(D){console.error("Erro ao gerar Excel:",D),alert("Erro ao gerar arquivo Excel: "+D.message)}},q=(k,B)=>{if(!k||k.length===0){alert("Sem dados para exportar.");return}try{const E=cs.book_new();k.forEach(({data:ce,name:he})=>{if(ce&&ce.length>0){const De=cs.json_to_sheet(ce),j=[];Object.keys(ce[0]||{}).forEach((re,xe)=>{let L=re.length;ce.forEach(Y=>{const ke=String(Y[re]||"");ke.length>L&&(L=ke.length)}),j[xe]={wch:Math.min(L+2,50)}}),De["!cols"]=j;const fe=v(he||"Dados");cs.book_append_sheet(E,De,fe)}});const D=Zn(E,{bookType:"xlsx",type:"array",cellStyles:!0}),z=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),oe=URL.createObjectURL(z),J=document.createElement("a");J.href=oe,J.download=`${B}.xlsx`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(oe)}catch(E){console.error("Erro ao gerar Excel multi-sheet:",E),alert("Erro ao gerar arquivo Excel: "+E.message)}},U=k=>{switch(x(k)){case"producao":return Fe.map(E=>{const D=ae(E.inicio,E.fim);return{Data:le(E.inicio),Hora_Inicio:se(E.inicio),Hora_Fim:se(E.fim),Duracao_min:D??"-",Maquina:Ee[String(E.maquina)]||E.maquina||"-",Operador:E.operador||"-",PedidoSeq:E.ordemTrabalho||E.ordem_trabalho||E.pedido_seq||"-",Produto:E.produto||E.codigoPerfil||"-",Ferramenta:ss(E.produto||E.codigoPerfil)||"-",Quantidade:E.quantidade||0,Pcs_por_Hora:D>0?((E.quantidade||0)/(D/60)).toFixed(1):"-",Refugo:E.qtd_refugo||0,RackOuPallet:E.rack_ou_pallet||E.rackOuPallet||"-",QtdPedido:E.qtd_pedido??E.qtdPedido??"-",Separado:E.separado??E.qtd_separado??"-"}});case"paradas":return $e.map(E=>({Data:le(E.inicio_norm),Maquina:Ee[String(E.maquina)]||E.maquina||"-",Motivo:E.motivo_norm,Tipo:E.tipo_norm,Inicio:E.inicio_norm?new Date(E.inicio_norm).toLocaleString("pt-BR"):"-",Fim:E.fim_norm?new Date(E.fim_norm).toLocaleString("pt-BR"):"-",Duracao_min:ae(E.inicio_norm,E.fim_norm)??"-"}));case"desempenho":{const E={};for(const D of ve){const z=D.operador||"-",oe=Ee[String(D.maquina)]||D.maquina||"-",J=`${z}__${oe}`;E[J]||(E[J]={Operador:z,Maquina:oe,Producao:0,Minutos:0}),E[J].Producao+=Number(D.quantidade||0)||0;const ce=ae(D.inicio,D.fim);E[J].Minutos+=ce||0}return Object.values(E).map(D=>({...D,Prod_por_Hora:(D.Minutos>0?D.Producao/(D.Minutos/60):0).toFixed(2)}))}case"oee":{const E={};for(const D of ve){const z=G(D.inicio)||"-",oe=Ee[String(D.maquina)]||D.maquina||"-",J=`${z}__${oe}`;E[J]||(E[J]={Data:z,Maquina:oe,Producao:0,ProdMin:0,ParadaMin:0}),E[J].Producao+=Number(D.quantidade||0)||0,E[J].ProdMin+=ae(D.inicio,D.fim)||0}for(const D of $e){const z=G(D.inicio_norm)||"-",oe=Ee[String(D.maquina)]||D.maquina||"-",J=`${z}__${oe}`;E[J]||(E[J]={Data:z,Maquina:oe,Producao:0,ProdMin:0,ParadaMin:0}),E[J].ParadaMin+=ae(D.inicio_norm,D.fim_norm)||0}return Object.values(E).sort((D,z)=>(D.Data||"").localeCompare(z.Data||""))}case"expedicao":{const E={};for(const D of ve){const z=D.produto||D.codigoPerfil,oe=ss(z);oe&&(E[oe]||(E[oe]={Ferramenta:oe,Quantidade:0}),E[oe].Quantidade+=Number(D.quantidade||0)||0)}return Object.values(E)}case"produtividade":{const E={};for(const D of ve){const z=D.produto||D.codigoPerfil,oe=ss(z),J=Xs(z),ce=`${oe}__${J}`;E[ce]||(E[ce]={Ferramenta:oe,Comprimento:J,Quantidade:0,Minutos:0}),E[ce].Quantidade+=Number(D.quantidade||0)||0,E[ce].Minutos+=ae(D.inicio,D.fim)||0}return Object.values(E).map(D=>({...D,Media_pcs_h:(D.Minutos>0?D.Quantidade/(D.Minutos/60):0).toFixed(2)}))}case"rastreabilidade":{const E=[];let D=0;for(const z of Fe){const oe={ID_Apont:z.id,Data:le(z.inicio),Hora:se(z.inicio),Operador:z.operador||"-",Maquina:Ee[String(z.maquina)]||z.maquina||"-",PedidoSeq:z.ordemTrabalho||z.ordem_trabalho||z.pedido_seq||"-",Produto_Usinagem:z.produto||z.codigoPerfil||"-",Lote_Usinagem:z.lote||"-",Qtde_Produzida:z.quantidade||0,Qtde_Refugo:z.qtd_refugo||0,RackOuPallet:z.rack_ou_pallet||z.rackOuPallet||"-",LotesExternos:Array.isArray(z.lotes_externos)?z.lotes_externos.join(", "):z.lote_externo||""},J=Array.isArray(z.amarrados_detalhados)?z.amarrados_detalhados:[];if(J.length===0){const ce=Array.isArray(z.lotes_externos)?z.lotes_externos:z.lote_externo?[z.lote_externo]:[];if(ce.length>0)for(const he of ce){const De=(l||[]).find(Y=>String(Y.lote||"").trim()===String(he))||{},j=String(De.produto||ye(De,"Produto")||"").trim(),de=ss(j)||"",fe=Xs(j)||"",re=String(De.pedido_seq||""),[xe,L]=re.includes("/")?re.split("/"):[re,""];E.push({...oe,Amarrado_Codigo:String(De.codigo||"").trim(),Amarrado_Lote:String(De.lote||"").trim(),Amarrado_Rack:String(De.rack_embalagem||"").trim(),Amarrado_Produto:j,Amarrado_Ferramenta:de,Amarrado_Comprimento_mm:fe,Amarrado_PedidoSeq:re,Amarrado_Pedido:xe||"",Amarrado_Seq:L||"",Amarrado_Romaneio:String(De.romaneio||"").trim(),Amarrado_QtKG:Number(De.qt_kg||0)||"",Amarrado_QtdPC:Number(De.qtd_pc||0)||""})}else E.push(oe)}else{D+=J.length;for(const ce of J){const he=ce.produto||"",De=ss(he)||"",j=Xs(he)||"",de=String(ce.pedido_seq||""),[fe,re]=de.includes("/")?de.split("/"):[de,""];E.push({...oe,Amarrado_Codigo:ce.codigo||"",Amarrado_Lote:ce.lote||"",Amarrado_Rack:ce.rack||"",Amarrado_Produto:he,Amarrado_Ferramenta:De,Amarrado_Comprimento_mm:j,Amarrado_PedidoSeq:de,Amarrado_Pedido:fe||"",Amarrado_Seq:re||"",Amarrado_Romaneio:ce.romaneio||"",Amarrado_QtKG:ce.qt_kg??"",Amarrado_QtdPC:ce.qtd_pc??""})}}}return console.log(` Rastreabilidade Detalhado: ${Fe.length} apontamentos, ${D} amarrados, ${E.length} linhas geradas`),E}default:return[]}},P=k=>{k.preventDefault();let B=U(e.tipoRelatorio);x(e.tipoRelatorio)==="rastreabilidade"&&e.modo==="compacto"&&(B=d(B));const E=g.find(ce=>ce.id===e.tipoRelatorio),D=((E==null?void 0:E.nome)||"Relatorio").replace(/\s+/g,"_"),z=x(e.tipoRelatorio)==="rastreabilidade"?`_${e.modo}`:"",oe=new Date().toISOString().slice(0,19).replace(/[:-]/g,""),J=`${D}${z}_${oe}`;if((e.formato||"excel").toLowerCase()==="excel"){const ce=(E==null?void 0:E.nome)||"Relatrio";R(B,J,ce)}else R(B,J,(E==null?void 0:E.nome)||"Relatrio"),alert("Formato PDF ainda no implementado. O arquivo foi exportado em Excel (.xlsx).")},X=()=>{try{const B=`Relatorios_Completos_${new Date().toISOString().slice(0,19).replace(/[:-]/g,"")}`,E=[],D={producao:"Producao",producao_usinagem:"Prod Usin",producao_embalagem:"Prod Emb",paradas:"Paradas",desempenho:"Desempenho",desempenho_usinagem:"Desemp Usin",desempenho_embalagem:"Desemp Emb",oee:"OEE",expedicao:"Expedicao",produtividade:"Produtividade",produtividade_usinagem:"Produt Usin",produtividade_embalagem:"Produt Emb",rastreabilidade:"Rastreab"};g.forEach(oe=>{try{const J=e.tipoRelatorio;e.tipoRelatorio=oe.id;let ce=U(oe.id);const he=D[oe.id]||oe.nome;if(oe.id==="rastreabilidade"){E.push({data:ce,name:`${he} Detalhado`});const De=d([...ce]);E.push({data:De,name:`${he} Compacto`})}else E.push({data:ce,name:he});e.tipoRelatorio=J}catch(J){console.error(`Erro ao gerar relatrio ${oe.nome}:`,J)}});const z=E.filter(oe=>oe.data&&oe.data.length>0);if(z.length===0){alert("Nenhum dado encontrado para gerar relatrios.");return}q(z,B),alert(`Arquivo Excel gerado com ${z.length} abas de relatrios!`)}catch(k){console.error("Erro ao gerar todos os relatrios:",k),alert("Erro ao gerar relatrios completos: "+k.message)}},G=k=>{if(!k)return null;try{return new Date(k).toISOString().slice(0,10)}catch{return null}},le=k=>{if(!k)return"";try{return new Date(k).toLocaleDateString("pt-BR")}catch{return String(k)}},se=k=>{if(!k)return"";try{return new Date(k).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}catch{return""}},V=(k,B=0)=>{try{return Number(k||0).toLocaleString("pt-BR",{minimumFractionDigits:B,maximumFractionDigits:B})}catch{return String(k)}},ye=(k,B)=>{try{const E=(k==null?void 0:k.dados_originais)||{},D=String(B).toLowerCase().replace(/[^a-z0-9]/g,"");for(const z of Object.keys(E))if(String(z).toLowerCase().replace(/[^a-z0-9]/g,"")===D)return E[z];return""}catch{return""}},Ee=I.useMemo(()=>{const k={};for(const B of c||[])B&&(k[String(B.id)]=B.nome||B.codigo||`Mquina ${B.id}`);return k},[c]),ve=I.useMemo(()=>{const k=p(e.tipoRelatorio),B=e.dataInicio?G(e.dataInicio):null,E=e.dataFim?G(e.dataFim):null;return(s||[]).filter(D=>{const z=G(D.inicio);if(B&&(!z||z<B)||E&&(!z||z>E)||e.maquina&&String(D.maquina)!==String(e.maquina)||e.operador&&String(D.operador)!==String(e.operador)||k==="embalagem"&&String(D.exp_unidade||"").toLowerCase()!=="embalagem"||k==="usinagem"&&String(D.exp_unidade||"").toLowerCase()==="embalagem")return!1;const oe=(D==null?void 0:D.produto)||(D==null?void 0:D.codigoPerfil);return!(e.ferramenta&&ss(oe)!==e.ferramenta||e.comprimento&&Xs(oe)!==e.comprimento)})},[s,e]),Fe=I.useMemo(()=>{const k=[...ve||[]];return k.sort((B,E)=>{const D=B&&B.inicio?new Date(B.inicio).getTime():0;return(E&&E.inicio?new Date(E.inicio).getTime():0)-D}),k},[ve]),Te=I.useMemo(()=>(i||[]).map(k=>({...k,inicio_norm:k.inicio||k.inicio_timestamp,fim_norm:k.fim||k.fim_timestamp,motivo_norm:k.motivo_parada||k.motivoParada||"-",tipo_norm:k.tipo_parada||k.tipoParada||"-"})),[i]),$e=I.useMemo(()=>{const k=e.dataInicio?G(e.dataInicio):null,B=e.dataFim?G(e.dataFim):null;return(Te||[]).filter(E=>{const D=G(E.inicio_norm);return!(k&&(!D||D<k)||B&&(!D||D>B)||e.maquina&&String(E.maquina)!==String(e.maquina))})},[Te,e]),ae=(k,B)=>{if(!k||!B)return null;try{const E=new Date(k),D=new Date(B);return Math.max(0,Math.round((D-E)/6e4))}catch{return null}},He=({tipo:k})=>{const B=x(k),E=I.useMemo(()=>{const de={};for(const fe of ve){const re=fe.operador||"-",xe=fe.maquina||"-",L=`${re}__${xe}`;de[L]||(de[L]={operador:re,maquina:xe,producao:0,minutos:0});const Y=Number(fe.quantidade||0);de[L].producao+=isNaN(Y)?0:Y;const ke=ae(fe.inicio,fe.fim);de[L].minutos+=ke||0}return Object.values(de)},[ve]),D="relatorio_flags_segundo_sistema",z=()=>{try{const de=localStorage.getItem(D);return de?JSON.parse(de):{}}catch{return{}}};I.useState(z());const oe="produtividade_overrides",J=()=>{try{const de=localStorage.getItem(oe);return de?JSON.parse(de):{}}catch{return{}}},ce=de=>{try{localStorage.setItem(oe,JSON.stringify(de))}catch{}},[he,De]=I.useState(J()),j=(de,fe,re)=>{const xe={...he,[de]:{...he[de]||{},[fe]:re}};De(xe),ce(xe)};switch(B){case"producao":return n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Incio"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fim"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durao"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operador"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido/Seq"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pcs/h"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Refugo"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rack"}),n.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[Fe.map((re,xe)=>{const L=ae(re.inicio,re.fim),Y=L>0?((re.quantidade||0)/(L/60)).toFixed(1):"-";return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:le(re.inicio)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:se(re.inicio)}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:se(re.fim)||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium",children:n.jsx("span",{className:`px-2 py-1 rounded text-xs ${L?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-500"}`,children:L?`${L} min`:"-"})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:Ee[String(re.maquina)]||re.maquina||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:re.operador||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600",children:re.ordemTrabalho||re.ordem_trabalho||re.pedido_seq||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-600 max-w-[150px] truncate",title:re.produto||re.codigoPerfil,children:re.produto||re.codigoPerfil||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-semibold text-gray-800",children:re.quantidade||0}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:n.jsx("span",{className:`font-medium ${Y!=="-"&&parseFloat(Y)>0?"text-green-600":"text-gray-400"}`,children:Y})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:n.jsx("span",{className:`${(re.qtd_refugo||0)>0?"text-red-600 font-medium":"text-gray-400"}`,children:re.qtd_refugo||0})}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:re.rack_ou_pallet||re.rackOuPallet||"-"}),n.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:n.jsx("button",{type:"button",className:"p-1.5 rounded border border-gray-300 text-gray-500 hover:bg-gray-100 hover:text-gray-700",title:"Imprimir formulrio",onClick:()=>_(re),children:n.jsx(f1,{className:"w-3 h-3"})})})]},xe)}),Fe.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"13",className:"px-6 py-8 text-center text-gray-500",children:n.jsxs("div",{className:"flex flex-col items-center gap-2",children:[n.jsx(Yg,{className:"w-8 h-8 text-gray-300"}),n.jsx("span",{children:"Nenhum apontamento encontrado no perodo selecionado"})]})})})]})]})});case"paradas":return n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Incio"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fim"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durao (min)"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[$e.map((re,xe)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:le(re.inicio_norm)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ee[String(re.maquina)]||re.maquina||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.motivo_norm}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(()=>{const L=re.tipo_norm;return L==="setup"?"Setup":L==="nao_planejada"?"No Planejada":L==="manutencao"?"Manuteno":L==="planejada"?"Planejada":L||"-"})()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.inicio_norm?new Date(re.inicio_norm).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.fim_norm?new Date(re.fim_norm).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(()=>{const L=ae(re.inicio_norm,re.fim_norm);return L??"-"})()})]},xe)),$e.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"7",className:"px-6 py-6 text-center text-gray-500",children:"Nenhuma parada encontrada"})})]})]});case"desempenho":return n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operador"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Horas (apontadas)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prod./Hora"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[E.map((re,xe)=>{const L=(re.minutos||0)/60,Y=L>0?(re.producao/L).toFixed(2):"-";return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.operador}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ee[String(re.maquina)]||re.maquina}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.producao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:L.toFixed(2)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y})]},xe)}),E.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-6 py-6 text-center text-gray-500",children:"Sem dados no perodo/seleo"})})]})]});case"oee":const de={};for(const re of ve){const xe=G(re.inicio)||"-",L=re.maquina||"-",Y=`${xe}__${L}`;de[Y]||(de[Y]={dia:xe,maquina:L,producao:0,prodMin:0,paradaMin:0});const ke=Number(re.quantidade||0);de[Y].producao+=isNaN(ke)?0:ke;const Pe=ae(re.inicio,re.fim);de[Y].prodMin+=Pe||0}for(const re of $e){const xe=G(re.inicio)||"-",L=re.maquina||"-",Y=`${xe}__${L}`;de[Y]||(de[Y]={dia:xe,maquina:L,producao:0,prodMin:0,paradaMin:0});const ke=ae(re.inicio,re.fim);de[Y].paradaMin+=ke||0}const fe=Object.values(de).sort((re,xe)=>(re.dia||"").localeCompare(xe.dia||""));return n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquina"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tempo Produo (min)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tempo Paradas (min)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"OEE"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[fe.map((re,xe)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.dia?re.dia.split("-").reverse().join("/"):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.maquina}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.producao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.prodMin}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.paradaMin}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:"-"})]},xe)),fe.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"6",className:"px-6 py-6 text-center text-gray-500",children:"Sem dados suficientes para OEE"})})]})]});case"expedicao":{const re={};for(const Y of ve){const ke=Y.produto||Y.codigoPerfil,Pe=ss(ke);if(!Pe)continue;re[Pe]||(re[Pe]={ferramenta:Pe,quantidade:0});const Ge=Number(Y.quantidade||0);re[Pe].quantidade+=isNaN(Ge)?0:Ge}const xe={};for(const Y of o||[])!Y||!Y.ferramenta||(xe[Y.ferramenta]=Y);const L=Object.values(re).map(Y=>{const ke=xe[Y.ferramenta]||{},Pe=ke.embalagem||"pallet",Ge=(Number(ke.comprimento_mm)||0)/1e3,Pt=(Number(ke.peso_linear)||0)*Ge*(Number(Y.quantidade)||0);let qe="-",ht="-",ot="-";if(Pe==="pallet"){const wt=Number(ke.pcs_por_pallet)||0,jt=Number(ke.ripas_por_pallet)||0;qe=wt>0?Math.ceil(Y.quantidade/wt):"-",ht=wt>0?Math.ceil(Y.quantidade/wt)*jt:"-"}else{const wt=Number(ke.pcs_por_caixa)||0;ot=wt>0?Math.ceil(Y.quantidade/wt):"-"}return{ferramenta:Y.ferramenta,comprimento_mm:ke.comprimento_mm||"-",quantidade:Y.quantidade,embalagem:Pe,pallets:qe,caixas:ot,ripas:ht,peso_estimado:Pt}});return n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ferramenta"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprimento (mm)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd. PCS Apontadas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Embalagem"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa Pallets"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa Caixas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa Ripas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Peso Estimado (kg)"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[L.map((Y,ke)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.ferramenta}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.comprimento_mm}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:V(Y.quantidade)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Y.embalagem}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:typeof Y.pallets=="number"?V(Y.pallets):Y.pallets}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:typeof Y.caixas=="number"?V(Y.caixas):Y.caixas}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:typeof Y.ripas=="number"?V(Y.ripas):Y.ripas}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:V(Y.peso_estimado,3)})]},ke)),L.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"px-6 py-6 text-center text-gray-500",children:"Sem dados para estimativa"})})]})]})}case"produtividade":{const re={};for(const L of ve){const Y=L.produto||L.codigoPerfil,ke=ss(Y),Pe=Xs(Y),Ge=`${ke}__${Pe}`;re[Ge]||(re[Ge]={ferramenta:ke,comprimento:Pe,quantidade:0,minutos:0,porDia:{}});const et=Number(L.quantidade||0);re[Ge].quantidade+=isNaN(et)?0:et;const Pt=ae(L.inicio,L.fim);re[Ge].minutos+=Pt||0;const qe=G(L.inicio);qe&&(re[Ge].porDia[qe]=(re[Ge].porDia[qe]||0)+(isNaN(et)?0:et))}const xe=Object.values(re).map(L=>{const Y=(L.minutos||0)/60,ke=Y>0?L.quantidade/Y:0,Pe=Object.keys(L.porDia),Ge=Pe.length>0?Pe.reduce((qe,ht)=>qe+(L.porDia[ht]||0),0)/Pe.length:0,et=`${L.ferramenta}__${L.comprimento}`,Pt=he[et]||{};return{...L,media_h:ke,media_dia:Ge,key:et,ovr:Pt}}).sort((L,Y)=>(L.ferramenta||"").localeCompare(Y.ferramenta||""));return n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ferramenta"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprimento"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mdia (pcs/h)"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ajuste (pcs/h)"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mdia (pcs/dia)"}),n.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ajuste (pcs/dia)"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[xe.map((L,Y)=>{var ke,Pe;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:L.ferramenta||"-"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:L.comprimento||"-"}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:V(L.media_h,2)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:n.jsx("input",{type:"number",className:"input-field input-field-sm w-32",placeholder:"usar mdia",value:((ke=L.ovr)==null?void 0:ke.h)??"",onChange:Ge=>j(L.key,"h",Ge.target.value)})}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:V(L.media_dia,0)}),n.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-700",children:n.jsx("input",{type:"number",className:"input-field input-field-sm w-32",placeholder:"usar mdia",value:((Pe=L.ovr)==null?void 0:Pe.d)??"",onChange:Ge=>j(L.key,"d",Ge.target.value)})})]},Y)}),xe.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"6",className:"px-6 py-6 text-center text-gray-500",children:"Sem dados para calcular produtividade"})})]})]})}case"rastreabilidade":{let re=(()=>{const xe=[];for(const L of Fe){const Y={Data:le(L.inicio),Hora:se(L.inicio),Maquina:Ee[String(L.maquina)]||L.maquina||"-",Operador:L.operador||"-",PedidoSeq:L.ordemTrabalho||L.ordem_trabalho||L.pedido_seq||"-",Produto_Usinagem:L.produto||L.codigoPerfil||"-",Lote_Usinagem:L.lote||"-",Qtde_Produzida:L.quantidade||0,Qtde_Refugo:L.qtd_refugo||0,RackOuPallet:L.rack_ou_pallet||L.rackOuPallet||"-",LotesExternos:Array.isArray(L.lotes_externos)?L.lotes_externos.join(", "):L.lote_externo||""},ke=Array.isArray(L.amarrados_detalhados)?L.amarrados_detalhados:[];if(ke.length===0){const Pe=Array.isArray(L.lotes_externos)?L.lotes_externos:L.lote_externo?[L.lote_externo]:[];if(Pe.length>0)for(const Ge of Pe){const et=(l||[]).find(Pt=>String(Pt.lote||"").trim()===String(Ge))||{};xe.push({...Y,Amarrado_Codigo:String(et.codigo||"").trim(),Amarrado_Lote:String(et.lote||"").trim(),Amarrado_Rack:String(et.rack_embalagem||"").trim(),Amarrado_Produto:String(et.produto||ye(et,"Produto")||"").trim(),Amarrado_PedidoSeq:String(et.pedido_seq||"").trim(),Amarrado_Romaneio:String(et.romaneio||"").trim(),Amarrado_QtKG:Number(et.qt_kg||0)||"",Amarrado_QtdPC:Number(et.qtd_pc||0)||""})}else xe.push(Y)}else for(const Pe of ke)xe.push({...Y,Amarrado_Codigo:Pe.codigo||"",Amarrado_Lote:Pe.lote||"",Amarrado_Rack:Pe.rack||"",Amarrado_Produto:Pe.produto||"",Amarrado_PedidoSeq:Pe.pedido_seq||"",Amarrado_Romaneio:Pe.romaneio||"",Amarrado_QtKG:Pe.qt_kg??"",Amarrado_QtdPC:Pe.qtd_pc??""})}return xe})();return e.modo==="compacto"&&(re=d(re)),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-[1200px] divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Data"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Hora"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Mquina"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Operador"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Pedido/Seq"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Produto Usinagem"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Lote Usinagem"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Qtd Produzida"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Refugo"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Rack/Pallet"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Lotes Externos"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Cdigo"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Lote"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Rack"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Produto"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Pedido/Seq"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Romaneio"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Qt(kg)"}),n.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Amarrado Qtd(pc)"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[re.map((xe,L)=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Data}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Hora}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Maquina}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Operador}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.PedidoSeq}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Produto_Usinagem}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Lote_Usinagem}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Qtde_Produzida}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Qtde_Refugo}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.RackOuPallet}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.LotesExternos}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_Codigo||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_Lote||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_Rack||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_Produto||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_PedidoSeq||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_Romaneio||"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_QtKG??"-"}),n.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:xe.Amarrado_QtdPC??"-"})]},L)),re.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"19",className:"px-6 py-6 text-center text-gray-500",children:"Nenhum dado de rastreabilidade no perodo/seleo"})})]})]})})}default:return n.jsx("p",{children:"Selecione um tipo de relatrio"})}},Ue=I.useMemo(()=>{const k=ve.length,B=ve.reduce((fe,re)=>fe+(Number(re.quantidade)||0),0),E=ve.reduce((fe,re)=>fe+(Number(re.qtd_refugo)||0),0),D=B>0?(E/B*100).toFixed(2):0;let z=0,oe=0;for(const fe of ve){const re=ae(fe.inicio,fe.fim);re&&re>0&&(z+=re,oe++)}const J=(z/60).toFixed(1),ce=z>0?(B/(z/60)).toFixed(1):0,he=new Set(ve.map(fe=>fe.operador).filter(Boolean)).size,De=new Set(ve.map(fe=>fe.maquina).filter(Boolean)).size,j=ve.filter(fe=>fe.inicio&&!fe.fim).length,de=[];return D>5&&de.push({tipo:"alerta",msg:`Taxa de refugo elevada: ${D}%`,icone:"warning"}),j>0&&de.push({tipo:"info",msg:`${j} apontamento(s) sem hora de trmino`,icone:"clock"}),ce>0&&parseFloat(ce)<10&&de.push({tipo:"atencao",msg:"Produtividade abaixo de 10 pcs/h",icone:"chart"}),k>0&&oe===0&&de.push({tipo:"info",msg:"Nenhum apontamento com durao calculada",icone:"clock"}),B>1e3&&de.push({tipo:"sucesso",msg:`Excelente! ${B.toLocaleString("pt-BR")} peas produzidas`,icone:"check"}),{totalApontamentos:k,totalProducao:B,totalRefugo:E,taxaRefugo:D,tempoTotalHoras:J,produtividadeMedia:ce,operadoresUnicos:he,maquinasUnicas:De,semHoraFim:j,insights:de}},[ve]);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Relatrios"}),n.jsxs("span",{className:"text-sm text-gray-500",children:[e.dataInicio&&`${new Date(e.dataInicio).toLocaleDateString("pt-BR")}`,e.dataFim&&` at ${new Date(e.dataFim).toLocaleDateString("pt-BR")}`]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-blue-500",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(_i,{className:"w-3 h-3"}),n.jsx("span",{children:"Apontamentos"})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:Ue.totalApontamentos})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-green-500",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(ff,{className:"w-3 h-3"}),n.jsx("span",{children:"Produo Total"})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:Ue.totalProducao.toLocaleString("pt-BR")}),n.jsx("div",{className:"text-xs text-gray-400",children:"peas"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-purple-500",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(Oi,{className:"w-3 h-3"}),n.jsx("span",{children:"Tempo Total"})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:Ue.tempoTotalHoras}),n.jsx("div",{className:"text-xs text-gray-400",children:"horas"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-teal-500",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(xf,{className:"w-3 h-3"}),n.jsx("span",{children:"Produtividade"})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:Ue.produtividadeMedia}),n.jsx("div",{className:"text-xs text-gray-400",children:"pcs/hora"})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border-l-4 border-orange-500",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(y1,{className:"w-3 h-3"}),n.jsx("span",{children:"Operadores"})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:Ue.operadoresUnicos})]}),n.jsxs("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${parseFloat(Ue.taxaRefugo)>5?"border-red-500":"border-gray-300"}`,children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs mb-1",children:[n.jsx(Io,{className:"w-3 h-3"}),n.jsx("span",{children:"Taxa Refugo"})]}),n.jsxs("div",{className:`text-2xl font-bold ${parseFloat(Ue.taxaRefugo)>5?"text-red-600":"text-gray-800"}`,children:[Ue.taxaRefugo,"%"]}),n.jsxs("div",{className:"text-xs text-gray-400",children:[Ue.totalRefugo," pcs"]})]})]}),Ue.insights.length>0&&n.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100",children:[n.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[n.jsx(_i,{className:"w-4 h-4 text-blue-600"}),"Insights Automticos"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Ue.insights.map((k,B)=>n.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-medium ${k.tipo==="alerta"?"bg-red-100 text-red-700":k.tipo==="atencao"?"bg-yellow-100 text-yellow-700":k.tipo==="sucesso"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:[k.icone==="warning"&&n.jsx(Io,{className:"w-3 h-3"}),k.icone==="clock"&&n.jsx(Oi,{className:"w-3 h-3"}),k.icone==="chart"&&n.jsx(_i,{className:"w-3 h-3"}),k.icone==="check"&&n.jsx(e1,{className:"w-3 h-3"}),k.msg]},B))})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 md:p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Filtros"}),n.jsx("button",{type:"button",onClick:()=>a(k=>!k),className:"text-sm text-blue-600 hover:text-blue-700 hover:underline",title:r?"Recolher filtros":"Expandir filtros",children:r?"Recolher":"Expandir"})]}),r&&n.jsxs("form",{onSubmit:P,children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Relatrio"}),n.jsx("select",{name:"tipoRelatorio",value:e.tipoRelatorio,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:g.map(k=>n.jsx("option",{value:k.id,children:k.nome},k.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Incio"}),n.jsx("input",{type:"date",name:"dataInicio",value:e.dataInicio,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Fim"}),n.jsx("input",{type:"date",name:"dataFim",value:e.dataFim,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mquina"}),n.jsxs("select",{name:"maquina",value:e.maquina,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"",children:"Todas as mquinas"}),u.map(k=>n.jsx("option",{value:k.id,children:k.nome},k.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operador"}),n.jsxs("select",{name:"operador",value:e.operador,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"",children:"Todos os operadores"}),f.map(k=>n.jsx("option",{value:k.id,children:k.nome},k.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferramenta"}),n.jsxs("select",{name:"ferramenta",value:e.ferramenta,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"",children:"Todas as ferramentas"}),m.map(k=>n.jsx("option",{value:k,children:k},k))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comprimento"}),n.jsxs("select",{name:"comprimento",value:e.comprimento,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"",children:"Todos os comprimentos"}),h.map(k=>n.jsx("option",{value:k,children:k},k))]})]}),x(e.tipoRelatorio)==="rastreabilidade"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modo de Exibio"}),n.jsxs("select",{name:"modo",value:e.modo,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"detalhado",children:"Detalhado (1 linha por amarrado)"}),n.jsx("option",{value:"compacto",children:"Compacto (amarrados concatenados)"})]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"sm:w-48",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Formato de Exportao"}),n.jsxs("select",{name:"formato",value:e.formato,onChange:w,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"excel",children:"Excel"}),n.jsx("option",{value:"pdf",children:"PDF"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white font-medium rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors whitespace-nowrap",children:"Gerar Relatrio"}),n.jsx("button",{type:"button",onClick:X,className:"px-6 py-2 bg-green-600 text-white font-medium rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors whitespace-nowrap",children:"Gerar Todos os Relatrios"})]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 md:p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Visualizao Prvia"}),n.jsx("div",{className:"overflow-x-auto pb-4",children:n.jsx(He,{tipo:e.tipoRelatorio})})]})]})},Tk=()=>{const[e,t]=I.useState("carteira"),[r,a]=I.useState({produto:"",maquina:"",operador:""}),[s,i]=I.useState("dia_util"),[o,c]=I.useState("historica"),[l,d]=I.useState(15e3),[u,f]=I.useState(()=>{const W=new Date,me=W.getFullYear(),we=String(W.getMonth()+1).padStart(2,"0"),Ae=String(W.getDate()).padStart(2,"0");return`${me}-${we}-${Ae}`}),[m,h]=I.useState([]),[g,p]=I.useState({quantidade:"",produtividadeManual:"",ferramenta:"",comprimentoMm:""}),[x,w]=I.useState(!1),[_,v]=I.useState(36),[R,q]=I.useState("prazo"),[U,P]=I.useState(!0),[X,G]=I.useState(!0),[le,se]=I.useState(!1),[V,ye]=I.useState(!1),[Ee,ve]=I.useState(!1),[Fe,Te]=I.useState(15e3),[$e,ae]=I.useState("carteira"),[He,Ue]=I.useState(()=>{const W=new Date,me=W.getFullYear(),we=String(W.getMonth()+1).padStart(2,"0"),Ae=String(W.getDate()).padStart(2,"0");return`${me}-${we}-${Ae}`}),[k,B]=I.useState(""),[E,D]=I.useState([]),[z,oe]=I.useState([{id:"TA",nome:"Turno A",horasTrabalho:8,horasParadas:0,ativo:!0},{id:"TB",nome:"Turno B",horasTrabalho:8,horasParadas:0,ativo:!0},{id:"TC",nome:"Turno C",horasTrabalho:8,horasParadas:0,ativo:!0}]),[J,ce]=I.useState(null),[he,De]=I.useState(0),[j,de]=I.useState(0),{items:fe}=ft("apontamentos"),{items:re}=ft("pedidos"),{items:xe}=ft("maquinas"),L=async W=>{if(W)try{const me=await hn(()=>Promise.resolve().then(()=>kk),void 0),we=await W.arrayBuffer(),Ae=me.read(we,{type:"array"}),S=Ae.Sheets[Ae.SheetNames[0]],T=[];if(S["!ref"]){const A=me.utils.decode_range(S["!ref"]);for(let N=20;N<=A.e.r&&!["A","B","C","D","E","F","G","H","I","J","K","L"].some(Qt=>{var Zt;const Pr=(Zt=S[Qt+(N+1)])==null?void 0:Zt.v;return String(Pr||"").toLowerCase().includes("valor total pedido")});N++){const F=S["C"+(N+1)],Q=S["F"+(N+1)],ee=S["I"+(N+1)],Z=((F==null?void 0:F.v)??"").toString().trim(),ne=Q==null?void 0:Q.v,ie=ee==null?void 0:ee.v,Se=ne!=null&&ne!==""?String(ne).toString().replace(",","."):"",Ce=ie!=null&&ie!==""&&parseFloat(String(ie).toString().replace(",","."))||0;if(!Z&&Ce<=0)continue;const Ie=Z,Ne="",Le=0;let Je=0,Nt=0,Tt="Manual";const it=Ke[Ie];Ce>0&&(it&&it.pcsPorHora>0?(Je=Ce/it.pcsPorHora,Nt=Je/(qe||1),Tt="Histrica"):(Je=0,Nt=0)),T.push({id:Date.now()+Math.random(),produto:Ie,descricao:Ne,quantidade:Ce,produtividadeManual:Le,ferramenta:Z,comprimentoMm:Se,estimativaHoras:Je.toFixed(2),estimativaDias:Nt.toFixed(2),confiabilidade:Tt})}}if(T.length===0){const A=me.utils.sheet_to_json(S,{defval:""});for(const N of A){if(Object.values(N).map(Ne=>String(Ne||"").toLowerCase()).join(" | ").includes("valor total pedido"))break;const F=String(N.produto||N.Produto||"").trim(),Q=String(N.descricao||N.Descricao||"").trim(),ee=parseFloat(N.quantidade||N.Qtd||N.volume||N.Volume||0)||0,Z=parseFloat(N.produtividade||N["produtividade (pcs/h)"]||0)||0,ne=String(N.ferramenta||N.Ferramenta||"").trim(),ie=String(N.comprimento_mm||N.Comprimento||N["Comprimento (mm)"]||"").trim();if(!F&&!ne||!ee)return;let Se=0,Ce=0,Ie="Manual";if(Z>0)Se=ee/Z,Ce=Se/(qe||1);else{const Ne=Ke[F];Ne&&Ne.pcsPorHora>0&&(Se=ee/Ne.pcsPorHora,Ce=Se/(qe||1),Ie="Histrica")}T.push({id:Date.now()+Math.random(),produto:F||ne,descricao:Q,quantidade:ee,produtividadeManual:Z,ferramenta:ne,comprimentoMm:ie,estimativaHoras:Se.toFixed(1),estimativaDias:Ce.toFixed(1),confiabilidade:Ie})}}T.length&&(h(A=>[...A,...T]),w(!1))}catch(me){console.error("Falha ao importar cotao:",me)}};I.useEffect(()=>{(async()=>{try{const Ae=await Qe.obterConfiguracao("previsao_turnos");Array.isArray(Ae)&&Ae.length&&oe(Ae);const S=await Qe.obterConfiguracao("previsao_extras");S&&typeof S=="object"&&(typeof S.extrasDiaUtil=="number"&&De(S.extrasDiaUtil),typeof S.extrasSabado=="number"&&de(S.extrasSabado));const T=await Qe.obterConfiguracao("previsao_produtividade");T&&typeof T=="object"&&(T.modo&&c(T.modo),typeof T.estimativaPcsPorDia=="number"&&T.estimativaPcsPorDia>0?d(T.estimativaPcsPorDia):(d(15e3),await Qe.salvarConfiguracao("previsao_produtividade",{modo:"estimativa",estimativaPcsPorDia:15e3})))}catch{}})();const W=localStorage.getItem("previsao_turnos");W&&oe(JSON.parse(W));const me=localStorage.getItem("previsao_extras");if(me)try{const Ae=JSON.parse(me);typeof Ae.extrasDiaUtil=="number"&&De(Ae.extrasDiaUtil),typeof Ae.extrasSabado=="number"&&de(Ae.extrasSabado)}catch{}const we=localStorage.getItem("previsao_produtividade");if(we)try{const Ae=JSON.parse(we);Ae.modo&&c(Ae.modo),typeof Ae.estimativaPcsPorDia=="number"&&Ae.estimativaPcsPorDia>0?d(Ae.estimativaPcsPorDia):d(15e3)}catch{}else d(15e3)},[]),I.useEffect(()=>{if(o==="estimativa"&&l!==15e3){d(15e3);try{localStorage.setItem("previsao_produtividade",JSON.stringify({modo:"estimativa",estimativaPcsPorDia:15e3}))}catch{}}},[o]);const Y=async()=>{try{await Qe.salvarConfiguracao("previsao_turnos",z)}catch{}try{localStorage.setItem("previsao_turnos",JSON.stringify(z))}catch{}},ke=async()=>{const W={extrasDiaUtil:he,extrasSabado:j};try{await Qe.salvarConfiguracao("previsao_extras",W)}catch{}try{localStorage.setItem("previsao_extras",JSON.stringify(W))}catch{}},Pe=async()=>{const W={modo:o,estimativaPcsPorDia:l};try{await Qe.salvarConfiguracao("previsao_produtividade",W)}catch{}try{localStorage.setItem("previsao_produtividade",JSON.stringify(W))}catch{}},Ge=I.useMemo(()=>z.filter(W=>W.ativo).reduce((W,me)=>W+(me.horasTrabalho-me.horasParadas),0),[z]),et=I.useMemo(()=>Ge+(he||0),[Ge,he]),Pt=I.useMemo(()=>j||0,[j]),qe=s==="sabado"?Pt:et,ht=W=>{if(!W)return"";const we=String(W).slice(8).match(/^\d+/),Ae=we?parseInt(we[0],10):null;return Number.isFinite(Ae)?`${Ae} mm`:""},ot=W=>{if(!W)return"";const me=String(W).toUpperCase(),we=/^([A-Z]{3})([A-Z0-9]+)/,Ae=/^([A-Z]{2})([A-Z0-9]+)/;let S="",T="",A=0,N=me.match(we);if(N)S=N[1],T=N[2],A=3;else{if(N=me.match(Ae),!N)return"";S=N[1],T=N[2],A=4}let C="";for(const F of T)if(/[0-9]/.test(F)?C+=F:F==="O"&&(C+="0"),C.length===A)break;return C.length<A&&(C=C.padEnd(A,"0")),`${S}-${C}`},wt=W=>{const me=(W||"").split("-").map(Number),[we,Ae,S]=me;return!we||!Ae||!S?new Date(NaN):new Date(we,Ae-1,S)},jt=W=>{const[me,we,Ae]=String(W||"").split("/");return!me||!we||!Ae?"":`${Ae}-${String(we).padStart(2,"0")}-${String(me).padStart(2,"0")}`},Ft=I.useMemo(()=>{const W={};return xe&&xe.length>0&&xe.forEach(me=>{me.id&&me.nome&&(W[String(me.id)]=me.nome)}),W},[xe]),Ke=I.useMemo(()=>{const W={};return!fe||fe.length===0||(fe.forEach(me=>{if(!me.produto||!me.quantidade||!me.inicio||!me.fim)return;const we=new Date(me.inicio),S=(new Date(me.fim)-we)/(1e3*60*60);if(S<=0)return;const T=me.produto,A=parseFloat(me.quantidade)||0;W[T]||(W[T]={produto:T,totalPcs:0,totalHoras:0,registros:0,maquinas:new Set,operadores:new Set}),W[T].totalPcs+=A,W[T].totalHoras+=S,W[T].registros+=1;const N=Ft[String(me.maquina)]||me.maquina||"N/A";W[T].maquinas.add(N),W[T].operadores.add(me.operador)}),Object.keys(W).forEach(me=>{const we=W[me];we.pcsPorHora=we.totalPcs/we.totalHoras,we.pcsPorDia=we.pcsPorHora*qe,we.maquinasArray=Array.from(we.maquinas),we.operadoresArray=Array.from(we.operadores)})),W},[fe,qe,Ft]);I.useMemo(()=>{if(!re||re.length===0)return{total:0,concluidos:0,saldoNegativo:0,validos:0};const W=re.length,me=re.filter(S=>S.status==="concluido").length,we=re.filter(S=>S.status!=="concluido"&&parseFloat(S.saldo_a_prod)<=0).length,Ae=re.filter(S=>S.status!=="concluido"&&parseFloat(S.saldo_a_prod)>0).length;return{total:W,concluidos:me,saldoNegativo:we,validos:Ae}},[re]);const vt=I.useMemo(()=>!re||re.length===0?[]:re.filter(me=>!k||(me.pedido_cliente||"").toLowerCase().includes(k.toLowerCase())).map(me=>{const we=Ke[me.produto],Ae=Math.max(0,parseFloat(me.saldo_a_prod)||0);let S=0,T=0,A="Baixa";return o==="estimativa"?Ae>0&&l>0&&(T=Ae/l,S=T*(qe||24),A="Estimativa"):Ae>0&&we&&we.pcsPorHora>0&&(S=Ae/we.pcsPorHora,T=S/(qe||24),A=we.registros>=5?"Alta":we.registros>=2?"Mdia":"Baixa"),{...me,produtividade:we,estimativaHoras:S.toFixed(2),estimativaDias:T.toFixed(2),confiabilidade:A,saldoProduzir:Ae}}).sort((me,we)=>new Date(me.dt_fatura)-new Date(we.dt_fatura)),[re,Ke,k,qe,o,l]),yt=I.useMemo(()=>{if(E.length===0)return vt;const W=new Set(E);return vt.filter(me=>W.has(me.pedido_seq))},[vt,E]),mt=I.useMemo(()=>{let W=e==="carteira"?vt:m;return r.produto&&(W=W.filter(me=>{var we;return(we=me.produto)==null?void 0:we.toLowerCase().includes(r.produto.toLowerCase())})),e==="carteira"&&le&&(W=W.filter(me=>parseFloat(me.saldoProduzir??me.saldo_a_prod??0)>0)),W},[vt,m,r,e,le]),lr=W=>{const{name:me,value:we}=W.target;a(Ae=>({...Ae,[me]:we}))},wr=()=>{if(!g.ferramenta||!g.quantidade)return;const W=parseFloat(g.quantidade)||0,me=parseFloat(g.produtividadeManual)||0;let we=0,Ae=0,S="Manual";const T=(g.ferramenta||"").trim();if(me>0)we=W/me,Ae=we/(qe||1);else if(o==="estimativa")W>0&&l>0&&(Ae=W/l,we=Ae*(qe||24),S="Estimativa");else{const N=Ke[T];N&&N.pcsPorHora>0&&(we=W/N.pcsPorHora,Ae=we/(qe||24),S="Histrica")}const A={id:Date.now(),produto:T,descricao:"",quantidade:W,produtividadeManual:me,ferramenta:g.ferramenta,comprimentoMm:g.comprimentoMm,estimativaHoras:we.toFixed(2),estimativaDias:Ae.toFixed(2),confiabilidade:S};h(N=>[...N,A]),p({quantidade:"",produtividadeManual:"",ferramenta:"",comprimentoMm:""})},Bt=W=>{h(me=>me.filter(we=>we.id!==W))},Wr=()=>{!m||m.length===0||!window.confirm("Deseja remover todas as estimativas manuais importadas/adicionadas?")||h([])},_r=()=>{const W=parseFloat(Fe)||0;if(W<=0)return ve(!1);let me=He;if($e==="carteira"&&(_t!=null&&_t.data)){const we=jt(_t.data);we&&(me=we)}h(we=>we.map(Ae=>{const S=parseFloat(Ae.quantidade)||0,T=!Ae.produtividadeManual||parseFloat(Ae.produtividadeManual)<=0,A=!Ae.confiabilidade||Ae.confiabilidade==="Manual"||Number(Ae.estimativaHoras)<=0;if(!(S>0&&T&&A))return Ae;const C=S/W,F=C*(qe||1);return{...Ae,estimativaHoras:F.toFixed(2),estimativaDias:C.toFixed(2),confiabilidade:"Estimativa",inicioPrevisto:me}})),ve(!1)},Sr=I.useMemo(()=>{let W=0,me=0;for(const we of m||[]){const Ae=parseFloat(we.quantidade)||0,S=!we.produtividadeManual||parseFloat(we.produtividadeManual)<=0,T=!we.confiabilidade||we.confiabilidade==="Manual"||Number(we.estimativaHoras)<=0;Ae>0&&S&&T&&(W++,me+=Ae)}return{itens:W,totalPcs:me}},[m]),ar=W=>E.includes(W),ha=W=>{D(me=>{const we=new Set(me);return we.has(W)?we.delete(W):we.add(W),Array.from(we)})},pr=()=>{D(Array.from(new Set((mt||[]).map(W=>W.pedido_seq))))},ia=()=>D([]),Qr=W=>{ce({...W})},Zr=()=>{J&&(oe(W=>W.map(me=>me.id===J.id?J:me)),ce(null),Y())},Ea=()=>{ce(null)},Wt=W=>{oe(me=>me.map(we=>we.id===W?{...we,ativo:!we.ativo}:we))},Ut=yt.reduce((W,me)=>W+parseFloat(me.estimativaHoras||0),0),pt=Ut/(qe||1),_t=I.useMemo(()=>{try{const W=wt(u);if(isNaN(W.getTime()))return{data:"",diasUteis:0,sabados:0,domingos:0,horasAcumuladas:0};const me=Number(Ut||0);if(!(me>0))return{data:W.toLocaleDateString("pt-BR"),diasUteis:0,sabados:0,domingos:0,horasAcumuladas:0};let we=Math.max(0,me),Ae=new Date(W),S=0,T=0,A=0,N=0,C=0;for(;we>0&&C<3660;){const Q=Ae.getDay();let ee=0;if(Q>=1&&Q<=5?(ee=Number(et||0),ee>0&&S++):Q===6?(ee=Number(j||0),ee>0&&T++):A++,ee>0&&(we-=ee,N+=ee),we<=0)break;Ae.setDate(Ae.getDate()+1),C++}return{data:Ae.toLocaleDateString("pt-BR"),diasUteis:S,sabados:T,domingos:A,horasAcumuladas:N}}catch{return{data:"",diasUteis:0,sabados:0,domingos:0,horasAcumuladas:0}}},[u,Ut,et,j]),St=I.useMemo(()=>{if(!yt||yt.length===0)return[];let W=[...yt];if(R==="prazo")W.sort((T,A)=>{const N=T.dt_fatura?new Date(T.dt_fatura).getTime():1/0,C=A.dt_fatura?new Date(A.dt_fatura).getTime():1/0;return N-C});else if(R==="estimativa")W.sort((T,A)=>parseFloat(A.estimativaDias||0)-parseFloat(T.estimativaDias||0));else if(R==="comp_desc"){const T=A=>{const N=parseFloat(A.comprimentoMm);if(!isNaN(N)&&isFinite(N))return N;const C=ht(A.produto)||"",F=parseFloat(String(C).replace(/[^0-9.]/g,""));return isNaN(F)?0:F};W.sort((A,N)=>T(N)-T(A))}else if(R==="comp_asc"){const T=A=>{const N=parseFloat(A.comprimentoMm);if(!isNaN(N)&&isFinite(N))return N;const C=ht(A.produto)||"",F=parseFloat(String(C).replace(/[^0-9.]/g,""));return isNaN(F)?0:F};W.sort((A,N)=>T(A)-T(N))}let we=wt(u).getTime(),Ae=0;return W.map(T=>{const A=Math.max(0,parseFloat(T.estimativaDias||0)),N=new Date(we),C=new Date(we+A*24*60*60*1e3),F=T.pedido_seq||T.id||"",Q=ot(T.produto||T.ferramenta)||T.ferramenta||"",ee=T.comprimentoMm?`${T.comprimentoMm} mm`:ht(T.produto)||"",Z={id:T.pedido_seq||T.id,label:[F,Q,ee].filter(Boolean).join(" - "),produto:T.produto||T.ferramenta||"-",dias:A,inicio:N,fim:C,startIndex:Ae,span:A};return we+=A*24*60*60*1e3,Ae+=A,Z})},[yt,u,R]);return n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Previso de Trabalho"}),n.jsx("p",{className:"text-gray-600",children:"Estimativas de tempo para concluso de pedidos"})]}),n.jsx("div",{className:"text-sm text-gray-600 mb-4",children:_t.data&&n.jsxs("span",{children:["Contagem: ",_t.diasUteis," dias teis",j>0?` + ${_t.sabados} sbado(s)`:"","  ",Number(et||0).toFixed(2),"h/dia til",j>0?`  ${Number(j||0)}h/sbado`:""]})}),n.jsx("div",{className:"mb-6",children:n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("nav",{className:"-mb-px flex space-x-8 whitespace-nowrap",children:[n.jsxs("button",{onClick:()=>t("carteira"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="carteira"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(_i,{className:"inline mr-2"}),"Carteira de Pedidos"]}),n.jsxs("button",{onClick:()=>t("manual"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="manual"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(ad,{className:"inline mr-2"}),"Estimativa Manual"]}),n.jsxs("button",{onClick:()=>t("turnos"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="turnos"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(rd,{className:"inline mr-2"}),"Turnos"]}),n.jsxs("button",{onClick:()=>t("produtividade"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="produtividade"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(Oi,{className:"inline mr-2"}),"Histrico Produtividade"]}),n.jsxs("button",{onClick:()=>t("gantt"),className:`py-2 px-1 border-b-2 font-medium text-sm ${e==="gantt"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(h1,{className:"inline mr-2"}),"Gantt"]})]})})})}),n.jsx("div",{className:"flex justify-end mb-2",children:n.jsx("button",{onClick:()=>G(W=>!W),className:"text-sm px-3 py-1 rounded border border-gray-300 bg-white hover:bg-gray-50",children:X?"Recolher filtros":"Expandir filtros"})}),n.jsxs("div",{className:`bg-white p-3 rounded-lg shadow mb-4 ${X?"":"hidden"}`,children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Produto"}),n.jsx("input",{type:"text",name:"produto",value:r.produto,onChange:lr,className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Filtrar por produto..."})]}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pedido Cliente"}),n.jsx("input",{type:"text",value:k,onChange:W=>B(W.target.value),className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Filtrar por Pedido Cliente..."})]}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Data Inicial da Previso"}),n.jsx("input",{type:"date",value:u,onChange:W=>f(W.target.value),className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tipo de Dia"}),n.jsxs("select",{value:s,onChange:W=>i(W.target.value),className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"dia_util",children:"Dia til (turnos + extras)"}),n.jsx("option",{value:"sabado",children:"Sbado (apenas extras de sbado)"})]})]}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Horas teis Selecionadas"}),n.jsx("input",{type:"text",value:`${Number(qe||0).toFixed(2)}h`,readOnly:!0,className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-gray-100 text-gray-600"})]}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Turnos Ativos"}),n.jsx("input",{type:"text",value:z.filter(W=>W.ativo).map(W=>W.id).join(", "),readOnly:!0,className:"w-full h-9 px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-gray-100 text-gray-600"})]})]}),n.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mt-4",children:[n.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-3",children:"Modo de Clculo de Produtividade"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mtodo de Clculo"}),n.jsxs("select",{value:o,onChange:W=>{c(W.target.value),Pe()},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[n.jsx("option",{value:"historica",children:"Produtividade Histrica (Registrada)"}),n.jsx("option",{value:"estimativa",children:"Estimativa Manual (Peas/Dia)"})]})]}),o==="estimativa"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimativa (peas/dia)"}),n.jsx("input",{type:"number",value:l,onChange:W=>{d(parseInt(W.target.value)||15e3),Pe()},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"15000"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtro"}),n.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",checked:le,onChange:W=>se(W.target.checked)}),"Apenas com saldo ",">"," 0"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),n.jsx("div",{className:"p-2 bg-white border border-gray-300 rounded-md text-sm text-gray-600",children:o==="historica"?"Usando dados de apontamentos":`${l.toLocaleString("pt-BR")} pcs/dia`})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[n.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(Oi,{className:"text-blue-600 text-2xl mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Total Estimado"}),n.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[Ut.toFixed(2),"h"]})]})]})}),n.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(_i,{className:"text-green-600 text-2xl mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Dias de Trabalho"}),n.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[pt.toFixed(2)," dias"]})]})]})}),n.jsx("div",{className:"bg-indigo-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(rd,{className:"text-indigo-600 text-2xl mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Trmino Previsto"}),n.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:_t.data||"-"})]})]})}),n.jsx("div",{className:"bg-yellow-50 p-4 rounded-lg",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx(ad,{className:"text-yellow-600 text-2xl mr-3"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-600",children:"Itens"}),n.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:yt.length})]})]})})]}),e==="gantt"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gantt da Previso"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Incio: ",wt(u).toLocaleDateString("pt-BR"),"  Trmino previsto: ",_t.data||"-"]})]}),n.jsxs("div",{className:"p-4 overflow-x-auto",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Zoom"}),n.jsx("input",{type:"range",min:"20",max:"80",step:"4",value:_,onChange:W=>v(parseInt(W.target.value)||36)}),n.jsxs("span",{className:"text-sm text-gray-500",children:[_,"px/dia"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Ordenar por"}),n.jsxs("select",{value:R,onChange:W=>q(W.target.value),className:"p-1 border border-gray-300 rounded",children:[n.jsx("option",{value:"prazo",children:"Prazo (dt_fatura)"}),n.jsx("option",{value:"estimativa",children:"Maior durao"}),n.jsx("option",{value:"comprimento",children:"Comprimento"}),n.jsx("option",{value:"sequencia",children:"Sequncia atual"})]})]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",checked:U,onChange:W=>P(W.target.checked)})," Sombrar finais de semana"]})]}),St.length===0?n.jsx("p",{className:"text-gray-500",children:"Nenhum item para exibir."}):(()=>{const W=St.reduce((C,F)=>C+(parseFloat(F.span)||0),0),me=Math.max(1,Math.ceil(W)),we=_,Ae=Array.from({length:me},(C,F)=>{const Q=wt(u);return Q.setDate(Q.getDate()+F),Q}),S=[];let T=0;for(;T<me;){const C=Ae[T],F=C.getMonth();let Q=0;for(;T+Q<me&&Ae[T+Q].getMonth()===F;)Q++;S.push({label:C.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"}),span:Q}),T+=Q}const N=Math.floor((new Date-wt(u))/(1e3*60*60*24));return n.jsxs("div",{children:[n.jsxs("div",{className:"grid",style:{gridTemplateColumns:`220px repeat(${me}, ${we}px)`},children:[n.jsx("div",{}),S.map((C,F)=>n.jsx("div",{className:"text-xs text-center text-gray-700 font-medium border-b border-gray-200 flex items-center justify-center",style:{gridColumn:`span ${C.span}`},children:C.label.toUpperCase()},F))]}),n.jsxs("div",{className:"grid",style:{gridTemplateColumns:`220px repeat(${me}, ${we}px)`},children:[n.jsx("div",{className:"text-xs text-gray-400 pl-2",children:"Tarefa"}),Ae.map((C,F)=>n.jsx("div",{className:`text-[10px] text-center border-r border-gray-100 ${U&&(C.getDay()===0||C.getDay()===6)?"bg-gray-50 text-gray-400":"text-gray-400"}`,children:C.getDate().toString().padStart(2,"0")},F))]}),n.jsxs("div",{className:"relative",children:[N>=0&&N<me&&n.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500",style:{left:`${220+N*we}px`}}),St.map(C=>{const F=yt.find(Z=>(Z.pedido_seq||Z.id)===C.id),Q=(F==null?void 0:F.confiabilidade)||"Baixa",ee=Q==="Alta"?"bg-green-500":Q==="Mdia"?"bg-yellow-500":Q==="Estimativa"?"bg-purple-500":"bg-blue-500";return n.jsxs("div",{className:"grid items-center",style:{gridTemplateColumns:`220px repeat(${me}, ${we}px)`},children:[n.jsx("div",{className:"text-sm text-gray-700 py-2 pr-3 truncate",children:C.label}),Ae.map((Z,ne)=>n.jsx("div",{className:`h-7 border-b border-r border-gray-100 ${U&&(Z.getDay()===0||Z.getDay()===6)?"bg-gray-50":""}`},ne)),n.jsxs("div",{className:"col-start-2 col-end-[-1] -mt-7 relative",style:{pointerEvents:"none"},children:[n.jsx("div",{className:`h-7 ${ee} rounded shadow-sm text-white text-[11px] flex items-center justify-center`,title:`${C.label} | ${C.inicio.toLocaleDateString("pt-BR")}  ${C.fim.toLocaleDateString("pt-BR")} | ${Number(C.span||0).toFixed(2)} dia(s) | ${Q}`,style:{position:"absolute",left:`${C.startIndex*we}px`,width:`${Math.max(.05,C.span)*we}px`,minWidth:"4px"},children:Number(C.span)<1?`${(Number(C.span)*24).toFixed(1)}h`:`${Number(C.span).toFixed(1)}d`}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",style:{position:"absolute",left:`${C.startIndex*we}px`,top:"28px"},children:[C.inicio.toLocaleDateString("pt-BR"),"  ",C.fim.toLocaleDateString("pt-BR")]})]})]},C.id)})]})]})})()]})]}),e==="carteira"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Estimativa para Pedidos da Carteira"}),n.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[n.jsx("button",{onClick:pr,className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Selecionar todos"}),n.jsx("button",{onClick:ia,className:"px-3 py-1 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Limpar seleo"}),E.length>0&&n.jsxs("span",{className:"text-sm text-gray-600",children:[E.length," selecionados"]}),e==="gantt"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gantt da Previso"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["Incio: ",wt(u).toLocaleDateString("pt-BR"),"  Trmino previsto: ",_t.data||"-"]})]}),n.jsxs("div",{className:"p-4 overflow-x-auto",children:[n.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Zoom"}),n.jsx("input",{type:"range",min:"20",max:"80",step:"4",value:_,onChange:W=>v(parseInt(W.target.value)||36)}),n.jsxs("span",{className:"text-sm text-gray-500",children:[_,"px/dia"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-700",children:"Ordenar por"}),n.jsxs("select",{value:R,onChange:W=>q(W.target.value),className:"p-1 border border-gray-300 rounded",children:[n.jsx("option",{value:"prazo",children:"Prazo (dt_fatura)"}),n.jsx("option",{value:"estimativa",children:"Maior durao"}),n.jsx("option",{value:"comp_asc",children:"Comprimento de AZ (menor  maior)"}),n.jsx("option",{value:"comp_desc",children:"Comprimento de ZA (maior  menor)"}),n.jsx("option",{value:"sequencia",children:"Sequncia atual"})]})]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",checked:U,onChange:W=>P(W.target.checked)})," Sombrar finais de semana"]})]}),St.length===0?n.jsx("p",{className:"text-gray-500",children:"Nenhum item para exibir."}):(()=>{const W=Math.max(1,St.reduce((N,C)=>N+C.span,0)),me=_,we=Array.from({length:W},(N,C)=>{const F=wt(u);return F.setDate(F.getDate()+C),F}),Ae=[];let S=0;for(;S<W;){const N=we[S],C=N.getMonth();let F=0;for(;S+F<W&&we[S+F].getMonth()===C;)F++;Ae.push({label:N.toLocaleDateString("pt-BR",{month:"short",year:"2-digit"}),span:F}),S+=F}const A=Math.floor((new Date-wt(u))/(1e3*60*60*24));return n.jsxs("div",{children:[n.jsxs("div",{className:"grid",style:{gridTemplateColumns:`220px repeat(${W}, ${me}px)`},children:[n.jsx("div",{}),Ae.map((N,C)=>n.jsx("div",{className:"text-xs text-center text-gray-700 font-medium border-b border-gray-200 flex items-center justify-center",style:{gridColumn:`span ${N.span}`},children:N.label.toUpperCase()},C))]}),n.jsxs("div",{className:"grid",style:{gridTemplateColumns:`220px repeat(${W}, ${me}px)`},children:[n.jsx("div",{className:"text-xs text-gray-400 pl-2",children:"Tarefa"}),we.map((N,C)=>n.jsx("div",{className:`text-[10px] text-center border-r border-gray-100 ${U&&(N.getDay()===0||N.getDay()===6)?"bg-gray-50 text-gray-400":"text-gray-400"}`,children:N.getDate().toString().padStart(2,"0")},C))]}),n.jsxs("div",{className:"relative",children:[A>=0&&A<W&&n.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500",style:{left:`${220+A*me}px`}}),St.map(N=>{const C=N.confiabilidade==="Alta"?"bg-green-500":N.confiabilidade==="Mdia"?"bg-yellow-500":"bg-blue-500";return n.jsxs("div",{className:"grid items-center",style:{gridTemplateColumns:`220px repeat(${W}, ${me}px)`},children:[n.jsx("div",{className:"text-sm text-gray-700 py-2 pr-3 truncate",children:N.label}),we.map((F,Q)=>n.jsx("div",{className:`h-7 border-b border-r border-gray-100 ${U&&(F.getDay()===0||F.getDay()===6)?"bg-gray-50":""}`},Q)),n.jsxs("div",{className:"col-start-2 col-end-[-1] -mt-7 relative",style:{pointerEvents:"none"},children:[n.jsxs("div",{className:`h-7 ${C} rounded shadow-sm text-white text-xs flex items-center justify-center`,title:`${N.label} | ${N.inicio.toLocaleDateString("pt-BR")}  ${N.fim.toLocaleDateString("pt-BR")} | ${N.span} dia(s)`,style:{position:"absolute",left:`${N.startIndex*me}px`,width:`${N.span*me}px`},children:[N.span,"d"]}),n.jsxs("div",{className:"text-[10px] text-gray-500 mt-1",style:{position:"absolute",left:`${N.startIndex*me}px`,top:"28px"},children:[N.inicio.toLocaleDateString("pt-BR"),"  ",N.fim.toLocaleDateString("pt-BR")]})]})]},N.id)})]})]})})()]})]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",onChange:W=>W.target.checked?pr():ia(),checked:E.length>0&&(mt||[]).every(W=>E.includes(W.pedido_seq)),className:"h-4 w-4 text-blue-600 border-gray-300 rounded",title:"Selecionar todos"})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido/Seq"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido Cliente"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo a Produzir"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produtividade (pcs/h)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa (horas)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa (dias)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Confiabilidade"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prazo"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:mt.map((W,me)=>{var we;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:n.jsx("input",{type:"checkbox",checked:ar(W.pedido_seq),onChange:()=>ha(W.pedido_seq),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:W.pedido_seq}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.pedido_cliente||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.produto}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(we=W.saldoProduzir)==null?void 0:we.toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.produtividade?W.produtividade.pcsPorHora.toFixed(1):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.estimativaHoras}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.estimativaDias}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${W.confiabilidade==="Alta"?"bg-green-100 text-green-800":W.confiabilidade==="Mdia"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:W.confiabilidade})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.dt_fatura?new Date(W.dt_fatura).toLocaleDateString("pt-BR"):"-"})]},me)})})]})})]}),x&&n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg p-6",children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Importar Formulrio de Cotao"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Carregue um arquivo CSV/XLSX com as colunas: produto, descricao, quantidade, produtividade, ferramenta, comprimento_mm."}),n.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:async W=>{var we;const me=(we=W.target.files)==null?void 0:we[0];await L(me)},className:"w-full mb-4"}),n.jsx("div",{className:"flex justify-end gap-2",children:n.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Fechar"})})]})}),Ee&&n.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md p-6",children:[n.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Estimativa (peas/dia) para Importados"}),n.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Defina uma taxa de produo diria para calcular horas e dias dos itens importados sem produtividade histrica."}),n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimativa (pcs/dia)"}),n.jsx("input",{type:"number",value:Fe,onChange:W=>Te(parseInt(W.target.value)||0),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 mb-4"}),n.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-md p-3 text-sm text-gray-700 mb-4",children:[n.jsxs("div",{className:"mb-1",children:["Quantidade de Itens no pedido: ",n.jsx("b",{children:Sr.itens})]}),n.jsxs("div",{className:"mb-3",children:["Quantidade de Pcs para Recortar: ",n.jsx("b",{children:Sr.totalPcs.toLocaleString("pt-BR")})]}),n.jsx("div",{className:"mb-2 font-medium",children:"Data de incio"}),n.jsxs("label",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{type:"radio",name:"inicioImp",value:"carteira",checked:$e==="carteira",onChange:()=>ae("carteira")}),n.jsxs("span",{children:['Usar "Trmino Previsto" da Carteira: ',n.jsx("b",{children:(_t==null?void 0:_t.data)||"-"})]})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",name:"inicioImp",value:"manual",checked:$e==="manual",onChange:()=>ae("manual")}),n.jsx("span",{children:"Informar manualmente:"})]}),$e==="manual"&&n.jsx("div",{className:"mt-2",children:n.jsx("input",{type:"date",value:He,onChange:W=>Ue(W.target.value),className:"p-2 border border-gray-300 rounded-md"})}),n.jsxs("div",{className:"mt-3",children:["Estimativa (peas/dia) informada: ",n.jsx("b",{children:Number(Fe||0).toLocaleString("pt-BR")})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{onClick:()=>ve(!1),className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Cancelar"}),n.jsx("button",{onClick:_r,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Aplicar"})]})]})}),e==="manual"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Adicionar Estimativa Manual"}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs("button",{onClick:()=>ye(W=>!W),className:"bg-blue-600 text-white px-3 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx(Di,{className:"inline mr-2"})," ",V?"Fechar formulrio":"Abrir formulrio manual"]}),n.jsx("button",{onClick:()=>{const W=new Date,me=W.getFullYear(),we=String(W.getMonth()+1).padStart(2,"0"),Ae=String(W.getDate()).padStart(2,"0"),S=`${me}-${we}-${Ae}`,T=jt(_t==null?void 0:_t.data);ae("carteira"),Ue(T||S),ve(!0)},className:"bg-purple-600 text-white px-3 py-2 rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500",children:"Definir Estimativa (pcs/dia) para Importados"}),n.jsxs("button",{onClick:()=>w(!0),className:"bg-indigo-600 text-white px-3 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500",title:"Importar formulrio de cotao",children:[n.jsx(o1,{className:"inline mr-2"})," Importar Cotao"]}),n.jsxs("button",{onClick:Wr,className:"bg-red-600 text-white px-3 py-2 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500",title:"Remover todas as estimativas manuais",children:[n.jsx(os,{className:"inline mr-2"})," Limpar Lista"]})]}),V&&n.jsxs("div",{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ferramenta"}),n.jsx("input",{type:"text",value:g.ferramenta,onChange:W=>p(me=>({...me,ferramenta:W.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex.: TR-0018"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comprimento (mm)"}),n.jsx("input",{type:"number",step:"1",value:g.comprimentoMm,onChange:W=>p(me=>({...me,comprimentoMm:W.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex.: 1100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Volume (pcs)"}),n.jsx("input",{type:"number",value:g.quantidade,onChange:W=>p(me=>({...me,quantidade:W.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Qtd a produzir (pcs)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Produtividade (pcs/h)"}),n.jsx("input",{type:"number",step:"0.1",value:g.produtividadeManual,onChange:W=>p(me=>({...me,produtividadeManual:W.target.value})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Opcional"})]})]}),n.jsxs("button",{onClick:wr,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx(Di,{className:"inline mr-2"})," Adicionar"]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Estimativas Manuais"})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ferramenta"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprimento (mm)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Volume (pcs)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produtividade (pcs/h)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa (horas)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estimativa (dias)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Confiabilidade"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(W=>{var me;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.ferramenta||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.comprimentoMm||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(me=W.quantidade)==null?void 0:me.toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.produtividadeManual?Number(W.produtividadeManual).toFixed(1):"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.estimativaHoras}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.estimativaDias}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${W.confiabilidade==="Manual"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:W.confiabilidade})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.jsx("button",{onClick:()=>Bt(W.id),className:"text-red-600 hover:text-red-900",children:n.jsx(os,{})})})]},W.id)})})]})})]})]}),e==="produtividade"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Histrico de Produtividade por Produto"})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Registros"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Produzido"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Horas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pcs/Hora"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pcs/Dia (8h)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mquinas"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operadores"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.values(Ke).map((W,me)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:W.produto}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.registros}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.totalPcs.toLocaleString("pt-BR")}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[W.totalHoras.toFixed(1),"h"]}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.pcsPorHora.toFixed(1)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.pcsPorDia.toFixed(1)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.maquinasArray.join(", ")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.operadoresArray.join(", ")})]},me))})]})})]}),e==="turnos"&&n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[n.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[n.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Configurao de Turnos de Trabalho"}),n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure os turnos para clculos mais precisos de estimativas"})]}),n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"grid grid-cols-1 gap-4",children:z.map(W=>n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:W.ativo,onChange:()=>Wt(W.id),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mr-3"}),n.jsxs("h4",{className:`text-lg font-medium ${W.ativo?"text-gray-900":"text-gray-400"}`,children:[W.nome," (",W.id,")"]})]}),n.jsx("div",{className:"flex items-center space-x-2",children:(J==null?void 0:J.id)===W.id?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:Zr,className:"bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500",children:[n.jsx(ba,{className:"inline mr-1"}),"Salvar"]}),n.jsx("button",{onClick:Ea,className:"bg-gray-600 text-white px-3 py-1 rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancelar"})]}):n.jsx("button",{onClick:()=>Qr(W),className:"bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Editar"})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Horas de Trabalho"}),(J==null?void 0:J.id)===W.id?n.jsx("input",{type:"number",step:"0.5",min:"0",max:"24",value:J.horasTrabalho,onChange:me=>ce(we=>({...we,horasTrabalho:parseFloat(me.target.value)||0})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"}):n.jsxs("div",{className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700",children:[W.horasTrabalho,"h"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Horas de Paradas"}),(J==null?void 0:J.id)===W.id?n.jsx("input",{type:"number",step:"0.5",min:"0",max:"24",value:J.horasParadas,onChange:me=>ce(we=>({...we,horasParadas:parseFloat(me.target.value)||0})),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"}):n.jsxs("div",{className:"w-full p-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700",children:[W.horasParadas,"h"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Horas teis"}),n.jsxs("div",{className:"w-full p-2 border border-gray-300 rounded-md bg-blue-50 text-blue-700 font-medium",children:[(J==null?void 0:J.id)===W.id?(J.horasTrabalho-J.horasParadas).toFixed(1):(W.horasTrabalho-W.horasParadas).toFixed(1),"h"]})]})]})]},W.id))}),n.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-lg font-medium text-blue-900",children:"Resumo dos Turnos"}),n.jsx("p",{className:"text-sm text-blue-700",children:"Total de horas teis por dia considerando todos os turnos ativos"})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Ge,"h/dia (turnos)"]}),n.jsxs("div",{className:"text-sm text-blue-600",children:[z.filter(W=>W.ativo).length," turnos ativos"]})]})]})}),n.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg",children:[n.jsx("h4",{className:"text-lg font-medium text-yellow-900 mb-3",children:"Horas Extras"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extras Dia til (h)"}),n.jsx("input",{type:"number",step:"0.5",min:"0",value:he,onChange:W=>De(parseFloat(W.target.value)||0),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extras Sbado (h)"}),n.jsx("input",{type:"number",step:"0.5",min:"0",value:j,onChange:W=>de(parseFloat(W.target.value)||0),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),n.jsx("div",{className:"flex md:justify-end",children:n.jsxs("button",{onClick:ke,className:"self-end bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-500",children:[n.jsx(ba,{className:"inline mr-2"})," Salvar Extras"]})})]})]})]})]})]})};function Cm(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ak}=Object.prototype,{getPrototypeOf:E0}=Object,{iterator:pc,toStringTag:Fm}=Symbol,gc=(e=>t=>{const r=Ak.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ua=e=>(e=e.toLowerCase(),t=>gc(t)===e),vc=e=>t=>typeof t===e,{isArray:ii}=Array,Ki=vc("undefined");function oo(e){return e!==null&&!Ki(e)&&e.constructor!==null&&!Ki(e.constructor)&&na(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Pm=Ua("ArrayBuffer");function Ck(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Pm(e.buffer),t}const Fk=vc("string"),na=vc("function"),Om=vc("number"),co=e=>e!==null&&typeof e=="object",Pk=e=>e===!0||e===!1,Ao=e=>{if(gc(e)!=="object")return!1;const t=E0(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Fm in e)&&!(pc in e)},Ok=e=>{if(!co(e)||oo(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},Dk=Ua("Date"),Ik=Ua("File"),Rk=Ua("Blob"),Lk=Ua("FileList"),Mk=e=>co(e)&&na(e.pipe),Bk=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||na(e.append)&&((t=gc(e))==="formdata"||t==="object"&&na(e.toString)&&e.toString()==="[object FormData]"))},Uk=Ua("URLSearchParams"),[qk,$k,Hk,zk]=["ReadableStream","Request","Response","Headers"].map(Ua),Wk=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function lo(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let a,s;if(typeof e!="object"&&(e=[e]),ii(e))for(a=0,s=e.length;a<s;a++)t.call(null,e[a],a,e);else{if(oo(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let c;for(a=0;a<o;a++)c=i[a],t.call(null,e[c],c,e)}}function Dm(e,t){if(oo(e))return null;t=t.toLowerCase();const r=Object.keys(e);let a=r.length,s;for(;a-- >0;)if(s=r[a],t===s.toLowerCase())return s;return null}const Zs=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Im=e=>!Ki(e)&&e!==Zs;function Sl(){const{caseless:e}=Im(this)&&this||{},t={},r=(a,s)=>{const i=e&&Dm(t,s)||s;Ao(t[i])&&Ao(a)?t[i]=Sl(t[i],a):Ao(a)?t[i]=Sl({},a):ii(a)?t[i]=a.slice():t[i]=a};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&lo(arguments[a],r);return t}const Vk=(e,t,r,{allOwnKeys:a}={})=>(lo(t,(s,i)=>{r&&na(s)?e[i]=Cm(s,r):e[i]=s},{allOwnKeys:a}),e),Gk=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Xk=(e,t,r,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},Kk=(e,t,r,a)=>{let s,i,o;const c={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],(!a||a(o,e,t))&&!c[o]&&(t[o]=e[o],c[o]=!0);e=r!==!1&&E0(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},Jk=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const a=e.indexOf(t,r);return a!==-1&&a===r},Yk=e=>{if(!e)return null;if(ii(e))return e;let t=e.length;if(!Om(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},Qk=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&E0(Uint8Array)),Zk=(e,t)=>{const a=(e&&e[pc]).call(e);let s;for(;(s=a.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},ej=(e,t)=>{let r;const a=[];for(;(r=e.exec(t))!==null;)a.push(r);return a},tj=Ua("HTMLFormElement"),rj=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,s){return a.toUpperCase()+s}),bu=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),aj=Ua("RegExp"),Rm=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),a={};lo(r,(s,i)=>{let o;(o=t(s,i,e))!==!1&&(a[i]=o||s)}),Object.defineProperties(e,a)},sj=e=>{Rm(e,(t,r)=>{if(na(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=e[r];if(na(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},nj=(e,t)=>{const r={},a=s=>{s.forEach(i=>{r[i]=!0})};return ii(e)?a(e):a(String(e).split(t)),r},ij=()=>{},oj=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function cj(e){return!!(e&&na(e.append)&&e[Fm]==="FormData"&&e[pc])}const lj=e=>{const t=new Array(10),r=(a,s)=>{if(co(a)){if(t.indexOf(a)>=0)return;if(oo(a))return a;if(!("toJSON"in a)){t[s]=a;const i=ii(a)?[]:{};return lo(a,(o,c)=>{const l=r(o,s+1);!Ki(l)&&(i[c]=l)}),t[s]=void 0,i}}return a};return r(e,0)},dj=Ua("AsyncFunction"),uj=e=>e&&(co(e)||na(e))&&na(e.then)&&na(e.catch),Lm=((e,t)=>e?setImmediate:t?((r,a)=>(Zs.addEventListener("message",({source:s,data:i})=>{s===Zs&&i===r&&a.length&&a.shift()()},!1),s=>{a.push(s),Zs.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",na(Zs.postMessage)),fj=typeof queueMicrotask<"u"?queueMicrotask.bind(Zs):typeof process<"u"&&process.nextTick||Lm,hj=e=>e!=null&&na(e[pc]),ge={isArray:ii,isArrayBuffer:Pm,isBuffer:oo,isFormData:Bk,isArrayBufferView:Ck,isString:Fk,isNumber:Om,isBoolean:Pk,isObject:co,isPlainObject:Ao,isEmptyObject:Ok,isReadableStream:qk,isRequest:$k,isResponse:Hk,isHeaders:zk,isUndefined:Ki,isDate:Dk,isFile:Ik,isBlob:Rk,isRegExp:aj,isFunction:na,isStream:Mk,isURLSearchParams:Uk,isTypedArray:Qk,isFileList:Lk,forEach:lo,merge:Sl,extend:Vk,trim:Wk,stripBOM:Gk,inherits:Xk,toFlatObject:Kk,kindOf:gc,kindOfTest:Ua,endsWith:Jk,toArray:Yk,forEachEntry:Zk,matchAll:ej,isHTMLForm:tj,hasOwnProperty:bu,hasOwnProp:bu,reduceDescriptors:Rm,freezeMethods:sj,toObjectSet:nj,toCamelCase:rj,noop:ij,toFiniteNumber:oj,findKey:Dm,global:Zs,isContextDefined:Im,isSpecCompliantForm:cj,toJSONObject:lj,isAsyncFn:dj,isThenable:uj,setImmediate:Lm,asap:fj,isIterable:hj};function lt(e,t,r,a,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),s&&(this.response=s,this.status=s.status?s.status:null)}ge.inherits(lt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const Mm=lt.prototype,Bm={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Bm[e]={value:e}});Object.defineProperties(lt,Bm);Object.defineProperty(Mm,"isAxiosError",{value:!0});lt.from=(e,t,r,a,s,i)=>{const o=Object.create(Mm);return ge.toFlatObject(e,o,function(l){return l!==Error.prototype},c=>c!=="isAxiosError"),lt.call(o,e.message,t,r,a,s),o.cause=e,o.name=e.name,i&&Object.assign(o,i),o};const mj=null;function Nl(e){return ge.isPlainObject(e)||ge.isArray(e)}function Um(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function wu(e,t,r){return e?e.concat(t).map(function(s,i){return s=Um(s),!r&&i?"["+s+"]":s}).join(r?".":""):t}function xj(e){return ge.isArray(e)&&!e.some(Nl)}const pj=ge.toFlatObject(ge,{},null,function(t){return/^is[A-Z]/.test(t)});function yc(e,t,r){if(!ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,x){return!ge.isUndefined(x[p])});const a=r.metaTokens,s=r.visitor||u,i=r.dots,o=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(t);if(!ge.isFunction(s))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(ge.isDate(g))return g.toISOString();if(ge.isBoolean(g))return g.toString();if(!l&&ge.isBlob(g))throw new lt("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(g)||ge.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,p,x){let w=g;if(g&&!x&&typeof g=="object"){if(ge.endsWith(p,"{}"))p=a?p:p.slice(0,-2),g=JSON.stringify(g);else if(ge.isArray(g)&&xj(g)||(ge.isFileList(g)||ge.endsWith(p,"[]"))&&(w=ge.toArray(g)))return p=Um(p),w.forEach(function(v,R){!(ge.isUndefined(v)||v===null)&&t.append(o===!0?wu([p],R,i):o===null?p:p+"[]",d(v))}),!1}return Nl(g)?!0:(t.append(wu(x,p,i),d(g)),!1)}const f=[],m=Object.assign(pj,{defaultVisitor:u,convertValue:d,isVisitable:Nl});function h(g,p){if(!ge.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));f.push(g),ge.forEach(g,function(w,_){(!(ge.isUndefined(w)||w===null)&&s.call(t,w,ge.isString(_)?_.trim():_,p,m))===!0&&h(w,p?p.concat(_):[_])}),f.pop()}}if(!ge.isObject(e))throw new TypeError("data must be an object");return h(e),t}function _u(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function T0(e,t){this._pairs=[],e&&yc(e,this,t)}const qm=T0.prototype;qm.append=function(t,r){this._pairs.push([t,r])};qm.toString=function(t){const r=t?function(a){return t.call(this,a,_u)}:_u;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function gj(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function $m(e,t,r){if(!t)return e;const a=r&&r.encode||gj;ge.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(t,r):i=ge.isURLSearchParams(t)?t.toString():new T0(t,r).toString(a),i){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class vj{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ge.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Su=vj,Hm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},yj=typeof URLSearchParams<"u"?URLSearchParams:T0,bj=typeof FormData<"u"?FormData:null,wj=typeof Blob<"u"?Blob:null,_j={isBrowser:!0,classes:{URLSearchParams:yj,FormData:bj,Blob:wj},protocols:["http","https","file","blob","url","data"]},A0=typeof window<"u"&&typeof document<"u",kl=typeof navigator=="object"&&navigator||void 0,Sj=A0&&(!kl||["ReactNative","NativeScript","NS"].indexOf(kl.product)<0),Nj=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),kj=A0&&window.location.href||"http://localhost",jj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:A0,hasStandardBrowserEnv:Sj,hasStandardBrowserWebWorkerEnv:Nj,navigator:kl,origin:kj},Symbol.toStringTag,{value:"Module"})),Ur={...jj,..._j};function Ej(e,t){return yc(e,new Ur.classes.URLSearchParams,{visitor:function(r,a,s,i){return Ur.isNode&&ge.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Tj(e){return ge.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Aj(e){const t={},r=Object.keys(e);let a;const s=r.length;let i;for(a=0;a<s;a++)i=r[a],t[i]=e[i];return t}function zm(e){function t(r,a,s,i){let o=r[i++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),l=i>=r.length;return o=!o&&ge.isArray(s)?s.length:o,l?(ge.hasOwnProp(s,o)?s[o]=[s[o],a]:s[o]=a,!c):((!s[o]||!ge.isObject(s[o]))&&(s[o]=[]),t(r,a,s[o],i)&&ge.isArray(s[o])&&(s[o]=Aj(s[o])),!c)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){const r={};return ge.forEachEntry(e,(a,s)=>{t(Tj(a),s,r,0)}),r}return null}function Cj(e,t,r){if(ge.isString(e))try{return(t||JSON.parse)(e),ge.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(e)}const C0={transitional:Hm,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",s=a.indexOf("application/json")>-1,i=ge.isObject(t);if(i&&ge.isHTMLForm(t)&&(t=new FormData(t)),ge.isFormData(t))return s?JSON.stringify(zm(t)):t;if(ge.isArrayBuffer(t)||ge.isBuffer(t)||ge.isStream(t)||ge.isFile(t)||ge.isBlob(t)||ge.isReadableStream(t))return t;if(ge.isArrayBufferView(t))return t.buffer;if(ge.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let c;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Ej(t,this.formSerializer).toString();if((c=ge.isFileList(t))||a.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return yc(c?{"files[]":t}:t,l&&new l,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),Cj(t)):t}],transformResponse:[function(t){const r=this.transitional||C0.transitional,a=r&&r.forcedJSONParsing,s=this.responseType==="json";if(ge.isResponse(t)||ge.isReadableStream(t))return t;if(t&&ge.isString(t)&&(a&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(c){if(o)throw c.name==="SyntaxError"?lt.from(c,lt.ERR_BAD_RESPONSE,this,null,this.response):c}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ur.classes.FormData,Blob:Ur.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{C0.headers[e]={}});const F0=C0,Fj=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pj=e=>{const t={};let r,a,s;return e&&e.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),a=o.substring(s+1).trim(),!(!r||t[r]&&Fj[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},Nu=Symbol("internals");function mi(e){return e&&String(e).trim().toLowerCase()}function Co(e){return e===!1||e==null?e:ge.isArray(e)?e.map(Co):String(e)}function Oj(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(e);)t[a[1]]=a[2];return t}const Dj=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Xc(e,t,r,a,s){if(ge.isFunction(a))return a.call(this,t,r);if(s&&(t=r),!!ge.isString(t)){if(ge.isString(a))return t.indexOf(a)!==-1;if(ge.isRegExp(a))return a.test(t)}}function Ij(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function Rj(e,t){const r=ge.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+r,{value:function(s,i,o){return this[a].call(this,t,s,i,o)},configurable:!0})})}class bc{constructor(t){t&&this.set(t)}set(t,r,a){const s=this;function i(c,l,d){const u=mi(l);if(!u)throw new Error("header name must be a non-empty string");const f=ge.findKey(s,u);(!f||s[f]===void 0||d===!0||d===void 0&&s[f]!==!1)&&(s[f||l]=Co(c))}const o=(c,l)=>ge.forEach(c,(d,u)=>i(d,u,l));if(ge.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(ge.isString(t)&&(t=t.trim())&&!Dj(t))o(Pj(t),r);else if(ge.isObject(t)&&ge.isIterable(t)){let c={},l,d;for(const u of t){if(!ge.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[d=u[0]]=(l=c[d])?ge.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(c,r)}else t!=null&&i(r,t,a);return this}get(t,r){if(t=mi(t),t){const a=ge.findKey(this,t);if(a){const s=this[a];if(!r)return s;if(r===!0)return Oj(s);if(ge.isFunction(r))return r.call(this,s,a);if(ge.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=mi(t),t){const a=ge.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||Xc(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let s=!1;function i(o){if(o=mi(o),o){const c=ge.findKey(a,o);c&&(!r||Xc(a,a[c],c,r))&&(delete a[c],s=!0)}}return ge.isArray(t)?t.forEach(i):i(t),s}clear(t){const r=Object.keys(this);let a=r.length,s=!1;for(;a--;){const i=r[a];(!t||Xc(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const r=this,a={};return ge.forEach(this,(s,i)=>{const o=ge.findKey(a,i);if(o){r[o]=Co(s),delete r[i];return}const c=t?Ij(i):String(i).trim();c!==i&&delete r[i],r[c]=Co(s),a[c]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return ge.forEach(this,(a,s)=>{a!=null&&a!==!1&&(r[s]=t&&ge.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(s=>a.set(s)),a}static accessor(t){const a=(this[Nu]=this[Nu]={accessors:{}}).accessors,s=this.prototype;function i(o){const c=mi(o);a[c]||(Rj(s,o),a[c]=!0)}return ge.isArray(t)?t.forEach(i):i(t),this}}bc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors(bc.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(a){this[r]=a}}});ge.freezeMethods(bc);const Ba=bc;function Kc(e,t){const r=this||F0,a=t||r,s=Ba.from(a.headers);let i=a.data;return ge.forEach(e,function(c){i=c.call(r,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Wm(e){return!!(e&&e.__CANCEL__)}function oi(e,t,r){lt.call(this,e??"canceled",lt.ERR_CANCELED,t,r),this.name="CanceledError"}ge.inherits(oi,lt,{__CANCEL__:!0});function Vm(e,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(new lt("Request failed with status code "+r.status,[lt.ERR_BAD_REQUEST,lt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Lj(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Mj(e,t){e=e||10;const r=new Array(e),a=new Array(e);let s=0,i=0,o;return t=t!==void 0?t:1e3,function(l){const d=Date.now(),u=a[i];o||(o=d),r[s]=l,a[s]=d;let f=i,m=0;for(;f!==s;)m+=r[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),d-o<t)return;const h=u&&d-u;return h?Math.round(m*1e3/h):void 0}}function Bj(e,t){let r=0,a=1e3/t,s,i;const o=(d,u=Date.now())=>{r=u,s=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),f=u-r;f>=a?o(d,u):(s=d,i||(i=setTimeout(()=>{i=null,o(s)},a-f)))},()=>s&&o(s)]}const Jo=(e,t,r=3)=>{let a=0;const s=Mj(50,250);return Bj(i=>{const o=i.loaded,c=i.lengthComputable?i.total:void 0,l=o-a,d=s(l),u=o<=c;a=o;const f={loaded:o,total:c,progress:c?o/c:void 0,bytes:l,rate:d||void 0,estimated:d&&c&&u?(c-o)/d:void 0,event:i,lengthComputable:c!=null,[t?"download":"upload"]:!0};e(f)},r)},ku=(e,t)=>{const r=e!=null;return[a=>t[0]({lengthComputable:r,total:e,loaded:a}),t[1]]},ju=e=>(...t)=>ge.asap(()=>e(...t)),Uj=Ur.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ur.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ur.origin),Ur.navigator&&/(msie|trident)/i.test(Ur.navigator.userAgent)):()=>!0,qj=Ur.hasStandardBrowserEnv?{write(e,t,r,a,s,i){const o=[e+"="+encodeURIComponent(t)];ge.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),ge.isString(a)&&o.push("path="+a),ge.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $j(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Hj(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Gm(e,t,r){let a=!$j(t);return e&&(a||r==!1)?Hj(e,t):t}const Eu=e=>e instanceof Ba?{...e}:e;function fn(e,t){t=t||{};const r={};function a(d,u,f,m){return ge.isPlainObject(d)&&ge.isPlainObject(u)?ge.merge.call({caseless:m},d,u):ge.isPlainObject(u)?ge.merge({},u):ge.isArray(u)?u.slice():u}function s(d,u,f,m){if(ge.isUndefined(u)){if(!ge.isUndefined(d))return a(void 0,d,f,m)}else return a(d,u,f,m)}function i(d,u){if(!ge.isUndefined(u))return a(void 0,u)}function o(d,u){if(ge.isUndefined(u)){if(!ge.isUndefined(d))return a(void 0,d)}else return a(void 0,u)}function c(d,u,f){if(f in t)return a(d,u);if(f in e)return a(void 0,d)}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(d,u,f)=>s(Eu(d),Eu(u),f,!0)};return ge.forEach(Object.keys({...e,...t}),function(u){const f=l[u]||s,m=f(e[u],t[u],u);ge.isUndefined(m)&&f!==c||(r[u]=m)}),r}const Xm=e=>{const t=fn({},e);let{data:r,withXSRFToken:a,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:c}=t;t.headers=o=Ba.from(o),t.url=$m(Gm(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let l;if(ge.isFormData(r)){if(Ur.hasStandardBrowserEnv||Ur.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[d,...u]=l?l.split(";").map(f=>f.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...u].join("; "))}}if(Ur.hasStandardBrowserEnv&&(a&&ge.isFunction(a)&&(a=a(t)),a||a!==!1&&Uj(t.url))){const d=s&&i&&qj.read(i);d&&o.set(s,d)}return t},zj=typeof XMLHttpRequest<"u",Wj=zj&&function(e){return new Promise(function(r,a){const s=Xm(e);let i=s.data;const o=Ba.from(s.headers).normalize();let{responseType:c,onUploadProgress:l,onDownloadProgress:d}=s,u,f,m,h,g;function p(){h&&h(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let x=new XMLHttpRequest;x.open(s.method.toUpperCase(),s.url,!0),x.timeout=s.timeout;function w(){if(!x)return;const v=Ba.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),q={data:!c||c==="text"||c==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:v,config:e,request:x};Vm(function(P){r(P),p()},function(P){a(P),p()},q),x=null}"onloadend"in x?x.onloadend=w:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(w)},x.onabort=function(){x&&(a(new lt("Request aborted",lt.ECONNABORTED,e,x)),x=null)},x.onerror=function(){a(new lt("Network Error",lt.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let R=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const q=s.transitional||Hm;s.timeoutErrorMessage&&(R=s.timeoutErrorMessage),a(new lt(R,q.clarifyTimeoutError?lt.ETIMEDOUT:lt.ECONNABORTED,e,x)),x=null},i===void 0&&o.setContentType(null),"setRequestHeader"in x&&ge.forEach(o.toJSON(),function(R,q){x.setRequestHeader(q,R)}),ge.isUndefined(s.withCredentials)||(x.withCredentials=!!s.withCredentials),c&&c!=="json"&&(x.responseType=s.responseType),d&&([m,g]=Jo(d,!0),x.addEventListener("progress",m)),l&&x.upload&&([f,h]=Jo(l),x.upload.addEventListener("progress",f),x.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(u=v=>{x&&(a(!v||v.type?new oi(null,e,x):v),x.abort(),x=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const _=Lj(s.url);if(_&&Ur.protocols.indexOf(_)===-1){a(new lt("Unsupported protocol "+_+":",lt.ERR_BAD_REQUEST,e));return}x.send(i||null)})},Vj=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let a=new AbortController,s;const i=function(d){if(!s){s=!0,c();const u=d instanceof Error?d:this.reason;a.abort(u instanceof lt?u:new oi(u instanceof Error?u.message:u))}};let o=t&&setTimeout(()=>{o=null,i(new lt(`timeout ${t} of ms exceeded`,lt.ETIMEDOUT))},t);const c=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:l}=a;return l.unsubscribe=()=>ge.asap(c),l}},Gj=Vj,Xj=function*(e,t){let r=e.byteLength;if(!t||r<t){yield e;return}let a=0,s;for(;a<r;)s=a+t,yield e.slice(a,s),a=s},Kj=async function*(e,t){for await(const r of Jj(e))yield*Xj(r,t)},Jj=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},Tu=(e,t,r,a)=>{const s=Kj(e,t);let i=0,o,c=l=>{o||(o=!0,a&&a(l))};return new ReadableStream({async pull(l){try{const{done:d,value:u}=await s.next();if(d){c(),l.close();return}let f=u.byteLength;if(r){let m=i+=f;r(m)}l.enqueue(new Uint8Array(u))}catch(d){throw c(d),d}},cancel(l){return c(l),s.return()}},{highWaterMark:2})},wc=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Km=wc&&typeof ReadableStream=="function",Yj=wc&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Jm=(e,...t)=>{try{return!!e(...t)}catch{return!1}},Qj=Km&&Jm(()=>{let e=!1;const t=new Request(Ur.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Au=64*1024,jl=Km&&Jm(()=>ge.isReadableStream(new Response("").body)),Yo={stream:jl&&(e=>e.body)};wc&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Yo[t]&&(Yo[t]=ge.isFunction(e[t])?r=>r[t]():(r,a)=>{throw new lt(`Response type '${t}' is not supported`,lt.ERR_NOT_SUPPORT,a)})})})(new Response);const Zj=async e=>{if(e==null)return 0;if(ge.isBlob(e))return e.size;if(ge.isSpecCompliantForm(e))return(await new Request(Ur.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(e)||ge.isArrayBuffer(e))return e.byteLength;if(ge.isURLSearchParams(e)&&(e=e+""),ge.isString(e))return(await Yj(e)).byteLength},eE=async(e,t)=>{const r=ge.toFiniteNumber(e.getContentLength());return r??Zj(t)},tE=wc&&(async e=>{let{url:t,method:r,data:a,signal:s,cancelToken:i,timeout:o,onDownloadProgress:c,onUploadProgress:l,responseType:d,headers:u,withCredentials:f="same-origin",fetchOptions:m}=Xm(e);d=d?(d+"").toLowerCase():"text";let h=Gj([s,i&&i.toAbortSignal()],o),g;const p=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let x;try{if(l&&Qj&&r!=="get"&&r!=="head"&&(x=await eE(u,a))!==0){let q=new Request(t,{method:"POST",body:a,duplex:"half"}),U;if(ge.isFormData(a)&&(U=q.headers.get("content-type"))&&u.setContentType(U),q.body){const[P,X]=ku(x,Jo(ju(l)));a=Tu(q.body,Au,P,X)}}ge.isString(f)||(f=f?"include":"omit");const w="credentials"in Request.prototype;g=new Request(t,{...m,signal:h,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:a,duplex:"half",credentials:w?f:void 0});let _=await fetch(g,m);const v=jl&&(d==="stream"||d==="response");if(jl&&(c||v&&p)){const q={};["status","statusText","headers"].forEach(G=>{q[G]=_[G]});const U=ge.toFiniteNumber(_.headers.get("content-length")),[P,X]=c&&ku(U,Jo(ju(c),!0))||[];_=new Response(Tu(_.body,Au,P,()=>{X&&X(),p&&p()}),q)}d=d||"text";let R=await Yo[ge.findKey(Yo,d)||"text"](_,e);return!v&&p&&p(),await new Promise((q,U)=>{Vm(q,U,{data:R,headers:Ba.from(_.headers),status:_.status,statusText:_.statusText,config:e,request:g})})}catch(w){throw p&&p(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new lt("Network Error",lt.ERR_NETWORK,e,g),{cause:w.cause||w}):lt.from(w,w&&w.code,e,g)}}),El={http:mj,xhr:Wj,fetch:tE};ge.forEach(El,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Cu=e=>`- ${e}`,rE=e=>ge.isFunction(e)||e===null||e===!1,Ym={getAdapter:e=>{e=ge.isArray(e)?e:[e];const{length:t}=e;let r,a;const s={};for(let i=0;i<t;i++){r=e[i];let o;if(a=r,!rE(r)&&(a=El[(o=String(r)).toLowerCase()],a===void 0))throw new lt(`Unknown adapter '${o}'`);if(a)break;s[o||"#"+i]=a}if(!a){const i=Object.entries(s).map(([c,l])=>`adapter ${c} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Cu).join(`
`):" "+Cu(i[0]):"as no adapter specified";throw new lt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a},adapters:El};function Jc(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new oi(null,e)}function Fu(e){return Jc(e),e.headers=Ba.from(e.headers),e.data=Kc.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ym.getAdapter(e.adapter||F0.adapter)(e).then(function(a){return Jc(e),a.data=Kc.call(e,e.transformResponse,a),a.headers=Ba.from(a.headers),a},function(a){return Wm(a)||(Jc(e),a&&a.response&&(a.response.data=Kc.call(e,e.transformResponse,a.response),a.response.headers=Ba.from(a.response.headers))),Promise.reject(a)})}const Qm="1.11.0",_c={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{_c[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}});const Pu={};_c.transitional=function(t,r,a){function s(i,o){return"[Axios v"+Qm+"] Transitional option '"+i+"'"+o+(a?". "+a:"")}return(i,o,c)=>{if(t===!1)throw new lt(s(o," has been removed"+(r?" in "+r:"")),lt.ERR_DEPRECATED);return r&&!Pu[o]&&(Pu[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(i,o,c):!0}};_c.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function aE(e,t,r){if(typeof e!="object")throw new lt("options must be an object",lt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let s=a.length;for(;s-- >0;){const i=a[s],o=t[i];if(o){const c=e[i],l=c===void 0||o(c,i,e);if(l!==!0)throw new lt("option "+i+" must be "+l,lt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new lt("Unknown option "+i,lt.ERR_BAD_OPTION)}}const Fo={assertOptions:aE,validators:_c},Wa=Fo.validators;class Qo{constructor(t){this.defaults=t||{},this.interceptors={request:new Su,response:new Su}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=fn(this.defaults,r);const{transitional:a,paramsSerializer:s,headers:i}=r;a!==void 0&&Fo.assertOptions(a,{silentJSONParsing:Wa.transitional(Wa.boolean),forcedJSONParsing:Wa.transitional(Wa.boolean),clarifyTimeoutError:Wa.transitional(Wa.boolean)},!1),s!=null&&(ge.isFunction(s)?r.paramsSerializer={serialize:s}:Fo.assertOptions(s,{encode:Wa.function,serialize:Wa.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Fo.assertOptions(r,{baseUrl:Wa.spelling("baseURL"),withXsrfToken:Wa.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=i&&ge.merge(i.common,i[r.method]);i&&ge.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),r.headers=Ba.concat(o,i);const c=[];let l=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(r)===!1||(l=l&&p.synchronous,c.unshift(p.fulfilled,p.rejected))});const d=[];this.interceptors.response.forEach(function(p){d.push(p.fulfilled,p.rejected)});let u,f=0,m;if(!l){const g=[Fu.bind(this),void 0];for(g.unshift(...c),g.push(...d),m=g.length,u=Promise.resolve(r);f<m;)u=u.then(g[f++],g[f++]);return u}m=c.length;let h=r;for(f=0;f<m;){const g=c[f++],p=c[f++];try{h=g(h)}catch(x){p.call(this,x);break}}try{u=Fu.call(this,h)}catch(g){return Promise.reject(g)}for(f=0,m=d.length;f<m;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=fn(this.defaults,t);const r=Gm(t.baseURL,t.url,t.allowAbsoluteUrls);return $m(r,t.params,t.paramsSerializer)}}ge.forEach(["delete","get","head","options"],function(t){Qo.prototype[t]=function(r,a){return this.request(fn(a||{},{method:t,url:r,data:(a||{}).data}))}});ge.forEach(["post","put","patch"],function(t){function r(a){return function(i,o,c){return this.request(fn(c||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Qo.prototype[t]=r(),Qo.prototype[t+"Form"]=r(!0)});const Po=Qo;class P0{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(s=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](s);a._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(c=>{a.subscribe(c),i=c}).then(s);return o.cancel=function(){a.unsubscribe(i)},o},t(function(i,o,c){a.reason||(a.reason=new oi(i,o,c),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new P0(function(s){t=s}),cancel:t}}}const sE=P0;function nE(e){return function(r){return e.apply(null,r)}}function iE(e){return ge.isObject(e)&&e.isAxiosError===!0}const Tl={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Tl).forEach(([e,t])=>{Tl[t]=e});const oE=Tl;function Zm(e){const t=new Po(e),r=Cm(Po.prototype.request,t);return ge.extend(r,Po.prototype,t,{allOwnKeys:!0}),ge.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return Zm(fn(e,s))},r}const cr=Zm(F0);cr.Axios=Po;cr.CanceledError=oi;cr.CancelToken=sE;cr.isCancel=Wm;cr.VERSION=Qm;cr.toFormData=yc;cr.AxiosError=lt;cr.Cancel=cr.CanceledError;cr.all=function(t){return Promise.all(t)};cr.spread=nE;cr.isAxiosError=iE;cr.mergeConfig=fn;cr.AxiosHeaders=Ba;cr.formToJSON=e=>zm(ge.isHTMLForm(e)?new FormData(e):e);cr.getAdapter=Ym.getAdapter;cr.HttpStatusCode=oE;cr.default=cr;const cE=cr,lE=()=>{const{user:e}=Ms(),{items:t,addItems:r,clearItems:a,loadItems:s}=ft("pedidos"),{items:i,addItems:o,clearItems:c}=ft("lotes"),[l,d]=I.useState(null),[u,f]=I.useState(null),[m,h]=I.useState(!1),[g,p]=I.useState(!1),[x,w]=I.useState(!1),[_,v]=I.useState(""),[R,q]=I.useState(""),[U,P]=I.useState(""),[X,G]=I.useState(""),[le,se]=I.useState(0),{items:V,addItem:ye,updateItem:Ee,removeItem:ve,loadItems:Fe,loading:Te}=ft("usuarios"),[$e,ae]=I.useState({nome:"",email:"",senha:"",nivel_acesso:"operador"}),{items:He,addItem:Ue,updateItem:k,removeItem:B}=ft("ferramentas_cfg"),[E,D]=I.useState({ferramenta:"",peso_linear:"",comprimento_mm:"",pcs_por_pallet:"",ripas_por_pallet:"",embalagem:"pallet",pcs_por_caixa:""}),[z,oe]=I.useState(null),[J,ce]=I.useState(!1),he=async()=>{try{if(!E.ferramenta){alert("Informe o cdigo da ferramenta");return}const b=(E.embalagem||"pallet")==="caixa",K={ferramenta:String(E.ferramenta).trim(),peso_linear:Number(E.peso_linear)||0,comprimento_mm:parseInt(E.comprimento_mm)||0,pcs_por_pallet:b?0:parseInt(E.pcs_por_pallet)||0,ripas_por_pallet:b?0:parseInt(E.ripas_por_pallet)||0,embalagem:E.embalagem||"pallet",pcs_por_caixa:b&&parseInt(E.pcs_por_caixa)||0};await Ue(K),D({ferramenta:"",peso_linear:"",comprimento_mm:"",pcs_por_pallet:"",ripas_por_pallet:"",embalagem:"pallet",pcs_por_caixa:""}),alert("Parmetros adicionados")}catch(b){alert("Falha ao adicionar: "+String((b==null?void 0:b.message)||b))}},De=b=>{if(b==null||b==="")return 0;if(typeof b=="number")return b;const K=String(b).trim();if(!K)return 0;const ue=K.replace(/\./g,"").replace(/,/g,"."),y=parseFloat(ue);return isNaN(y)?0:y},j=b=>{try{if(!b&&b!==0)return"";if(typeof b=="number"){const y=Uo.parse_date_code(b);return y&&y.y?`${y.y}-${String(y.m).padStart(2,"0")}-${String(y.d).padStart(2,"0")}`:""}const K=String(b);if(K.includes("/")){const y=K.split("/");if(y.length===3)return`${y[2]}-${y[1].padStart(2,"0")}-${y[0].padStart(2,"0")}`}const ue=new Date(K);return isNaN(ue.getTime())?"":ue.toISOString().split("T")[0]}catch{return""}},de=async()=>{if(!u){P("Selecione um arquivo para importar");return}const b=u.name.split(".").pop().toLowerCase();if(!["xlsx","xls"].includes(b)){P("Formato no suportado (.xlsx/.xls)");return}p(!0),P(""),G(""),se(0);try{const K=new FileReader;K.onload=async ue=>{try{const y=new Uint8Array(ue.target.result),M=Qn(y,{type:"array"}),H=M.SheetNames[0],pe=M.Sheets[H],Oe=cs.sheet_to_json(pe,{header:1});if(!Oe||Oe.length<=1)throw new Error("A planilha no contm dados suficientes");const _e=Oe[0].map(Gt=>String(Gt||"").trim()),ze={codigo:"Codigo",situacao:"Situao",produto:"Produto",lote:"Lote",rackEmb:"Rack!Embalagem",embalagem:"Embalagem",romaneio:"Romaneio",qtKg:"Qt Kg",qtdPc:"Qtd PC"},Xe={};for(const Gt of Object.keys(ze))if(Xe[Gt]=_e.indexOf(ze[Gt]),Xe[Gt]===-1)throw new Error(`Coluna obrigatria no encontrada: ${ze[Gt]}`);const st=_e.indexOf("Pedido e Seq"),rt=_e.indexOf("Pedido"),Be=_e.indexOf("Seq"),jr=_e.indexOf("Nota Fiscal"),dr=st!==-1;if(!dr&&!(rt!==-1&&Be!==-1))throw new Error("Coluna obrigatria no encontrada: Pedido e Seq (ou as colunas Pedido e Seq)");const Er=[];for(let Gt=1;Gt<Oe.length;Gt++){const qt=Oe[Gt]||[];let Ve="";if(dr)Ve=String(qt[st]||"").trim();else{const sr=qt[rt],Sc=qt[Be],uo=String(sr??"").toString().replace(/[^0-9]/g,""),fo=String(Sc??"").toString().replace(/[^0-9]/g,"");if(uo&&fo){const ho=parseInt(fo,10);Ve=`${uo}/${Number.isFinite(ho)?ho:0}`}}const We=String(qt[Xe.rackEmb]||"").trim();if(!Ve||!We)continue;const Tr={};for(let sr=0;sr<_e.length;sr++)_e[sr]&&qt[sr]!==void 0&&(Tr[_e[sr]]=qt[sr]);Er.push({pedido_seq:Ve,codigo:String(qt[Xe.codigo]||"").trim(),situacao:String(qt[Xe.situacao]||"").trim(),produto:String(qt[Xe.produto]||"").trim(),lote:String(qt[Xe.lote]||"").trim(),rack_embalagem:We,embalagem_data:j(qt[Xe.embalagem]||""),romaneio:String(qt[Xe.romaneio]||"").trim(),nota_fiscal:jr!==-1?String(qt[jr]||"").trim():"",qt_kg:De(qt[Xe.qtKg]),qtd_pc:De(qt[Xe.qtdPc]),dados_originais:Tr})}if(Er.length===0)throw new Error("Nenhuma linha vlida encontrada (verifique Pedido e Seq e Rack!Embalagem)");try{await c()}catch{}const An=100;let bs=0;for(let Gt=0;Gt<Er.length;Gt+=An){const qt=Er.slice(Gt,Gt+An);await o(qt),bs+=qt.length,console.log(`Inseridos ${bs}/${Er.length} lotes...`)}se(bs),G(`Arquivo ${u.name} importado com sucesso! ${Er.length} lotes foram processados.`),f(null)}catch(y){P("Erro ao processar o arquivo: "+y.message)}finally{p(!1)}},K.onerror=()=>{P("Erro ao ler o arquivo"),p(!1)},K.readAsArrayBuffer(u)}catch(K){P("Erro ao importar arquivo: "+((K==null?void 0:K.message)||"desconhecido")),p(!1)}},fe=b=>{oe({...b}),ce(!0)},re=()=>{oe(null),ce(!1)},xe=async()=>{if(!z||!z.ferramenta){alert("Ferramenta  obrigatria");return}try{const b=(z.embalagem||"pallet")==="caixa",K={...z,peso_linear:Number(z.peso_linear)||0,comprimento_mm:parseInt(z.comprimento_mm)||0,pcs_por_pallet:b?0:parseInt(z.pcs_por_pallet)||0,ripas_por_pallet:b?0:parseInt(z.ripas_por_pallet)||0,pcs_por_caixa:b&&parseInt(z.pcs_por_caixa)||0};await k(K),re(),alert("Alteraes salvas")}catch(b){alert("Falha ao salvar: "+String((b==null?void 0:b.message)||b))}},L=async b=>{b&&window.confirm("Excluir este cadastro?")&&await B(b)},[Y,ke]=I.useState(null),[Pe,Ge]=I.useState(!1),[et,Pt]=I.useState({tempo_padrao_setup:30,tempo_padrao_manutencao:60,meta_oee:85,horas_turno:8,dias_uteis_mes:22}),{items:qe,addItem:ht,updateItem:ot,removeItem:wt}=ft("motivos_parada"),[jt,Ft]=I.useState(""),[Ke,vt]=I.useState("planejada"),[yt,mt]=I.useState(null),[lr,wr]=I.useState(!1),{items:Bt,addItem:Wr,updateItem:_r,removeItem:Sr}=ft("tipos_parada"),[ar,ha]=I.useState(""),pr=b=>{if(!b)return"";try{return String(b).toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu,"").replace(/\s+/g,"_")}catch{return String(b).toLowerCase()}};I.useEffect(()=>{if((Bt||[]).length>0){const b=Bt[0],K=(b==null?void 0:b.descricao)||(b==null?void 0:b.nome)||"";K&&vt(pr(K))}},[Bt]);const{items:ia,addItem:Qr,updateItem:Zr,removeItem:Ea}=ft("maquinas"),[Wt,Ut]=I.useState({nome:"",status:"ativa"}),[pt,_t]=I.useState(null),[St,W]=I.useState(!1),[me,we]=I.useState([{id:1,codigo:"INS001",nome:"leo Lubrificante",tipo:"oleo",quantidade:50,unidade:"litros"},{id:2,codigo:"INS002",nome:"Serra Circular",tipo:"ferramenta",quantidade:15,unidade:"peas"},{id:3,codigo:"INS003",nome:"Broca 10mm",tipo:"ferramenta",quantidade:30,unidade:"peas"},{id:4,codigo:"INS004",nome:"Inserto CNMG",tipo:"ferramenta_cnc",quantidade:100,unidade:"peas"}]),[Ae,S]=I.useState(()=>{const b=localStorage.getItem("configuracao_impressoras");return b?JSON.parse(b):{termica:{nome:"Impressora Trmica",caminho:"\\\\192.168.1.100\\Zebra_ZT230",ip:"192.168.1.100",porta:"9100",ativa:!0},comum:{nome:"Impressora Comum",caminho:"\\\\192.168.1.101\\HP_LaserJet",ip:"192.168.1.101",porta:"9100",ativa:!0}}}),[T,A]=I.useState({codigo:"",nome:"",tipo:"ferramenta",quantidade:0,unidade:"peas"}),[N,C]=I.useState(null),[F,Q]=I.useState(!1),[ee,Z]=I.useState("usuarios"),[ne]=lx();I.useEffect(()=>{const b=ne.get("tab");b&&Z(b)},[ne]);const[ie,Se]=I.useState(localStorage.getItem("pdfBasePath")||""),[Ce,Ie]=I.useState(localStorage.getItem("processBasePath")||"");I.useEffect(()=>{const b=localStorage.getItem("pdfBasePath");b&&b!==ie&&Se(b);const K=localStorage.getItem("processBasePath");K&&K!==Ce&&Ie(K)},[]);const Ne=()=>{localStorage.setItem("pdfBasePath",ie||""),alert("Caminho salvo!")},Le=()=>{localStorage.setItem("processBasePath",Ce||""),alert("Caminho salvo!")},Je=(b,K)=>`file:///${`${String(b||"").replace(/[\\/]+$/,"")}\\${K}`.replace(/\\/g,"/")}`,Nt=()=>{if(!ie){alert("Defina o caminho base dos PDFs primeiro.");return}const b=Je(ie,"TR-0000.pdf");window.open(b,"_blank")},Tt=()=>{if(!Ce){alert("Defina o caminho base das Fichas de Processo primeiro.");return}const b=Je(Ce,"TR-0000.pdf");window.open(b,"_blank")},[it,Qt]=I.useState(!1),[Pr,Zt]=I.useState(null),[Vr,ma]=I.useState(null),[er,$s]=I.useState(null),[ps,es]=I.useState(null),[qa,ts]=I.useState(null),xa=async()=>{Qt(!0);try{try{const b=await fetch("/");Zt(b.ok?"ok":"erro")}catch{Zt("erro")}try{const b=await fetch("/api/sync/pedidos/changes");ma(b.ok?"ok":"erro")}catch{ma("erro")}try{await dbService.init(),$s("ok")}catch{$s("erro")}es(await dbService.getSyncMeta("last_sync_pedidos")),ts(await dbService.getSyncMeta("last_sync_apontamentos"))}finally{Qt(!1)}},Nr=async()=>{w(!0);try{await SyncService.syncAll(),await xa(),q("Sincronizao concluda")}catch(b){v("Falha ao sincronizar: "+String(b))}finally{w(!1)}},Ta=async()=>{if(!$e.nome||!$e.email||!$e.senha){alert("Preencha todos os campos obrigatrios");return}try{const b={nome:$e.nome.trim(),email:$e.email.trim().toLowerCase(),senha:$e.senha,senha_hash:$e.senha,nivel_acesso:$e.nivel_acesso,ativo:!0,data_criacao:new Date().toISOString()};await ye(b),await ls.registrarCriacao(e,"usuarios",`Criou usurio: ${b.nome} (${b.email})`,{...b,senha:"***",senha_hash:"***"}),ae({nome:"",email:"",senha:"",nivel_acesso:"operador"}),alert("Usurio adicionado com sucesso!")}catch(b){console.error("Erro ao adicionar usurio:",b),alert("Erro ao adicionar usurio: "+(b.message||"Erro desconhecido"))}},_n=b=>{ke({...b,senha:""}),Ge(!0)},ea=async()=>{if(!Y.nome||!Y.email){alert("Nome e email so obrigatrios");return}try{const b=V.find(ue=>ue.id===Y.id),K={...Y,nome:Y.nome.trim(),email:Y.email.trim().toLowerCase()};Y.senha&&Y.senha.trim()?(K.senha=Y.senha,K.senha_hash=Y.senha):(delete K.senha,delete K.senha_hash),await Ee(K),await ls.registrarEdicao(e,"usuarios",`Editou usurio: ${K.nome} (${K.email})`,{...b,senha:"***",senha_hash:"***"},{...K,senha:"***",senha_hash:"***"}),ta(),alert("Usurio atualizado com sucesso!")}catch(b){console.error("Erro ao atualizar usurio:",b),alert("Erro ao atualizar usurio: "+(b.message||"Erro desconhecido"))}},ta=()=>{ke(null),Ge(!1)},$a=async b=>{if(window.confirm("Tem certeza que deseja excluir este usurio?"))try{const K=V.find(ue=>ue.id===b);console.log("Excluindo usurio ID:",b),await ve(b),console.log("Usurio excludo com sucesso"),K&&await ls.registrarExclusao(e,"usuarios",`Excluiu usurio: ${K.nome} (${K.email})`,{...K,senha:"***",senha_hash:"***"}),console.log("Forando reload da lista de usurios..."),await Fe(),console.log("Lista recarregada"),alert("Usurio excludo com sucesso!")}catch(K){console.error("Erro ao excluir usurio:",K),alert("Erro ao excluir usurio: "+(K.message||"Erro desconhecido"))}},kr=b=>{const{name:K,value:ue}=b.target;Pt({...et,[K]:Number(ue)})},Aa=async()=>{if(!jt.trim()){alert("Digite uma descrio para o motivo de parada");return}const b=String(Ke||"planejada");await ht({descricao:jt.trim(),tipo_parada:b}),Ft(""),vt("planejada")},Or=b=>{mt({id:b.id,descricao:b.descricao||"",tipo_parada:b.tipo_parada||""}),wr(!0)},Ca=async()=>{if(!yt||!String(yt.descricao||"").trim()){alert("Descrio  obrigatria");return}const b={id:yt.id,descricao:String(yt.descricao).trim(),tipo_parada:String(yt.tipo_parada||"").trim()};await ot(b),Sn()},Sn=()=>{mt(null),wr(!1)},Ha=async b=>{b&&window.confirm("Excluir este motivo?")&&await wt(b)},gs=async()=>{if(!ar.trim()){alert("Digite uma descrio para o tipo de parada");return}await Wr({descricao:ar.trim()}),ha("")},Fa=async b=>{b&&window.confirm("Excluir este tipo?")&&await Sr(b)},Pa=async()=>{if(!Wt.nome){alert("Nome da mquina  obrigatrio");return}const b=(Wt.status||"ativa").toLowerCase(),K=b==="ativo"?"ativa":b==="inativo"?"inativa":b;await Qr({nome:String(Wt.nome).trim(),status:K}),Ut({nome:"",status:"ativa"})},Nn=b=>{_t({...b}),W(!0)},rs=async()=>{if(!pt.nome){alert("Nome da mquina  obrigatrio");return}const b=String(pt.status||"").toLowerCase();await Zr({...pt,status:b==="ativo"?"ativa":b==="inativo"?"inativa":b||"ativa"}),as()},as=()=>{_t(null),W(!1)},ci=async b=>{window.confirm("Tem certeza que deseja excluir esta mquina?")&&await Ea(b)},Hs=()=>{if(!T.codigo||!T.nome){alert("Cdigo e nome do insumo so obrigatrios");return}const b=me.length>0?Math.max(...me.map(K=>K.id))+1:1;we([...me,{id:b,codigo:T.codigo,nome:T.nome,tipo:T.tipo,quantidade:T.quantidade,unidade:T.unidade}]),A({codigo:"",nome:"",tipo:"ferramenta",quantidade:0,unidade:"peas"})},vs=b=>{C({...b}),Q(!0)},zs=()=>{if(!N.codigo||!N.nome){alert("Cdigo e nome do insumo so obrigatrios");return}we(me.map(b=>b.id===N.id?N:b)),kn()},kn=()=>{C(null),Q(!1)},jn=b=>{window.confirm("Tem certeza que deseja excluir este insumo?")&&we(me.filter(K=>K.id!==b))},En=()=>{localStorage.setItem("configuracao_impressoras",JSON.stringify(Ae)),alert("Configuraes de impressoras salvas com sucesso!")},Dr=(b,K,ue)=>{S(y=>({...y,[b]:{...y[b],[K]:ue}}))},ys=b=>{const K=Ae[b];if(!K.ativa){alert(`Impressora ${K.nome} est desativada`);return}alert(`Teste de impresso enviado para: ${K.nome}
Caminho: ${K.caminho}
IP: ${K.ip}:${K.porta}`)},Ws=()=>{alert("Configuraes salvas com sucesso!")},O=async()=>{w(!0),v("");try{const b=await cE.get("http://localhost:8000/api/pedidos/");await a(),await r(b.data),q("Pedidos sincronizados com o servidor")}catch(b){v("Erro ao sincronizar pedidos: "+b.message)}finally{w(!1)}},te=async()=>{var K,ue;if(!l){v("Selecione um arquivo para importar");return}const b=l.name.split(".").pop().toLowerCase();if(!["xlsx","xls"].includes(b)){v("Formato de arquivo no suportado. Por favor, selecione um arquivo Excel (.xlsx ou .xls)");return}h(!0),v(""),q("");try{const y=new FileReader;y.onload=async M=>{try{const H=l.name,pe=new Uint8Array(M.target.result),Oe=Qn(pe,{type:"array"}),_e=Oe.SheetNames[0],ze=Oe.Sheets[_e],Xe=cs.sheet_to_json(ze,{header:1});if(!Xe||Xe.length<=1)throw new Error("A planilha no contm dados suficientes");const st=Xe[0].map(Ve=>String(Ve||"").trim()),rt={};st.forEach((Ve,We)=>{Ve&&(rt[Ve]=We)});const Be={},jr=Ve=>String(Ve||"").toLowerCase().replace(/[^a-z0-9]/g,"");Be.pedido=rt["PEDIDO/SEQ"]??rt.PEDIDO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("pedido")||String(Ve).toLowerCase().includes("seq"));{const Ve=st.findIndex(We=>jr(We)==="cliente");if(Ve!==-1)Be.cliente=Ve;else if(rt.CLIENTE!==void 0)Be.cliente=rt.CLIENTE;else{const We=st.findIndex(Tr=>{const sr=jr(Tr);return sr.includes("cliente")&&sr!=="pedidocliente"});Be.cliente=We!==-1?We:st.findIndex(Tr=>String(Tr).toLowerCase().includes("cliente"))}}Be.pedidoCliente=st.findIndex(Ve=>String(Ve).toLowerCase().includes("pedido")&&String(Ve).toLowerCase().includes("cliente")),Be.data=rt["DT.FATURA"]??rt["DATA ENTREGA"]??rt["DT ENTREGA"]??st.findIndex(Ve=>String(Ve).toLowerCase().includes("data")||String(Ve).toLowerCase().includes("entrega")||String(Ve).toLowerCase().includes("fatura")),Be.produto=rt.PRODUTO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("produto")),Be.descricao=rt.DESCRIO??rt.DESCRICAO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("descri")),Be.unidade=rt.UNIDADE??rt.UN??st.findIndex(Ve=>String(Ve).toLowerCase().includes("un")),Be.quantidade=rt["QTD.PEDIDO"]??rt["QTD. PEDIDO"]??rt.QUANTIDADE??st.findIndex(Ve=>String(Ve).toLowerCase().includes("qtd")),Be.saldo=rt["SALDO..PROD"]??rt["SALDO A PROD."]??rt.SALDO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("saldo")),Be.estoque=rt["ESTOQUE.ACA"]??rt.ESTOQUE??st.findIndex(Ve=>String(Ve).toLowerCase().includes("estoque")||String(Ve).toLowerCase().includes("aca")),Be.separado=rt.SEPARADO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("separado")),Be.faturado=rt.FATURADO??st.findIndex(Ve=>String(Ve).toLowerCase().includes("faturado")),Be.perfil=rt["ITEM.PERFIL"]??rt["ITEM PERFIL"]??st.findIndex(Ve=>String(Ve).toLowerCase().includes("item")&&String(Ve).toLowerCase().includes("perfil"));{const Ve=st.findIndex(We=>jr(We)==="nrodaop");Ve!==-1?Be.op=Ve:Be.op=rt["NRO DA OP"]??rt["N OP"]??rt.OP??st.findIndex(We=>jr(We).includes("op"))}const Tn=["pedido","cliente","produto"].filter(Ve=>Be[Ve]===-1);if(Tn.length>0)throw new Error(`Colunas obrigatrias no encontradas: ${Tn.join(", ")}`);const Er=[],An=t.length>0?Math.max(...t.map(Ve=>parseInt(Ve.id))):0;for(let Ve=1;Ve<Xe.length;Ve++){const We=Xe[Ve];if(!We||We.length===0||!We[Be.pedido])continue;const Tr=(An+Er.length+1).toString(),sr=We[Be.pedido]?String(We[Be.pedido]).trim():"",Sc=Be.pedidoCliente!==-1&&We[Be.pedidoCliente]?String(We[Be.pedidoCliente]).trim():"",uo=We[Be.cliente]?String(We[Be.cliente]).trim():"Cliente no especificado",fo=We[Be.produto]?String(We[Be.produto]).trim():"",ho=We[Be.descricao]?String(We[Be.descricao]).trim():"Sem descrio",tx=Be.unidade!==-1&&We[Be.unidade]?String(We[Be.unidade]).trim():"PC",mo=We[Be.quantidade]!==void 0?typeof We[Be.quantidade]=="number"?We[Be.quantidade]:parseInt(String(We[Be.quantidade]).replace(/\D/g,""))||0:0,Nc=We[Be.saldo]!==void 0?typeof We[Be.saldo]=="number"?We[Be.saldo]:parseInt(String(We[Be.saldo]).replace(/\D/g,""))||0:mo,rx=Be.estoque!==-1&&We[Be.estoque]!==void 0?typeof We[Be.estoque]=="number"?We[Be.estoque]:parseInt(String(We[Be.estoque]).replace(/\D/g,""))||0:0,ax=Be.separado!==-1&&We[Be.separado]!==void 0?typeof We[Be.separado]=="number"?We[Be.separado]:parseInt(String(We[Be.separado]).replace(/\D/g,""))||0:0,sx=Be.faturado!==-1&&We[Be.faturado]!==void 0?typeof We[Be.faturado]=="number"?We[Be.faturado]:parseInt(String(We[Be.faturado]).replace(/\D/g,""))||0:0,ws=We[Be.data]||"";let _s="";if(ws)try{if(typeof ws=="number"){const ur=Uo.parse_date_code(ws);_s=`${ur.y}-${String(ur.m).padStart(2,"0")}-${String(ur.d).padStart(2,"0")}`}else if(typeof ws=="string")if(ws.includes("/")){const ur=ws.split("/");if(ur.length===3)_s=`${ur[2]}-${ur[1]}-${ur[0]}`;else{const li=new Date(ws);isNaN(li.getTime())||(_s=li.toISOString().split("T")[0])}}else{const ur=new Date(ws);isNaN(ur.getTime())||(_s=ur.toISOString().split("T")[0])}}catch{_s=""}if(!_s){const ur=new Date;ur.setDate(ur.getDate()+30),_s=ur.toISOString().split("T")[0]}const nx=Be.op!==-1&&We[Be.op]?String(We[Be.op]).trim():`OP${Tr.padStart(3,"0")}`,ix=Be.perfil!==-1&&We[Be.perfil]?String(We[Be.perfil]).trim():`PERF${Tr.padStart(3,"0")}`,O0={};st.forEach((ur,li)=>{ur&&We[li]!==void 0&&(O0[ur]=We[li])}),Er.push({pedido_seq:sr.includes("/")?sr:`${sr}/1`,pedido_cliente:Sc||sr,cliente:uo,dt_fatura:_s,produto:fo,descricao:ho,unidade:tx,qtd_pedido:mo,saldo_a_prod:Nc,estoque_aca:rx||(mo-Nc>0?mo-Nc:0),separado:ax,faturado:sx,item_perfil:ix,nro_op:nx,status:"pendente",dados_originais:O0})}if(Er.length===0)throw new Error("Nenhum pedido vlido encontrado na planilha");const bs=50;let Gt=0;for(let Ve=0;Ve<Er.length;Ve+=bs){const We=Er.slice(Ve,Ve+bs);await r(We),Gt+=We.length,console.log(`Inseridos ${Gt}/${Er.length} pedidos...`)}q(`Arquivo ${H} importado com sucesso! ${Er.length} pedidos foram processados.`),h(!1),d(null);const qt=document.querySelector('input[type="file"]');qt&&(qt.value="")}catch(H){v("Erro ao processar o arquivo: "+H.message),h(!1)}},y.onerror=()=>{v("Erro ao ler o arquivo"),h(!1)},y.readAsArrayBuffer(l)}catch(y){v("Erro ao importar arquivo: "+(((ue=(K=y.response)==null?void 0:K.data)==null?void 0:ue.detail)||y.message)),h(!1)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Configuraes"}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"-mb-px flex flex-wrap sm:flex-nowrap sm:space-x-4 lg:space-x-8 overflow-x-auto pb-1 gap-2 sm:gap-0",children:[n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="usuarios"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("usuarios"),children:"Usurios"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="processo"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("processo"),children:"Processo"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="maquinas"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("maquinas"),children:"Mquinas"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="insumos"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("insumos"),children:"Insumos"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="impressoras"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("impressoras"),children:"Impressoras"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="dados"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("dados"),children:"Dados"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="arquivos"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("arquivos"),children:"Arquivos"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="expedicao"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("expedicao"),children:"Expedio"}),n.jsx("button",{className:`py-3 px-2 sm:px-3 lg:px-4 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap transition-colors ${ee==="status"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,onClick:()=>Z("status"),children:"Status"})]})}),ee==="usuarios"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Gerenciamento de Usurios"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[n.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:Pe?"Editar Usurio":"Adicionar Novo Usurio"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),n.jsx("input",{type:"text",className:"input-field",value:Pe?(Y==null?void 0:Y.nome)||"":$e.nome||"",onChange:b=>Pe?ke({...Y,nome:b.target.value}):ae({...$e,nome:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),n.jsx("input",{type:"email",className:"input-field",value:Pe?(Y==null?void 0:Y.email)||"":$e.email||"",onChange:b=>Pe?ke({...Y,email:b.target.value}):ae({...$e,email:b.target.value})})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Senha ",Pe&&"(deixe em branco para manter a atual)"]}),n.jsx("input",{type:"password",className:"input-field",value:Pe?(Y==null?void 0:Y.senha)||"":$e.senha||"",onChange:b=>Pe?ke({...Y,senha:b.target.value}):ae({...$e,senha:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nvel de Acesso"}),n.jsxs("select",{className:"input-field",value:Pe?(Y==null?void 0:Y.nivel_acesso)||"operador":$e.nivel_acesso||"operador",onChange:b=>Pe?ke({...Y,nivel_acesso:b.target.value}):ae({...$e,nivel_acesso:b.target.value}),children:[n.jsx("option",{value:"operador",children:"Operador"}),n.jsx("option",{value:"supervisor",children:"Supervisor"}),n.jsx("option",{value:"admin",children:"Administrador"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:Pe?n.jsxs(n.Fragment,{children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:ta,children:[n.jsx(Ys,{className:"mr-1"})," Cancelar"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:ea,children:[n.jsx(ba,{className:"mr-1"})," Salvar Alteraes"]})]}):n.jsxs("button",{type:"button",className:"btn-primary",onClick:Ta,disabled:Te,children:[n.jsx(v1,{className:"mr-1"})," ",Te?"Adicionando...":"Adicionar Usurio"]})})]}),V.length===0&&!Te&&n.jsxs("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[n.jsxs("p",{className:"text-sm text-yellow-800",children:[n.jsx("strong",{children:" Ateno:"})," A tabela de usurios pode no estar criada no Supabase."]}),n.jsxs("p",{className:"text-xs text-yellow-700 mt-2",children:["Execute o script SQL em ",n.jsx("code",{className:"bg-yellow-100 px-1 rounded",children:"database_schema_usuarios.sql"})," no Supabase para criar a tabela."]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nvel de Acesso"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[V.map(b=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.nome}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.email}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[b.nivel_acesso==="admin"&&"Administrador",b.nivel_acesso==="supervisor"&&"Supervisor",b.nivel_acesso==="operador"&&"Operador"]}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:()=>_n(b),children:n.jsx(ui,{})}),n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>$a(b.id),disabled:Te,children:n.jsx(os,{})})]})]},b.id)),!Te&&V.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:"Nenhum usurio cadastrado. Adicione o primeiro usurio acima."})}),Te&&n.jsx("tr",{children:n.jsx("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:"Carregando usurios..."})})]})]})})]})}),ee==="expedicao"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Parmetros por Ferramenta (Expedio)"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[n.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:J?"Editar":"Adicionar"}),n.jsxs("div",{className:`grid grid-cols-1 ${(J?z==null?void 0:z.embalagem:E.embalagem)==="caixa"?"md:grid-cols-7":"md:grid-cols-6"} gap-4`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ferramenta *"}),n.jsx("input",{type:"text",className:"input-field",value:J?z.ferramenta:E.ferramenta,onChange:b=>J?oe({...z,ferramenta:b.target.value}):D({...E,ferramenta:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Peso Linear (kg)"}),n.jsx("input",{type:"number",step:"0.001",className:"input-field",value:J?z.peso_linear:E.peso_linear,onChange:b=>J?oe({...z,peso_linear:b.target.value}):D({...E,peso_linear:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comprimento (mm)"}),n.jsx("input",{type:"number",className:"input-field",value:J?z.comprimento_mm:E.comprimento_mm,onChange:b=>J?oe({...z,comprimento_mm:b.target.value}):D({...E,comprimento_mm:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pcs por Pallet"}),n.jsx("input",{type:"number",className:"input-field",value:J?z.pcs_por_pallet:E.pcs_por_pallet,disabled:J?z.embalagem==="caixa":E.embalagem==="caixa",onChange:b=>J?oe({...z,pcs_por_pallet:b.target.value}):D({...E,pcs_por_pallet:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ripas por Pallet"}),n.jsx("input",{type:"number",className:"input-field",value:J?z.ripas_por_pallet:E.ripas_por_pallet,disabled:J?z.embalagem==="caixa":E.embalagem==="caixa",onChange:b=>J?oe({...z,ripas_por_pallet:b.target.value}):D({...E,ripas_por_pallet:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Embalagem"}),n.jsxs("select",{className:"input-field",value:J?z.embalagem:E.embalagem,onChange:b=>{const K=b.target.value;if(J){const ue={...z,embalagem:K};K==="pallet"&&(ue.pcs_por_caixa=""),K==="caixa"&&(ue.pcs_por_pallet="",ue.ripas_por_pallet=""),oe(ue)}else{const ue={...E,embalagem:K};K==="pallet"&&(ue.pcs_por_caixa=""),K==="caixa"&&(ue.pcs_por_pallet="",ue.ripas_por_pallet=""),D(ue)}},children:[n.jsx("option",{value:"pallet",children:"Pallet"}),n.jsx("option",{value:"caixa",children:"Caixa de papelo"})]})]}),(J?(z==null?void 0:z.embalagem)==="caixa":E.embalagem==="caixa")&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pcs por Caixa"}),n.jsx("input",{type:"number",className:"input-field",value:J?z.pcs_por_caixa:E.pcs_por_caixa,onChange:b=>J?oe({...z,pcs_por_caixa:b.target.value}):D({...E,pcs_por_caixa:b.target.value})})]})]}),n.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:J?n.jsxs(n.Fragment,{children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:re,children:[n.jsx(Ys,{className:"mr-1"})," Cancelar"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:xe,children:[n.jsx(ba,{className:"mr-1"})," Salvar Alteraes"]})]}):n.jsxs("button",{type:"button",className:"btn-primary",onClick:he,children:[n.jsx(ba,{className:"mr-1"})," Adicionar"]})})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ferramenta"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Peso Linear (kg)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Comprimento (mm)"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pcs/Pallet"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ripas/Pallet"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Embalagem"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pcs/Caixa"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[(He||[]).map(b=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.ferramenta}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.peso_linear}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.comprimento_mm}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.pcs_por_pallet}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.ripas_por_pallet}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.embalagem}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:b.pcs_por_caixa}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:()=>fe(b),children:n.jsx(ui,{})}),n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>L(b.id),children:n.jsx(os,{})})]})]},b.id)),(He||[]).length===0&&n.jsx("tr",{children:n.jsx("td",{className:"px-6 py-6 text-center text-gray-500",colSpan:"8",children:"Nenhum cadastro"})})]})]})})]})}),ee==="status"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Status do Sistema"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:xa,disabled:it,children:[n.jsx(Oc,{className:"mr-1"})," Verificar"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:Nr,disabled:x,children:[n.jsx(Oc,{className:"mr-1"})," Sincronizar"]})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Servidor (API)"}),n.jsx("p",{className:`text-lg font-semibold ${Pr==="ok"?"text-green-600":"text-red-600"}`,children:Pr?Pr==="ok"?"Ativo":"Indisponvel":"-"})]}),n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"Banco (SQLite - Backend)"}),n.jsx("p",{className:`text-lg font-semibold ${Vr==="ok"?"text-green-600":"text-red-600"}`,children:Vr?Vr==="ok"?"Ativo":"Indisponvel":"-"})]}),n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"IndexedDB (Local)"}),n.jsx("p",{className:`text-lg font-semibold ${er==="ok"?"text-green-600":"text-red-600"}`,children:er?er==="ok"?"Ativo":"Indisponvel":"-"})]})]}),n.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"ltima sincronizao - Pedidos"}),n.jsx("p",{className:"text-sm",children:ps||"-"})]}),n.jsxs("div",{className:"p-4 border rounded-lg",children:[n.jsx("p",{className:"text-sm text-gray-500",children:"ltima sincronizao - Apontamentos"}),n.jsx("p",{className:"text-sm",children:qa||"-"})]})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Dica: se a estrutura local foi atualizada (IndexedDB), recarregue a pgina para garantir a reconexo."})]})}),ee==="arquivos"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Desenhos de Ferramentas (PDF)"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caminho base dos PDFs"}),n.jsx("input",{type:"text",className:"input-field",placeholder:"Ex.: C:\\\\Compartilhado\\\\FerramentasPDF",value:ie,onChange:b=>Se(b.target.value)}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"O app abrir arquivos pelo padro: CAMINHO \\\\ CDIGO-DA-FERRAMENTA .pdf. Ex.: C:\\\\...\\\\TR-0018.pdf"})]})}),n.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:Nt,children:[n.jsx(nd,{className:"mr-1"})," Testar abertura (exemplo)"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:Ne,children:[n.jsx(ba,{className:"mr-1"})," Salvar Caminho"]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Fichas de Processo (PDF)"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caminho base das Fichas"}),n.jsx("input",{type:"text",className:"input-field",placeholder:"Ex.: C:\\\\Compartilhado\\\\FichasProcesso",value:Ce,onChange:b=>Ie(b.target.value)}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Padro: CAMINHO \\\\ CDIGO-DA-FERRAMENTA .pdf. Ex.: C:\\\\...\\\\TR-0018.pdf"})]})}),n.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:Tt,children:[n.jsx(nd,{className:"mr-1"})," Testar abertura (exemplo)"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:Le,children:[n.jsx(ba,{className:"mr-1"})," Salvar Caminho"]})]})]})]}),ee==="impressoras"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Configurao de Impressoras"}),n.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure os caminhos e endereos das impressoras para etiquetas trmicas e documentos comuns."}),n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-md font-medium text-gray-800 flex items-center",children:" Impressora Trmica (Etiquetas)"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:Ae.termica.ativa,onChange:b=>Dr("termica","ativa",b.target.checked),className:"mr-2"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Ativa"})]}),n.jsx("button",{type:"button",onClick:()=>ys("termica"),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600",children:"Testar"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Impressora"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.termica.nome,onChange:b=>Dr("termica","nome",b.target.value),placeholder:"Ex: Zebra ZT230"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caminho de Rede"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.termica.caminho,onChange:b=>Dr("termica","caminho",b.target.value),placeholder:"Ex: \\\\192.168.1.100\\Zebra_ZT230"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endereo IP"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.termica.ip,onChange:b=>Dr("termica","ip",b.target.value),placeholder:"Ex: 192.168.1.100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porta"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.termica.porta,onChange:b=>Dr("termica","porta",b.target.value),placeholder:"Ex: 9100"})]})]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-md font-medium text-gray-800 flex items-center",children:" Impressora Comum (Documentos)"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:Ae.comum.ativa,onChange:b=>Dr("comum","ativa",b.target.checked),className:"mr-2"}),n.jsx("span",{className:"text-sm text-gray-600",children:"Ativa"})]}),n.jsx("button",{type:"button",onClick:()=>ys("comum"),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600",children:"Testar"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Impressora"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.comum.nome,onChange:b=>Dr("comum","nome",b.target.value),placeholder:"Ex: HP LaserJet Pro"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Caminho de Rede"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.comum.caminho,onChange:b=>Dr("comum","caminho",b.target.value),placeholder:"Ex: \\\\192.168.1.101\\HP_LaserJet"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Endereo IP"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.comum.ip,onChange:b=>Dr("comum","ip",b.target.value),placeholder:"Ex: 192.168.1.101"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Porta"}),n.jsx("input",{type:"text",className:"input-field",value:Ae.comum.porta,onChange:b=>Dr("comum","porta",b.target.value),placeholder:"Ex: 9100"})]})]})]}),n.jsx("div",{className:"flex justify-end space-x-3",children:n.jsxs("button",{type:"button",onClick:En,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:[n.jsx(ba,{className:"mr-2 inline"}),"Salvar Configuraes"]})}),n.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[n.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:" Dicas de Configurao"}),n.jsxs("ul",{className:"text-xs text-blue-700 space-y-1",children:[n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Caminho de Rede:"})," Use o formato \\\\IP\\NomeCompartilhamento para impressoras compartilhadas"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"IP Direto:"})," Para impressoras com IP fixo, use o endereo IP + porta"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Teste:"}),' Use o boto "Testar" para verificar se a impressora est acessvel']}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Etiqueta Trmica:"})," Usada para imprimir etiquetas pequenas (cdigo de barras, lote)"]}),n.jsxs("li",{children:[" ",n.jsx("strong",{children:"Impressora Comum:"})," Usada para documentos A4 (formulrio de identificao)"]})]})]})]})}),ee==="dados"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 form-compact",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Dados  Pedidos"}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:b=>d(b.target.files[0]),className:"block w-full text-xs text-gray-500 file:mr-3 file:py-2 file:px-3 file:rounded-md file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),n.jsxs("button",{type:"button",className:"btn-primary text-xs px-3 py-2 flex items-center",onClick:te,disabled:m||!l,children:[n.jsx(id,{className:"mr-2"})," ",m?"Importando...":"Importar Planilha"]})]}),n.jsxs("div",{className:"flex justify-end gap-2 mb-2",children:[n.jsxs("button",{type:"button",className:"text-xs px-3 py-1.5 border rounded bg-white hover:bg-gray-50 text-gray-700 flex items-center",onClick:s,disabled:m||x,children:[n.jsx(Oc,{className:"mr-1"})," Recarregar"]}),n.jsxs("button",{type:"button",className:"text-xs px-3 py-1.5 border rounded bg-white hover:bg-gray-50 text-gray-700 flex items-center",onClick:O,disabled:m||x,children:[n.jsx(s1,{className:"mr-1"})," ",x?"Sincronizando...":"Sincronizar"]}),n.jsxs("button",{type:"button",className:"text-xs px-3 py-1.5 border rounded bg-white hover:bg-gray-50 text-gray-700 flex items-center",onClick:a,disabled:m||x,children:[n.jsx(os,{className:"mr-1"})," Limpar Dados"]})]}),_&&n.jsx("div",{className:"text-xs text-red-600 mb-1",children:_}),R&&n.jsx("div",{className:"text-xs text-green-600 mb-1",children:R}),n.jsxs("div",{className:"text-xs text-gray-500",children:[n.jsxs("p",{children:["Total no banco: ",t.length]}),n.jsx("p",{children:"Suporta Excel (.xlsx, .xls)"})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-4 form-compact",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Dados  Lotes"}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("input",{id:"input-lotes-file",type:"file",accept:".xlsx,.xls",onChange:b=>f(b.target.files[0]),className:"block w-full text-xs text-gray-500 file:mr-3 file:py-2 file:px-3 file:rounded-md file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),n.jsxs("button",{type:"button",className:"btn-primary text-xs px-3 py-2 flex items-center",onClick:de,disabled:g||!u,children:[n.jsx(id,{className:"mr-2"})," ",g?"Importando...":"Importar Lotes"]})]}),(U||X)&&n.jsxs("div",{className:"text-xs mb-1",children:[U&&n.jsx("div",{className:"text-red-600",children:U}),X&&n.jsx("div",{className:"text-green-600",children:X})]}),n.jsxs("div",{className:"text-xs text-gray-500",children:[n.jsxs("p",{children:["Total de lotes (local): ",i.length]}),le>0&&n.jsx("p",{children:n.jsxs("span",{className:"font-semibold text-primary-700",children:["Lotes importados: ",le]})})]})]})]}),ee==="maquinas"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Gerenciamento de Mquinas"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[n.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:St?"Editar Mquina":"Adicionar Nova Mquina"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cdigo *"}),n.jsx("input",{type:"text",className:"input-field",value:St?pt.codigo:Wt.codigo,onChange:b=>St?_t({...pt,codigo:b.target.value}):Ut({...Wt,codigo:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),n.jsx("input",{type:"text",className:"input-field",value:St?pt.nome:Wt.nome,onChange:b=>St?_t({...pt,nome:b.target.value}):Ut({...Wt,nome:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Modelo"}),n.jsx("input",{type:"text",className:"input-field",value:St?pt.modelo:Wt.modelo,onChange:b=>St?_t({...pt,modelo:b.target.value}):Ut({...Wt,modelo:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fabricante"}),n.jsx("input",{type:"text",className:"input-field",value:St?pt.fabricante:Wt.fabricante,onChange:b=>St?_t({...pt,fabricante:b.target.value}):Ut({...Wt,fabricante:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ano"}),n.jsx("input",{type:"number",className:"input-field",value:St?pt.ano:Wt.ano,onChange:b=>St?_t({...pt,ano:parseInt(b.target.value)||new Date().getFullYear()}):Ut({...Wt,ano:parseInt(b.target.value)||new Date().getFullYear()})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{className:"input-field",value:St?pt.status:Wt.status,onChange:b=>St?_t({...pt,status:b.target.value}):Ut({...Wt,status:b.target.value}),children:[n.jsx("option",{value:"ativo",children:"Ativo"}),n.jsx("option",{value:"manutencao",children:"Em Manuteno"}),n.jsx("option",{value:"inativo",children:"Inativo"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:St?n.jsxs(n.Fragment,{children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:as,children:[n.jsx(Ys,{className:"mr-1"})," Cancelar"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:rs,children:[n.jsx(ba,{className:"mr-1"})," Salvar Alteraes"]})]}):n.jsxs("button",{type:"button",className:"btn-primary",onClick:Pa,children:[n.jsx(ff,{className:"mr-1"})," Adicionar Mquina"]})})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cdigo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modelo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fabricante"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ano"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ia.map(b=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.codigo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.nome}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.modelo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.fabricante}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.ano}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                          ${b.status==="ativo"?"bg-green-100 text-green-800":b.status==="manutencao"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:b.status==="ativo"?"Ativo":b.status==="manutencao"?"Em Manuteno":"Inativo"})}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:()=>Nn(b),children:n.jsx(ui,{})}),n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>ci(b.id),children:n.jsx(os,{})})]})]},b.id))})]})})]})}),ee==="insumos"&&n.jsx("div",{className:"space-y-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Gerenciamento de Insumos"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[n.jsx("h3",{className:"text-md font-medium text-gray-700 mb-3",children:F?"Editar Insumo":"Adicionar Novo Insumo"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cdigo *"}),n.jsx("input",{type:"text",className:"input-field",value:F?N.codigo:T.codigo,onChange:b=>F?C({...N,codigo:b.target.value}):A({...T,codigo:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),n.jsx("input",{type:"text",className:"input-field",value:F?N.nome:T.nome,onChange:b=>F?C({...N,nome:b.target.value}):A({...T,nome:b.target.value})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),n.jsxs("select",{className:"input-field",value:F?N.tipo:T.tipo,onChange:b=>F?C({...N,tipo:b.target.value}):A({...T,tipo:b.target.value}),children:[n.jsx("option",{value:"ferramenta",children:"Ferramenta"}),n.jsx("option",{value:"ferramenta_cnc",children:"Ferramenta CNC"}),n.jsx("option",{value:"oleo",children:"Lubrificante/leo"}),n.jsx("option",{value:"consumivel",children:"Consumvel"}),n.jsx("option",{value:"outro",children:"Outro"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantidade"}),n.jsx("input",{type:"number",className:"input-field",value:F?N.quantidade:T.quantidade,onChange:b=>F?C({...N,quantidade:parseInt(b.target.value)||0}):A({...T,quantidade:parseInt(b.target.value)||0})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unidade"}),n.jsxs("select",{className:"input-field",value:F?N.unidade:T.unidade,onChange:b=>F?C({...N,unidade:b.target.value}):A({...T,unidade:b.target.value}),children:[n.jsx("option",{value:"peas",children:"Peas"}),n.jsx("option",{value:"litros",children:"Litros"}),n.jsx("option",{value:"kg",children:"Quilogramas"}),n.jsx("option",{value:"metros",children:"Metros"}),n.jsx("option",{value:"unidades",children:"Unidades"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end space-x-3",children:F?n.jsxs(n.Fragment,{children:[n.jsxs("button",{type:"button",className:"btn-outline",onClick:kn,children:[n.jsx(Ys,{className:"mr-1"})," Cancelar"]}),n.jsxs("button",{type:"button",className:"btn-primary",onClick:zs,children:[n.jsx(ba,{className:"mr-1"})," Salvar Alteraes"]})]}):n.jsxs("button",{type:"button",className:"btn-primary",onClick:Hs,children:[n.jsx(Dl,{className:"mr-1"})," Adicionar Insumo"]})})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cdigo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unidade"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:me.map(b=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.codigo}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.nome}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.tipo==="ferramenta"?"Ferramenta":b.tipo==="ferramenta_cnc"?"Ferramenta CNC":b.tipo==="oleo"?"Lubrificante/leo":b.tipo==="consumivel"?"Consumvel":"Outro"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.quantidade}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:b.unidade}),n.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:()=>vs(b),children:n.jsx(ui,{})}),n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>jn(b.id),children:n.jsx(os,{})})]})]},b.id))})]})})]})}),ee==="processo"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Configuraes do Processo"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Setup (min)"}),n.jsx("input",{type:"number",name:"tempo_padrao_setup",className:"input-field",value:et.tempo_padrao_setup,onChange:kr})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Manut. (min)"}),n.jsx("input",{type:"number",name:"tempo_padrao_manutencao",className:"input-field",value:et.tempo_padrao_manutencao,onChange:kr})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Meta OEE (%)"}),n.jsx("input",{type:"number",name:"meta_oee",className:"input-field",value:et.meta_oee,onChange:kr,min:"0",max:"100"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Horas/Turno"}),n.jsx("input",{type:"number",name:"horas_turno",className:"input-field",value:et.horas_turno,onChange:kr})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Dias teis/Ms"}),n.jsx("input",{type:"number",name:"dias_uteis_mes",className:"input-field",value:et.dias_uteis_mes,onChange:kr})]})]}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsxs("button",{type:"button",className:"btn-primary",onClick:Ws,children:[n.jsx(ba,{className:"mr-1"})," Salvar Configuraes"]})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Motivos de Parada"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2 mb-4",children:[n.jsx("input",{type:"text",className:"input-field md:col-span-3",placeholder:"Digite um novo motivo de parada",value:jt,onChange:b=>Ft(b.target.value),onKeyPress:b=>b.key==="Enter"&&Aa()}),n.jsx("select",{className:"input-field md:col-span-2",value:Ke,onChange:b=>vt(b.target.value),children:(Bt||[]).map(b=>{const K=(b==null?void 0:b.descricao)||(b==null?void 0:b.nome)||"-",ue=pr(K);return n.jsx("option",{value:ue,children:K},b.id||ue)})}),n.jsx("button",{type:"button",className:"btn-primary whitespace-nowrap",onClick:Aa,children:"Adicionar"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrio"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:qe.map(b=>{const K=(()=>{const y=(Bt||[]).find(H=>pr((H==null?void 0:H.descricao)||(H==null?void 0:H.nome))===String(b.tipo_parada||""));if(y)return y.descricao;const M=String(b.tipo_parada||"").replace(/_/g," ");return M?M.charAt(0).toUpperCase()+M.slice(1):"-"})(),ue=lr&&(yt==null?void 0:yt.id)===b.id;return n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ue?n.jsx("input",{type:"text",className:"input-field",value:yt.descricao,onChange:y=>mt(M=>({...M,descricao:y.target.value}))}):b.descricao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ue?n.jsx("select",{className:"input-field",value:yt.tipo_parada||"",onChange:y=>mt(M=>({...M,tipo_parada:y.target.value})),children:(Bt||[]).map(y=>{const M=(y==null?void 0:y.descricao)||(y==null?void 0:y.nome)||"-",H=pr(M);return n.jsx("option",{value:H,children:M},y.id||H)})}):K}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:ue?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:Ca,children:n.jsx(ba,{})}),n.jsx("button",{className:"text-gray-600 hover:text-gray-900",onClick:Sn,children:n.jsx(Ys,{})})]}):n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"text-primary-600 hover:text-primary-900 mr-3",onClick:()=>Or(b),children:n.jsx(ui,{})}),n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>Ha(b.id),children:n.jsx(os,{})})]})})]},b.id)})})]})})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[n.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Tipos de Parada"}),n.jsxs("div",{className:"flex space-x-2 mb-4",children:[n.jsx("input",{type:"text",className:"input-field flex-grow",placeholder:"Digite um novo tipo de parada",value:ar,onChange:b=>ha(b.target.value),onKeyPress:b=>b.key==="Enter"&&gs()}),n.jsx("button",{type:"button",className:"btn-primary whitespace-nowrap",onClick:gs,children:"Adicionar"})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrio"}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Bt.map(b=>n.jsxs("tr",{children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:b.descricao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx("button",{className:"text-red-600 hover:text-red-900",onClick:()=>Fa(b.id),children:n.jsx(os,{})})})]},b.id))})]})})]})]})]})},dE=()=>{const{items:e,loading:t,error:r,addItems:a,clearItems:s,loadItems:i}=ft("pedidos"),{items:o}=ft("apontamentos"),{items:c}=ft("maquinas"),l=I.useMemo(()=>{const j={};for(const de of c||[])de&&(j[String(de.id)]=de.nome||de.codigo||`Mquina ${de.id}`);return j},[c]),[d,u]=I.useState([]),[f,m]=I.useState(new Set),{user:h}=Ms(),[g,p]=I.useState([]),[x,w]=I.useState(!1);I.useState(""),I.useState(""),I.useState(!1);const[_,v]=I.useState(!1),[R,q]=I.useState(null),[U,P]=I.useState(!1),[X,G]=I.useState({cliente:"",pedidoCliente:"",produto:"",status:"",ferramenta:"",comprimento:"",prioridade:"todos"}),[le,se]=I.useState({campo:"pedido_seq",direcao:"asc"}),[V,ye]=I.useState({pagina:1,itensPorPagina:10,total:0});I.useState(null),I.useEffect(()=>{Ee()},[]);const Ee=async()=>{try{const j=await Qe.getAll("pcp_prioridades");u(j||[]);const de=new Set((j||[]).map(fe=>fe.pedido_numero).filter(Boolean));m(de)}catch(j){console.warn("No foi possvel carregar prioridades do PCP:",j),u([]),m(new Set)}},ve=j=>f.has(j),Fe=j=>d.find(de=>de.pedido_numero===j);I.useEffect(()=>{B()},[X,e,f]);const Te=j=>{if(!j)return"";const de=String(j).toUpperCase(),fe=/^([A-Z]{3})([A-Z0-9]+)/,re=/^([A-Z]{2})([A-Z0-9]+)/;let xe="",L="",Y=0,ke=de.match(fe);if(ke)xe=ke[1],L=ke[2],Y=3;else{if(ke=de.match(re),!ke)return"";xe=ke[1],L=ke[2],Y=4}let Pe="";for(const Ge of L)if(/[0-9]/.test(Ge)?Pe+=Ge:Ge==="O"&&(Pe+="0"),Pe.length===Y)break;return Pe.length<Y&&(Pe=Pe.padEnd(Y,"0")),`${xe}-${Pe}`},$e=j=>{if(!j)return"";const fe=String(j).slice(8).match(/^\d+/);return fe?String(parseInt(fe[0],10)):""};I.useMemo(()=>{const j={},de={};try{if(!(h!=null&&h.nome))return{porSeqOp:j,porSeq:de};for(const fe of o||[]){if(String(fe.operador||"")!==String(h.nome))continue;const re=String(fe.ordem_trabalho||fe.ordemTrabalho||fe.pedido_seq||"");if(!re)continue;const xe=Number(fe.quantidade||fe.quantidadeProduzida||0),L=isNaN(xe)?0:xe,Y=String(fe.nro_op||fe.nroOp||"");if(Y){const ke=`${re}__${Y}`;j[ke]=(j[ke]||0)+L}else de[re]=(de[re]||0)+L}}catch{}return{porSeqOp:j,porSeq:de}},[o,h]);const ae=j=>{if(!j)return{lista:[],total:0};const de=String(j.pedido_seq||""),fe=(o||[]).filter(xe=>String(xe.ordem_trabalho||xe.ordemTrabalho||xe.pedido_seq||"")===de),re=fe.reduce((xe,L)=>{const Y=Number(L.quantidade||L.quantidadeProduzida||0);return xe+(isNaN(Y)?0:Y)},0);return{lista:fe,total:re}},He=j=>{if(j!=null&&j.finalizado_manual)return"Finalizado";const de=Number((j==null?void 0:j.separado)||0),fe=Number((j==null?void 0:j.qtd_pedido)||0);return de===0?"Pendente":fe>0&&de>=fe?"Finalizado":"Em Produo"},Ue=j=>j==="Pendente"?"bg-yellow-100 text-yellow-800":j==="Finalizado"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",k=j=>{const de=(j||"").toLowerCase();return de.includes("pendente")?"pendente":de.includes("finalizado")?"finalizado":"em_producao"},B=()=>{let j=[...e];if(X.cliente&&(j=j.filter(de=>de.cliente&&de.cliente.toLowerCase().includes(X.cliente.toLowerCase()))),X.pedidoCliente){const de=X.pedidoCliente.toLowerCase();j=j.filter(fe=>(fe.pedido_cliente||"")&&String(fe.pedido_cliente).toLowerCase().includes(de))}if(X.produto&&(j=j.filter(de=>de.produto&&de.produto.toLowerCase().includes(X.produto.toLowerCase())||de.descricao&&de.descricao.toLowerCase().includes(X.produto.toLowerCase()))),X.ferramenta){const de=X.ferramenta.toLowerCase();j=j.filter(fe=>Te(fe.produto).toLowerCase().includes(de))}if(X.comprimento){const de=String(X.comprimento).replace(/\D/g,"");j=j.filter(fe=>$e(fe.produto).includes(de))}X.status&&(j=j.filter(de=>k(He(de))===X.status)),X.prioridade==="prioritarios"&&(j=j.filter(de=>ve(de.pedido_seq))),j.sort((de,fe)=>{const re=de[le.campo]!==void 0?de[le.campo]:"",xe=fe[le.campo]!==void 0?fe[le.campo]:"";if(le.campo==="dt_fatura"){const ke=re?new Date(re):new Date(0),Pe=xe?new Date(xe):new Date(0);return le.direcao==="asc"?ke-Pe:Pe-ke}if(typeof re=="number"&&typeof xe=="number")return le.direcao==="asc"?re-xe:xe-re;const L=String(re).toLowerCase(),Y=String(xe).toLowerCase();return L<Y?le.direcao==="asc"?-1:1:L>Y?le.direcao==="asc"?1:-1:0}),p(j),ye({...V,total:j.length})},E=j=>{le.campo===j?se({...le,direcao:le.direcao==="asc"?"desc":"asc"}):se({campo:j,direcao:"asc"})},D=j=>{const{name:de,value:fe}=j.target;G({...X,[de]:fe}),ye(re=>({...re,pagina:1}))},z=()=>{G({cliente:"",pedidoCliente:"",produto:"",status:"",ferramenta:"",comprimento:"",prioridade:"todos"})},oe=j=>{if(!j)return"";try{return new Date(j).toLocaleDateString("pt-BR")}catch{return j}},J=j=>le.campo!==j?n.jsx(p1,{className:"ml-1 text-gray-400"}):le.direcao==="asc"?n.jsx(x1,{className:"ml-1 text-primary-600"}):n.jsx(m1,{className:"ml-1 text-primary-600"}),ce=g.slice((V.pagina-1)*V.itensPorPagina,V.pagina*V.itensPorPagina),he=Math.ceil(g.length/V.itensPorPagina),De=I.useMemo(()=>{try{return g.reduce((j,de)=>{const fe=Number(de.qtd_pedido??0);return j+(Number.isFinite(fe)?fe:0)},0)}catch{return 0}},[g]);return t?n.jsx("div",{className:"flex items-center justify-center h-64",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600 mb-2"}),n.jsx("p",{className:"text-gray-600",children:"Carregando dados do banco local..."})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Pedidos e Produtos"}),n.jsxs("div",{className:"bg-white rounded-lg shadow p-3 mb-4",children:[n.jsx("h2",{className:"text-base font-semibold text-gray-700 mb-2",children:"Filtros"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-end",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Cliente"}),n.jsx("input",{type:"text",name:"cliente",value:X.cliente,onChange:D,placeholder:"Filtrar por cliente",className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pedido Cliente"}),n.jsx("input",{type:"text",name:"pedidoCliente",value:X.pedidoCliente,onChange:D,placeholder:"Filtrar por pedido do cliente",className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Produto/Descrio"}),n.jsx("input",{type:"text",name:"produto",value:X.produto,onChange:D,placeholder:"Filtrar por produto",className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),n.jsxs("select",{name:"status",value:X.status,onChange:D,className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"",children:"Todos"}),n.jsx("option",{value:"pendente",children:"Pendente"}),n.jsx("option",{value:"em_producao",children:"Em Produo"}),n.jsx("option",{value:"concluido",children:"Concludo"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Prioridade"}),n.jsxs("select",{name:"prioridade",value:X.prioridade,onChange:D,className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[n.jsx("option",{value:"todos",children:"Todos"}),n.jsx("option",{value:"prioritarios",children:"Apenas Prioritrios"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Ferramenta"}),n.jsx("input",{type:"text",name:"ferramenta",value:X.ferramenta,onChange:D,placeholder:"Ex.: TP-0192",className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Comprimento (mm)"}),n.jsx("input",{type:"text",name:"comprimento",value:X.comprimento,onChange:D,placeholder:"Ex.: 1100",className:"w-full h-8 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),n.jsx("div",{className:"md:col-auto justify-self-end",children:n.jsx("button",{type:"button",className:"px-3 h-8 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",onClick:z,children:"Limpar Filtros"})})]})]}),n.jsx("div",{className:"flex justify-end text-sm text-gray-600",children:n.jsxs("span",{className:"px-2 py-1 bg-white rounded border border-gray-200 shadow-sm",children:["Total Qtd. Pedido (itens filtrados):"," ",n.jsx("span",{className:"font-semibold",children:De.toLocaleString("pt-BR")})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden mt-2",children:[n.jsx("div",{className:"overflow-x-auto pb-6",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200 table-compact",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("nro_op"),children:n.jsxs("div",{className:"flex items-center",children:["N OP",J("nro_op")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("pedido_seq"),children:n.jsxs("div",{className:"flex items-center",children:["Pedido/Seq",J("pedido_seq")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("pedido_cliente"),children:n.jsxs("div",{className:"flex items-center",children:["Pedido Cliente",J("pedido_cliente")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("cliente"),children:n.jsxs("div",{className:"flex items-center",children:["Cliente",J("cliente")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("dt_fatura"),children:n.jsxs("div",{className:"flex items-center",children:["Data Entrega",J("dt_fatura")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ferramenta"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("produto"),children:n.jsxs("div",{className:"flex items-center",children:["Produto",J("produto")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descrio"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unidade"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("qtd_pedido"),children:n.jsxs("div",{className:"flex items-center",children:["Qtd. Pedido",J("qtd_pedido")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-primary-700 uppercase tracking-wider",title:"Soma de apontamentos registrados para este pedido (total de todos operadores)",children:"Apontado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("saldo_a_prod"),children:n.jsxs("div",{className:"flex items-center",children:["Saldo a Prod.",J("saldo_a_prod")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("estoque_aca"),children:n.jsxs("div",{className:"flex items-center",children:["Estoque",J("estoque_aca")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("separado"),children:n.jsxs("div",{className:"flex items-center",children:["Separado",J("separado")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("faturado"),children:n.jsxs("div",{className:"flex items-center",children:["Faturado",J("faturado")]})}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item Perfil"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>E("status"),children:n.jsxs("div",{className:"flex items-center",children:["Status",J("status")]})}),n.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ce.length>0?ce.map(j=>{const de=ve(j.pedido_seq),fe=de?Fe(j.pedido_seq):null;return n.jsxs("tr",{className:`hover:bg-gray-50 ${de?"bg-yellow-50 border-l-4 border-l-yellow-500":""}`,children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.nro_op}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:n.jsxs("div",{className:"flex items-center gap-2",children:[de&&n.jsx(mf,{className:"text-yellow-500",title:`Prioridade #${(fe==null?void 0:fe.prioridade)||"-"}`}),n.jsx("span",{children:j.pedido_seq})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.pedido_cliente}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.cliente}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:oe(j.dt_fatura)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Te(j.produto)}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 col-truncate",children:j.produto}),n.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 col-truncate",children:j.descricao}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.unidade}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.qtd_pedido}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(()=>{const{total:re}=ae(j);return n.jsx("span",{className:"px-2 py-1 rounded bg-primary-50 text-primary-800 font-bold",title:"Total apontado (todos)",children:re})})()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.saldo_a_prod}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.estoque_aca}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.separado}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.faturado}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.item_perfil}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(()=>{const re=He(j);return n.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Ue(re)}`,children:re})})()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:n.jsx("button",{className:"text-primary-600 hover:text-primary-900",title:"Visualizar detalhes",onClick:()=>{q(j),v(!0)},children:n.jsx(n1,{})})})]},j.id)}):n.jsx("tr",{children:n.jsx("td",{colSpan:"17",className:"px-6 py-4 text-center text-sm text-gray-500",children:x?"Carregando pedidos...":"Nenhum pedido encontrado"})})})]})}),g.length>0&&n.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[n.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[n.jsx("button",{onClick:()=>ye({...V,pagina:Math.max(1,V.pagina-1)}),disabled:V.pagina===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Anterior"}),n.jsx("button",{onClick:()=>ye({...V,pagina:Math.min(he,V.pagina+1)}),disabled:V.pagina===he,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Prximo"})]}),n.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[n.jsx("div",{children:n.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",n.jsx("span",{className:"font-medium",children:(V.pagina-1)*V.itensPorPagina+1})," a ",n.jsx("span",{className:"font-medium",children:Math.min(V.pagina*V.itensPorPagina,g.length)})," de ",n.jsx("span",{className:"font-medium",children:g.length})," resultados"]})}),n.jsx("div",{children:n.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[n.jsxs("button",{onClick:()=>ye({...V,pagina:Math.max(1,V.pagina-1)}),disabled:V.pagina===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[n.jsx("span",{className:"sr-only",children:"Anterior"}),"<"]}),[...Array(he).keys()].map(j=>n.jsx("button",{onClick:()=>ye({...V,pagina:j+1}),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium
                        ${V.pagina===j+1?"z-10 bg-primary-50 border-primary-500 text-primary-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:j+1},j)),n.jsxs("button",{onClick:()=>ye({...V,pagina:Math.min(he,V.pagina+1)}),disabled:V.pagina===he,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:[n.jsx("span",{className:"sr-only",children:"Prximo"}),">"]})]})})]})]})]}),_&&R&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>{v(!1),q(null)}}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-4xl p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Detalhes do Pedido"}),n.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{const{total:j}=ae(R);return n.jsxs("div",{className:"px-3 py-1 rounded-md bg-primary-50 text-primary-700 text-sm font-semibold border border-primary-200",title:"Total apontado (todos)",children:["Qtd. Apontada: ",j]})})(),n.jsxs("button",{className:"btn-secondary py-1 px-2 flex items-center gap-2",title:"Ver apontamentos",onClick:()=>P(!0),children:[n.jsx(d1,{}),"Ver apontamentos"]}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>{v(!1),q(null)},children:"Fechar"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Pedido/Seq"}),n.jsx("div",{className:"font-medium",children:R.pedido_seq})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Pedido Cliente"}),n.jsx("div",{className:"font-medium",children:R.pedido_cliente})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Cliente"}),n.jsx("div",{className:"font-medium",children:R.cliente})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Data Entrega"}),n.jsx("div",{className:"font-medium",children:oe(R.dt_fatura)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Produto"}),n.jsx("div",{className:"font-medium break-all",children:R.produto})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Descrio"}),n.jsx("div",{className:"font-medium",children:R.descricao})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Unidade"}),n.jsx("div",{className:"font-medium",children:R.unidade})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Qtd. Pedido"}),n.jsx("div",{className:"font-medium",children:R.qtd_pedido})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Saldo a Prod."}),n.jsx("div",{className:"font-medium",children:R.saldo_a_prod})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Estoque"}),n.jsx("div",{className:"font-medium",children:R.estoque_aca})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Separado"}),n.jsx("div",{className:"font-medium",children:R.separado})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Faturado"}),n.jsx("div",{className:"font-medium",children:R.faturado})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Item Perfil"}),n.jsx("div",{className:"font-medium",children:R.item_perfil})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"N OP"}),n.jsx("div",{className:"font-medium",children:R.nro_op})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Status"}),n.jsx("div",{className:"font-medium",children:He(R)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Ferramenta"}),n.jsx("div",{className:"font-medium",children:Te(R.produto)})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-gray-500",children:"Comprimento do Acabado"}),n.jsx("div",{className:"font-medium",children:(()=>{const j=$e(R.produto);return j?`${j} mm`:""})()})]})]})]})]}),U&&R&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30",onClick:()=>P(!1)}),n.jsxs("div",{className:"relative bg-white rounded-lg shadow-lg w-full max-w-5xl p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Apontamentos do Pedido ",R.pedido_seq]}),n.jsx("button",{className:"text-sm text-gray-600 hover:text-gray-900",onClick:()=>P(!1),children:"Fechar"})]}),(()=>{const{lista:j,total:de}=ae(R);return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"mb-3 text-sm text-gray-600",children:["Total apontado: ",n.jsx("span",{className:"font-semibold text-primary-700",children:de})]}),n.jsx("div",{className:"max-h-96 overflow-auto border rounded",children:n.jsxs("table",{className:"min-w-full text-sm",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-3 py-2",children:"Incio"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Fim"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Mquina"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Operador"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Cdigo"}),n.jsx("th",{className:"text-right px-3 py-2",children:"Quantidade"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Rack/Pallet"}),n.jsx("th",{className:"text-left px-3 py-2",children:"Obs."})]})}),n.jsxs("tbody",{children:[j.map((fe,re)=>n.jsxs("tr",{className:"border-t",children:[n.jsx("td",{className:"px-3 py-2",children:fe.inicio?new Date(fe.inicio).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-3 py-2",children:fe.fim?new Date(fe.fim).toLocaleString("pt-BR"):"-"}),n.jsx("td",{className:"px-3 py-2",children:(()=>{const xe=fe.maquina??fe.maquina_id??fe.maquinaId,L=fe.maquina_nome??fe.maquinaNome;return l[String(xe)]||L||xe||"-"})()}),n.jsx("td",{className:"px-3 py-2",children:fe.operador||"-"}),n.jsx("td",{className:"px-3 py-2",children:fe.produto||fe.codigoPerfil||"-"}),n.jsx("td",{className:"px-3 py-2 text-right",children:fe.quantidade||fe.quantidadeProduzida||0}),n.jsx("td",{className:"px-3 py-2",children:fe.rack_ou_pallet||fe.rackOuPallet||"-"}),n.jsx("td",{className:"px-3 py-2",children:fe.observacoes||"-"})]},re)),j.length===0&&n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"px-3 py-6 text-center text-gray-500",children:"Nenhum apontamento para este pedido"})})]})]})})]})})()]})]})]})},uE=()=>{const{user:e}=Ms(),[t,r]=I.useState([]),[a,s]=I.useState([]),[i,o]=I.useState([]),[c,l]=I.useState([]),[d,u]=I.useState(!0),[f,m]=I.useState({});I.useState(null);const[h,g]=I.useState({pedido_id:"",prioridade:1,data_entrega:"",observacoes:"",status:"pendente"}),[p,x]=I.useState(!1),[w,_]=I.useState("individual"),[v,R]=I.useState(""),[q,U]=I.useState([]),[P,X]=I.useState(new Set),[G,le]=I.useState(!1),[se,V]=I.useState([]),[ye,Ee]=I.useState(!1),[ve,Fe]=I.useState(new Set),[Te,$e]=I.useState("prioridades"),[ae,He]=I.useState(!1),Ue=I.useMemo(()=>[...t].sort((Y,ke)=>{const Pe=Y!=null&&Y.finalizado_manual?1:0,Ge=ke!=null&&ke.finalizado_manual?1:0;return Pe!==Ge?Pe-Ge:((Y==null?void 0:Y.prioridade)||0)-((ke==null?void 0:ke.prioridade)||0)}),[t]),k=I.useMemo(()=>Ue.filter(L=>!(L!=null&&L.finalizado_manual)),[Ue]);k.length>0&&(ve.size,k.length);const B=I.useMemo(()=>{const L=ae?[...i,...c]:i,Y=new Map;for(const ke of L)ke&&(Y.has(ke.id)||Y.set(ke.id,ke));return Array.from(Y.values())},[ae,i,c]);I.useEffect(()=>{D()},[]);const E=async L=>{const Y=Array.from(new Set((L||[]).filter(Boolean)));if(Y.length===0)return m({}),{};const ke={},Pe=(qe,ht)=>{for(const ot of qe||[]){const wt=Number((ot==null?void 0:ot.quantidade)??(ot==null?void 0:ot.quantidade_produzida)??0);if(!(!Number.isFinite(wt)||wt===0))for(const jt of ht){if(!(jt in(ot||{})))continue;const Ft=String(ot[jt]||"").trim();Ft&&(ke[Ft]=(ke[Ft]||0)+wt)}}},Ge=async(qe,ht)=>{try{const ot=await Qe.getByIn("apontamentos",qe,Y);return Pe(ot,ht),!0}catch(ot){return(ot==null?void 0:ot.code)==="42703"?!1:(console.warn(`No foi possvel carregar apontamentos por ${qe}:`,(ot==null?void 0:ot.message)||ot),!0)}},et=await Ge("pedido_seq",["pedido_seq","pedidoSeq"]),Pt=await Ge("ordem_trabalho",["ordem_trabalho","ordemTrabalho"]);if((!et||!Pt)&&Object.keys(ke).length===0)try{const qe=await Qe.getAll("apontamentos");Pe(qe,["pedido_seq","pedidoSeq","ordem_trabalho","ordemTrabalho"])}catch(qe){console.warn("No foi possvel carregar apontamentos (fallback):",(qe==null?void 0:qe.message)||qe)}return m(ke),ke},D=async()=>{try{u(!0);const[L,Y]=await Promise.all([Qe.getAll("pcp_prioridades"),Qe.getAll("pedidos")]),ke=await E(Y.map(qe=>qe.pedido_seq).filter(Boolean)),Pe=Y.map(qe=>{const ht=Number(ke[qe.pedido_seq]||0);return{...qe,apontadoManual:ht}});r(L.sort((qe,ht)=>((qe==null?void 0:qe.prioridade)||0)-((ht==null?void 0:ht.prioridade)||0)));const Ge=Pe.filter(qe=>!qe.finalizado_manual),et=Pe.filter(qe=>qe.finalizado_manual),Pt=Ge.filter(qe=>{const ht=Number(qe.qtd_pedido||0),ot=Number(qe.apontadoManual||0),wt=Number(qe.saldo_a_prod||0);return Number.isNaN(ht)||!ht?!1:ot>=ht||wt<=0});s(Ge),o(Pt),l(et)}catch(L){console.error(" Erro ao carregar dados:",L),alert("Erro ao carregar dados do PCP: "+(L.message||"Erro desconhecido"))}finally{u(!1)}},z=async()=>{if(w==="pedido_cliente"){await j();return}if(!h.pedido_id){alert("Selecione um pedido");return}try{const L=a.find(ke=>ke.id===h.pedido_id),Y={...h,pedido_numero:(L==null?void 0:L.pedido_seq)||"",produto:(L==null?void 0:L.produto)||"",quantidade:(L==null?void 0:L.qtd_pedido)||0,criado_por:(e==null?void 0:e.nome)||(e==null?void 0:e.email)||"Sistema",criado_em:new Date().toISOString()};await Qe.add("pcp_prioridades",Y),await ls.registrarCriacao(e,"pcp",`Adicionou prioridade: ${Y.pedido_numero} - ${Y.produto}`,Y),g({pedido_id:"",prioridade:t.length+1,data_entrega:"",observacoes:"",status:"pendente"}),x(!1),await D(),alert("Prioridade adicionada com sucesso!")}catch(L){console.error("Erro ao adicionar prioridade:",L),alert("Erro ao adicionar prioridade")}},oe=L=>{if(R(L),!L||L.trim().length<2){V([]),Ee(!1);return}const Y=L.trim().toLowerCase(),ke=new Map;a.forEach(Ge=>{const et=String(Ge.pedido_cliente||"").trim();et&&et.toLowerCase().includes(Y)&&(ke.has(et)||ke.set(et,Ge))});const Pe=Array.from(ke.values()).slice(0,10).map(Ge=>({pedido_cliente:Ge.pedido_cliente,cliente:Ge.cliente}));V(Pe),Ee(Pe.length>0)},J=L=>{R(L),Ee(!1),setTimeout(()=>ce(L),100)},ce=async(L=null)=>{try{le(!0);const Y=(L||v||"").trim().toLowerCase();if(!Y){U([]),X(new Set);return}const ke=(a||[]).filter(Pe=>String(Pe.pedido_cliente||"").toLowerCase().includes(Y));U(ke),X(new Set),Ee(!1)}finally{le(!1)}},he=L=>{const Y=new Set(P);Y.has(L)?Y.delete(L):Y.add(L),X(Y)},De=()=>{P.size===q.length?X(new Set):X(new Set(q.map(L=>L.id)))},j=async()=>{if(!q.length||P.size===0){alert("Selecione pelo menos um item do Pedido Cliente");return}try{let L=(t==null?void 0:t.length)||0;for(const Y of q){if(!P.has(Y.id))continue;const ke={pedido_id:Y.id,prioridade:++L,data_entrega:h.data_entrega||null,observacoes:h.observacoes||"",status:h.status||"pendente",pedido_numero:Y.pedido_seq||"",produto:Y.produto||"",quantidade:Y.qtd_pedido||0,criado_por:(e==null?void 0:e.nome)||(e==null?void 0:e.email)||"Sistema",criado_em:new Date().toISOString()};await Qe.add("pcp_prioridades",ke),await ls.registrarCriacao(e,"pcp",`Adicionou prioridade (lote): ${ke.pedido_numero} - ${ke.produto}`,ke)}X(new Set),U([]),R(""),await D(),alert("Prioridades em lote adicionadas com sucesso!")}catch(L){console.error("Erro ao adicionar prioridades em lote:",L),alert("Erro ao adicionar prioridades em lote")}},de=async()=>{if(ve.size!==0&&window.confirm(`Excluir ${ve.size} registro(s) selecionado(s)?`))try{await Qe.removeMany("pcp_prioridades",Array.from(ve)),Fe(new Set),await D(),alert("Registros selecionados excludos com sucesso!")}catch(L){console.error("Erro ao excluir selecionados:",L),alert("Erro ao excluir selecionados")}},fe=async()=>{if(t.length!==0&&window.confirm("Excluir TODOS os registros da lista?"))try{await Qe.removeMany("pcp_prioridades",k.map(L=>L.id)),Fe(new Set),await D(),alert("Todos os registros foram excludos!")}catch(L){console.error("Erro ao excluir todos:",L),alert("Erro ao excluir todos")}},re=async L=>{try{const Y={id:L.id,finalizado_manual:!0,finalizado_em:new Date().toISOString(),finalizado_por:(e==null?void 0:e.nome)||(e==null?void 0:e.email)||"Sistema",status:"concluido"};await Qe.update("pedidos",Y),await ls.registrarEdicao(e,"pcp",`Finalizou manualmente o pedido ${L.pedido_seq}`,L,Y),await D(),alert(`Pedido ${L.pedido_seq} finalizado com sucesso!`)}catch(Y){console.error("Erro ao finalizar prioridade:",Y),alert("Erro ao finalizar prioridade")}},xe=async L=>{try{const Y={id:L.id,finalizado_manual:!1,finalizado_em:null,finalizado_por:null,status:"em_producao"};await Qe.update("pedidos",Y),await ls.registrarEdicao(e,"pcp",`Reabriu manualmente o pedido ${L.pedido_seq}`,L,Y),await D(),alert(`Pedido ${L.pedido_seq} reaberto com sucesso!`)}catch(Y){console.error("Erro ao reabrir prioridade:",Y),alert("Erro ao reabrir prioridade")}};return d?n.jsx("div",{className:"flex items-center justify-center h-screen",children:n.jsx("div",{className:"text-xl",children:"Carregando..."})}):n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"PCP - Planejamento e Controle de Produo"}),n.jsx("p",{className:"text-gray-600",children:"Gerencie as prioridades de produo da usinagem"})]}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"inline-flex rounded-md shadow-sm border border-gray-200 overflow-hidden",children:[n.jsx("button",{type:"button",className:`px-4 py-2 text-sm font-medium transition-colors ${Te==="prioridades"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>$e("prioridades"),children:"Prioridades"}),n.jsx("button",{type:"button",className:`px-4 py-2 text-sm font-medium transition-colors border-l border-gray-200 ${Te==="finalizacao"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,onClick:()=>$e("finalizacao"),children:"Finalizao Manual"})]})}),Te==="prioridades"&&n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs("button",{onClick:()=>x(!p),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[n.jsx(Di,{}),p?"Cancelar":"Adicionar Prioridade"]}),n.jsxs("button",{onClick:de,disabled:ve.size===0,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-gray-400",children:["Excluir Selecionados (",ve.size,")"]}),n.jsx("button",{onClick:fe,disabled:t.length===0,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:bg-gray-400",children:"Excluir Todos"})]})}),p&&n.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4",children:"Nova Prioridade"}),n.jsxs("div",{className:"flex gap-2 mb-4",children:[n.jsx("button",{type:"button",onClick:()=>_("individual"),className:`px-3 py-1 rounded ${w==="individual"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Seleo Individual"}),n.jsx("button",{type:"button",onClick:()=>_("pedido_cliente"),className:`px-3 py-1 rounded ${w==="pedido_cliente"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Por Pedido Cliente (grupo)"})]}),w==="pedido_cliente"&&n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"md:col-span-2 relative",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pedido Cliente"}),n.jsx("input",{type:"text",value:v,onChange:L=>oe(L.target.value),onFocus:()=>v.length>=2&&V.length>0&&Ee(!0),onBlur:()=>setTimeout(()=>Ee(!1),200),placeholder:"Digite o nmero do Pedido do Cliente",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",autoComplete:"off"}),ye&&se.length>0&&n.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:se.map((L,Y)=>n.jsxs("button",{type:"button",onClick:()=>J(L.pedido_cliente),className:"w-full text-left px-4 py-2 hover:bg-blue-50 focus:bg-blue-50 focus:outline-none border-b last:border-b-0",children:[n.jsx("div",{className:"font-medium text-gray-900",children:L.pedido_cliente}),n.jsx("div",{className:"text-sm text-gray-500",children:L.cliente||"Cliente no informado"})]},Y))})]}),n.jsx("div",{className:"flex items-end",children:n.jsxs("button",{type:"button",onClick:()=>ce(),disabled:G,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",children:[n.jsx(hf,{})," ",G?"Buscando...":"Buscar"]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Entrega"}),n.jsx("input",{type:"date",value:h.data_entrega,onChange:L=>g({...h,data_entrega:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),n.jsxs("select",{value:h.status,onChange:L=>g({...h,status:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"pendente",children:"Pendente"}),n.jsx("option",{value:"em_producao",children:"Em Produo"}),n.jsx("option",{value:"concluido",children:"Concludo"}),n.jsx("option",{value:"atrasado",children:"Atrasado"})]})]}),n.jsxs("div",{className:"md:col-span-1",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes (opcional)"}),n.jsx("input",{type:"text",value:h.observacoes,onChange:L=>g({...h,observacoes:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Observaes para o grupo"})]})]}),n.jsxs("div",{className:"border rounded-md",children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-50 border-b",children:[n.jsx("span",{className:"font-medium text-gray-700",children:"Itens do Pedido Cliente"}),n.jsx("button",{type:"button",onClick:De,className:"text-blue-600 hover:underline text-sm",children:P.size===q.length?"Limpar seleo":"Selecionar todos"})]}),n.jsx("div",{className:"max-h-56 overflow-auto",children:q.length===0?n.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"Nenhum item encontrado"}):q.map(L=>n.jsxs("label",{className:"flex items-start gap-3 px-4 py-2 border-b last:border-b-0 cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"checkbox",checked:P.has(L.id),onChange:()=>he(L.id),className:"mt-1"}),n.jsxs("div",{className:"text-sm text-gray-700",children:[n.jsxs("div",{className:"font-medium",children:[L.pedido_seq," - ",L.produto]}),n.jsxs("div",{className:"text-gray-500",children:["Qtd: ",Number(L.qtd_pedido||0).toLocaleString("pt-BR"),"  Cliente: ",L.cliente||"-"]})]})]},L.id))})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{type:"button",onClick:j,disabled:P.size===0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-400",children:"Salvar Grupo"}),n.jsxs("span",{className:"text-sm text-gray-500 self-center",children:["Selecionados: ",P.size]})]})]}),n.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 ${w==="pedido_cliente"?"opacity-60 pointer-events-none":""}`,children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pedido"}),n.jsxs("select",{value:h.pedido_id,onChange:L=>g({...h,pedido_id:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:d,children:[n.jsx("option",{value:"",children:d?"Carregando pedidos...":"Selecione um pedido"}),d?n.jsx("option",{disabled:!0,children:"Carregando..."}):a.length===0?n.jsx("option",{disabled:!0,children:"Nenhum pedido disponvel"}):a.map(L=>n.jsxs("option",{value:L.id,children:[L.pedido_seq," - ",L.produto," - Qtd: ",Number(L.qtd_pedido||0).toLocaleString("pt-BR")," - ",L.cliente||"Cliente no informado"]},L.id))]}),!d&&a.length>0&&n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.length," pedido(s) disponvel(is)"]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data de Entrega"}),n.jsx("input",{type:"date",value:h.data_entrega,onChange:L=>g({...h,data_entrega:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),n.jsxs("select",{value:h.status,onChange:L=>g({...h,status:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[n.jsx("option",{value:"pendente",children:"Pendente"}),n.jsx("option",{value:"em_producao",children:"Em Produo"}),n.jsx("option",{value:"concluido",children:"Concludo"}),n.jsx("option",{value:"atrasado",children:"Atrasado"})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes"}),n.jsx("textarea",{value:h.observacoes,onChange:L=>g({...h,observacoes:L.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"Observaes sobre esta prioridade..."})]})]}),n.jsxs("div",{className:"mt-4 flex gap-2",children:[n.jsx("button",{onClick:z,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Salvar"}),n.jsx("button",{onClick:()=>x(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]}),Te==="finalizacao"&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Finalizao Manual de Pedidos"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"Utilize esta aba para finalizar ou reabrir pedidos manualmente. Consideramos elegvel quem j possui quantidade apontada maior ou igual ao pedido, ou saldo a produzir menor ou igual a zero."})]}),n.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[n.jsx("input",{type:"checkbox",checked:ae,onChange:L=>He(L.target.checked),className:"h-4 w-4 text-blue-600"}),"Mostrar pedidos finalizados"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Qtd. Pedido"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Apontado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Separado"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Saldo a Produzir"}),n.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"Nenhum pedido elegvel para finalizao no momento."})}):B.map(L=>{const Y=Number(L.qtd_pedido||0),ke=Number(f[L.pedido_seq]||L.apontadoManual||0),Pe=Y>0?Math.round(ke/Y*100):0;return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.pedido_seq}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:L.produto||"-"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Y.toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:ke.toLocaleString("pt-BR")}),n.jsxs("span",{className:`text-xs font-medium ${ke>=Y?"text-green-600":"text-gray-500"}`,children:["(",Pe,"%)"]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Number(L.separado||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Number(L.saldo_a_prod||0).toLocaleString("pt-BR")}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:n.jsxs("div",{className:"flex gap-2",children:[!L.finalizado_manual&&n.jsx("button",{onClick:()=>re(L),className:"px-3 py-1 bg-green-600 text-white text-xs font-semibold rounded-md hover:bg-green-700",children:"Finalizar"}),L.finalizado_manual&&n.jsx("button",{onClick:()=>xe(L),className:"px-3 py-1 bg-yellow-500 text-white text-xs font-semibold rounded-md hover:bg-yellow-600",children:"Reabrir"})]})})]},`${L.id}-finalizacao`)})})]})})})]})]})},fE="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABmCAYAAACgJz3XAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAz6SURBVHgB7VxdbBTXFf5mf+z1ggOmViBFMUPtJqTNj5MI2ihK2FZJnJJICQ+o6Utrkj61UgsPVauqKo7UVspDlUSV8hKpmIdSngqoCRGJBKYFKQ4SMX1IaILlxeEnJgYbbPDi9e7knJl7d+/M7N/YO7NrvJ90mbl3zpy9882Zc+899xjt+S2/NVDHeOfQa5paf/6539d3f9/9i+Zsi6D+cYdynkb9g/sriZ6lMrMYSH5QnjQ3N3+F+seDkUgEc3Nz3N/Lt27d+rwuSW5rW477H+jAN9d+A3/449a/xePxNdweCoWy585dwczMLC5evIrhs19ieHgM9QQiOEIEs0vTDMMIm22oE8RamrBxYxeRuw5dXXepl7rVSleXyTceoJeAHuDq1WmT7MOHT2NiYhq1BhPMlsyYnZ01j3VB8hNPfgc9zz6MlpZmeMWqVcuxalMXNlI5+dFZInuIyL6BWoKI1pjopqYmk+iaktxGBL30kyeclutCOp2fUIToAwyHtIJyTHRn12rs/9eH+OSTC8iPP8GDfTKRbHa8ZiQzwb/45Y/IEltd11IpA9ems7g+ncFMyj1ja4lpiDWHsGpFCMviIds11vfKz5/GoUMn8cH7/yM/HuwjkgVrwiezFZtvuSYkFyN4liz2/KU5TN/MlryfiZ9JZTBxLYOmqIbV7WG0rQjbZLZs2Yip61M4ceIzRKMtCApswRCfEFsyu4sQAgYPcIUIHr+awecj6bIEO8Ev5gt6MRfHMshk7Vb/45d+iLs77iCLukm12q1hAie5p6fbRfDYOJF0ec5FkheMT8xheDTt0rF9+xYYxgwRnUJAyHVAuotASWY38eTm+21tbMFj4xlUA+zLk+fnbG3t7Svx1FOP0tz6Gn3KtxAA5GhryIEvUJJ7eh621flTZwuuJm6QuxmfsL+0Z3q+R6uvEBE9RVbtzR3NBzT42Qa+wEhu4cXGpm/b2qplwU6wXtVtxOMxPP74g2TJKZoOzsBPCILlwGe2BUZyZ+caW52tmGcHfiCTMXB9ym6xHevWIJvNkHXN+GrNPLuQMwy54guMZI5DqEil/P1snbOUDRvWmce5zCy9BP+CeWJJbRt9AyOZl78qZm75O6W6cdOunwdATdOQzWR8HQDlkloF1YxjspLNZqNzmXTcehHFlqTyWiVH5M5p4GF/kfMZs+ng562p1PRZaCGOj2VoJZgi1rlrBnWxUMdh1q3rFvK05OXcVBlMNGxK7FhNb2GD8CmqTK4DctmoLB8150+JeKrZxgMB6zty5Mjv1q5d+6yUuTg255oFVBO8EtzQ2WRru++++3aaD6Rpk1RGqV9qBzTRd0O1RgcXOXegEGk4dSjgOOwZ57L6Bt08Km+goDMo6GwTEMFoV3ssFjNSqZR5Dz2A2QlFzli2bNkFOEjwE1GH/nQ6fYP6dTlDoyIRNREOh7/g0C/3WZWTz8fgvjufle7LHWW7lFGPBI3Op/jESTIHZHNxQieRpdqps65r6nlbW9txCmK/IuvLlvlL8opW+3AzPT19lki+xOcU/B+nvo3QacFPqdgzFKqrbc6jgOHbkz7/3G9sTpfnyX/6809tMsOjs64BqlpgV6F+LXv/cZhizR+ag18stpz6sxKH3nstkFhoYLML3jIaPnvJ1tbeFoYfaKMQqNMdnTp1xvSYPI5x+JPJJqyAtfHJwRTfQnWBLqsPHz5lq69oDVM8uLrGFDVDn3YvePz4aXw1PmmehyjqH4nkBsQHYG18PkTHu+FTlD9QkoeHL7msWV8bdQ1S80WIdkxYn9OKD+wfsE4MfgkxGrSiZpXIDXOhwS5CS2B/PivUINS5b99/TNchEQ5r6OyI0k7HwohmglkP75qoYIJNKzZ46ypML4C9Qk5GE1M0Qy6B/UDgJF+9OoXdf//A1saWd8/6JtzZPj9jYpdzz3o3we/TQHfgwDGLUvonGomRJTdLf6zuYmgymOMHAieZwW6DLdqJNeRLeVbAA1c5F8KWy+R+i6y3s6PJ5SKO/3cIe/cepmCQtVpgFxFraSWCXS9ShiV9W4LWbCP15Eef4cL5K3j55afNYL4Ek3X3XZbP5CAP7+dlKWzJy3C+xuSyxXIptmu9n1zEgf3HcvUwDXaxWCsdozY5sTI1V3c0d4ZfLqOmKQEXL17BW2+9i6ef6camTfe6ri+nnejl8YrVYZx879tvH8SZT5NWWMKwLDgev4O+jHjOTUjIpb+6+ekHap7cwj563z+P4b1Dg7SD8Sgee+y78IozZ5LkHk7j+InTRKwBTTjhpqaYacGRSLOLYAE1RnH7uQsVGkXGrl+/ZZL9zr9PmAH+7ofvMcOTHR1rXPI3b6YwOjpmkstW+ykdTT38Dy1iQ+EIxQ/iVJab8+IykMGe29eS89DMRcLMTBZDQ6MYHDxjBtgHB/f96pFHHmlnAQpCTYbDnX9lktXYl2Wl5KPDnBoVp9KirurK/rCIvN3elqyCrZoXDPyJZ40MR88uDA4OjlPUK0aXrz/2/fU0gEVMOfYLfC5XceFwkzkX1io0SnUXQ+at+YG6zU9mKwxrESZiggcmClGGKFw63traLiSYm5ApJy3ZK1ivzCX2c55c90ngymecIauerWZumySYNyCwNHxyefjwOcsdHviJmqz4PMJwHKsKPwc8icVAMsNcNMi0Jz/0+6h7UbgLrcj5gqHuKsuUKj+wWCzZHKT8COKItCpZfMGiGfj8ii8o1ry0LblQ6lO19S7peTJDzmU5HFll5JJybqudEa+Qub6wtoiqas3CVfjukxfNFM6PSJlwF5pSfEHdkyx2LlyZklVCznqX+jwZSmJjtfXKU19XfYsqduEDNPnnB43FiAWj2tMsmSbL535O4QJJuCPcSWWDGlKUn6oMN0LJGpfWpcZ7uY2mcGNkcf9XZFdTuVfcI+VdSdjKb8i6zEFWZb+kouquGoJyF+loNDqdTtvT66mNdz7gaNOknHIuE86deat885SqhwP4oq7R0eB2JljKqLKOEGdgf03pF9haeEczvG3bNtuRSyKRiMhzh1yEj+q5U69TH+tSdau/ocrIosgsJtfZgBNsYW/AytMthlepJLH08CKVFxxtnJbUL851UQZEfSWVX8Piy4Uk7EtLZ0lg6YH/S55ifDD5/eK8T8jvoDKBIoNmww8VRkI5P0dl0nHtZ6JtSLSxxa8spowdvy7O+TgizvupbHco1pU6/8ABuDtWTIY78KI4HxJ1vUI9Sdg/ST/1DAg5lbBecTwKy11IHX2YB3TkP4ndSvsuFP5sRjzI6I42VeaooufjInp2B6gnAYtAta7Dbt0J8Xt9on4UFUbydBQmeQLF/VN3hTI6Svt91JFMH9wky3sSjnv7xLWjKEFyJT5ZfjoHqaynsrPANXnkT+8HsI+wTl+1R8gcRHFUS+ZN0edyeraWuK7Dcp8jmOckwMvAx9aahH0QcOIa8n6NcQzu6V9SyJTSUy2ZSZTvM1+XAxj31+nbd8Ma6OYNr7OLBKy5YDkkYVlZArWfYyeobC4jwy9B9neoiEw/8nNkT/ASu+DRuFepF7JSiQHUB9ggdin1/iJyTPJAkWv8nL3IP6sOj/BiySuVH60XKy0H2ed+WL55O7yjDwt8Ti8kJ5EndwDWKqe7zD0sq6N2GECeXLbWXagBvJA8IAoTyyPt6yi+ytFhTWuOorYkS5fWC6vPfagB5rOslvPeUkigvmIeCZRY9voNLwMfk9tH5aESMusqkKkEmyvQ84L4vc0L1OM7KiGZAyT8MN1w++CkQ0aH2+8lURmcQZhEGR2F+jMfPb6jEnfRC3fn+EHUOHMlMuUg5ScLtL9ZQH6PolveW07Pq2igLHS44wZ1j0Y8OQA0SA4Aiy2DiP2qXLUNoYEGGmiggQY8QsPih478qo53NSaxyKHDyjja7Si9BWS5LYigDEcDDdEvL0igthHColB3ZZ0lIWR4B2VEtOnwF7r4nY893MPxDvkcCQSA+ezxlbvGJOsIBvxbvBO91eM9CVhuJRDXMt/FCAfDE8gneZSCM1tnCPZPVe4OF8roScLaKJA6ZGpUUsi+IYrUpUbmDiAf+5Z6gHygqB/uiJ2u1AtlJQUC6RoGRD0Bd8CmX2nTUTioU0pmBO6snwnH9ZXK7x+FPXVKyjmziHYIGb53l9CZEG2vo7ALLGdAFaEeYxe6o94L+wDK16W19qO4C3PGmqUck93n0LmjiI4EquD66pFkmRkkYxMyJ2KnNzWmPN93TtQrmenInfg9SpuOBWIhJPfCnjNXLSRhzwySORFeA0JD8J7/MQJ7BlRVMN+BbzPKZ+U0INCIJweAhZDM0yAv89Mli/mSzANEH26DOEEQaLiLANAgOQAETXJdZPSUgMySqurMKYiN1FIZPfUC7iMvVgplJS14wzYIS3Zm7iRRP0niErw6TDraJkV7Y3BvoIEGGmigAS/4Gl8taZUFJWhPAAAAAElFTkSuQmCC",Ou="/assets/LogoTecnoRedeSocial-SemFundo-d83ab761.png",hE=({isOpen:e,onToggle:t,onClose:r,isMobile:a})=>{const[s,i]=I.useState(!1),[o,c]=I.useState(!1),{user:l}=Ms(),u=[{path:"/dashboard",name:"Dashboard",icon:n.jsx(xf,{}),roles:["admin","supervisor","operador"]},{path:"/pedidos",name:"Pedidos e Produtos",icon:n.jsx(i1,{}),roles:["admin","supervisor","operador"]},{path:"/apontamentos-usinagem",name:"Apontamentos de Usinagem",icon:n.jsx(t1,{}),roles:["admin","supervisor","operador"]},{path:"/apontamentos-embalagem",name:"Apontamentos de Embalagem",icon:n.jsx(uf,{}),roles:["admin","supervisor","operador"]},{path:"/apontamentos-paradas",name:"Apontamentos de Paradas",icon:n.jsx(Dl,{}),roles:["admin","supervisor","operador"]},{path:"/relatorios",name:"Relatrios",icon:n.jsx(Qg,{}),roles:["admin","supervisor","operador"]},{path:"/estoque",name:"Estoque",icon:n.jsx(b1,{}),roles:["admin","supervisor","operador"]},{path:"/previsao-trabalho",name:"Previso Trab.",icon:n.jsx(Oi,{}),roles:["admin","supervisor","operador"]},{path:"/pcp",name:"PCP",icon:n.jsx(g1,{}),roles:["admin","supervisor"]},{path:"/configuracoes",name:"Configuraes",icon:n.jsx(r1,{}),roles:["admin"]}].filter(h=>!l||!l.role?!1:h.roles.includes(l.role)),f=()=>{a?t():i(!s)},m=()=>{a&&r()};return n.jsxs("div",{className:`bg-blue-800 text-white flex flex-col
        ${a?`fixed inset-y-0 left-0 z-30 w-64 transform transition-transform duration-300 ease-in-out shadow-lg ${e?"translate-x-0":"-translate-x-full"}`:`relative ${s?"w-16":"w-64"} min-h-screen transition-all duration-300 ease-in-out`}`,children:[n.jsx("div",{className:"flex items-center justify-center p-3 border-b border-blue-700",children:n.jsx("button",{onClick:f,className:"p-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-600 transition-colors","aria-label":a?"Fechar menu":s?"Expandir menu":"Recolher menu",children:a?n.jsx(Ys,{}):s?n.jsx(dl,{}):n.jsx(dl,{})})}),n.jsx("div",{className:"flex flex-col items-center px-2 py-4 border-b border-blue-700",children:!s||a?n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsx("button",{type:"button",onClick:()=>c(!0),className:"bg-white rounded-lg p-3 mb-2 shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-300","aria-label":"Visualizar logo",children:n.jsx("img",{src:fE,alt:"Tecnoperfil",className:"h-12 w-auto"})}),n.jsxs("div",{className:"text-center",children:[n.jsx("h2",{className:"text-lg font-bold text-white",children:"Tecnoperfil"}),n.jsx("p",{className:"text-xs text-blue-200",children:"Controle de Usinagem"})]})]}):n.jsx("button",{type:"button",onClick:()=>c(!0),className:"flex items-center justify-center focus:outline-none focus:ring-2 focus:ring-blue-300 rounded mt-2","aria-label":"Visualizar logo",children:n.jsx("img",{src:Ou,alt:"Tecnoperfil",className:"h-10 w-10 object-contain"})})}),n.jsx("nav",{className:"flex-1 overflow-y-auto py-2",children:n.jsx("div",{className:"space-y-1 px-2",children:u.map(h=>n.jsxs(dx,{to:h.path,onClick:m,className:({isActive:g})=>`flex items-center ${s&&!a?"justify-center":"space-x-3"} py-2 px-3 rounded-lg transition-all duration-200 ${g?"bg-blue-700 text-white shadow-md":"text-blue-100 hover:bg-blue-700 hover:text-white"}`,title:h.name,children:[n.jsx("div",{className:"text-lg flex-shrink-0",children:h.icon}),(!s||a)&&n.jsx("span",{className:"font-medium truncate",children:h.name})]},h.path))})}),o&&n.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[n.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:()=>c(!1)}),n.jsxs("div",{className:"relative z-10 max-w-[90vw] max-h-[90vh] p-4",children:[n.jsx("img",{src:Ou,alt:"Logo Tecnoperfil",className:"max-w-[80vw] max-h-[80vh] object-contain rounded-lg shadow-2xl"}),n.jsx("button",{type:"button",onClick:()=>c(!1),className:"absolute -top-2 -right-2 bg-white text-blue-800 rounded-full w-8 h-8 shadow hover:bg-gray-100","aria-label":"Fechar",children:""})]})]})]})},mE=({onMenuClick:e,isMobile:t})=>{const[r,a]=I.useState(!1),s=ux(),{logout:i}=Ms(),o=()=>{try{i()}finally{s("/login"),a(!1)}};return n.jsxs("header",{className:"bg-white shadow h-16 flex items-center justify-between px-4 md:px-6",children:[n.jsxs("div",{className:"flex items-center space-x-4",children:[t&&n.jsx("button",{onClick:e,className:"p-2 rounded-md text-gray-600 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors","aria-label":"Abrir menu",children:n.jsx(dl,{className:"w-5 h-5"})}),n.jsx("h1",{className:"text-lg md:text-xl font-semibold text-gray-800 truncate",children:"Controle de Usinagem"})]}),n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>a(!r),className:"flex items-center space-x-2 focus:outline-none",children:[n.jsx("span",{className:"text-gray-700",children:"Usurio"}),n.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),r&&n.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10",children:n.jsx("button",{onClick:o,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Sair"})})]})]})},xE=()=>{const[e,t]=I.useState(!1),[r,a]=I.useState(!1);I.useEffect(()=>{const o=()=>{const c=window.innerWidth<768;a(c),c||t(!1)};return o(),window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]);const s=()=>{t(!e)},i=()=>{t(!1)};return n.jsxs("div",{className:"flex h-screen bg-gray-100",children:[r&&e&&n.jsx("div",{className:"fixed inset-0 z-20 bg-black bg-opacity-50 transition-opacity",onClick:i}),n.jsx(hE,{isOpen:e,onToggle:s,onClose:i,isMobile:r}),n.jsxs("div",{className:"flex flex-col flex-1 min-w-0 overflow-hidden",children:[n.jsx(mE,{onMenuClick:s,isMobile:r}),n.jsx("main",{className:"flex-1 overflow-auto bg-white p-4",children:n.jsx(fx,{})})]})]})},pE=({children:e,allowedRoles:t=[]})=>{const{user:r}=Ms();return t.length===0?e:!r||!r.role?n.jsx(Mn,{to:"/dashboard",replace:!0}):t.includes(r.role)?e:n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:n.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-6xl mb-4",children:""}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Acesso Negado"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"Voc no tem permisso para acessar esta pgina."}),n.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Nvel de acesso necessrio: ",n.jsx("strong",{children:t.join(", ")})]}),n.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:["Seu nvel de acesso: ",n.jsx("strong",{children:r.role})]}),n.jsx("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Voltar"})]})})})};function ex(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=ex(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function gE(){for(var e,t,r=0,a="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=ex(e))&&(a&&(a+=" "),a+=t);return a}const Du={success:"border-green-200 bg-green-50 text-green-800",error:"border-red-200 bg-red-50 text-red-800",warning:"border-yellow-200 bg-yellow-50 text-yellow-800",info:"border-blue-200 bg-blue-50 text-blue-800"},vE=()=>{const{toasts:e,removeToast:t}=zg();return e.length?n.jsx("div",{className:"fixed inset-x-0 top-4 z-[9999] flex flex-col items-center gap-2 px-4",children:e.map(r=>n.jsx("div",{className:gE("min-w-[280px] max-w-lg rounded-md border px-4 py-3 text-sm shadow-lg transition-all",Du[r.type]||Du.info),children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsx("p",{className:"flex-1 whitespace-pre-line",children:r.message}),n.jsx("button",{type:"button",onClick:()=>t(r.id),className:"text-xs font-semibold uppercase tracking-wide text-gray-500 hover:text-gray-700",children:"Fechar"})]})},r.id))}):null};function yE(){const{user:e,login:t}=Ms(),r=!!e,a=(s,i)=>t(s,i);return n.jsxs(Hg,{children:[n.jsxs(hx,{children:[n.jsx(Gr,{path:"/login",element:r?n.jsx(Mn,{to:"/dashboard",replace:!0}):n.jsx(Vg,{onLogin:a})}),n.jsxs(Gr,{path:"/",element:r?n.jsx(xE,{}):n.jsx(Mn,{to:"/login",replace:!0}),children:[n.jsx(Gr,{index:!0,element:n.jsx(Mn,{to:"/dashboard",replace:!0})}),n.jsx(Gr,{path:"dashboard",element:n.jsx(_1,{})}),n.jsx(Gr,{path:"apontamentos-usinagem",element:n.jsx(pf,{})}),n.jsx(Gr,{path:"apontamentos-embalagem",element:n.jsx(S1,{})}),n.jsx(Gr,{path:"estoque",element:n.jsx(N1,{})}),n.jsx(Gr,{path:"apontamentos-paradas",element:n.jsx(k1,{})}),n.jsx(Gr,{path:"relatorios",element:n.jsx(Ek,{})}),n.jsx(Gr,{path:"previsao-trabalho",element:n.jsx(Tk,{})}),n.jsx(Gr,{path:"pcp",element:n.jsx(uE,{})}),n.jsx(Gr,{path:"configuracoes",element:n.jsx(pE,{allowedRoles:["admin"],children:n.jsx(lE,{})})}),n.jsx(Gr,{path:"pedidos",element:n.jsx(dE,{})}),n.jsx(Gr,{path:"carteira-encomendas",element:n.jsx(Mn,{to:"/pedidos",replace:!0})})]}),n.jsx(Gr,{path:"*",element:n.jsx(Mn,{to:r?"/dashboard":"/login",replace:!0})})]}),n.jsx(vE,{})]})}Yc.createRoot(document.getElementById("root")).render(n.jsx(Fs.StrictMode,{children:n.jsx(mx,{children:n.jsx(Ug,{children:n.jsx(yE,{})})})}));
